Upstream patch level 8 from 5, minus HTML file patches consisting entirely of
'meta name="date"' changes.

Index: petsc/conf/rules
===================================================================
--- petsc.orig/conf/rules
+++ petsc/conf/rules
@@ -878,6 +878,10 @@
 # rules for building different shared libraries
 shared_none:
 
+shared_linux_ibm:
+	-@cd ${SHARED_LIBRARY_TMPDIR}; \
+        ${CLINKER} -qmkshrobj -o ${INSTALL_LIB_DIR}/$$LIBNAME.${SL_LINKER_SUFFIX} *.o ${PETSC_EXTERNAL_LIB_BASIC}
+
 shared_linux_intel:
 	-@cd ${SHARED_LIBRARY_TMPDIR}; \
 	${CLINKER} -shared -o ${INSTALL_LIB_DIR}/$$LIBNAME.${SL_LINKER_SUFFIX} *.o ${PETSC_EXTERNAL_LIB_BASIC}
Index: petsc/config/BuildSystem/config/packages/BlasLapack.py
===================================================================
--- petsc.orig/config/BuildSystem/config/packages/BlasLapack.py
+++ petsc/config/BuildSystem/config/packages/BlasLapack.py
@@ -191,8 +191,6 @@
         f2cLibs = f2cLibs+self.libraries.math
       yield ('User specified installation root (F2C)', f2cLibs, os.path.join(dir, 'libf2clapack.a'), 1)
       yield ('User specified installation root', os.path.join(dir, 'libfblas.a'),   os.path.join(dir, 'libflapack.a'), 1)
-      yield ('User specified ATLAS Linux installation root', [os.path.join(dir, 'libcblas.a'),os.path.join(dir, 'libf77blas.a'), os.path.join(dir, 'libatlas.a')],  [os.path.join(dir, 'liblapack.a')], 1)
-      yield ('User specified ATLAS Linux installation root', [os.path.join(dir, 'libf77blas.a'), os.path.join(dir, 'libatlas.a')],  [os.path.join(dir, 'liblapack.a')], 1)
       # Check AMD ACML libraries
       yield ('User specified AMD ACML lib dir', None, os.path.join(dir,'lib','libacml.a'), 1)
       yield ('User specified AMD ACML lib dir', None, [os.path.join(dir,'lib','libacml.a'), os.path.join(dir,'lib','libacml_mv.a')], 1)
@@ -202,11 +200,11 @@
       yield ('User specified MKL Linux lib dir', None, [os.path.join(dir, 'libmkl_lapack.a'), 'mkl', 'guide', 'pthread'], 1)
       for libdir in ['32','64','em64t']:
         yield ('User specified MKL Linux installation root', None, [os.path.join(dir,'lib',libdir,'libmkl_lapack.a'),'mkl', 'guide', 'pthread'], 1)
-      # Some new MLK 11 variations
-      yield ('User specified MKL11 Linux-x86 lib dir', None, [os.path.join(dir, 'libmkl_lapack.a'), 'mkl_intel', 'mkl_intel_thread', 'mkl_core', 'guide', 'pthread'], 1)
-      yield ('User specified MKL11 Linux-x86 installation root', None, [os.path.join(dir,'lib','em64t','libmkl_lapack.a'),'mkl_intel', 'mkl_intel_thread', 'mkl_core', 'guide', 'pthread'], 1)
-      yield ('User specified MKL11 Linux-em64t lib dir', None, [os.path.join(dir, 'libmkl_lapack.a'), 'mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'guide', 'pthread'], 1)
-      yield ('User specified MKL11 Linux-em64t installation root', None, [os.path.join(dir,'lib','em64t','libmkl_lapack.a'),'mkl_intel_lp64', 'mkl_intel_thread', 'mkl_core', 'guide', 'pthread'], 1)
+      # Some new MKL 11/12 variations
+      for libdir in ['',os.path.join('lib','32'),os.path.join('lib','ia32')]:
+        yield ('User specified MKL11/12 Linux32', None, [os.path.join(dir,libdir,'libmkl_intel.a'),'mkl_intel_thread','mkl_core','iomp5','pthread'],1)
+      for libdir in ['',os.path.join('lib','em64t'),os.path.join('lib','intel64')]:
+        yield ('User specified MKL11/12 Linux64', None, [os.path.join(dir,libdir,'libmkl_intel_lp64.a'),'mkl_intel_thread','mkl_core','iomp5','pthread'],1)
       # Older Linux MKL checks
       yield ('User specified MKL Linux-x86 lib dir', None, [os.path.join(dir, 'libmkl_lapack.a'), 'libmkl_def.a', 'guide', 'pthread'], 1)
       yield ('User specified MKL Linux-x86 lib dir', None, [os.path.join(dir, 'libmkl_lapack.a'), 'libmkl_def.a', 'guide', 'vml','pthread'], 1)
@@ -241,6 +239,9 @@
       mkldir = os.path.join(dir, 'ia64', 'lib')
       yield ('User specified ia64 MKL Windows installation root', None, [os.path.join(mkldir, 'mkl_dll.lib')], 1)
       yield ('User specified MKL10-64 Windows installation root', None, [os.path.join(mkldir, 'mkl_intel_lp64_dll.lib'),'mkl_intel_thread_dll.lib','mkl_core_dll.lib','libiomp5md.lib'], 1)
+      # Search for atlas
+      yield ('User specified ATLAS Linux installation root', [os.path.join(dir, 'libcblas.a'),os.path.join(dir, 'libf77blas.a'), os.path.join(dir, 'libatlas.a')],  [os.path.join(dir, 'liblapack.a')], 1)
+      yield ('User specified ATLAS Linux installation root', [os.path.join(dir, 'libf77blas.a'), os.path.join(dir, 'libatlas.a')],  [os.path.join(dir, 'liblapack.a')], 1)
       # Search for liblapack.a and libblas.a after the implementations with more specific name to avoid
       # finding these in /usr/lib despite using -L<blas-lapack-dir> while attempting to get a different library.
       yield ('User specified installation root', os.path.join(dir, 'libblas.a'),    os.path.join(dir, 'liblapack.a'), 1)
@@ -307,7 +308,7 @@
     return
 
   def getSharedFlag(self,cflags):
-    for flag in ['-PIC', '-fPIC', '-KPIC']:
+    for flag in ['-PIC', '-fPIC', '-KPIC', '-qpic']:
       if cflags.find(flag) >=0: return flag
     return ''
 
Index: petsc/config/BuildSystem/config/setCompilers.py
===================================================================
--- petsc.orig/config/BuildSystem/config/setCompilers.py
+++ petsc/config/BuildSystem/config/setCompilers.py
@@ -875,7 +875,7 @@
       languages.append('FC')
     for language in languages:
       self.pushLanguage(language)
-      for testFlag in ['-PIC', '-fPIC', '-KPIC']:
+      for testFlag in ['-PIC', '-fPIC', '-KPIC','-qpic']:
         try:
           self.framework.logPrint('Trying '+language+' compiler flag '+testFlag)
           if not self.checkLinkerFlag(testFlag):
@@ -1083,6 +1083,7 @@
       yield (self.CXX, ['-shared'], 'so')
     # C compiler default
     yield (self.CC, ['-shared'], 'so')
+    yield (self.CC, ['-qmkshrobj'], 'so')
     # Solaris default
     if Configure.isSolaris():
       if hasattr(self, 'CXX') and self.mainLanguage == 'Cxx':
Index: petsc/config/configure.py
===================================================================
--- petsc.orig/config/configure.py
+++ petsc/config/configure.py
@@ -323,7 +323,7 @@
       try:
         framework.log.write(msg+se)
         traceback.print_tb(sys.exc_info()[2], file = framework.log)
-        close(framework.log)
+        if hasattr(framework,'log'): close(framework.log)
         move_configure_log(framework)
       except:
         pass
@@ -332,7 +332,7 @@
     print se
     import traceback
     traceback.print_tb(sys.exc_info()[2])
-  close(framework.log)
+  if hasattr(framework,'log'): close(framework.log)
   move_configure_log(framework)
 
 if __name__ == '__main__':
Index: petsc/config/PETSc/packages/blopex.py
===================================================================
--- petsc.orig/config/PETSc/packages/blopex.py
+++ petsc/config/PETSc/packages/blopex.py
@@ -3,7 +3,7 @@
 class Configure(PETSc.package.NewPackage):
   def __init__(self, framework):
     PETSc.package.NewPackage.__init__(self, framework)
-    self.download   = ['http://ftp.mcs.anl.gov/pub/petsc/externalpackages/blopex-1.1.tar.gz']
+    self.download   = ['http://ftp.mcs.anl.gov/pub/petsc/externalpackages/blopex-1.1.1.tar.gz']
     self.functions  = ['lobpcg_solve']
     self.includes   = ['interpreter.h']
     self.liblist    = [['libBLOPEX.a']]
@@ -17,6 +17,10 @@
     # Hypre has blopex sources/includes for eg: interpreter.h which can conflict with one in petsc.
     # hence attepmt to build hypre before blopex - so blopex's interpreter.h is the one that gets used.
     if self.framework.argDB.has_key('download-hypre') and self.framework.argDB['download-hypre']:
+      if self.framework.argDB.has_key('download-openmpi') and self.framework.argDB['download-openmpi']:
+        if self.framework.argDB.has_key('download-blopex') and self.framework.argDB['download-blopex']:
+          raise RuntimeError('Cannot use BLOPEX with --download-hypre aswell as --download-openmpi.\n\
+Suggest using --download-mpich or install openmpi separately - and specify mpicc etc to petsc configure.\n')
       self.hypre      = framework.require('PETSc.packages.hypre',self)
       self.deps       = [self.blasLapack,self.hypre]
     else:
@@ -32,7 +36,11 @@
     g.write('CFLAGS      = ' + self.setCompilers.getCompilerFlags().replace('-Wall','').replace('-Wshadow','') +'\n')
     self.setCompilers.popLanguage()
     g.write('AR          = '+self.setCompilers.AR+' '+self.setCompilers.AR_FLAGS+'\n')
+    g.write('AR_LIB_SUFFIX = '+self.setCompilers.AR_LIB_SUFFIX+'\n')
     g.write('RANLIB      = '+self.setCompilers.RANLIB+'\n')
+    # blopex uses defaut 'make' targets, and this uses TARGET_ARCH var. If this var
+    # is set incorrectly in user env - build breaks.
+    g.write('TARGET_ARCH = \n')
     g.close()
 
     if self.installNeeded('Makefile.inc'):
Index: petsc/config/PETSc/packages/pARMS.py
===================================================================
--- petsc.orig/config/PETSc/packages/pARMS.py
+++ petsc/config/PETSc/packages/pARMS.py
@@ -39,7 +39,7 @@
     if hasattr(self.compilers, 'FC'):
       self.setCompilers.pushLanguage('FC')
       g.write('FC         = '+self.setCompilers.getCompiler()+'\n')
-      g.write('FFLAGS     = '+self.setCompilers.getCompilerFlags()+' -DVOID_POINTER_SIZE_'+str(self.types.sizes['known-sizeof-void_p'])+'\n')
+      g.write('FFLAGS     = '+self.setCompilers.getCompilerFlags()+' -DVOID_POINTER_SIZE_'+str(self.types.sizes['known-sizeof-void-p'])+'\n')
       # this mangling information is for both BLAS and the Fortran compiler so cannot use the BlasLapack mangling flag      
       # set fortran name mangling
       if self.compilers.fortranMangling == 'underscore':
@@ -48,7 +48,7 @@
         g.write('CFDEFS     = -DFORTRAN_CAPS\n')
       else:
         g.write('CFDEFS     = -DFORTRAN_DOUBLE_UNDERSCORE\n') 
-      g.write('CFFLAGS    = ${CFDEFS} -DVOID_POINTER_SIZE_'+str(self.types.sizes['known-sizeof-void_p'])+'\n')
+      g.write('CFFLAGS    = ${CFDEFS} -DVOID_POINTER_SIZE_'+str(self.types.sizes['known-sizeof-void-p'])+'\n')
       self.setCompilers.popLanguage()
       
     else:
Index: petsc/config/PETSc/utilities/sharedLibraries.py
===================================================================
--- petsc.orig/config/PETSc/utilities/sharedLibraries.py
+++ petsc/config/PETSc/utilities/sharedLibraries.py
@@ -47,6 +47,8 @@
     if self.useShared:
       if config.setCompilers.Configure.isSolaris() and config.setCompilers.Configure.isGNU(self.framework.getCompiler()):
         self.addMakeRule('shared_arch','shared_'+self.arch.hostOsBase+'gnu')
+      elif '-qmkshrobj' in self.setCompilers.sharedLibraryFlags:
+        self.addMakeRule('shared_arch','shared_linux_ibm')
       else:
         self.addMakeRule('shared_arch','shared_'+self.arch.hostOsBase)
       self.addMakeMacro('BUILDSHAREDLIB','yes')
Index: petsc/configure
===================================================================
--- petsc.orig/configure
+++ petsc/configure
@@ -323,7 +323,7 @@
       try:
         framework.log.write(msg+se)
         traceback.print_tb(sys.exc_info()[2], file = framework.log)
-        close(framework.log)
+        if hasattr(framework,'log'): close(framework.log)
         move_configure_log(framework)
       except:
         pass
@@ -332,7 +332,7 @@
     print se
     import traceback
     traceback.print_tb(sys.exc_info()[2])
-  close(framework.log)
+  if hasattr(framework,'log'): close(framework.log)
   move_configure_log(framework)
 
 if __name__ == '__main__':
Index: petsc/include/finclude/petsckspdef.h
===================================================================
--- petsc.orig/include/finclude/petsckspdef.h
+++ petsc/include/finclude/petsckspdef.h
@@ -45,4 +45,6 @@
 #define KSPSYMMLQ 'symmlq'
 #define KSPLCD 'lcd'
 #define KSPPYTHON 'python'
+#define KSPBROYDEN 'broyden'
+#define KSPGCR 'gcr'
 #endif
Index: petsc/include/finclude/petsckspdef.h.html
===================================================================
--- petsc.orig/include/finclude/petsckspdef.h.html
+++ petsc/include/finclude/petsckspdef.h.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:54:39+00:00">
+<meta name="date" content="2011-03-17T19:13:09+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -54,7 +54,9 @@
 <a name="line45"> 45: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/KSP/KSPSYMMLQ.html#KSPSYMMLQ">KSPSYMMLQ</A> 'symmlq'</font></strong>
 <a name="line46"> 46: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/KSP/KSPLCD.html#KSPLCD">KSPLCD</A> 'lcd'</font></strong>
 <a name="line47"> 47: </a><strong><font color="#228B22">#define KSPPYTHON 'python'</font></strong>
-<a name="line48"> 48: </a><font color="#A020F0">#endif</font>
+<a name="line48"> 48: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/KSP/KSPBROYDEN.html#KSPBROYDEN">KSPBROYDEN</A> 'broyden'</font></strong>
+<a name="line49"> 49: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/KSP/KSPGCR.html#KSPGCR">KSPGCR</A> 'gcr'</font></strong>
+<a name="line50"> 50: </a><font color="#A020F0">#endif</font>
 </pre>
 </body>
 
Index: petsc/include/finclude/petscmatdef.h
===================================================================
--- petsc.orig/include/finclude/petscmatdef.h
+++ petsc/include/finclude/petscmatdef.h
@@ -103,6 +103,10 @@
 #define MATPYTHON          'python'
 #define MATHYPRESTRUCT     'hyprestruct'
 #define MATHYPRESSTRUCT    'hypresstruct'
+#define MATSUBMATRIX       'submatrix'
+#ifdef PETSC_USE_MATFWK
+#define MATFWK           'matfwk'
+#endif
 !
 ! MatSolverPackages
 !
@@ -113,8 +117,10 @@
 #define MAT_SOLVER_ESSL         'essl'
 #define MAT_SOLVER_LUSOL        'lusol'
 #define MAT_SOLVER_MUMPS        'mumps'
+#define MAT_SOLVER_PASTIX       'pastix'
 #define MAT_SOLVER_DSCPACK      'dscpack'
 #define MAT_SOLVER_MATLAB       'matlab'
 #define MAT_SOLVER_PETSC        'petsc'
+#define MAT_SOLVER_PLAPACK      'plapack'
 #define MAT_SOLVER_BAS          'bas'
 #endif
Index: petsc/include/finclude/petscmatdef.h.html
===================================================================
--- petsc.orig/include/finclude/petscmatdef.h.html
+++ petsc/include/finclude/petscmatdef.h.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:54:39+00:00">
+<meta name="date" content="2011-03-17T19:13:08+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -112,21 +112,27 @@
 <a name="line103">103: </a><strong><font color="#228B22">#define MATPYTHON          'python'</font></strong>
 <a name="line104">104: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/DA/MATHYPRESTRUCT.html#MATHYPRESTRUCT">MATHYPRESTRUCT</A>     'hyprestruct'</font></strong>
 <a name="line105">105: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/DA/MATHYPRESSTRUCT.html#MATHYPRESSTRUCT">MATHYPRESSTRUCT</A>    'hypresstruct'</font></strong>
-<a name="line106">106: </a>!
-<a name="line107">107: </a>! MatSolverPackages
-<a name="line108">108: </a>!
-<a name="line109">109: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_SPOOLES.html#MAT_SOLVER_SPOOLES">MAT_SOLVER_SPOOLES</A>      'spooles'</font></strong>
-<a name="line110">110: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_SUPERLU.html#MAT_SOLVER_SUPERLU">MAT_SOLVER_SUPERLU</A>      'superlu'</font></strong>
-<a name="line111">111: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_SUPERLU_DIST.html#MAT_SOLVER_SUPERLU_DIST">MAT_SOLVER_SUPERLU_DIST</A> 'superlu_dist'</font></strong>
-<a name="line112">112: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_UMFPACK.html#MAT_SOLVER_UMFPACK">MAT_SOLVER_UMFPACK</A>      'umfpack'</font></strong>
-<a name="line113">113: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_ESSL.html#MAT_SOLVER_ESSL">MAT_SOLVER_ESSL</A>         'essl'</font></strong>
-<a name="line114">114: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_LUSOL.html#MAT_SOLVER_LUSOL">MAT_SOLVER_LUSOL</A>        'lusol'</font></strong>
-<a name="line115">115: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_MUMPS.html#MAT_SOLVER_MUMPS">MAT_SOLVER_MUMPS</A>        'mumps'</font></strong>
-<a name="line116">116: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_DSCPACK.html#MAT_SOLVER_DSCPACK">MAT_SOLVER_DSCPACK</A>      'dscpack'</font></strong>
-<a name="line117">117: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_MATLAB.html#MAT_SOLVER_MATLAB">MAT_SOLVER_MATLAB</A>       'matlab'</font></strong>
-<a name="line118">118: </a><strong><font color="#228B22">#define MAT_SOLVER_PETSC        'petsc'</font></strong>
-<a name="line119">119: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_BAS.html#MAT_SOLVER_BAS">MAT_SOLVER_BAS</A>          'bas'</font></strong>
-<a name="line120">120: </a><font color="#A020F0">#endif</font>
+<a name="line106">106: </a><strong><font color="#228B22">#define MATSUBMATRIX       'submatrix'</font></strong>
+<a name="line107">107: </a><font color="#A020F0">#ifdef PETSC_USE_MATFWK</font>
+<a name="line108">108: </a><strong><font color="#228B22">#define MATFWK           'matfwk'</font></strong>
+<a name="line109">109: </a><font color="#A020F0">#endif</font>
+<a name="line110">110: </a>!
+<a name="line111">111: </a>! MatSolverPackages
+<a name="line112">112: </a>!
+<a name="line113">113: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_SPOOLES.html#MAT_SOLVER_SPOOLES">MAT_SOLVER_SPOOLES</A>      'spooles'</font></strong>
+<a name="line114">114: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_SUPERLU.html#MAT_SOLVER_SUPERLU">MAT_SOLVER_SUPERLU</A>      'superlu'</font></strong>
+<a name="line115">115: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_SUPERLU_DIST.html#MAT_SOLVER_SUPERLU_DIST">MAT_SOLVER_SUPERLU_DIST</A> 'superlu_dist'</font></strong>
+<a name="line116">116: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_UMFPACK.html#MAT_SOLVER_UMFPACK">MAT_SOLVER_UMFPACK</A>      'umfpack'</font></strong>
+<a name="line117">117: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_ESSL.html#MAT_SOLVER_ESSL">MAT_SOLVER_ESSL</A>         'essl'</font></strong>
+<a name="line118">118: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_LUSOL.html#MAT_SOLVER_LUSOL">MAT_SOLVER_LUSOL</A>        'lusol'</font></strong>
+<a name="line119">119: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_MUMPS.html#MAT_SOLVER_MUMPS">MAT_SOLVER_MUMPS</A>        'mumps'</font></strong>
+<a name="line120">120: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_PASTIX.html#MAT_SOLVER_PASTIX">MAT_SOLVER_PASTIX</A>       'pastix'</font></strong>
+<a name="line121">121: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_DSCPACK.html#MAT_SOLVER_DSCPACK">MAT_SOLVER_DSCPACK</A>      'dscpack'</font></strong>
+<a name="line122">122: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_MATLAB.html#MAT_SOLVER_MATLAB">MAT_SOLVER_MATLAB</A>       'matlab'</font></strong>
+<a name="line123">123: </a><strong><font color="#228B22">#define MAT_SOLVER_PETSC        'petsc'</font></strong>
+<a name="line124">124: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_PLAPACK.html#MAT_SOLVER_PLAPACK">MAT_SOLVER_PLAPACK</A>      'plapack'</font></strong>
+<a name="line125">125: </a><strong><font color="#228B22">#define <A href="../../docs/manualpages/Mat/MAT_SOLVER_BAS.html#MAT_SOLVER_BAS">MAT_SOLVER_BAS</A>          'bas'</font></strong>
+<a name="line126">126: </a><font color="#A020F0">#endif</font>
 </pre>
 </body>
 
Index: petsc/include/mpiuni/mpi.h
===================================================================
--- petsc.orig/include/mpiuni/mpi.h
+++ petsc/include/mpiuni/mpi.h
@@ -633,7 +633,7 @@
      MPIUNI_TMP = (void*)(MPIUNI_INTPTR) (comm2),\
      *(result)=MPI_IDENT,\
      MPI_SUCCESS)
-#define MPI_Comm_split(comm,color,key,newcomm) MPI_SUCCESS
+#define MPI_Comm_split(comm,color,key,newcomm) MPI_Comm_dup(comm,newcomm)
 #define MPI_Comm_test_inter(comm,flag) (*(flag)=1,MPI_SUCCESS)
 #define MPI_Comm_remote_size(comm,size) (*(size)=1,MPI_SUCCESS)
 #define MPI_Comm_remote_group(comm,group) MPI_SUCCESS
Index: petsc/include/mpiuni/mpi.h.html
===================================================================
--- petsc.orig/include/mpiuni/mpi.h.html
+++ petsc/include/mpiuni/mpi.h.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:22:56+00:00">
+<meta name="date" content="2011-03-17T18:44:09+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -625,7 +625,7 @@
 <a name="line633">633: </a><strong><font color="#228B22">     MPIUNI_TMP = (void*)(MPIUNI_INTPTR) (comm2),\</font></strong>
 <a name="line634">634: </a><strong><font color="#228B22">     *(result)=MPI_IDENT,\</font></strong>
 <a name="line635">635: </a><strong><font color="#228B22">     MPI_SUCCESS)</font></strong>
-<a name="line636">636: </a><strong><font color="#228B22">#define <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_split.html#MPI_Comm_split">MPI_Comm_split</A>(comm,color,key,newcomm) MPI_SUCCESS</font></strong>
+<a name="line636">636: </a><strong><font color="#228B22">#define <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_split.html#MPI_Comm_split">MPI_Comm_split</A>(comm,color,key,newcomm) <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_dup.html#MPI_Comm_dup">MPI_Comm_dup</A>(comm,newcomm)</font></strong>
 <a name="line637">637: </a><strong><font color="#228B22">#define <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_test_inter.html#MPI_Comm_test_inter">MPI_Comm_test_inter</A>(comm,flag) (*(flag)=1,MPI_SUCCESS)</font></strong>
 <a name="line638">638: </a><strong><font color="#228B22">#define <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_remote_size.html#MPI_Comm_remote_size">MPI_Comm_remote_size</A>(comm,size) (*(size)=1,MPI_SUCCESS)</font></strong>
 <a name="line639">639: </a><strong><font color="#228B22">#define <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_remote_group.html#MPI_Comm_remote_group">MPI_Comm_remote_group</A>(comm,group) MPI_SUCCESS</font></strong>
Index: petsc/include/petscerror.h
===================================================================
--- petsc.orig/include/petscerror.h
+++ petsc/include/petscerror.h
@@ -480,6 +480,10 @@
 #define CHKERRCONTINUE(n) ;
 #define CHKMEMQ        ;
 
+#ifdef PETSC_CLANGUAGE_CXX
+#define CHKERRXX(n) ;
+#endif
+
 #if !defined(PETSC_SKIP_UNDERSCORE_CHKERR)
 #define _   
 #define ___  
Index: petsc/include/petscerror.h.html
===================================================================
--- petsc.orig/include/petscerror.h.html
+++ petsc/include/petscerror.h.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T01:28:34+00:00">
+<meta name="date" content="2011-03-17T18:42:25+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -474,168 +474,172 @@
 <a name="line480">480: </a><strong><font color="#228B22">#define CHKERRCONTINUE(n) ;</font></strong>
 <a name="line481">481: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/CHKMEMQ.html#CHKMEMQ">CHKMEMQ</A>        ;</font></strong>
 
-<a name="line483">483: </a><font color="#A020F0">#if !defined(PETSC_SKIP_UNDERSCORE_CHKERR)</font>
-<a name="line484">484: </a><strong><font color="#228B22">#define _   </font></strong>
-<a name="line486">486: </a><font color="#A020F0">#endif </font>
-
-<a name="line488">488: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionPush.html#PetscExceptionPush">PetscExceptionPush</A>(a)                0</font></strong>
-<a name="line489">489: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionPop.html#PetscExceptionPop">PetscExceptionPop</A>(a)                 0</font></strong>
-<a name="line490">490: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscErrorSetCatchable.html#PetscErrorSetCatchable">PetscErrorSetCatchable</A>(a,b)          0</font></strong>
-<a name="line491">491: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscErrorIsCatchable.html#PetscErrorIsCatchable">PetscErrorIsCatchable</A>(a)             <A href="../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font></strong>
-
-<a name="line493">493: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionCaught.html#PetscExceptionCaught">PetscExceptionCaught</A>(a,b)            <A href="../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font></strong>
-<a name="line494">494: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionValue.html#PetscExceptionValue">PetscExceptionValue</A>(a)               <A href="../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font></strong>
-<a name="line495">495: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionTry1.html#PetscExceptionTry1">PetscExceptionTry1</A>(a,b)              a</font></strong>
-<a name="line496">496: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionTrySyncNorm.html#PetscExceptionTrySyncNorm">PetscExceptionTrySyncNorm</A>(comm,a,b)  a</font></strong>
-
-<a name="line498">498: </a><font color="#A020F0">#endif</font>
-
-<a name="line500">500: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscErrorPrintfInitialize(void)</font></strong>;
-<a name="line501">501: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscErrorMessage.html#PetscErrorMessage">PetscErrorMessage</A>(int,const char*[],char **)</font></strong>;
-<a name="line502">502: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscTraceBackErrorHandler.html#PetscTraceBackErrorHandler">PetscTraceBackErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line504">504: </a><font color="#A020F0">#include &lt;sstream&gt;</font>
-<a name="line505">505: </a>EXTERN void            <A href="../docs/manualpages/Sys/PetscTraceBackErrorHandlerCxx.html#PetscTraceBackErrorHandlerCxx">PetscTraceBackErrorHandlerCxx</A>(int,const char *,const char *,const char *,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int, std::ostringstream&amp;);
-<a name="line506">506: </a><font color="#A020F0">#endif</font>
-<a name="line507">507: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscIgnoreErrorHandler.html#PetscIgnoreErrorHandler">PetscIgnoreErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line508">508: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscEmacsClientErrorHandler.html#PetscEmacsClientErrorHandler">PetscEmacsClientErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line509">509: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscMPIAbortErrorHandler.html#PetscMPIAbortErrorHandler">PetscMPIAbortErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line510">510: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscAbortErrorHandler.html#PetscAbortErrorHandler">PetscAbortErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line511">511: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscAttachDebuggerErrorHandler.html#PetscAttachDebuggerErrorHandler">PetscAttachDebuggerErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line512">512: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscReturnErrorHandler.html#PetscReturnErrorHandler">PetscReturnErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
-<a name="line513">513: </a><strong><font color="#4169E1"><a name="PetscError"></a>EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscError.html#PetscError">PetscError</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,...)</font></strong> PETSC_PRINTF_FORMAT_CHECK(7,8);
-<a name="line514">514: </a><strong><font color="#4169E1">EXTERN void            <A href="../docs/manualpages/Sys/PetscErrorCxx.html#PetscErrorCxx">PetscErrorCxx</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int)</font></strong>;
-<a name="line515">515: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPushErrorHandler.html#PetscPushErrorHandler">PetscPushErrorHandler</A>(<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*handler)(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*),void*)</font></strong>;
-<a name="line516">516: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPopErrorHandler.html#PetscPopErrorHandler">PetscPopErrorHandler</A>(void)</font></strong>;
-<a name="line517">517: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscDefaultSignalHandler.html#PetscDefaultSignalHandler">PetscDefaultSignalHandler</A>(int,void*)</font></strong>;
-<a name="line518">518: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPushSignalHandler.html#PetscPushSignalHandler">PetscPushSignalHandler</A>(<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*)(int,void *),void*)</font></strong>;
-<a name="line519">519: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPopSignalHandler.html#PetscPopSignalHandler">PetscPopSignalHandler</A>(void)</font></strong>;
-
-<a name="line521">521: </a><font color="#4169E1">typedef</font> <font color="#4169E1">enum</font> {PETSC_FP_TRAP_OFF=0,PETSC_FP_TRAP_ON=1} PetscFPTrap;
-<a name="line522">522: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   <A href="../docs/manualpages/Sys/PetscSetFPTrap.html#PetscSetFPTrap">PetscSetFPTrap</A>(PetscFPTrap)</font></strong>;
-
-<a name="line524">524: </a><font color="#B22222">/*</font>
-<a name="line525">525: </a><font color="#B22222">      Allows the code to build a stack frame as it runs</font>
-<a name="line526">526: </a><font color="#B22222">*/</font>
-<a name="line527">527: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-
-<a name="line529">529: </a><strong><font color="#228B22">#define PETSCSTACKSIZE 15</font></strong>
-
-<a name="line531">531: </a><font color="#4169E1">typedef</font> <font color="#4169E1">struct</font>  {
-<a name="line532">532: </a>  const char *function[PETSCSTACKSIZE];
-<a name="line533">533: </a>  const char *file[PETSCSTACKSIZE];
-<a name="line534">534: </a>  const char *directory[PETSCSTACKSIZE];
-<a name="line535">535: </a>        int  line[PETSCSTACKSIZE];
-<a name="line536">536: </a>        int currentsize;
-<a name="line537">537: </a>} PetscStack;
-
-<a name="line540">540: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackCopy(PetscStack*,PetscStack*)</font></strong>;
-<a name="line541">541: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackPrint(PetscStack*,FILE* fp)</font></strong>;
-
-<a name="line543">543: </a><strong><font color="#228B22">#define PetscStackActive (petscstack != 0)</font></strong>
-
-
-<a name="line546">546: </a><font color="#B22222">/*MC</font>
-<a name="line548">548: </a><font color="#B22222">        used for error handling.</font>
-
-<a name="line550">550: </a><font color="#B22222">   Synopsis:</font>
-
-<a name="line553">553: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line555">555: </a><font color="#B22222">   Usage:</font>
-<a name="line556">556: </a><font color="#B22222">.vb</font>
-<a name="line557">557: </a><font color="#B22222">     int something;</font>
-
-<a name="line560">560: </a><font color="#B22222">.ve</font>
-
-<a name="line562">562: </a><font color="#B22222">   Notes:</font>
-<a name="line563">563: </a><font color="#B22222">     Not available in Fortran</font>
-
-<a name="line565">565: </a><font color="#B22222">   Level: developer</font>
-
-<a name="line567">567: </a><font color="#B22222">.seealso: <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>()</font>
-
-<a name="line569">569: </a><font color="#B22222">.keywords: traceback, error handling</font>
-<a name="line570">570: </a><font color="#B22222">M*/</font>
-<a name="line572">572: </a><strong><font color="#228B22">  {\</font></strong>
-<a name="line573">573: </a><strong><font color="#228B22">   if (petscstack &amp;&amp; (petscstack-&gt;currentsize &lt; PETSCSTACKSIZE)) {    \</font></strong>
-<a name="line574">574: </a><strong><font color="#228B22">    petscstack-&gt;function[petscstack-&gt;currentsize]  = __FUNCT__; \</font></strong>
-<a name="line575">575: </a><strong><font color="#228B22">    petscstack-&gt;file[petscstack-&gt;currentsize]      = __FILE__; \</font></strong>
-<a name="line576">576: </a><strong><font color="#228B22">    petscstack-&gt;directory[petscstack-&gt;currentsize] = __SDIR__; \</font></strong>
-<a name="line577">577: </a><strong><font color="#228B22">    petscstack-&gt;line[petscstack-&gt;currentsize]      = __LINE__; \</font></strong>
-<a name="line578">578: </a><strong><font color="#228B22">    petscstack-&gt;currentsize++; \</font></strong>
-<a name="line579">579: </a><strong><font color="#228B22">  }}</font></strong>
-
-<a name="line581">581: </a><strong><font color="#228B22">#define PetscStackPush(n) \</font></strong>
-<a name="line582">582: </a><strong><font color="#228B22">  {if (petscstack &amp;&amp; (petscstack-&gt;currentsize &lt; PETSCSTACKSIZE)) {    \</font></strong>
-<a name="line583">583: </a><strong><font color="#228B22">    petscstack-&gt;function[petscstack-&gt;currentsize]  = n; \</font></strong>
-<a name="line584">584: </a><strong><font color="#228B22">    petscstack-&gt;file[petscstack-&gt;currentsize]      = </font><font color="#666666">"unknown"</font><font color="#228B22">; \</font></strong>
-<a name="line585">585: </a><strong><font color="#228B22">    petscstack-&gt;directory[petscstack-&gt;currentsize] = </font><font color="#666666">"unknown"</font><font color="#228B22">; \</font></strong>
-<a name="line586">586: </a><strong><font color="#228B22">    petscstack-&gt;line[petscstack-&gt;currentsize]      = 0; \</font></strong>
-<a name="line587">587: </a><strong><font color="#228B22">    petscstack-&gt;currentsize++; \</font></strong>
-<a name="line588">588: </a><strong><font color="#228B22">  }}</font></strong>
-
-<a name="line590">590: </a><strong><font color="#228B22">#define PetscStackPop \</font></strong>
-<a name="line591">591: </a><strong><font color="#228B22">  {if (petscstack &amp;&amp; petscstack-&gt;currentsize &gt; 0) {     \</font></strong>
-<a name="line592">592: </a><strong><font color="#228B22">    petscstack-&gt;currentsize--; \</font></strong>
-<a name="line593">593: </a><strong><font color="#228B22">    petscstack-&gt;function[petscstack-&gt;currentsize]  = 0; \</font></strong>
-<a name="line594">594: </a><strong><font color="#228B22">    petscstack-&gt;file[petscstack-&gt;currentsize]      = 0; \</font></strong>
-<a name="line595">595: </a><strong><font color="#228B22">    petscstack-&gt;directory[petscstack-&gt;currentsize] = 0; \</font></strong>
-<a name="line596">596: </a><strong><font color="#228B22">    petscstack-&gt;line[petscstack-&gt;currentsize]      = 0; \</font></strong>
-<a name="line597">597: </a><strong><font color="#228B22">  }};</font></strong>
-
-<a name="line599">599: </a><font color="#B22222">/*MC</font>
-<a name="line600">600: </a><font color="#B22222">   <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A> - Last executable line of each PETSc function</font>
-<a name="line601">601: </a><font color="#B22222">        used for error handling. Replaces return()</font>
-
-<a name="line603">603: </a><font color="#B22222">   Synopsis:</font>
-<a name="line604">604: </a><font color="#B22222">   void return(0);</font>
-
-<a name="line606">606: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line608">608: </a><font color="#B22222">   Usage:</font>
-<a name="line609">609: </a><font color="#B22222">.vb</font>
-<a name="line610">610: </a><font color="#B22222">    ....</font>
-<a name="line611">611: </a><font color="#B22222">     return(0);</font>
-<a name="line612">612: </a><font color="#B22222">   }</font>
-<a name="line613">613: </a><font color="#B22222">.ve</font>
-
-<a name="line615">615: </a><font color="#B22222">   Notes:</font>
-<a name="line616">616: </a><font color="#B22222">     Not available in Fortran</font>
-
-<a name="line618">618: </a><font color="#B22222">   Level: developer</font>
-
-
-<a name="line622">622: </a><font color="#B22222">.keywords: traceback, error handling</font>
-<a name="line623">623: </a><font color="#B22222">M*/</font>
-<a name="line624">624: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>(a) \</font></strong>
-<a name="line625">625: </a><strong><font color="#228B22">  {\</font></strong>
-<a name="line626">626: </a><strong><font color="#228B22">  PetscStackPop; \</font></strong>
-<a name="line627">627: </a><strong><font color="#228B22">  return(a);}</font></strong>
-
-<a name="line629">629: </a><strong><font color="#228B22">#define PetscFunctionReturnVoid() \</font></strong>
-<a name="line630">630: </a><strong><font color="#228B22">  {\</font></strong>
-<a name="line631">631: </a><strong><font color="#228B22">  PetscStackPop; \</font></strong>
-<a name="line632">632: </a><strong><font color="#228B22">  return;}</font></strong>
-
-
-<a name="line635">635: </a><font color="#A020F0">#else</font>
-
-<a name="line638">638: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>(a)  return(a)</font></strong>
-<a name="line639">639: </a><strong><font color="#228B22">#define PetscFunctionReturnVoid() return</font></strong>
-<a name="line640">640: </a><strong><font color="#228B22">#define PetscStackPop </font></strong>
-<a name="line641">641: </a><strong><font color="#228B22">#define PetscStackPush(f) </font></strong>
-<a name="line642">642: </a><strong><font color="#228B22">#define PetscStackActive        0</font></strong>
-
-<a name="line644">644: </a><font color="#A020F0">#endif</font>
-
-<a name="line646">646: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackCreate(void)</font></strong>;
-<a name="line647">647: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackView(<A href="../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>)</font></strong>;
-<a name="line648">648: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackDestroy(void)</font></strong>;
-<a name="line649">649: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackPublish(void)</font></strong>;
-<a name="line650">650: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackDepublish(void)</font></strong>;
+<a name="line483">483: </a><font color="#A020F0">#ifdef PETSC_CLANGUAGE_CXX</font>
+<a name="line484">484: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/CHKERRXX.html#CHKERRXX">CHKERRXX</A>(n) ;</font></strong>
+<a name="line485">485: </a><font color="#A020F0">#endif</font>
+
+<a name="line487">487: </a><font color="#A020F0">#if !defined(PETSC_SKIP_UNDERSCORE_CHKERR)</font>
+<a name="line488">488: </a><strong><font color="#228B22">#define _   </font></strong>
+<a name="line490">490: </a><font color="#A020F0">#endif </font>
+
+<a name="line492">492: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionPush.html#PetscExceptionPush">PetscExceptionPush</A>(a)                0</font></strong>
+<a name="line493">493: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionPop.html#PetscExceptionPop">PetscExceptionPop</A>(a)                 0</font></strong>
+<a name="line494">494: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscErrorSetCatchable.html#PetscErrorSetCatchable">PetscErrorSetCatchable</A>(a,b)          0</font></strong>
+<a name="line495">495: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscErrorIsCatchable.html#PetscErrorIsCatchable">PetscErrorIsCatchable</A>(a)             <A href="../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font></strong>
+
+<a name="line497">497: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionCaught.html#PetscExceptionCaught">PetscExceptionCaught</A>(a,b)            <A href="../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font></strong>
+<a name="line498">498: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionValue.html#PetscExceptionValue">PetscExceptionValue</A>(a)               <A href="../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font></strong>
+<a name="line499">499: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionTry1.html#PetscExceptionTry1">PetscExceptionTry1</A>(a,b)              a</font></strong>
+<a name="line500">500: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscExceptionTrySyncNorm.html#PetscExceptionTrySyncNorm">PetscExceptionTrySyncNorm</A>(comm,a,b)  a</font></strong>
+
+<a name="line502">502: </a><font color="#A020F0">#endif</font>
+
+<a name="line504">504: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscErrorPrintfInitialize(void)</font></strong>;
+<a name="line505">505: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscErrorMessage.html#PetscErrorMessage">PetscErrorMessage</A>(int,const char*[],char **)</font></strong>;
+<a name="line506">506: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscTraceBackErrorHandler.html#PetscTraceBackErrorHandler">PetscTraceBackErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line508">508: </a><font color="#A020F0">#include &lt;sstream&gt;</font>
+<a name="line509">509: </a>EXTERN void            <A href="../docs/manualpages/Sys/PetscTraceBackErrorHandlerCxx.html#PetscTraceBackErrorHandlerCxx">PetscTraceBackErrorHandlerCxx</A>(int,const char *,const char *,const char *,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int, std::ostringstream&amp;);
+<a name="line510">510: </a><font color="#A020F0">#endif</font>
+<a name="line511">511: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscIgnoreErrorHandler.html#PetscIgnoreErrorHandler">PetscIgnoreErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line512">512: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscEmacsClientErrorHandler.html#PetscEmacsClientErrorHandler">PetscEmacsClientErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line513">513: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscMPIAbortErrorHandler.html#PetscMPIAbortErrorHandler">PetscMPIAbortErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line514">514: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscAbortErrorHandler.html#PetscAbortErrorHandler">PetscAbortErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line515">515: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscAttachDebuggerErrorHandler.html#PetscAttachDebuggerErrorHandler">PetscAttachDebuggerErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line516">516: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscReturnErrorHandler.html#PetscReturnErrorHandler">PetscReturnErrorHandler</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*)</font></strong>;
+<a name="line517">517: </a><strong><font color="#4169E1"><a name="PetscError"></a>EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscError.html#PetscError">PetscError</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,...)</font></strong> PETSC_PRINTF_FORMAT_CHECK(7,8);
+<a name="line518">518: </a><strong><font color="#4169E1">EXTERN void            <A href="../docs/manualpages/Sys/PetscErrorCxx.html#PetscErrorCxx">PetscErrorCxx</A>(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int)</font></strong>;
+<a name="line519">519: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPushErrorHandler.html#PetscPushErrorHandler">PetscPushErrorHandler</A>(<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*handler)(int,const char*,const char*,const char*,<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>,int,const char*,void*),void*)</font></strong>;
+<a name="line520">520: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPopErrorHandler.html#PetscPopErrorHandler">PetscPopErrorHandler</A>(void)</font></strong>;
+<a name="line521">521: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscDefaultSignalHandler.html#PetscDefaultSignalHandler">PetscDefaultSignalHandler</A>(int,void*)</font></strong>;
+<a name="line522">522: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPushSignalHandler.html#PetscPushSignalHandler">PetscPushSignalHandler</A>(<A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*)(int,void *),void*)</font></strong>;
+<a name="line523">523: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../docs/manualpages/Sys/PetscPopSignalHandler.html#PetscPopSignalHandler">PetscPopSignalHandler</A>(void)</font></strong>;
+
+<a name="line525">525: </a><font color="#4169E1">typedef</font> <font color="#4169E1">enum</font> {PETSC_FP_TRAP_OFF=0,PETSC_FP_TRAP_ON=1} PetscFPTrap;
+<a name="line526">526: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   <A href="../docs/manualpages/Sys/PetscSetFPTrap.html#PetscSetFPTrap">PetscSetFPTrap</A>(PetscFPTrap)</font></strong>;
+
+<a name="line528">528: </a><font color="#B22222">/*</font>
+<a name="line529">529: </a><font color="#B22222">      Allows the code to build a stack frame as it runs</font>
+<a name="line530">530: </a><font color="#B22222">*/</font>
+<a name="line531">531: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+
+<a name="line533">533: </a><strong><font color="#228B22">#define PETSCSTACKSIZE 15</font></strong>
+
+<a name="line535">535: </a><font color="#4169E1">typedef</font> <font color="#4169E1">struct</font>  {
+<a name="line536">536: </a>  const char *function[PETSCSTACKSIZE];
+<a name="line537">537: </a>  const char *file[PETSCSTACKSIZE];
+<a name="line538">538: </a>  const char *directory[PETSCSTACKSIZE];
+<a name="line539">539: </a>        int  line[PETSCSTACKSIZE];
+<a name="line540">540: </a>        int currentsize;
+<a name="line541">541: </a>} PetscStack;
+
+<a name="line544">544: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackCopy(PetscStack*,PetscStack*)</font></strong>;
+<a name="line545">545: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackPrint(PetscStack*,FILE* fp)</font></strong>;
+
+<a name="line547">547: </a><strong><font color="#228B22">#define PetscStackActive (petscstack != 0)</font></strong>
+
+
+<a name="line550">550: </a><font color="#B22222">/*MC</font>
+<a name="line552">552: </a><font color="#B22222">        used for error handling.</font>
+
+<a name="line554">554: </a><font color="#B22222">   Synopsis:</font>
+
+<a name="line557">557: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line559">559: </a><font color="#B22222">   Usage:</font>
+<a name="line560">560: </a><font color="#B22222">.vb</font>
+<a name="line561">561: </a><font color="#B22222">     int something;</font>
+
+<a name="line564">564: </a><font color="#B22222">.ve</font>
+
+<a name="line566">566: </a><font color="#B22222">   Notes:</font>
+<a name="line567">567: </a><font color="#B22222">     Not available in Fortran</font>
+
+<a name="line569">569: </a><font color="#B22222">   Level: developer</font>
+
+<a name="line571">571: </a><font color="#B22222">.seealso: <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>()</font>
+
+<a name="line573">573: </a><font color="#B22222">.keywords: traceback, error handling</font>
+<a name="line574">574: </a><font color="#B22222">M*/</font>
+<a name="line576">576: </a><strong><font color="#228B22">  {\</font></strong>
+<a name="line577">577: </a><strong><font color="#228B22">   if (petscstack &amp;&amp; (petscstack-&gt;currentsize &lt; PETSCSTACKSIZE)) {    \</font></strong>
+<a name="line578">578: </a><strong><font color="#228B22">    petscstack-&gt;function[petscstack-&gt;currentsize]  = __FUNCT__; \</font></strong>
+<a name="line579">579: </a><strong><font color="#228B22">    petscstack-&gt;file[petscstack-&gt;currentsize]      = __FILE__; \</font></strong>
+<a name="line580">580: </a><strong><font color="#228B22">    petscstack-&gt;directory[petscstack-&gt;currentsize] = __SDIR__; \</font></strong>
+<a name="line581">581: </a><strong><font color="#228B22">    petscstack-&gt;line[petscstack-&gt;currentsize]      = __LINE__; \</font></strong>
+<a name="line582">582: </a><strong><font color="#228B22">    petscstack-&gt;currentsize++; \</font></strong>
+<a name="line583">583: </a><strong><font color="#228B22">  }}</font></strong>
+
+<a name="line585">585: </a><strong><font color="#228B22">#define PetscStackPush(n) \</font></strong>
+<a name="line586">586: </a><strong><font color="#228B22">  {if (petscstack &amp;&amp; (petscstack-&gt;currentsize &lt; PETSCSTACKSIZE)) {    \</font></strong>
+<a name="line587">587: </a><strong><font color="#228B22">    petscstack-&gt;function[petscstack-&gt;currentsize]  = n; \</font></strong>
+<a name="line588">588: </a><strong><font color="#228B22">    petscstack-&gt;file[petscstack-&gt;currentsize]      = </font><font color="#666666">"unknown"</font><font color="#228B22">; \</font></strong>
+<a name="line589">589: </a><strong><font color="#228B22">    petscstack-&gt;directory[petscstack-&gt;currentsize] = </font><font color="#666666">"unknown"</font><font color="#228B22">; \</font></strong>
+<a name="line590">590: </a><strong><font color="#228B22">    petscstack-&gt;line[petscstack-&gt;currentsize]      = 0; \</font></strong>
+<a name="line591">591: </a><strong><font color="#228B22">    petscstack-&gt;currentsize++; \</font></strong>
+<a name="line592">592: </a><strong><font color="#228B22">  }}</font></strong>
+
+<a name="line594">594: </a><strong><font color="#228B22">#define PetscStackPop \</font></strong>
+<a name="line595">595: </a><strong><font color="#228B22">  {if (petscstack &amp;&amp; petscstack-&gt;currentsize &gt; 0) {     \</font></strong>
+<a name="line596">596: </a><strong><font color="#228B22">    petscstack-&gt;currentsize--; \</font></strong>
+<a name="line597">597: </a><strong><font color="#228B22">    petscstack-&gt;function[petscstack-&gt;currentsize]  = 0; \</font></strong>
+<a name="line598">598: </a><strong><font color="#228B22">    petscstack-&gt;file[petscstack-&gt;currentsize]      = 0; \</font></strong>
+<a name="line599">599: </a><strong><font color="#228B22">    petscstack-&gt;directory[petscstack-&gt;currentsize] = 0; \</font></strong>
+<a name="line600">600: </a><strong><font color="#228B22">    petscstack-&gt;line[petscstack-&gt;currentsize]      = 0; \</font></strong>
+<a name="line601">601: </a><strong><font color="#228B22">  }};</font></strong>
+
+<a name="line603">603: </a><font color="#B22222">/*MC</font>
+<a name="line604">604: </a><font color="#B22222">   <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A> - Last executable line of each PETSc function</font>
+<a name="line605">605: </a><font color="#B22222">        used for error handling. Replaces return()</font>
+
+<a name="line607">607: </a><font color="#B22222">   Synopsis:</font>
+<a name="line608">608: </a><font color="#B22222">   void return(0);</font>
+
+<a name="line610">610: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line612">612: </a><font color="#B22222">   Usage:</font>
+<a name="line613">613: </a><font color="#B22222">.vb</font>
+<a name="line614">614: </a><font color="#B22222">    ....</font>
+<a name="line615">615: </a><font color="#B22222">     return(0);</font>
+<a name="line616">616: </a><font color="#B22222">   }</font>
+<a name="line617">617: </a><font color="#B22222">.ve</font>
+
+<a name="line619">619: </a><font color="#B22222">   Notes:</font>
+<a name="line620">620: </a><font color="#B22222">     Not available in Fortran</font>
+
+<a name="line622">622: </a><font color="#B22222">   Level: developer</font>
+
+
+<a name="line626">626: </a><font color="#B22222">.keywords: traceback, error handling</font>
+<a name="line627">627: </a><font color="#B22222">M*/</font>
+<a name="line628">628: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>(a) \</font></strong>
+<a name="line629">629: </a><strong><font color="#228B22">  {\</font></strong>
+<a name="line630">630: </a><strong><font color="#228B22">  PetscStackPop; \</font></strong>
+<a name="line631">631: </a><strong><font color="#228B22">  return(a);}</font></strong>
+
+<a name="line633">633: </a><strong><font color="#228B22">#define PetscFunctionReturnVoid() \</font></strong>
+<a name="line634">634: </a><strong><font color="#228B22">  {\</font></strong>
+<a name="line635">635: </a><strong><font color="#228B22">  PetscStackPop; \</font></strong>
+<a name="line636">636: </a><strong><font color="#228B22">  return;}</font></strong>
+
+
+<a name="line639">639: </a><font color="#A020F0">#else</font>
+
+<a name="line642">642: </a><strong><font color="#228B22">#define <A href="../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>(a)  return(a)</font></strong>
+<a name="line643">643: </a><strong><font color="#228B22">#define PetscFunctionReturnVoid() return</font></strong>
+<a name="line644">644: </a><strong><font color="#228B22">#define PetscStackPop </font></strong>
+<a name="line645">645: </a><strong><font color="#228B22">#define PetscStackPush(f) </font></strong>
+<a name="line646">646: </a><strong><font color="#228B22">#define PetscStackActive        0</font></strong>
+
+<a name="line648">648: </a><font color="#A020F0">#endif</font>
+
+<a name="line650">650: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackCreate(void)</font></strong>;
+<a name="line651">651: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackView(<A href="../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>)</font></strong>;
+<a name="line652">652: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackDestroy(void)</font></strong>;
+<a name="line653">653: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackPublish(void)</font></strong>;
+<a name="line654">654: </a><strong><font color="#4169E1">EXTERN <A href="../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   PetscStackDepublish(void)</font></strong>;
 
 
-<a name="line654">654: </a><font color="#A020F0">#endif</font>
+<a name="line658">658: </a><font color="#A020F0">#endif</font>
 </pre>
 </body>
 
Index: petsc/include/petscsys.h
===================================================================
--- petsc.orig/include/petscsys.h
+++ petsc/include/petscsys.h
@@ -2109,17 +2109,17 @@
 $      which end in F90; such as VecGetArrayF90()
 $
 $    2) classic Fortran 90 style
-$#include "finclude/petscXXX.h"
+$#include "finclude/petscXXX.h" 
 $#include "finclude/petscXXX.h90" to work with material from the XXX component of PETSc
 $       XXX variablename
 $
 $    3) Using Fortran modules
-$#include "finclude/petscXXXdef.h"
+$#include "finclude/petscXXXdef.h" 
 $         use petscXXXX
 $       XXX variablename
 $
 $    4) Use Fortran modules and Fortran data types for PETSc types
-$#include "finclude/petscXXXdef.h"
+$#include "finclude/petscXXXdef.h" 
 $         use petscXXXX
 $       type(XXX) variablename
 $      To use this approach you must config/configure.py PETSc with the additional
Index: petsc/include/petscsys.h.html
===================================================================
--- petsc.orig/include/petscsys.h.html
+++ petsc/include/petscsys.h.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T02:00:41+00:00">
+<meta name="date" content="2011-03-17T19:12:49+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -2077,23 +2077,23 @@
 <a name="line2103">2103: </a><font color="#B22222">    <A href="../docs/manualpages/Sys/UsingFortran.html#UsingFortran">UsingFortran</A> - Fortran can be used with PETSc in four distinct approaches</font>
 
 <a name="line2105">2105: </a><font color="#B22222">$    1) classic Fortran 77 style</font>
-<a name="line2106">2106: </a><font color="#B22222">$#include "petscXXX.h" to work with material from the XXX component of PETSc</font>
+<a name="line2106">2106: </a><font color="#B22222">$#include "finclude/petscXXX.h" to work with material from the XXX component of PETSc</font>
 <a name="line2107">2107: </a><font color="#B22222">$       XXX variablename</font>
 <a name="line2108">2108: </a><font color="#B22222">$      You cannot use this approach if you wish to use the Fortran 90 specific PETSc routines</font>
 <a name="line2109">2109: </a><font color="#B22222">$      which end in F90; such as <A href="../docs/manualpages/Vec/VecGetArrayF90.html#VecGetArrayF90">VecGetArrayF90</A>()</font>
 <a name="line2110">2110: </a><font color="#B22222">$</font>
 <a name="line2111">2111: </a><font color="#B22222">$    2) classic Fortran 90 style</font>
-<a name="line2112">2112: </a><font color="#B22222">$#include "petscXXX.h" </font>
-<a name="line2113">2113: </a><font color="#B22222">$#include "petscXXX.h90" to work with material from the XXX component of PETSc</font>
+<a name="line2112">2112: </a><font color="#B22222">$#include "finclude/petscXXX.h" </font>
+<a name="line2113">2113: </a><font color="#B22222">$#include "finclude/petscXXX.h90" to work with material from the XXX component of PETSc</font>
 <a name="line2114">2114: </a><font color="#B22222">$       XXX variablename</font>
 <a name="line2115">2115: </a><font color="#B22222">$</font>
 <a name="line2116">2116: </a><font color="#B22222">$    3) Using Fortran modules</font>
-<a name="line2117">2117: </a><font color="#B22222">$#include "petscXXXdef.h" </font>
+<a name="line2117">2117: </a><font color="#B22222">$#include "finclude/petscXXXdef.h" </font>
 <a name="line2118">2118: </a><font color="#B22222">$         use petscXXXX</font>
 <a name="line2119">2119: </a><font color="#B22222">$       XXX variablename</font>
 <a name="line2120">2120: </a><font color="#B22222">$</font>
 <a name="line2121">2121: </a><font color="#B22222">$    4) Use Fortran modules and Fortran data types for PETSc types</font>
-<a name="line2122">2122: </a><font color="#B22222">$#include "petscXXXdef.h" </font>
+<a name="line2122">2122: </a><font color="#B22222">$#include "finclude/petscXXXdef.h" </font>
 <a name="line2123">2123: </a><font color="#B22222">$         use petscXXXX</font>
 <a name="line2124">2124: </a><font color="#B22222">$       type(XXX) variablename</font>
 <a name="line2125">2125: </a><font color="#B22222">$      To use this approach you must config/configure.py PETSc with the additional</font>
Index: petsc/include/petscversion.h
===================================================================
--- petsc.orig/include/petscversion.h
+++ petsc/include/petscversion.h
@@ -5,16 +5,16 @@
 #define PETSC_VERSION_MAJOR      3
 #define PETSC_VERSION_MINOR      1
 #define PETSC_VERSION_SUBMINOR   0
-#define PETSC_VERSION_PATCH      5
+#define PETSC_VERSION_PATCH      8
 #define PETSC_VERSION_DATE       "Mar, 25, 2010"
-#define PETSC_VERSION_PATCH_DATE "Mon Sep 27 11:51:54 CDT 2010"
+#define PETSC_VERSION_PATCH_DATE "Thu Mar 17 13:37:48 CDT 2011"
 
 #if !defined (PETSC_VERSION_HG)
-#define PETSC_VERSION_HG         "1b3dc7caf650c17b3732147f0ff2f82ed80e0fd9"
+#define PETSC_VERSION_HG         "1409dfc44c26997c47851592fa5dce2a0c80bb8d"
 #endif
 
 #if !defined(PETSC_VERSION_DATE_HG)
-#define PETSC_VERSION_DATE_HG         "Mon Sep 27 11:51:31 2010 -0500"
+#define PETSC_VERSION_DATE_HG         "Thu Mar 17 12:43:03 2011 -0500"
 #endif
 
 #define PETSC_VERSION_(MAJOR,MINOR,SUBMINOR) \
Index: petsc/makefile
===================================================================
--- petsc.orig/makefile
+++ petsc/makefile
@@ -23,7 +23,7 @@
 	@${OMAKE}  PETSC_ARCH=${PETSC_ARCH}  PETSC_DIR=${PETSC_DIR} chkpetsc_dir
 	-@${OMAKE} all_build PETSC_ARCH=${PETSC_ARCH}  PETSC_DIR=${PETSC_DIR} 2>&1  | tee ${PETSC_ARCH}/conf/make.log
 	-@if [ -L make.log ]; then ${RM} make.log; fi; ln -s ${PETSC_ARCH}/conf/make.log make.log
-	-@egrep -i "( error | error:)" ${PETSC_ARCH}/conf/make.log > /dev/null; if [ "$$?" = "0" ]; then \
+	-@egrep -i "( error | error: |no such file or directory)" ${PETSC_ARCH}/conf/make.log > /dev/null; if [ "$$?" = "0" ]; then \
            echo "********************************************************************" 2>&1 | tee -a ${PETSC_ARCH}/conf/make.log; \
            echo "  Error during compile, check ${PETSC_ARCH}/conf/make.log" 2>&1 | tee -a ${PETSC_ARCH}/conf/make.log; \
            echo "  Send it and ${PETSC_ARCH}/conf/configure.log to petsc-maint@mcs.anl.gov" 2>&1 | tee -a ${PETSC_ARCH}/conf/make.log;\
@@ -226,7 +226,7 @@
 #
 #
 install:
-	-@./config/install.py
+	@./config/install.py
 
 newall:
 	-@cd src/sys; ${PETSC_DIR}/config/builder.py
Index: petsc/makefile.html
===================================================================
--- petsc.orig/makefile.html
+++ petsc/makefile.html
@@ -3,7 +3,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T01:26:41+00:00">
+<meta name="date" content="2011-03-17T18:40:47+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -32,7 +32,7 @@
         @${OMAKE}  PETSC_ARCH=${PETSC_ARCH}  PETSC_DIR=${PETSC_DIR} chkpetsc_dir
         -@${OMAKE} all_build PETSC_ARCH=${PETSC_ARCH}  PETSC_DIR=${PETSC_DIR} 2&gt;&amp;1  | tee ${PETSC_ARCH}/conf/make.log
         -@<font color="#4169E1">if</font> [ -L make.log ]; then ${RM} make.log; fi; ln -s ${PETSC_ARCH}/conf/make.log make.log
-        -@egrep -i <font color="#666666">"( error | error:)"</font> ${PETSC_ARCH}/conf/make.log &gt; /dev/null; <font color="#4169E1">if</font> [ <font color="#666666">"$$?"</font> = <font color="#666666">"0"</font> ]; then \
+        -@egrep -i <font color="#666666">"( error | error: |no such file or directory)"</font> ${PETSC_ARCH}/conf/make.log &gt; /dev/null; <font color="#4169E1">if</font> [ <font color="#666666">"$$?"</font> = <font color="#666666">"0"</font> ]; then \
            echo <font color="#666666">"********************************************************************"</font> 2&gt;&amp;1 | tee -a ${PETSC_ARCH}/conf/make.log; \
            echo <font color="#666666">"  Error during compile, check ${PETSC_ARCH}/conf/make.log"</font> 2&gt;&amp;1 | tee -a ${PETSC_ARCH}/conf/make.log; \
            echo <font color="#666666">"  Send it and ${PETSC_ARCH}/conf/configure.log to petsc-maint@mcs.anl.gov"</font> 2&gt;&amp;1 | tee -a ${PETSC_ARCH}/conf/make.log;\
@@ -235,7 +235,7 @@
 #
 #
 install:
-        -@./config/install.py
+        @./config/install.py
 
 newall:
         -@cd src/sys; ${PETSC_DIR}/config/builder.py
Index: petsc/src/contrib/blopex/driver/driver.c
===================================================================
--- petsc.orig/src/contrib/blopex/driver/driver.c
+++ petsc/src/contrib/blopex/driver/driver.c
@@ -148,6 +148,9 @@
    PetscViewer                viewer;
 */
    PetscInt                   tmp_int;
+   mv_TempMultiVector * xe;
+   PetscInt  N;
+   PetscScalar * xx;
 
    PetscInitialize(&argc,&args,(char *)0,help);
    ierr = PetscOptionsGetInt(PETSC_NULL,"-n_eigs",&tmp_int,&option_present);CHKERRQ(ierr);
@@ -281,7 +284,6 @@
    eigenvectors = mv_MultiVectorCreateFromSampleVector(&ii, n_eigs,u);
 
 
-   mv_TempMultiVector * xe;
    xe = (mv_TempMultiVector *) mv_MultiVectorGetData( eigenvectors );
    /*
    VecView( (Vec)xe->vector[0],PETSC_VIEWER_STDOUT_WORLD);
@@ -293,10 +295,8 @@
    VecView( (Vec)xe->vector[0],PETSC_VIEWER_STDOUT_WORLD);
    */
 
-   PetscInt  N;
    VecGetSize( (Vec)xe->vector[0], &N );
    N=mv_TempMultiVectorHeight( xe );
-   PetscScalar * xx;
    VecGetArray( (Vec)xe->vector[0],&xx);
 
    lobpcg_tol.absolute = tol;
Index: petsc/src/contrib/blopex/driver_diag/driver_diag.c
===================================================================
--- petsc.orig/src/contrib/blopex/driver_diag/driver_diag.c
+++ petsc/src/contrib/blopex/driver_diag/driver_diag.c
@@ -107,7 +107,7 @@
    PetscViewer                fd;    /* viewer */
 
    PetscTruth                 option_present;
-   PetscReal                  shift;
+   PetscReal                  shift=0;
    PetscTruth                 shift_present;
    char                       output_filename[PETSC_MAX_PATH_LEN];
    PetscTruth                 output_filename_present;
@@ -218,7 +218,7 @@
 
    PETSCSetupInterpreter( &ii );
    eigenvectors = mv_MultiVectorCreateFromSampleVector(&ii, n_eigs,u);
-
+ 
    for (i=0; i<seed; i++) /* this cycle is to imitate changing random seed */
       mv_MultiVectorSetRandom (eigenvectors, 1234);
 
@@ -295,8 +295,11 @@
    PetscPrintf(PETSC_COMM_WORLD,"Solution process, seconds: %e\n",elapsed_time);
 
    /* shift eigenvalues back */
+   if (shift_present)
+   {
    for (i=0; i<n_eigs; i++)
       eigs[i]-=shift;
+   }
 
    PetscPrintf(PETSC_COMM_WORLD,"Final eigenvalues:\n");
    for (i=0;i<n_eigs;i++)
Index: petsc/src/contrib/blopex/driver_fiedler/driver_fiedler.c
===================================================================
--- petsc.orig/src/contrib/blopex/driver_fiedler/driver_fiedler.c
+++ petsc/src/contrib/blopex/driver_fiedler/driver_fiedler.c
@@ -125,7 +125,7 @@
    char                       filename[PETSC_MAX_PATH_LEN];
    char                       mass_filename[PETSC_MAX_PATH_LEN];
    PetscTruth                 mass_matrix_present;
-   PetscReal                  shift;
+   PetscReal                  shift=0;
    PetscTruth                 shift_present;
    char                       output_filename[PETSC_MAX_PATH_LEN];
    PetscTruth                 output_filename_present;
@@ -257,7 +257,7 @@
    eigenvectors = mv_MultiVectorCreateFromSampleVector(&ii, n_eigs,u);
 
    /* building constraints (constant vector) */
-   /* the constraints will not beused if run with -no_con option */
+   /* the constraints will not beused if run with -no_con option */ 
      constraints= mv_MultiVectorCreateFromSampleVector(&ii, 1,u);
      raw_constraints = (mv_TempMultiVector*)mv_MultiVectorGetData (constraints);
      tmp_vec = (Vec)(raw_constraints->vector)[0];
@@ -340,8 +340,11 @@
    PetscPrintf(PETSC_COMM_WORLD,"Solution process, seconds: %e\n",elapsed_time);
 
    /* shift eigenvalues back */
+   if (shift_present)
+   {
    for (i=0; i<n_eigs; i++)
       eigs[i]-=shift;
+   }
 
    PetscPrintf(PETSC_COMM_WORLD,"Final eigenvalues:\n");
    for (i=0;i<n_eigs;i++)
Index: petsc/src/dm/da/src/da1.c.html
===================================================================
--- petsc.orig/src/dm/da/src/da1.c.html
+++ petsc/src/dm/da/src/da1.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:48:36+00:00">
+<meta name="date" content="2011-03-17T18:57:40+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -147,246 +147,248 @@
 <a name="line149">149: </a>  da-&gt;m = size;
 <a name="line150">150: </a>  m     = da-&gt;m;
 
-<a name="line152">152: </a>  <font color="#4169E1">if</font> (M &lt; m)     <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"More processors than data points! %D %D"</font>,m,M);
-<a name="line153">153: </a>  <font color="#4169E1">if</font> ((M-1) &lt; s) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Array is too small for stencil! %D %D"</font>,M-1,s);
-
-<a name="line155">155: </a>  <font color="#B22222">/* </font>
-<a name="line156">156: </a><font color="#B22222">     Determine locally owned region </font>
-<a name="line157">157: </a><font color="#B22222">     xs is the first local node number, x is the number of local nodes </font>
-<a name="line158">158: </a><font color="#B22222">  */</font>
-<a name="line159">159: </a>  <font color="#4169E1">if</font> (!lx) {
-<a name="line160">160: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-da_partition_blockcomm"</font>,&amp;flg1,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line161">161: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-da_partition_nodes_at_end"</font>,&amp;flg2,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line162">162: </a>    <font color="#4169E1">if</font> (flg1) {      <font color="#B22222">/* Block Comm type Distribution */</font>
-<a name="line163">163: </a>      xs = rank*M/m;
-<a name="line164">164: </a>      x  = (rank + 1)*M/m - xs;
-<a name="line165">165: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg2) { <font color="#B22222">/* The odd nodes are evenly distributed across last nodes */</font>
-<a name="line166">166: </a>      x = (M + rank)/m;
-<a name="line167">167: </a>      <font color="#4169E1">if</font> (M/m == x) { xs = rank*x; }
-<a name="line168">168: </a>      <font color="#4169E1">else</font>          { xs = rank*(x-1) + (M+rank)%(x*m); }
-<a name="line169">169: </a>    } <font color="#4169E1">else</font> { <font color="#B22222">/* The odd nodes are evenly distributed across the first k nodes */</font>
-<a name="line170">170: </a>      <font color="#B22222">/* Regular PETSc Distribution */</font>
-<a name="line171">171: </a>      x = M/m + ((M % m) &gt; rank);
-<a name="line172">172: </a>      <font color="#4169E1">if</font> (rank &gt;= (M % m)) {xs = (rank * (<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)(M/m) + M % m);}
-<a name="line173">173: </a>      <font color="#4169E1">else</font>                 {xs = rank * (<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)(M/m) + rank;}
-<a name="line174">174: </a>    }
-<a name="line175">175: </a>  } <font color="#4169E1">else</font> {
-<a name="line176">176: </a>    x  = lx[rank];
-<a name="line177">177: </a>    xs = 0;
-<a name="line178">178: </a>    <font color="#4169E1">for</font> (i=0; i&lt;rank; i++) {
-<a name="line179">179: </a>      xs += lx[i];
-<a name="line180">180: </a>    }
-<a name="line181">181: </a>    <font color="#B22222">/* verify that data user provided is consistent */</font>
-<a name="line182">182: </a>    left = xs;
-<a name="line183">183: </a>    <font color="#4169E1">for</font> (i=rank; i&lt;size; i++) {
-<a name="line184">184: </a>      left += lx[i];
-<a name="line185">185: </a>    }
-<a name="line186">186: </a>    <font color="#4169E1">if</font> (left != M) {
-<a name="line187">187: </a>      <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Sum of lx across processors not equal to M %D %D"</font>,left,M);
-<a name="line188">188: </a>    }
-<a name="line189">189: </a>  }
-
-<a name="line191">191: </a>  <font color="#B22222">/* From now on x,xs,xe,Xs,Xe are the exact location in the array */</font>
-<a name="line192">192: </a>  x  *= dof;
-<a name="line193">193: </a>  xs *= dof;
-<a name="line194">194: </a>  xe  = xs + x;
-
-<a name="line196">196: </a>  <font color="#B22222">/* determine ghost region */</font>
-<a name="line197">197: </a>  <font color="#4169E1">if</font> (wrap == DA_XPERIODIC || wrap == DA_XYZGHOSTED) {
-<a name="line198">198: </a>    Xs = xs - sDist;
-<a name="line199">199: </a>    Xe = xe + sDist;
-<a name="line200">200: </a>  } <font color="#4169E1">else</font> {
-<a name="line201">201: </a>    <font color="#4169E1">if</font> ((xs-sDist) &gt;= 0)     Xs = xs-sDist;  <font color="#4169E1">else</font> Xs = 0;
-<a name="line202">202: </a>    <font color="#4169E1">if</font> ((xe+sDist) &lt;= M*dof) Xe = xe+sDist;  <font color="#4169E1">else</font> Xe = M*dof;
-<a name="line203">203: </a>  }
-
-<a name="line205">205: </a>  <font color="#B22222">/* allocate the base parallel and sequential vectors */</font>
-<a name="line206">206: </a>  da-&gt;Nlocal = x;
-<a name="line207">207: </a>  <A href="../../../../docs/manualpages/Vec/VecCreateMPIWithArray.html#VecCreateMPIWithArray">VecCreateMPIWithArray</A>(comm,da-&gt;Nlocal,<A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>,0,&amp;global);
-<a name="line208">208: </a>  <A href="../../../../docs/manualpages/Vec/VecSetBlockSize.html#VecSetBlockSize">VecSetBlockSize</A>(global,dof);
-<a name="line209">209: </a>  da-&gt;nlocal = (Xe-Xs);
-<a name="line210">210: </a>  <A href="../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>(<A href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,da-&gt;nlocal,0,&amp;local);
-<a name="line211">211: </a>  <A href="../../../../docs/manualpages/Vec/VecSetBlockSize.html#VecSetBlockSize">VecSetBlockSize</A>(local,dof);
-<a name="line212">212: </a>
-<a name="line213">213: </a>  <font color="#B22222">/* Create Local to Global Vector Scatter Context */</font>
-<a name="line214">214: </a>  <font color="#B22222">/* local to global inserts non-ghost point region into global */</font>
-<a name="line215">215: </a>  <A href="../../../../docs/manualpages/Vec/VecGetOwnershipRange.html#VecGetOwnershipRange">VecGetOwnershipRange</A>(global,&amp;start,&amp;end);
-<a name="line216">216: </a>  <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,x,start,1,&amp;to);
-<a name="line217">217: </a>  <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,x,xs-Xs,1,&amp;from);
-<a name="line218">218: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(local,from,global,to,&amp;ltog);
-<a name="line219">219: </a>  PetscLogObjectParent(da,ltog);
-<a name="line220">220: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(from);
-<a name="line221">221: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(to);
-
-<a name="line223">223: </a>  <font color="#B22222">/* Create Global to Local Vector Scatter Context */</font>
-<a name="line224">224: </a>  <font color="#B22222">/* global to local must retrieve ghost points */</font>
-<a name="line225">225: </a>  <font color="#4169E1">if</font>  (wrap == DA_XYZGHOSTED) {
-<a name="line226">226: </a>    <font color="#4169E1">if</font> (size == 1) {
-<a name="line227">227: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(xe-xs),sDist,1,&amp;to);
-<a name="line228">228: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!rank) {
-<a name="line229">229: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(Xe-xs),sDist,1,&amp;to);
-<a name="line230">230: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (rank == size-1) {
-<a name="line231">231: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(xe-Xs),0,1,&amp;to);
-<a name="line232">232: </a>    } <font color="#4169E1">else</font> {
-<a name="line233">233: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(Xe-Xs),0,1,&amp;to);
-<a name="line234">234: </a>    }
-<a name="line235">235: </a>  } <font color="#4169E1">else</font> {
-<a name="line236">236: </a>    <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(Xe-Xs),0,1,&amp;to);
-<a name="line237">237: </a>  }
-<a name="line238">238: </a>
-<a name="line239">239: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((x+2*sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;idx);
-<a name="line240">240: </a>  PetscLogObjectMemory(da,(x+2*sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-
-<a name="line242">242: </a>  nn = 0;
-<a name="line243">243: </a>  <font color="#4169E1">if</font> (wrap == DA_XPERIODIC) {    <font color="#B22222">/* Handle all cases with wrap first */</font>
-
-<a name="line245">245: </a>    <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) {  <font color="#B22222">/* Left ghost points */</font>
-<a name="line246">246: </a>      <font color="#4169E1">if</font> ((xs-sDist+i)&gt;=0) { idx[nn++] = xs-sDist+i;}
-<a name="line247">247: </a>      <font color="#4169E1">else</font>                 { idx[nn++] = M*dof+(xs-sDist+i);}
-<a name="line248">248: </a>    }
-
-<a name="line250">250: </a>    <font color="#4169E1">for</font> (i=0; i&lt;x; i++) { idx [nn++] = xs + i;}  <font color="#B22222">/* Non-ghost points */</font>
-<a name="line251">251: </a>
-<a name="line252">252: </a>    <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) { <font color="#B22222">/* Right ghost points */</font>
-<a name="line253">253: </a>      <font color="#4169E1">if</font> ((xe+i)&lt;M*dof) { idx [nn++] =  xe+i; }
-<a name="line254">254: </a>      <font color="#4169E1">else</font>              { idx [nn++] = (xe+i) - M*dof;}
-<a name="line255">255: </a>    }
-<a name="line256">256: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (wrap == DA_XYZGHOSTED) {
-
-<a name="line258">258: </a>    <font color="#4169E1">if</font> (sDist &lt;= xs) {<font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) {idx[nn++] = xs - sDist + i;}}
-
-<a name="line260">260: </a>    <font color="#4169E1">for</font> (i=0; i&lt;x; i++) { idx [nn++] = xs + i;}
-<a name="line261">261: </a>
-<a name="line262">262: </a>    <font color="#4169E1">if</font> ((xe+sDist)&lt;=M*dof) {<font color="#4169E1">for</font> (i=0;  i&lt;sDist;     i++) {idx[nn++]=xe+i;}}
-
-<a name="line264">264: </a>  } <font color="#4169E1">else</font> {      <font color="#B22222">/* Now do all cases with no wrapping */</font>
-
-<a name="line266">266: </a>    <font color="#4169E1">if</font> (sDist &lt;= xs) {<font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) {idx[nn++] = xs - sDist + i;}}
-<a name="line267">267: </a>    <font color="#4169E1">else</font>             {<font color="#4169E1">for</font> (i=0; i&lt;xs;    i++) {idx[nn++] = i;}}
-
-<a name="line269">269: </a>    <font color="#4169E1">for</font> (i=0; i&lt;x; i++) { idx [nn++] = xs + i;}
-<a name="line270">270: </a>
-<a name="line271">271: </a>    <font color="#4169E1">if</font> ((xe+sDist)&lt;=M*dof) {<font color="#4169E1">for</font> (i=0;  i&lt;sDist;   i++) {idx[nn++]=xe+i;}}
-<a name="line272">272: </a>    <font color="#4169E1">else</font>                   {<font color="#4169E1">for</font> (i=xe; i&lt;(M*dof); i++) {idx[nn++]=i;}}
-<a name="line273">273: </a>  }
-
-<a name="line275">275: </a>  <A href="../../../../docs/manualpages/IS/ISCreateGeneral.html#ISCreateGeneral">ISCreateGeneral</A>(comm,nn,idx,&amp;from);
-<a name="line276">276: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(global,from,local,to,&amp;gtol);
-<a name="line277">277: </a>  PetscLogObjectParent(da,to);
-<a name="line278">278: </a>  PetscLogObjectParent(da,from);
-<a name="line279">279: </a>  PetscLogObjectParent(da,gtol);
-<a name="line280">280: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(to);
-<a name="line281">281: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(from);
-<a name="line282">282: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(local);
-<a name="line283">283: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(global);
-
-<a name="line285">285: </a>  da-&gt;xs = xs; da-&gt;xe = xe; da-&gt;ys = 0; da-&gt;ye = 1; da-&gt;zs = 0; da-&gt;ze = 1;
-<a name="line286">286: </a>  da-&gt;Xs = Xs; da-&gt;Xe = Xe; da-&gt;Ys = 0; da-&gt;Ye = 1; da-&gt;Zs = 0; da-&gt;Ze = 1;
-
-<a name="line288">288: </a>  da-&gt;gtol      = gtol;
-<a name="line289">289: </a>  da-&gt;ltog      = ltog;
-<a name="line290">290: </a>  da-&gt;base      = xs;
-<a name="line291">291: </a>  da-&gt;ops-&gt;view = DAView_1d;
-
-<a name="line293">293: </a>  <font color="#B22222">/* </font>
-<a name="line294">294: </a><font color="#B22222">     Set the local to global ordering in the global vector, this allows use</font>
-<a name="line295">295: </a><font color="#B22222">     of <A href="../../../../docs/manualpages/Vec/VecSetValuesLocal.html#VecSetValuesLocal">VecSetValuesLocal</A>().</font>
-<a name="line296">296: </a><font color="#B22222">  */</font>
-<a name="line297">297: </a>  <font color="#4169E1">if</font> (wrap == DA_XYZGHOSTED) {
-<a name="line298">298: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *tmpidx;
-<a name="line299">299: </a>    <font color="#4169E1">if</font> (size == 1) {
-<a name="line300">300: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((nn+2*sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;tmpidx);
-<a name="line301">301: </a>      <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) tmpidx[i] = -1;
-<a name="line302">302: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpidx+sDist,idx,nn*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line303">303: </a>      <font color="#4169E1">for</font> (i=nn+sDist; i&lt;nn+2*sDist; i++) tmpidx[i] = -1;
-<a name="line304">304: </a>      <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(idx);
-<a name="line305">305: </a>      idx  = tmpidx;
-<a name="line306">306: </a>      nn  += 2*sDist;
-<a name="line307">307: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!rank) { <font color="#B22222">/* must preprend -1 marker for ghost location that have no global value */</font>
-<a name="line308">308: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((nn+sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;tmpidx);
-<a name="line309">309: </a>      <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) tmpidx[i] = -1;
-<a name="line310">310: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpidx+sDist,idx,nn*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line311">311: </a>      <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(idx);
-<a name="line312">312: </a>      idx  = tmpidx;
-<a name="line313">313: </a>      nn  += sDist;
-<a name="line314">314: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (rank  == size-1) { <font color="#B22222">/* must postpend -1 marker for ghost location that have no global value */</font>
-<a name="line315">315: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((nn+sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;tmpidx);
-<a name="line316">316: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpidx,idx,nn*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line317">317: </a>      <font color="#4169E1">for</font> (i=nn; i&lt;nn+sDist; i++) tmpidx[i] = -1;
-<a name="line318">318: </a>      <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(idx);
-<a name="line319">319: </a>      idx  = tmpidx;
-<a name="line320">320: </a>      nn  += sDist;
-<a name="line321">321: </a>    }
-<a name="line322">322: </a>  }
-<a name="line323">323: </a>  <A href="../../../../docs/manualpages/IS/ISLocalToGlobalMappingCreateNC.html#ISLocalToGlobalMappingCreateNC">ISLocalToGlobalMappingCreateNC</A>(comm,nn,idx,&amp;da-&gt;ltogmap);
-<a name="line324">324: </a>  <A href="../../../../docs/manualpages/IS/ISLocalToGlobalMappingBlock.html#ISLocalToGlobalMappingBlock">ISLocalToGlobalMappingBlock</A>(da-&gt;ltogmap,da-&gt;w,&amp;da-&gt;ltogmapb);
-<a name="line325">325: </a>  PetscLogObjectParent(da,da-&gt;ltogmap);
-
-<a name="line327">327: </a>  da-&gt;idx = idx;
-<a name="line328">328: </a>  da-&gt;Nl  = nn;
-
-<a name="line330">330: </a>  PetscPublishAll(da);
-<a name="line331">331: </a>  <font color="#4169E1">return</font>(0);
-<a name="line332">332: </a>}
-
-<a name="line337">337: </a><font color="#B22222">/*@C</font>
-<a name="line338">338: </a><font color="#B22222">   <A href="../../../../docs/manualpages/DA/DACreate1d.html#DACreate1d">DACreate1d</A> - Creates an object that will manage the communication of  one-dimensional </font>
-<a name="line339">339: </a><font color="#B22222">   regular array data that is distributed across some processors.</font>
-
-<a name="line341">341: </a><font color="#B22222">   Collective on <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line343">343: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line344">344: </a><font color="#B22222">+  comm - MPI communicator</font>
-<a name="line345">345: </a><font color="#B22222">.  wrap - type of periodicity should the array have, if any. Use </font>
-<a name="line346">346: </a><font color="#B22222">          either DA_NONPERIODIC or DA_XPERIODIC</font>
-<a name="line347">347: </a><font color="#B22222">.  M - global dimension of the array (use -M to indicate that it may be set to a different value </font>
-<a name="line348">348: </a><font color="#B22222">            from the command line with -da_grid_x &lt;M&gt;)</font>
-<a name="line349">349: </a><font color="#B22222">.  dof - number of degrees of freedom per node</font>
-<a name="line350">350: </a><font color="#B22222">.  s - stencil width</font>
-<a name="line351">351: </a><font color="#B22222">-  lx - array containing number of nodes in the X direction on each processor, </font>
-<a name="line352">352: </a><font color="#B22222">        or <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>. If non-null, must be of length as m.</font>
-
-<a name="line354">354: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line355">355: </a><font color="#B22222">.  da - the resulting distributed array object</font>
-
-<a name="line357">357: </a><font color="#B22222">   Options Database Key:</font>
-<a name="line358">358: </a><font color="#B22222">+  -da_view - Calls <A href="../../../../docs/manualpages/DA/DAView.html#DAView">DAView</A>() at the conclusion of <A href="../../../../docs/manualpages/DA/DACreate1d.html#DACreate1d">DACreate1d</A>()</font>
-<a name="line359">359: </a><font color="#B22222">.  -da_grid_x &lt;nx&gt; - number of grid points in x direction; can set if M &lt; 0</font>
-<a name="line360">360: </a><font color="#B22222">-  -da_refine_x - refinement factor </font>
-
-<a name="line362">362: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line364">364: </a><font color="#B22222">   Notes:</font>
-<a name="line365">365: </a><font color="#B22222">   The array data itself is NOT stored in the <A href="../../../../docs/manualpages/DA/DA.html#DA">DA</A>, it is stored in <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> objects;</font>
-<a name="line366">366: </a><font color="#B22222">   The appropriate vector objects can be obtained with calls to <A href="../../../../docs/manualpages/DA/DACreateGlobalVector.html#DACreateGlobalVector">DACreateGlobalVector</A>()</font>
-<a name="line367">367: </a><font color="#B22222">   and <A href="../../../../docs/manualpages/DA/DACreateLocalVector.html#DACreateLocalVector">DACreateLocalVector</A>() and calls to <A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>() if more are needed.</font>
-
-
-<a name="line370">370: </a><font color="#B22222">.keywords: distributed array, create, one-dimensional</font>
-
-<a name="line372">372: </a><font color="#B22222">.seealso: <A href="../../../../docs/manualpages/DA/DADestroy.html#DADestroy">DADestroy</A>(), <A href="../../../../docs/manualpages/DA/DAView.html#DAView">DAView</A>(), <A href="../../../../docs/manualpages/DA/DACreate2d.html#DACreate2d">DACreate2d</A>(), <A href="../../../../docs/manualpages/DA/DACreate3d.html#DACreate3d">DACreate3d</A>(), <A href="../../../../docs/manualpages/DA/DAGlobalToLocalBegin.html#DAGlobalToLocalBegin">DAGlobalToLocalBegin</A>(), <A href="../../../../docs/manualpages/DA/DASetRefinementFactor.html#DASetRefinementFactor">DASetRefinementFactor</A>(),</font>
-<a name="line373">373: </a><font color="#B22222">          <A href="../../../../docs/manualpages/DA/DAGlobalToLocalEnd.html#DAGlobalToLocalEnd">DAGlobalToLocalEnd</A>(), <A href="../../../../docs/manualpages/DA/DALocalToGlobal.html#DALocalToGlobal">DALocalToGlobal</A>(), <A href="../../../../docs/manualpages/DA/DALocalToLocalBegin.html#DALocalToLocalBegin">DALocalToLocalBegin</A>(), <A href="../../../../docs/manualpages/DA/DALocalToLocalEnd.html#DALocalToLocalEnd">DALocalToLocalEnd</A>(), <A href="../../../../docs/manualpages/DA/DAGetRefinementFactor.html#DAGetRefinementFactor">DAGetRefinementFactor</A>(),</font>
-<a name="line374">374: </a><font color="#B22222">          <A href="../../../../docs/manualpages/DA/DAGetInfo.html#DAGetInfo">DAGetInfo</A>(), <A href="../../../../docs/manualpages/DA/DACreateGlobalVector.html#DACreateGlobalVector">DACreateGlobalVector</A>(), <A href="../../../../docs/manualpages/DA/DACreateLocalVector.html#DACreateLocalVector">DACreateLocalVector</A>(), <A href="../../../../docs/manualpages/DA/DACreateNaturalVector.html#DACreateNaturalVector">DACreateNaturalVector</A>(), <A href="../../../../docs/manualpages/DA/DALoad.html#DALoad">DALoad</A>(), <A href="../../../../docs/manualpages/DA/DAView.html#DAView">DAView</A>(), <A href="../../../../docs/manualpages/DA/DAGetOwnershipRanges.html#DAGetOwnershipRanges">DAGetOwnershipRanges</A>()</font>
-
-<a name="line376">376: </a><font color="#B22222">@*/</font>
-<a name="line377">377: </a><strong><font color="#4169E1"><a name="DACreate1d"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../docs/manualpages/DA/DACreate1d.html#DACreate1d">DACreate1d</A>(<A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm, <A href="../../../../docs/manualpages/DA/DAPeriodicType.html#DAPeriodicType">DAPeriodicType</A> wrap, <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> M, <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> dof, <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> s, const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> lx[], <A href="../../../../docs/manualpages/DA/DA.html#DA">DA</A> *da)</font></strong>
-<a name="line378">378: </a>{
-<a name="line380">380: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
-
-<a name="line383">383: </a>  <A href="../../../../docs/manualpages/DA/DACreate.html#DACreate">DACreate</A>(comm, da);
-<a name="line384">384: </a>  <A href="../../../../docs/manualpages/DA/DASetDim.html#DASetDim">DASetDim</A>(*da, 1);
-<a name="line385">385: </a>  <A href="../../../../docs/manualpages/DA/DASetSizes.html#DASetSizes">DASetSizes</A>(*da, M, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>);
-<a name="line386">386: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm, &amp;size);
-<a name="line387">387: </a>  <A href="../../../../docs/manualpages/DA/DASetNumProcs.html#DASetNumProcs">DASetNumProcs</A>(*da, size, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>);
-<a name="line388">388: </a>  <A href="../../../../docs/manualpages/DA/DASetPeriodicity.html#DASetPeriodicity">DASetPeriodicity</A>(*da, wrap);
-<a name="line389">389: </a>  <A href="../../../../docs/manualpages/DA/DASetDof.html#DASetDof">DASetDof</A>(*da, dof);
-<a name="line390">390: </a>  <A href="../../../../docs/manualpages/DA/DASetStencilWidth.html#DASetStencilWidth">DASetStencilWidth</A>(*da, s);
-<a name="line391">391: </a>  <A href="../../../../docs/manualpages/DA/DASetVertexDivision.html#DASetVertexDivision">DASetVertexDivision</A>(*da, lx, <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>, <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line392">392: </a>  <font color="#B22222">/* This violates the behavior for other classes, but right now users expect negative dimensions to be handled this way */</font>
-<a name="line393">393: </a>  <A href="../../../../docs/manualpages/DA/DASetFromOptions.html#DASetFromOptions">DASetFromOptions</A>(*da);
-<a name="line394">394: </a>  <A href="../../../../docs/manualpages/DA/DASetType.html#DASetType">DASetType</A>(*da, DA1D);
-<a name="line395">395: </a>  <font color="#4169E1">return</font>(0);
-<a name="line396">396: </a>}
+<a name="line152">152: </a>  <font color="#4169E1">if</font> (s &gt; 0) {
+<a name="line153">153: </a>    <font color="#B22222">/* if not communicating data then should be ok to have nothing on some processes */</font>
+<a name="line154">154: </a>    <font color="#4169E1">if</font> (M &lt; m)     <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"More processors than data points! %D %D"</font>,m,M);
+<a name="line155">155: </a>    <font color="#4169E1">if</font> ((M-1) &lt; s) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Array is too small for stencil! %D %D"</font>,M-1,s);
+<a name="line156">156: </a>  }
+<a name="line157">157: </a>  <font color="#B22222">/* </font>
+<a name="line158">158: </a><font color="#B22222">     Determine locally owned region </font>
+<a name="line159">159: </a><font color="#B22222">     xs is the first local node number, x is the number of local nodes </font>
+<a name="line160">160: </a><font color="#B22222">  */</font>
+<a name="line161">161: </a>  <font color="#4169E1">if</font> (!lx) {
+<a name="line162">162: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-da_partition_blockcomm"</font>,&amp;flg1,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line163">163: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-da_partition_nodes_at_end"</font>,&amp;flg2,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line164">164: </a>    <font color="#4169E1">if</font> (flg1) {      <font color="#B22222">/* Block Comm type Distribution */</font>
+<a name="line165">165: </a>      xs = rank*M/m;
+<a name="line166">166: </a>      x  = (rank + 1)*M/m - xs;
+<a name="line167">167: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg2) { <font color="#B22222">/* The odd nodes are evenly distributed across last nodes */</font>
+<a name="line168">168: </a>      x = (M + rank)/m;
+<a name="line169">169: </a>      <font color="#4169E1">if</font> (M/m == x) { xs = rank*x; }
+<a name="line170">170: </a>      <font color="#4169E1">else</font>          { xs = rank*(x-1) + (M+rank)%(x*m); }
+<a name="line171">171: </a>    } <font color="#4169E1">else</font> { <font color="#B22222">/* The odd nodes are evenly distributed across the first k nodes */</font>
+<a name="line172">172: </a>      <font color="#B22222">/* Regular PETSc Distribution */</font>
+<a name="line173">173: </a>      x = M/m + ((M % m) &gt; rank);
+<a name="line174">174: </a>      <font color="#4169E1">if</font> (rank &gt;= (M % m)) {xs = (rank * (<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)(M/m) + M % m);}
+<a name="line175">175: </a>      <font color="#4169E1">else</font>                 {xs = rank * (<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)(M/m) + rank;}
+<a name="line176">176: </a>    }
+<a name="line177">177: </a>  } <font color="#4169E1">else</font> {
+<a name="line178">178: </a>    x  = lx[rank];
+<a name="line179">179: </a>    xs = 0;
+<a name="line180">180: </a>    <font color="#4169E1">for</font> (i=0; i&lt;rank; i++) {
+<a name="line181">181: </a>      xs += lx[i];
+<a name="line182">182: </a>    }
+<a name="line183">183: </a>    <font color="#B22222">/* verify that data user provided is consistent */</font>
+<a name="line184">184: </a>    left = xs;
+<a name="line185">185: </a>    <font color="#4169E1">for</font> (i=rank; i&lt;size; i++) {
+<a name="line186">186: </a>      left += lx[i];
+<a name="line187">187: </a>    }
+<a name="line188">188: </a>    <font color="#4169E1">if</font> (left != M) {
+<a name="line189">189: </a>      <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Sum of lx across processors not equal to M %D %D"</font>,left,M);
+<a name="line190">190: </a>    }
+<a name="line191">191: </a>  }
+
+<a name="line193">193: </a>  <font color="#B22222">/* From now on x,xs,xe,Xs,Xe are the exact location in the array */</font>
+<a name="line194">194: </a>  x  *= dof;
+<a name="line195">195: </a>  xs *= dof;
+<a name="line196">196: </a>  xe  = xs + x;
+
+<a name="line198">198: </a>  <font color="#B22222">/* determine ghost region */</font>
+<a name="line199">199: </a>  <font color="#4169E1">if</font> (wrap == DA_XPERIODIC || wrap == DA_XYZGHOSTED) {
+<a name="line200">200: </a>    Xs = xs - sDist;
+<a name="line201">201: </a>    Xe = xe + sDist;
+<a name="line202">202: </a>  } <font color="#4169E1">else</font> {
+<a name="line203">203: </a>    <font color="#4169E1">if</font> ((xs-sDist) &gt;= 0)     Xs = xs-sDist;  <font color="#4169E1">else</font> Xs = 0;
+<a name="line204">204: </a>    <font color="#4169E1">if</font> ((xe+sDist) &lt;= M*dof) Xe = xe+sDist;  <font color="#4169E1">else</font> Xe = M*dof;
+<a name="line205">205: </a>  }
+
+<a name="line207">207: </a>  <font color="#B22222">/* allocate the base parallel and sequential vectors */</font>
+<a name="line208">208: </a>  da-&gt;Nlocal = x;
+<a name="line209">209: </a>  <A href="../../../../docs/manualpages/Vec/VecCreateMPIWithArray.html#VecCreateMPIWithArray">VecCreateMPIWithArray</A>(comm,da-&gt;Nlocal,<A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>,0,&amp;global);
+<a name="line210">210: </a>  <A href="../../../../docs/manualpages/Vec/VecSetBlockSize.html#VecSetBlockSize">VecSetBlockSize</A>(global,dof);
+<a name="line211">211: </a>  da-&gt;nlocal = (Xe-Xs);
+<a name="line212">212: </a>  <A href="../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>(<A href="../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,da-&gt;nlocal,0,&amp;local);
+<a name="line213">213: </a>  <A href="../../../../docs/manualpages/Vec/VecSetBlockSize.html#VecSetBlockSize">VecSetBlockSize</A>(local,dof);
+<a name="line214">214: </a>
+<a name="line215">215: </a>  <font color="#B22222">/* Create Local to Global Vector Scatter Context */</font>
+<a name="line216">216: </a>  <font color="#B22222">/* local to global inserts non-ghost point region into global */</font>
+<a name="line217">217: </a>  <A href="../../../../docs/manualpages/Vec/VecGetOwnershipRange.html#VecGetOwnershipRange">VecGetOwnershipRange</A>(global,&amp;start,&amp;end);
+<a name="line218">218: </a>  <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,x,start,1,&amp;to);
+<a name="line219">219: </a>  <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,x,xs-Xs,1,&amp;from);
+<a name="line220">220: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(local,from,global,to,&amp;ltog);
+<a name="line221">221: </a>  PetscLogObjectParent(da,ltog);
+<a name="line222">222: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(from);
+<a name="line223">223: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(to);
+
+<a name="line225">225: </a>  <font color="#B22222">/* Create Global to Local Vector Scatter Context */</font>
+<a name="line226">226: </a>  <font color="#B22222">/* global to local must retrieve ghost points */</font>
+<a name="line227">227: </a>  <font color="#4169E1">if</font>  (wrap == DA_XYZGHOSTED) {
+<a name="line228">228: </a>    <font color="#4169E1">if</font> (size == 1) {
+<a name="line229">229: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(xe-xs),sDist,1,&amp;to);
+<a name="line230">230: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!rank) {
+<a name="line231">231: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(Xe-xs),sDist,1,&amp;to);
+<a name="line232">232: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (rank == size-1) {
+<a name="line233">233: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(xe-Xs),0,1,&amp;to);
+<a name="line234">234: </a>    } <font color="#4169E1">else</font> {
+<a name="line235">235: </a>      <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(Xe-Xs),0,1,&amp;to);
+<a name="line236">236: </a>    }
+<a name="line237">237: </a>  } <font color="#4169E1">else</font> {
+<a name="line238">238: </a>    <A href="../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(comm,(Xe-Xs),0,1,&amp;to);
+<a name="line239">239: </a>  }
+<a name="line240">240: </a>
+<a name="line241">241: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((x+2*sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;idx);
+<a name="line242">242: </a>  PetscLogObjectMemory(da,(x+2*sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+
+<a name="line244">244: </a>  nn = 0;
+<a name="line245">245: </a>  <font color="#4169E1">if</font> (wrap == DA_XPERIODIC) {    <font color="#B22222">/* Handle all cases with wrap first */</font>
+
+<a name="line247">247: </a>    <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) {  <font color="#B22222">/* Left ghost points */</font>
+<a name="line248">248: </a>      <font color="#4169E1">if</font> ((xs-sDist+i)&gt;=0) { idx[nn++] = xs-sDist+i;}
+<a name="line249">249: </a>      <font color="#4169E1">else</font>                 { idx[nn++] = M*dof+(xs-sDist+i);}
+<a name="line250">250: </a>    }
+
+<a name="line252">252: </a>    <font color="#4169E1">for</font> (i=0; i&lt;x; i++) { idx [nn++] = xs + i;}  <font color="#B22222">/* Non-ghost points */</font>
+<a name="line253">253: </a>
+<a name="line254">254: </a>    <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) { <font color="#B22222">/* Right ghost points */</font>
+<a name="line255">255: </a>      <font color="#4169E1">if</font> ((xe+i)&lt;M*dof) { idx [nn++] =  xe+i; }
+<a name="line256">256: </a>      <font color="#4169E1">else</font>              { idx [nn++] = (xe+i) - M*dof;}
+<a name="line257">257: </a>    }
+<a name="line258">258: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (wrap == DA_XYZGHOSTED) {
+
+<a name="line260">260: </a>    <font color="#4169E1">if</font> (sDist &lt;= xs) {<font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) {idx[nn++] = xs - sDist + i;}}
+
+<a name="line262">262: </a>    <font color="#4169E1">for</font> (i=0; i&lt;x; i++) { idx [nn++] = xs + i;}
+<a name="line263">263: </a>
+<a name="line264">264: </a>    <font color="#4169E1">if</font> ((xe+sDist)&lt;=M*dof) {<font color="#4169E1">for</font> (i=0;  i&lt;sDist;     i++) {idx[nn++]=xe+i;}}
+
+<a name="line266">266: </a>  } <font color="#4169E1">else</font> {      <font color="#B22222">/* Now do all cases with no wrapping */</font>
+
+<a name="line268">268: </a>    <font color="#4169E1">if</font> (sDist &lt;= xs) {<font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) {idx[nn++] = xs - sDist + i;}}
+<a name="line269">269: </a>    <font color="#4169E1">else</font>             {<font color="#4169E1">for</font> (i=0; i&lt;xs;    i++) {idx[nn++] = i;}}
+
+<a name="line271">271: </a>    <font color="#4169E1">for</font> (i=0; i&lt;x; i++) { idx [nn++] = xs + i;}
+<a name="line272">272: </a>
+<a name="line273">273: </a>    <font color="#4169E1">if</font> ((xe+sDist)&lt;=M*dof) {<font color="#4169E1">for</font> (i=0;  i&lt;sDist;   i++) {idx[nn++]=xe+i;}}
+<a name="line274">274: </a>    <font color="#4169E1">else</font>                   {<font color="#4169E1">for</font> (i=xe; i&lt;(M*dof); i++) {idx[nn++]=i;}}
+<a name="line275">275: </a>  }
+
+<a name="line277">277: </a>  <A href="../../../../docs/manualpages/IS/ISCreateGeneral.html#ISCreateGeneral">ISCreateGeneral</A>(comm,nn,idx,&amp;from);
+<a name="line278">278: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(global,from,local,to,&amp;gtol);
+<a name="line279">279: </a>  PetscLogObjectParent(da,to);
+<a name="line280">280: </a>  PetscLogObjectParent(da,from);
+<a name="line281">281: </a>  PetscLogObjectParent(da,gtol);
+<a name="line282">282: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(to);
+<a name="line283">283: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(from);
+<a name="line284">284: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(local);
+<a name="line285">285: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(global);
+
+<a name="line287">287: </a>  da-&gt;xs = xs; da-&gt;xe = xe; da-&gt;ys = 0; da-&gt;ye = 1; da-&gt;zs = 0; da-&gt;ze = 1;
+<a name="line288">288: </a>  da-&gt;Xs = Xs; da-&gt;Xe = Xe; da-&gt;Ys = 0; da-&gt;Ye = 1; da-&gt;Zs = 0; da-&gt;Ze = 1;
+
+<a name="line290">290: </a>  da-&gt;gtol      = gtol;
+<a name="line291">291: </a>  da-&gt;ltog      = ltog;
+<a name="line292">292: </a>  da-&gt;base      = xs;
+<a name="line293">293: </a>  da-&gt;ops-&gt;view = DAView_1d;
+
+<a name="line295">295: </a>  <font color="#B22222">/* </font>
+<a name="line296">296: </a><font color="#B22222">     Set the local to global ordering in the global vector, this allows use</font>
+<a name="line297">297: </a><font color="#B22222">     of <A href="../../../../docs/manualpages/Vec/VecSetValuesLocal.html#VecSetValuesLocal">VecSetValuesLocal</A>().</font>
+<a name="line298">298: </a><font color="#B22222">  */</font>
+<a name="line299">299: </a>  <font color="#4169E1">if</font> (wrap == DA_XYZGHOSTED) {
+<a name="line300">300: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *tmpidx;
+<a name="line301">301: </a>    <font color="#4169E1">if</font> (size == 1) {
+<a name="line302">302: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((nn+2*sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;tmpidx);
+<a name="line303">303: </a>      <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) tmpidx[i] = -1;
+<a name="line304">304: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpidx+sDist,idx,nn*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line305">305: </a>      <font color="#4169E1">for</font> (i=nn+sDist; i&lt;nn+2*sDist; i++) tmpidx[i] = -1;
+<a name="line306">306: </a>      <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(idx);
+<a name="line307">307: </a>      idx  = tmpidx;
+<a name="line308">308: </a>      nn  += 2*sDist;
+<a name="line309">309: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!rank) { <font color="#B22222">/* must preprend -1 marker for ghost location that have no global value */</font>
+<a name="line310">310: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((nn+sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;tmpidx);
+<a name="line311">311: </a>      <font color="#4169E1">for</font> (i=0; i&lt;sDist; i++) tmpidx[i] = -1;
+<a name="line312">312: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpidx+sDist,idx,nn*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line313">313: </a>      <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(idx);
+<a name="line314">314: </a>      idx  = tmpidx;
+<a name="line315">315: </a>      nn  += sDist;
+<a name="line316">316: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (rank  == size-1) { <font color="#B22222">/* must postpend -1 marker for ghost location that have no global value */</font>
+<a name="line317">317: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((nn+sDist)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;tmpidx);
+<a name="line318">318: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpidx,idx,nn*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line319">319: </a>      <font color="#4169E1">for</font> (i=nn; i&lt;nn+sDist; i++) tmpidx[i] = -1;
+<a name="line320">320: </a>      <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(idx);
+<a name="line321">321: </a>      idx  = tmpidx;
+<a name="line322">322: </a>      nn  += sDist;
+<a name="line323">323: </a>    }
+<a name="line324">324: </a>  }
+<a name="line325">325: </a>  <A href="../../../../docs/manualpages/IS/ISLocalToGlobalMappingCreateNC.html#ISLocalToGlobalMappingCreateNC">ISLocalToGlobalMappingCreateNC</A>(comm,nn,idx,&amp;da-&gt;ltogmap);
+<a name="line326">326: </a>  <A href="../../../../docs/manualpages/IS/ISLocalToGlobalMappingBlock.html#ISLocalToGlobalMappingBlock">ISLocalToGlobalMappingBlock</A>(da-&gt;ltogmap,da-&gt;w,&amp;da-&gt;ltogmapb);
+<a name="line327">327: </a>  PetscLogObjectParent(da,da-&gt;ltogmap);
+
+<a name="line329">329: </a>  da-&gt;idx = idx;
+<a name="line330">330: </a>  da-&gt;Nl  = nn;
+
+<a name="line332">332: </a>  PetscPublishAll(da);
+<a name="line333">333: </a>  <font color="#4169E1">return</font>(0);
+<a name="line334">334: </a>}
+
+<a name="line339">339: </a><font color="#B22222">/*@C</font>
+<a name="line340">340: </a><font color="#B22222">   <A href="../../../../docs/manualpages/DA/DACreate1d.html#DACreate1d">DACreate1d</A> - Creates an object that will manage the communication of  one-dimensional </font>
+<a name="line341">341: </a><font color="#B22222">   regular array data that is distributed across some processors.</font>
+
+<a name="line343">343: </a><font color="#B22222">   Collective on <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line345">345: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line346">346: </a><font color="#B22222">+  comm - MPI communicator</font>
+<a name="line347">347: </a><font color="#B22222">.  wrap - type of periodicity should the array have, if any. Use </font>
+<a name="line348">348: </a><font color="#B22222">          either DA_NONPERIODIC or DA_XPERIODIC</font>
+<a name="line349">349: </a><font color="#B22222">.  M - global dimension of the array (use -M to indicate that it may be set to a different value </font>
+<a name="line350">350: </a><font color="#B22222">            from the command line with -da_grid_x &lt;M&gt;)</font>
+<a name="line351">351: </a><font color="#B22222">.  dof - number of degrees of freedom per node</font>
+<a name="line352">352: </a><font color="#B22222">.  s - stencil width</font>
+<a name="line353">353: </a><font color="#B22222">-  lx - array containing number of nodes in the X direction on each processor, </font>
+<a name="line354">354: </a><font color="#B22222">        or <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>. If non-null, must be of length as m.</font>
+
+<a name="line356">356: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line357">357: </a><font color="#B22222">.  da - the resulting distributed array object</font>
+
+<a name="line359">359: </a><font color="#B22222">   Options Database Key:</font>
+<a name="line360">360: </a><font color="#B22222">+  -da_view - Calls <A href="../../../../docs/manualpages/DA/DAView.html#DAView">DAView</A>() at the conclusion of <A href="../../../../docs/manualpages/DA/DACreate1d.html#DACreate1d">DACreate1d</A>()</font>
+<a name="line361">361: </a><font color="#B22222">.  -da_grid_x &lt;nx&gt; - number of grid points in x direction; can set if M &lt; 0</font>
+<a name="line362">362: </a><font color="#B22222">-  -da_refine_x - refinement factor </font>
+
+<a name="line364">364: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line366">366: </a><font color="#B22222">   Notes:</font>
+<a name="line367">367: </a><font color="#B22222">   The array data itself is NOT stored in the <A href="../../../../docs/manualpages/DA/DA.html#DA">DA</A>, it is stored in <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> objects;</font>
+<a name="line368">368: </a><font color="#B22222">   The appropriate vector objects can be obtained with calls to <A href="../../../../docs/manualpages/DA/DACreateGlobalVector.html#DACreateGlobalVector">DACreateGlobalVector</A>()</font>
+<a name="line369">369: </a><font color="#B22222">   and <A href="../../../../docs/manualpages/DA/DACreateLocalVector.html#DACreateLocalVector">DACreateLocalVector</A>() and calls to <A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>() if more are needed.</font>
+
+
+<a name="line372">372: </a><font color="#B22222">.keywords: distributed array, create, one-dimensional</font>
+
+<a name="line374">374: </a><font color="#B22222">.seealso: <A href="../../../../docs/manualpages/DA/DADestroy.html#DADestroy">DADestroy</A>(), <A href="../../../../docs/manualpages/DA/DAView.html#DAView">DAView</A>(), <A href="../../../../docs/manualpages/DA/DACreate2d.html#DACreate2d">DACreate2d</A>(), <A href="../../../../docs/manualpages/DA/DACreate3d.html#DACreate3d">DACreate3d</A>(), <A href="../../../../docs/manualpages/DA/DAGlobalToLocalBegin.html#DAGlobalToLocalBegin">DAGlobalToLocalBegin</A>(), <A href="../../../../docs/manualpages/DA/DASetRefinementFactor.html#DASetRefinementFactor">DASetRefinementFactor</A>(),</font>
+<a name="line375">375: </a><font color="#B22222">          <A href="../../../../docs/manualpages/DA/DAGlobalToLocalEnd.html#DAGlobalToLocalEnd">DAGlobalToLocalEnd</A>(), <A href="../../../../docs/manualpages/DA/DALocalToGlobal.html#DALocalToGlobal">DALocalToGlobal</A>(), <A href="../../../../docs/manualpages/DA/DALocalToLocalBegin.html#DALocalToLocalBegin">DALocalToLocalBegin</A>(), <A href="../../../../docs/manualpages/DA/DALocalToLocalEnd.html#DALocalToLocalEnd">DALocalToLocalEnd</A>(), <A href="../../../../docs/manualpages/DA/DAGetRefinementFactor.html#DAGetRefinementFactor">DAGetRefinementFactor</A>(),</font>
+<a name="line376">376: </a><font color="#B22222">          <A href="../../../../docs/manualpages/DA/DAGetInfo.html#DAGetInfo">DAGetInfo</A>(), <A href="../../../../docs/manualpages/DA/DACreateGlobalVector.html#DACreateGlobalVector">DACreateGlobalVector</A>(), <A href="../../../../docs/manualpages/DA/DACreateLocalVector.html#DACreateLocalVector">DACreateLocalVector</A>(), <A href="../../../../docs/manualpages/DA/DACreateNaturalVector.html#DACreateNaturalVector">DACreateNaturalVector</A>(), <A href="../../../../docs/manualpages/DA/DALoad.html#DALoad">DALoad</A>(), <A href="../../../../docs/manualpages/DA/DAView.html#DAView">DAView</A>(), <A href="../../../../docs/manualpages/DA/DAGetOwnershipRanges.html#DAGetOwnershipRanges">DAGetOwnershipRanges</A>()</font>
+
+<a name="line378">378: </a><font color="#B22222">@*/</font>
+<a name="line379">379: </a><strong><font color="#4169E1"><a name="DACreate1d"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../docs/manualpages/DA/DACreate1d.html#DACreate1d">DACreate1d</A>(<A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm, <A href="../../../../docs/manualpages/DA/DAPeriodicType.html#DAPeriodicType">DAPeriodicType</A> wrap, <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> M, <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> dof, <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> s, const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> lx[], <A href="../../../../docs/manualpages/DA/DA.html#DA">DA</A> *da)</font></strong>
+<a name="line380">380: </a>{
+<a name="line382">382: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
+
+<a name="line385">385: </a>  <A href="../../../../docs/manualpages/DA/DACreate.html#DACreate">DACreate</A>(comm, da);
+<a name="line386">386: </a>  <A href="../../../../docs/manualpages/DA/DASetDim.html#DASetDim">DASetDim</A>(*da, 1);
+<a name="line387">387: </a>  <A href="../../../../docs/manualpages/DA/DASetSizes.html#DASetSizes">DASetSizes</A>(*da, M, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>);
+<a name="line388">388: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm, &amp;size);
+<a name="line389">389: </a>  <A href="../../../../docs/manualpages/DA/DASetNumProcs.html#DASetNumProcs">DASetNumProcs</A>(*da, size, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>, <A href="../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>);
+<a name="line390">390: </a>  <A href="../../../../docs/manualpages/DA/DASetPeriodicity.html#DASetPeriodicity">DASetPeriodicity</A>(*da, wrap);
+<a name="line391">391: </a>  <A href="../../../../docs/manualpages/DA/DASetDof.html#DASetDof">DASetDof</A>(*da, dof);
+<a name="line392">392: </a>  <A href="../../../../docs/manualpages/DA/DASetStencilWidth.html#DASetStencilWidth">DASetStencilWidth</A>(*da, s);
+<a name="line393">393: </a>  <A href="../../../../docs/manualpages/DA/DASetVertexDivision.html#DASetVertexDivision">DASetVertexDivision</A>(*da, lx, <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>, <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line394">394: </a>  <font color="#B22222">/* This violates the behavior for other classes, but right now users expect negative dimensions to be handled this way */</font>
+<a name="line395">395: </a>  <A href="../../../../docs/manualpages/DA/DASetFromOptions.html#DASetFromOptions">DASetFromOptions</A>(*da);
+<a name="line396">396: </a>  <A href="../../../../docs/manualpages/DA/DASetType.html#DASetType">DASetType</A>(*da, DA1D);
+<a name="line397">397: </a>  <font color="#4169E1">return</font>(0);
+<a name="line398">398: </a>}
 </pre>
 </body>
 
Index: petsc/src/dm/da/utils/fdda.c
===================================================================
--- petsc.orig/src/dm/da/utils/fdda.c
+++ petsc/src/dm/da/utils/fdda.c
@@ -699,8 +699,8 @@
     } else if (dim == 3) {
       ierr = DAGetMatrix3d_MPIBAIJ(da,A);CHKERRQ(ierr);
     } else {
-      SETERRQ2(PETSC_ERR_SUP,"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n" \
-	       "Send mail to petsc-maint@mcs.anl.gov for code",Atype,dim);
+      SETERRQ3(PETSC_ERR_SUP,"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n" \
+	       "Send mail to petsc-maint@mcs.anl.gov for code",dim,Atype,dim);
     }
   } else if (sbaij) {
     if (dim == 2) {
@@ -708,8 +708,8 @@
     } else if (dim == 3) {
       ierr = DAGetMatrix3d_MPISBAIJ(da,A);CHKERRQ(ierr);
     } else {
-      SETERRQ2(PETSC_ERR_SUP,"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n" \
-	       "Send mail to petsc-maint@mcs.anl.gov for code",Atype,dim);
+      SETERRQ3(PETSC_ERR_SUP,"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n" \
+	       "Send mail to petsc-maint@mcs.anl.gov for code",dim,Atype,dim);
     }
   } 
   ierr = DAGetGhostCorners(da,&starts[0],&starts[1],&starts[2],&dims[0],&dims[1],&dims[2]);CHKERRQ(ierr);
Index: petsc/src/dm/da/utils/fdda.c.html
===================================================================
--- petsc.orig/src/dm/da/utils/fdda.c.html
+++ petsc/src/dm/da/utils/fdda.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-06-04T21:02:41+00:00">
+<meta name="date" content="2011-03-17T18:58:49+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -673,8 +673,8 @@
 <a name="line699">699: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (dim == 3) {
 <a name="line700">700: </a>      DAGetMatrix3d_MPIBAIJ(da,A);
 <a name="line701">701: </a>    } <font color="#4169E1">else</font> {
-<a name="line702">702: </a>      <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_SUP,<font color="#666666">"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n"</font> \
-<a name="line703">703: </a>               <font color="#666666">"Send mail to petsc-maint@mcs.anl.gov for code"</font>,Atype,dim);
+<a name="line702">702: </a>      <A href="../../../../docs/manualpages/Sys/SETERRQ3.html#SETERRQ3">SETERRQ3</A>(PETSC_ERR_SUP,<font color="#666666">"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n"</font> \
+<a name="line703">703: </a>               <font color="#666666">"Send mail to petsc-maint@mcs.anl.gov for code"</font>,dim,Atype,dim);
 <a name="line704">704: </a>    }
 <a name="line705">705: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (sbaij) {
 <a name="line706">706: </a>    <font color="#4169E1">if</font> (dim == 2) {
@@ -682,8 +682,8 @@
 <a name="line708">708: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (dim == 3) {
 <a name="line709">709: </a>      DAGetMatrix3d_MPISBAIJ(da,A);
 <a name="line710">710: </a>    } <font color="#4169E1">else</font> {
-<a name="line711">711: </a>      <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_SUP,<font color="#666666">"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n"</font> \
-<a name="line712">712: </a>               <font color="#666666">"Send mail to petsc-maint@mcs.anl.gov for code"</font>,Atype,dim);
+<a name="line711">711: </a>      <A href="../../../../docs/manualpages/Sys/SETERRQ3.html#SETERRQ3">SETERRQ3</A>(PETSC_ERR_SUP,<font color="#666666">"Not implemented for %D dimension and Matrix Type: %s in %D dimension!\n"</font> \
+<a name="line712">712: </a>               <font color="#666666">"Send mail to petsc-maint@mcs.anl.gov for code"</font>,dim,Atype,dim);
 <a name="line713">713: </a>    }
 <a name="line714">714: </a>  }
 <a name="line715">715: </a>  <A href="../../../../docs/manualpages/DA/DAGetGhostCorners.html#DAGetGhostCorners">DAGetGhostCorners</A>(da,&amp;starts[0],&amp;starts[1],&amp;starts[2],&amp;dims[0],&amp;dims[1],&amp;dims[2]);
Index: petsc/src/ksp/ksp/impls/gmres/fgmres/ftn-custom/zmodpcff.c
===================================================================
--- petsc.orig/src/ksp/ksp/impls/gmres/fgmres/ftn-custom/zmodpcff.c
+++ petsc/src/ksp/ksp/impls/gmres/fgmres/ftn-custom/zmodpcff.c
@@ -3,8 +3,12 @@
 
 #if defined(PETSC_HAVE_FORTRAN_CAPS)
 #define kspfgmressetmodifypc_      KSPFGMRESSETMODIFYPC
+#define kspfgmresmodifypcnochange_ KSPFGMRESMODIFYPCNOCHANGE
+#define kspfgmresmodifypcksp_      KSPFGMRESMODIFYPCKSP
 #elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)
 #define kspfgmressetmodifypc_      kspfgmressetmodifypc
+#define kspfgmresmodifypcnochange_ kspfgmresmodifypcnochange
+#define kspfgmresmodifypcksp_      kspfgmresmodifypcksp
 #endif
 
 static PetscErrorCode ourmodify(KSP ksp,PetscInt i,PetscInt i2,PetscReal d,void* ctx)
Index: petsc/src/mat/impls/aij/mpi/mpiaij.c
===================================================================
--- petsc.orig/src/mat/impls/aij/mpi/mpiaij.c
+++ petsc/src/mat/impls/aij/mpi/mpiaij.c
@@ -530,7 +530,7 @@
     ierr = MatSetUpMultiply_MPIAIJ(mat);CHKERRQ(ierr);
   }
   ierr = MatSetOption(aij->B,MAT_USE_INODES,PETSC_FALSE);CHKERRQ(ierr);
-  ((Mat_SeqAIJ *)aij->B->data)->compressedrow.use = PETSC_TRUE; /* b->compressedrow.use */
+  ((Mat_SeqAIJ *)aij->B->data)->compressedrow.use = PETSC_FALSE; /* b->compressedrow.use */
   ierr = MatAssemblyBegin(aij->B,mode);CHKERRQ(ierr);
   ierr = MatAssemblyEnd(aij->B,mode);CHKERRQ(ierr);
 
Index: petsc/src/mat/impls/aij/mpi/mpiaij.c.html
===================================================================
--- petsc.orig/src/mat/impls/aij/mpi/mpiaij.c.html
+++ petsc/src/mat/impls/aij/mpi/mpiaij.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:29:04+00:00">
+<meta name="date" content="2011-03-17T18:50:10+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -510,7 +510,7 @@
 <a name="line530">530: </a>    MatSetUpMultiply_MPIAIJ(mat);
 <a name="line531">531: </a>  }
 <a name="line532">532: </a>  <A href="../../../../../docs/manualpages/Mat/MatSetOption.html#MatSetOption">MatSetOption</A>(aij-&gt;B,MAT_USE_INODES,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-<a name="line533">533: </a>  ((Mat_SeqAIJ *)aij-&gt;B-&gt;data)-&gt;compressedrow.use = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#B22222">/* b-&gt;compressedrow.use */</font>
+<a name="line533">533: </a>  ((Mat_SeqAIJ *)aij-&gt;B-&gt;data)-&gt;compressedrow.use = <A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#B22222">/* b-&gt;compressedrow.use */</font>
 <a name="line534">534: </a>  <A href="../../../../../docs/manualpages/Mat/MatAssemblyBegin.html#MatAssemblyBegin">MatAssemblyBegin</A>(aij-&gt;B,mode);
 <a name="line535">535: </a>  <A href="../../../../../docs/manualpages/Mat/MatAssemblyEnd.html#MatAssemblyEnd">MatAssemblyEnd</A>(aij-&gt;B,mode);
 
Index: petsc/src/mat/impls/aij/mpi/pastix/pastix.c
===================================================================
--- petsc.orig/src/mat/impls/aij/mpi/pastix/pastix.c
+++ petsc/src/mat/impls/aij/mpi/pastix/pastix.c
@@ -164,7 +164,10 @@
   {
     PetscScalar *tmpvalues;
     PetscInt    *tmprows,*tmpcolptr;
-    ierr = PetscMalloc3(nnz,PetscScalar,&tmpvalues,nnz,PetscInt,&tmprows,(*n+1),PetscInt,&tmpcolptr);CHKERRQ(ierr);
+    tmpvalues = (PetscScalar*)malloc(nnz*sizeof(PetscScalar)); if (!tmpvalues) SETERRQ(PETSC_ERR_MEM,"Unable to allocate memory");
+    tmprows   = (PetscInt*)malloc(nnz*sizeof(PetscInt));if (!tmprows) SETERRQ(PETSC_ERR_MEM,"Unable to allocate memory");
+    tmpcolptr = (PetscInt*)malloc((*n+1)*sizeof(PetscInt));if (!tmpcolptr) SETERRQ(PETSC_ERR_MEM,"Unable to allocate memory");
+
     if (sizeof(PetscScalar) != sizeof(pastix_float_t)) {
       SETERRQ2(PETSC_ERR_SUP,"sizeof(PetscScalar) %d != sizeof(pastix_float_t) %d",sizeof(PetscScalar),sizeof(pastix_float_t));
     }
@@ -185,7 +188,9 @@
     ierr = PetscMemcpy(*row,tmprows,((*colptr)[*n]-1)*sizeof(PetscInt));CHKERRQ(ierr);
     ierr = PetscMalloc(((*colptr)[*n]-1)*sizeof(PetscScalar),values);CHKERRQ(ierr);
     ierr = PetscMemcpy(*values,tmpvalues,((*colptr)[*n]-1)*sizeof(PetscScalar));CHKERRQ(ierr);
-    ierr = PetscFree3(tmpvalues,tmprows,tmpcolptr);CHKERRQ(ierr);
+    free(tmpvalues);
+    free(tmprows);
+    free(tmpcolptr);
   }
   PetscFunctionReturn(0);
 }
@@ -327,11 +332,12 @@
   IS             is_iden;
   Vec            b;
   IS             isrow;
-  PetscTruth     isSeqAIJ,isSeqSBAIJ;
+  PetscTruth     isSeqAIJ,isSeqSBAIJ,isMPIAIJ;
 
   PetscFunctionBegin; 	
   
   ierr = PetscTypeCompare((PetscObject)A,MATSEQAIJ,&isSeqAIJ);CHKERRQ(ierr);
+  ierr = PetscTypeCompare((PetscObject)A,MATMPIAIJ,&isMPIAIJ);CHKERRQ(ierr);
   ierr = PetscTypeCompare((PetscObject)A,MATSEQSBAIJ,&isSeqSBAIJ);CHKERRQ(ierr);
   if (lu->matstruc == DIFFERENT_NONZERO_PATTERN){ 
     (F)->ops->solve   = MatSolve_PaStiX;
@@ -377,7 +383,12 @@
     PetscOptionsEnd();
     valOnly = PETSC_FALSE; 
   }  else {
-    valOnly = PETSC_TRUE; 
+    if (isSeqAIJ || isMPIAIJ)  {
+      ierr = PetscFree(lu->colptr);CHKERRQ(ierr);
+      ierr = PetscFree(lu->row);CHKERRQ(ierr);
+      ierr = PetscFree(lu->val);CHKERRQ(ierr);
+      valOnly = PETSC_FALSE;
+    } else valOnly = PETSC_TRUE; 
   }
 
   lu->iparm[IPARM_MATRIX_VERIFICATION] = API_YES;
@@ -391,8 +402,10 @@
   ierr = MatIsSymmetric(*tseq,0.0,&isSym);CHKERRQ(ierr);
   ierr = MatDestroyMatrices(1,&tseq);CHKERRQ(ierr);
 
-  ierr = PetscMalloc((lu->n)*sizeof(PetscInt)   ,&(lu->perm));CHKERRQ(ierr);
-  ierr = PetscMalloc((lu->n)*sizeof(PetscInt)   ,&(lu->invp));CHKERRQ(ierr);
+  if (!lu->perm) {
+    ierr = PetscMalloc((lu->n)*sizeof(PetscInt)   ,&(lu->perm));CHKERRQ(ierr);
+    ierr = PetscMalloc((lu->n)*sizeof(PetscInt)   ,&(lu->invp));CHKERRQ(ierr);
+  }
 
   if (isSym) {
     /* On symmetric matrix, LLT */
Index: petsc/src/mat/impls/aij/mpi/pastix/pastix.c.html
===================================================================
--- petsc.orig/src/mat/impls/aij/mpi/pastix/pastix.c.html
+++ petsc/src/mat/impls/aij/mpi/pastix/pastix.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:30:09+00:00">
+<meta name="date" content="2011-03-17T18:51:07+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -169,526 +169,539 @@
 <a name="line164">164: </a>  {
 <a name="line165">165: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *tmpvalues;
 <a name="line166">166: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    *tmprows,*tmpcolptr;
-<a name="line167">167: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(nnz,<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;tmpvalues,nnz,<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;tmprows,(*n+1),<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;tmpcolptr);
-<a name="line168">168: </a>    <font color="#4169E1">if</font> (<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>) != <font color="#4169E1">sizeof</font>(pastix_float_t)) {
-<a name="line169">169: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_SUP,<font color="#666666">"sizeof(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>) %d != sizeof(pastix_float_t) %d"</font>,<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),<font color="#4169E1">sizeof</font>(pastix_float_t));
-<a name="line170">170: </a>    }
-<a name="line171">171: </a>    <font color="#4169E1">if</font> (<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>) != <font color="#4169E1">sizeof</font>(pastix_int_t)) {
-<a name="line172">172: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_SUP,<font color="#666666">"sizeof(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>) %d != sizeof(pastix_int_t) %d"</font>,<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),<font color="#4169E1">sizeof</font>(pastix_int_t));
-<a name="line173">173: </a>    }
+<a name="line167">167: </a>    tmpvalues = (<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>*)malloc(nnz*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)); <font color="#4169E1">if</font> (!tmpvalues) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_MEM,<font color="#666666">"Unable to allocate memory"</font>);
+<a name="line168">168: </a>    tmprows   = (<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>*)malloc(nnz*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));<font color="#4169E1">if</font> (!tmprows) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_MEM,<font color="#666666">"Unable to allocate memory"</font>);
+<a name="line169">169: </a>    tmpcolptr = (<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>*)malloc((*n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));<font color="#4169E1">if</font> (!tmpcolptr) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_MEM,<font color="#666666">"Unable to allocate memory"</font>);
 
-<a name="line175">175: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpcolptr,*colptr,(*n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line176">176: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmprows,*row,nnz*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line177">177: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpvalues,*values,nnz*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-<a name="line178">178: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(*row);
-<a name="line179">179: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(*values);
-
-<a name="line181">181: </a>    pastix_checkMatrix(MPI_COMM_WORLD,API_VERBOSE_NO,((isSym != 0) ? API_SYM_YES : API_SYM_NO),API_YES,*n,&amp;tmpcolptr,&amp;tmprows,&amp;tmpvalues,NULL,1);
-<a name="line182">182: </a>
-<a name="line183">183: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(*colptr,tmpcolptr,(*n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line184">184: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),row);
-<a name="line185">185: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(*row,tmprows,((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line186">186: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),values);
-<a name="line187">187: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(*values,tmpvalues,((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-<a name="line188">188: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(tmpvalues,tmprows,tmpcolptr);
-<a name="line189">189: </a>  }
-<a name="line190">190: </a>  <font color="#4169E1">return</font>(0);
-<a name="line191">191: </a>}
-
-
-
-<a name="line197">197: </a><font color="#B22222">/*</font>
-<a name="line198">198: </a><font color="#B22222">  Call clean step of PaStiX if lu-&gt;CleanUpPastix == true.</font>
-<a name="line199">199: </a><font color="#B22222">  Free the CSC matrix.</font>
-<a name="line200">200: </a><font color="#B22222"> */</font>
-<a name="line201">201: </a><strong><font color="#4169E1"><a name="MatDestroy_Pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatDestroy_Pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A)</font></strong>
-<a name="line202">202: </a>{
-<a name="line203">203: </a>  Mat_Pastix      *lu=(Mat_Pastix*)A-&gt;spptr;
-<a name="line204">204: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   ierr;
-<a name="line205">205: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>      size=lu-&gt;commSize;
-
-<a name="line208">208: </a>  <font color="#4169E1">if</font> (lu-&gt;CleanUpPastix) {
-<a name="line209">209: </a>    <font color="#B22222">/* Terminate instance, deallocate memories */</font>
-<a name="line210">210: </a>    <font color="#4169E1">if</font> (size &gt; 1){
-<a name="line211">211: </a>      <A href="../../../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(lu-&gt;scat_rhs);
-<a name="line212">212: </a>      <A href="../../../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(lu-&gt;b_seq);
-<a name="line213">213: </a>      <A href="../../../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(lu-&gt;scat_sol);
-<a name="line214">214: </a>    }
-<a name="line215">215: </a>
-<a name="line216">216: </a>    lu-&gt;iparm[IPARM_START_TASK]=API_TASK_CLEAN;
-<a name="line217">217: </a>    lu-&gt;iparm[IPARM_END_TASK]=API_TASK_CLEAN;
-
-<a name="line219">219: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
-<a name="line220">220: </a>                              lu-&gt;pastix_comm,
-<a name="line221">221: </a>           (pastix_int_t)     lu-&gt;n,
-<a name="line222">222: </a>           (pastix_int_t*)    lu-&gt;colptr,
-<a name="line223">223: </a>           (pastix_int_t*)    lu-&gt;row,
-<a name="line224">224: </a>           (pastix_float_t*)  lu-&gt;val,
-<a name="line225">225: </a>           (pastix_int_t*)    lu-&gt;perm,
-<a name="line226">226: </a>           (pastix_int_t*)    lu-&gt;invp,
-<a name="line227">227: </a>           (pastix_float_t*)  lu-&gt;rhs,
-<a name="line228">228: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
-<a name="line229">229: </a>           (pastix_int_t*)    lu-&gt;iparm,
-<a name="line230">230: </a>                              lu-&gt;dparm);
-
-<a name="line232">232: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;colptr);
-<a name="line233">233: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;row);
-<a name="line234">234: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;val);
-<a name="line235">235: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;perm);
-<a name="line236">236: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;invp);
-<a name="line237">237: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_free.html#MPI_Comm_free">MPI_Comm_free</A>(&amp;(lu-&gt;pastix_comm));
-<a name="line238">238: </a>  }
-<a name="line239">239: </a>  (lu-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>)(A);
-<a name="line240">240: </a>  <font color="#4169E1">return</font>(0);
-<a name="line241">241: </a>}
-
-<a name="line245">245: </a><font color="#B22222">/*</font>
-<a name="line246">246: </a><font color="#B22222">  Gather right-hand-side.</font>
-<a name="line247">247: </a><font color="#B22222">  Call for Solve step.</font>
-<a name="line248">248: </a><font color="#B22222">  Scatter solution.</font>
-<a name="line249">249: </a><font color="#B22222"> */</font>
-<a name="line250">250: </a><strong><font color="#4169E1"><a name="MatSolve_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatSolve_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> b,<A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> x)</font></strong>
-<a name="line251">251: </a>{
-<a name="line252">252: </a>  Mat_Pastix     *lu=(Mat_Pastix*)A-&gt;spptr;
-<a name="line253">253: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *array;
-<a name="line254">254: </a>  <A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>             x_seq;
-<a name="line255">255: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  ierr;
-
-<a name="line258">258: </a>  lu-&gt;rhsnbr = 1;
-<a name="line259">259: </a>  x_seq = lu-&gt;b_seq;
-<a name="line260">260: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize &gt; 1){
-<a name="line261">261: </a>    <font color="#B22222">/* PaStiX only supports centralized rhs. Scatter b into a seqential rhs vector */</font>
-<a name="line262">262: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(lu-&gt;scat_rhs,b,x_seq,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line263">263: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>(lu-&gt;scat_rhs,b,x_seq,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line264">264: </a>    <A href="../../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(x_seq,&amp;array);
-<a name="line265">265: </a>  } <font color="#4169E1">else</font> {  <font color="#B22222">/* size == 1 */</font>
-<a name="line266">266: </a>    <A href="../../../../../../docs/manualpages/Vec/VecCopy.html#VecCopy">VecCopy</A>(b,x);
-<a name="line267">267: </a>    <A href="../../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(x,&amp;array);
-<a name="line268">268: </a>  }
-<a name="line269">269: </a>  lu-&gt;rhs = array;
-<a name="line270">270: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize == 1){
-<a name="line271">271: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x,&amp;array);
-<a name="line272">272: </a>  } <font color="#4169E1">else</font> {
-<a name="line273">273: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x_seq,&amp;array);
-<a name="line274">274: </a>  }
-
-<a name="line276">276: </a>  <font color="#B22222">/* solve phase */</font>
-<a name="line277">277: </a>  <font color="#B22222">/*-------------*/</font>
-<a name="line278">278: </a>  lu-&gt;iparm[IPARM_START_TASK] = API_TASK_SOLVE;
-<a name="line279">279: </a>  lu-&gt;iparm[IPARM_END_TASK]   = API_TASK_REFINE;
-<a name="line280">280: </a>  lu-&gt;iparm[IPARM_RHS_MAKING] = API_RHS_B;
-<a name="line281">281: </a>
-<a name="line282">282: </a>  pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
-<a name="line283">283: </a>         (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
-<a name="line284">284: </a>         (pastix_int_t)     lu-&gt;n,
-<a name="line285">285: </a>         (pastix_int_t*)    lu-&gt;colptr,
-<a name="line286">286: </a>         (pastix_int_t*)    lu-&gt;row,
-<a name="line287">287: </a>         (pastix_float_t*)  lu-&gt;val,
-<a name="line288">288: </a>         (pastix_int_t*)    lu-&gt;perm,
-<a name="line289">289: </a>         (pastix_int_t*)    lu-&gt;invp,
-<a name="line290">290: </a>         (pastix_float_t*)  lu-&gt;rhs,
-<a name="line291">291: </a>         (pastix_int_t)     lu-&gt;rhsnbr,
-<a name="line292">292: </a>         (pastix_int_t*)    lu-&gt;iparm,
-<a name="line293">293: </a>         (double*)          lu-&gt;dparm);
-<a name="line294">294: </a>
-<a name="line295">295: </a>  <font color="#4169E1">if</font> (lu-&gt;iparm[IPARM_ERROR_NUMBER] &lt; 0) {
-<a name="line296">296: </a>    <A href="../../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_LIB,<font color="#666666">"Error reported by PaStiX in solve phase: lu-&gt;iparm[IPARM_ERROR_NUMBER] = %d\n"</font>,lu-&gt;iparm[IPARM_ERROR_NUMBER] );
-<a name="line297">297: </a>  }
-
-<a name="line299">299: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize == 1){
-<a name="line300">300: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x,&amp;(lu-&gt;rhs));
-<a name="line301">301: </a>  } <font color="#4169E1">else</font> {
-<a name="line302">302: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x_seq,&amp;(lu-&gt;rhs));
-<a name="line303">303: </a>  }
-
-<a name="line305">305: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize &gt; 1) { <font color="#B22222">/* convert PaStiX centralized solution to petsc mpi x */</font>
-<a name="line306">306: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(lu-&gt;scat_sol,x_seq,x,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line307">307: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>(lu-&gt;scat_sol,x_seq,x,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line171">171: </a>    <font color="#4169E1">if</font> (<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>) != <font color="#4169E1">sizeof</font>(pastix_float_t)) {
+<a name="line172">172: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_SUP,<font color="#666666">"sizeof(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>) %d != sizeof(pastix_float_t) %d"</font>,<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),<font color="#4169E1">sizeof</font>(pastix_float_t));
+<a name="line173">173: </a>    }
+<a name="line174">174: </a>    <font color="#4169E1">if</font> (<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>) != <font color="#4169E1">sizeof</font>(pastix_int_t)) {
+<a name="line175">175: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_SUP,<font color="#666666">"sizeof(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>) %d != sizeof(pastix_int_t) %d"</font>,<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),<font color="#4169E1">sizeof</font>(pastix_int_t));
+<a name="line176">176: </a>    }
+
+<a name="line178">178: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpcolptr,*colptr,(*n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line179">179: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmprows,*row,nnz*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line180">180: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(tmpvalues,*values,nnz*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+<a name="line181">181: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(*row);
+<a name="line182">182: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(*values);
+
+<a name="line184">184: </a>    pastix_checkMatrix(MPI_COMM_WORLD,API_VERBOSE_NO,((isSym != 0) ? API_SYM_YES : API_SYM_NO),API_YES,*n,&amp;tmpcolptr,&amp;tmprows,&amp;tmpvalues,NULL,1);
+<a name="line185">185: </a>
+<a name="line186">186: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(*colptr,tmpcolptr,(*n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line187">187: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),row);
+<a name="line188">188: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(*row,tmprows,((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line189">189: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),values);
+<a name="line190">190: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(*values,tmpvalues,((*colptr)[*n]-1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+<a name="line191">191: </a>    free(tmpvalues);
+<a name="line192">192: </a>    free(tmprows);
+<a name="line193">193: </a>    free(tmpcolptr);
+<a name="line194">194: </a>  }
+<a name="line195">195: </a>  <font color="#4169E1">return</font>(0);
+<a name="line196">196: </a>}
+
+
+
+<a name="line202">202: </a><font color="#B22222">/*</font>
+<a name="line203">203: </a><font color="#B22222">  Call clean step of PaStiX if lu-&gt;CleanUpPastix == true.</font>
+<a name="line204">204: </a><font color="#B22222">  Free the CSC matrix.</font>
+<a name="line205">205: </a><font color="#B22222"> */</font>
+<a name="line206">206: </a><strong><font color="#4169E1"><a name="MatDestroy_Pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatDestroy_Pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A)</font></strong>
+<a name="line207">207: </a>{
+<a name="line208">208: </a>  Mat_Pastix      *lu=(Mat_Pastix*)A-&gt;spptr;
+<a name="line209">209: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>   ierr;
+<a name="line210">210: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>      size=lu-&gt;commSize;
+
+<a name="line213">213: </a>  <font color="#4169E1">if</font> (lu-&gt;CleanUpPastix) {
+<a name="line214">214: </a>    <font color="#B22222">/* Terminate instance, deallocate memories */</font>
+<a name="line215">215: </a>    <font color="#4169E1">if</font> (size &gt; 1){
+<a name="line216">216: </a>      <A href="../../../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(lu-&gt;scat_rhs);
+<a name="line217">217: </a>      <A href="../../../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(lu-&gt;b_seq);
+<a name="line218">218: </a>      <A href="../../../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(lu-&gt;scat_sol);
+<a name="line219">219: </a>    }
+<a name="line220">220: </a>
+<a name="line221">221: </a>    lu-&gt;iparm[IPARM_START_TASK]=API_TASK_CLEAN;
+<a name="line222">222: </a>    lu-&gt;iparm[IPARM_END_TASK]=API_TASK_CLEAN;
+
+<a name="line224">224: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
+<a name="line225">225: </a>                              lu-&gt;pastix_comm,
+<a name="line226">226: </a>           (pastix_int_t)     lu-&gt;n,
+<a name="line227">227: </a>           (pastix_int_t*)    lu-&gt;colptr,
+<a name="line228">228: </a>           (pastix_int_t*)    lu-&gt;row,
+<a name="line229">229: </a>           (pastix_float_t*)  lu-&gt;val,
+<a name="line230">230: </a>           (pastix_int_t*)    lu-&gt;perm,
+<a name="line231">231: </a>           (pastix_int_t*)    lu-&gt;invp,
+<a name="line232">232: </a>           (pastix_float_t*)  lu-&gt;rhs,
+<a name="line233">233: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
+<a name="line234">234: </a>           (pastix_int_t*)    lu-&gt;iparm,
+<a name="line235">235: </a>                              lu-&gt;dparm);
+
+<a name="line237">237: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;colptr);
+<a name="line238">238: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;row);
+<a name="line239">239: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;val);
+<a name="line240">240: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;perm);
+<a name="line241">241: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;invp);
+<a name="line242">242: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_free.html#MPI_Comm_free">MPI_Comm_free</A>(&amp;(lu-&gt;pastix_comm));
+<a name="line243">243: </a>  }
+<a name="line244">244: </a>  (lu-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>)(A);
+<a name="line245">245: </a>  <font color="#4169E1">return</font>(0);
+<a name="line246">246: </a>}
+
+<a name="line250">250: </a><font color="#B22222">/*</font>
+<a name="line251">251: </a><font color="#B22222">  Gather right-hand-side.</font>
+<a name="line252">252: </a><font color="#B22222">  Call for Solve step.</font>
+<a name="line253">253: </a><font color="#B22222">  Scatter solution.</font>
+<a name="line254">254: </a><font color="#B22222"> */</font>
+<a name="line255">255: </a><strong><font color="#4169E1"><a name="MatSolve_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatSolve_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> b,<A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> x)</font></strong>
+<a name="line256">256: </a>{
+<a name="line257">257: </a>  Mat_Pastix     *lu=(Mat_Pastix*)A-&gt;spptr;
+<a name="line258">258: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *array;
+<a name="line259">259: </a>  <A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>             x_seq;
+<a name="line260">260: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  ierr;
+
+<a name="line263">263: </a>  lu-&gt;rhsnbr = 1;
+<a name="line264">264: </a>  x_seq = lu-&gt;b_seq;
+<a name="line265">265: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize &gt; 1){
+<a name="line266">266: </a>    <font color="#B22222">/* PaStiX only supports centralized rhs. Scatter b into a seqential rhs vector */</font>
+<a name="line267">267: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(lu-&gt;scat_rhs,b,x_seq,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line268">268: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>(lu-&gt;scat_rhs,b,x_seq,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line269">269: </a>    <A href="../../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(x_seq,&amp;array);
+<a name="line270">270: </a>  } <font color="#4169E1">else</font> {  <font color="#B22222">/* size == 1 */</font>
+<a name="line271">271: </a>    <A href="../../../../../../docs/manualpages/Vec/VecCopy.html#VecCopy">VecCopy</A>(b,x);
+<a name="line272">272: </a>    <A href="../../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(x,&amp;array);
+<a name="line273">273: </a>  }
+<a name="line274">274: </a>  lu-&gt;rhs = array;
+<a name="line275">275: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize == 1){
+<a name="line276">276: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x,&amp;array);
+<a name="line277">277: </a>  } <font color="#4169E1">else</font> {
+<a name="line278">278: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x_seq,&amp;array);
+<a name="line279">279: </a>  }
+
+<a name="line281">281: </a>  <font color="#B22222">/* solve phase */</font>
+<a name="line282">282: </a>  <font color="#B22222">/*-------------*/</font>
+<a name="line283">283: </a>  lu-&gt;iparm[IPARM_START_TASK] = API_TASK_SOLVE;
+<a name="line284">284: </a>  lu-&gt;iparm[IPARM_END_TASK]   = API_TASK_REFINE;
+<a name="line285">285: </a>  lu-&gt;iparm[IPARM_RHS_MAKING] = API_RHS_B;
+<a name="line286">286: </a>
+<a name="line287">287: </a>  pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
+<a name="line288">288: </a>         (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
+<a name="line289">289: </a>         (pastix_int_t)     lu-&gt;n,
+<a name="line290">290: </a>         (pastix_int_t*)    lu-&gt;colptr,
+<a name="line291">291: </a>         (pastix_int_t*)    lu-&gt;row,
+<a name="line292">292: </a>         (pastix_float_t*)  lu-&gt;val,
+<a name="line293">293: </a>         (pastix_int_t*)    lu-&gt;perm,
+<a name="line294">294: </a>         (pastix_int_t*)    lu-&gt;invp,
+<a name="line295">295: </a>         (pastix_float_t*)  lu-&gt;rhs,
+<a name="line296">296: </a>         (pastix_int_t)     lu-&gt;rhsnbr,
+<a name="line297">297: </a>         (pastix_int_t*)    lu-&gt;iparm,
+<a name="line298">298: </a>         (double*)          lu-&gt;dparm);
+<a name="line299">299: </a>
+<a name="line300">300: </a>  <font color="#4169E1">if</font> (lu-&gt;iparm[IPARM_ERROR_NUMBER] &lt; 0) {
+<a name="line301">301: </a>    <A href="../../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_LIB,<font color="#666666">"Error reported by PaStiX in solve phase: lu-&gt;iparm[IPARM_ERROR_NUMBER] = %d\n"</font>,lu-&gt;iparm[IPARM_ERROR_NUMBER] );
+<a name="line302">302: </a>  }
+
+<a name="line304">304: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize == 1){
+<a name="line305">305: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x,&amp;(lu-&gt;rhs));
+<a name="line306">306: </a>  } <font color="#4169E1">else</font> {
+<a name="line307">307: </a>    <A href="../../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(x_seq,&amp;(lu-&gt;rhs));
 <a name="line308">308: </a>  }
-<a name="line309">309: </a>  <font color="#4169E1">return</font>(0);
-<a name="line310">310: </a>}
 
-<a name="line312">312: </a><font color="#B22222">/*</font>
-<a name="line313">313: </a><font color="#B22222">  Numeric factorisation using PaStiX solver.</font>
+<a name="line310">310: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize &gt; 1) { <font color="#B22222">/* convert PaStiX centralized solution to petsc mpi x */</font>
+<a name="line311">311: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(lu-&gt;scat_sol,x_seq,x,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line312">312: </a>    <A href="../../../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>(lu-&gt;scat_sol,x_seq,x,<A href="../../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line313">313: </a>  }
+<a name="line314">314: </a>  <font color="#4169E1">return</font>(0);
+<a name="line315">315: </a>}
+
+<a name="line317">317: </a><font color="#B22222">/*</font>
+<a name="line318">318: </a><font color="#B22222">  Numeric factorisation using PaStiX solver.</font>
+
+<a name="line320">320: </a><font color="#B22222"> */</font>
+<a name="line323">323: </a><strong><font color="#4169E1"><a name="MatFactorNumeric_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatFactorNumeric_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> F,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,const <A href="../../../../../../docs/manualpages/Mat/MatFactorInfo.html#MatFactorInfo">MatFactorInfo</A> *info)</font></strong>
+<a name="line324">324: </a>{
+<a name="line325">325: </a>  Mat_Pastix    *lu =(Mat_Pastix*)(F)-&gt;spptr;
+<a name="line326">326: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>           *tseq;
+<a name="line327">327: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> 0;
+<a name="line328">328: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       icntl;
+<a name="line329">329: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       M=A-&gt;rmap-&gt;N;
+<a name="line330">330: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     valOnly,flg, isSym;
+<a name="line331">331: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            F_diag;
+<a name="line332">332: </a>  <A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A>             is_iden;
+<a name="line333">333: </a>  <A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>            b;
+<a name="line334">334: </a>  <A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A>             isrow;
+<a name="line335">335: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isSeqAIJ,isSeqSBAIJ,isMPIAIJ;
+
+<a name="line338">338: </a>
+<a name="line339">339: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A,<A href="../../../../../../docs/manualpages/Mat/MATSEQAIJ.html#MATSEQAIJ">MATSEQAIJ</A>,&amp;isSeqAIJ);
+<a name="line340">340: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A,<A href="../../../../../../docs/manualpages/Mat/MATMPIAIJ.html#MATMPIAIJ">MATMPIAIJ</A>,&amp;isMPIAIJ);
+<a name="line341">341: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A,<A href="../../../../../../docs/manualpages/Mat/MATSEQSBAIJ.html#MATSEQSBAIJ">MATSEQSBAIJ</A>,&amp;isSeqSBAIJ);
+<a name="line342">342: </a>  <font color="#4169E1">if</font> (lu-&gt;matstruc == DIFFERENT_NONZERO_PATTERN){
+<a name="line343">343: </a>    (F)-&gt;ops-&gt;solve   = MatSolve_PaStiX;
+
+<a name="line345">345: </a>    <font color="#B22222">/* Initialize a PASTIX instance */</font>
+<a name="line346">346: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_dup.html#MPI_Comm_dup">MPI_Comm_dup</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;(lu-&gt;pastix_comm));
+<a name="line347">347: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(lu-&gt;pastix_comm, &amp;lu-&gt;commRank);
+<a name="line348">348: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(lu-&gt;pastix_comm, &amp;lu-&gt;commSize);
+
+<a name="line350">350: </a>    <font color="#B22222">/* Set pastix options */</font>
+<a name="line351">351: </a>    lu-&gt;iparm[IPARM_MODIFY_PARAMETER] = API_NO;
+<a name="line352">352: </a>    lu-&gt;iparm[IPARM_START_TASK]       = API_TASK_INIT;
+<a name="line353">353: </a>    lu-&gt;iparm[IPARM_END_TASK]         = API_TASK_INIT;
+<a name="line354">354: </a>    lu-&gt;rhsnbr = 1;
+
+<a name="line356">356: </a>    <font color="#B22222">/* Call to set default pastix options */</font>
+<a name="line357">357: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
+<a name="line358">358: </a>           (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
+<a name="line359">359: </a>           (pastix_int_t)     lu-&gt;n,
+<a name="line360">360: </a>           (pastix_int_t*)    lu-&gt;colptr,
+<a name="line361">361: </a>           (pastix_int_t*)    lu-&gt;row,
+<a name="line362">362: </a>           (pastix_float_t*)  lu-&gt;val,
+<a name="line363">363: </a>           (pastix_int_t*)    lu-&gt;perm,
+<a name="line364">364: </a>           (pastix_int_t*)    lu-&gt;invp,
+<a name="line365">365: </a>           (pastix_float_t*)  lu-&gt;rhs,
+<a name="line366">366: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
+<a name="line367">367: </a>           (pastix_int_t*)    lu-&gt;iparm,
+<a name="line368">368: </a>           (double*)          lu-&gt;dparm);
+
+<a name="line370">370: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;prefix,<font color="#666666">"PaStiX Options"</font>,<font color="#666666">"<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>"</font>);
 
-<a name="line315">315: </a><font color="#B22222"> */</font>
-<a name="line318">318: </a><strong><font color="#4169E1"><a name="MatFactorNumeric_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatFactorNumeric_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> F,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,const <A href="../../../../../../docs/manualpages/Mat/MatFactorInfo.html#MatFactorInfo">MatFactorInfo</A> *info)</font></strong>
-<a name="line319">319: </a>{
-<a name="line320">320: </a>  Mat_Pastix    *lu =(Mat_Pastix*)(F)-&gt;spptr;
-<a name="line321">321: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>           *tseq;
-<a name="line322">322: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> 0;
-<a name="line323">323: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       icntl;
-<a name="line324">324: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       M=A-&gt;rmap-&gt;N;
-<a name="line325">325: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     valOnly,flg, isSym;
-<a name="line326">326: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            F_diag;
-<a name="line327">327: </a>  <A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A>             is_iden;
-<a name="line328">328: </a>  <A href="../../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>            b;
-<a name="line329">329: </a>  <A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A>             isrow;
-<a name="line330">330: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isSeqAIJ,isSeqSBAIJ;
-
-<a name="line333">333: </a>
-<a name="line334">334: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A,<A href="../../../../../../docs/manualpages/Mat/MATSEQAIJ.html#MATSEQAIJ">MATSEQAIJ</A>,&amp;isSeqAIJ);
-<a name="line335">335: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A,<A href="../../../../../../docs/manualpages/Mat/MATSEQSBAIJ.html#MATSEQSBAIJ">MATSEQSBAIJ</A>,&amp;isSeqSBAIJ);
-<a name="line336">336: </a>  <font color="#4169E1">if</font> (lu-&gt;matstruc == DIFFERENT_NONZERO_PATTERN){
-<a name="line337">337: </a>    (F)-&gt;ops-&gt;solve   = MatSolve_PaStiX;
-
-<a name="line339">339: </a>    <font color="#B22222">/* Initialize a PASTIX instance */</font>
-<a name="line340">340: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_dup.html#MPI_Comm_dup">MPI_Comm_dup</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;(lu-&gt;pastix_comm));
-<a name="line341">341: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(lu-&gt;pastix_comm, &amp;lu-&gt;commRank);
-<a name="line342">342: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(lu-&gt;pastix_comm, &amp;lu-&gt;commSize);
-
-<a name="line344">344: </a>    <font color="#B22222">/* Set pastix options */</font>
-<a name="line345">345: </a>    lu-&gt;iparm[IPARM_MODIFY_PARAMETER] = API_NO;
-<a name="line346">346: </a>    lu-&gt;iparm[IPARM_START_TASK]       = API_TASK_INIT;
-<a name="line347">347: </a>    lu-&gt;iparm[IPARM_END_TASK]         = API_TASK_INIT;
-<a name="line348">348: </a>    lu-&gt;rhsnbr = 1;
-
-<a name="line350">350: </a>    <font color="#B22222">/* Call to set default pastix options */</font>
-<a name="line351">351: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
-<a name="line352">352: </a>           (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
-<a name="line353">353: </a>           (pastix_int_t)     lu-&gt;n,
-<a name="line354">354: </a>           (pastix_int_t*)    lu-&gt;colptr,
-<a name="line355">355: </a>           (pastix_int_t*)    lu-&gt;row,
-<a name="line356">356: </a>           (pastix_float_t*)  lu-&gt;val,
-<a name="line357">357: </a>           (pastix_int_t*)    lu-&gt;perm,
-<a name="line358">358: </a>           (pastix_int_t*)    lu-&gt;invp,
-<a name="line359">359: </a>           (pastix_float_t*)  lu-&gt;rhs,
-<a name="line360">360: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
-<a name="line361">361: </a>           (pastix_int_t*)    lu-&gt;iparm,
-<a name="line362">362: </a>           (double*)          lu-&gt;dparm);
-
-<a name="line364">364: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;prefix,<font color="#666666">"PaStiX Options"</font>,<font color="#666666">"<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>"</font>);
-
-<a name="line366">366: </a>    icntl=-1;
-<a name="line367">367: </a>    lu-&gt;iparm[IPARM_VERBOSE] = API_VERBOSE_NOT;
-<a name="line368">368: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(<font color="#666666">"-mat_pastix_verbose"</font>,<font color="#666666">"iparm[IPARM_VERBOSE] : level of printing (0 to 2)"</font>,<font color="#666666">"None"</font>,lu-&gt;iparm[IPARM_VERBOSE],&amp;icntl,&amp;flg);
-<a name="line369">369: </a>    <font color="#4169E1">if</font> ((flg &amp;&amp; icntl &gt; 0) || PetscLogPrintInfo) {
-<a name="line370">370: </a>      lu-&gt;iparm[IPARM_VERBOSE] =  icntl;
-<a name="line371">371: </a>    }
 <a name="line372">372: </a>    icntl=-1;
-<a name="line373">373: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(<font color="#666666">"-mat_pastix_threadnbr"</font>,<font color="#666666">"iparm[IPARM_THREAD_NBR] : Number of thread by MPI node"</font>,<font color="#666666">"None"</font>,lu-&gt;iparm[IPARM_THREAD_NBR],&amp;icntl,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line374">374: </a>    <font color="#4169E1">if</font> ((flg &amp;&amp; icntl &gt; 0)) {
-<a name="line375">375: </a>      lu-&gt;iparm[IPARM_THREAD_NBR] = icntl;
-<a name="line376">376: </a>    }
-<a name="line377">377: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>();
-<a name="line378">378: </a>    valOnly = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line379">379: </a>  }  <font color="#4169E1">else</font> {
-<a name="line380">380: </a>    valOnly = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line381">381: </a>  }
-
-<a name="line383">383: </a>  lu-&gt;iparm[IPARM_MATRIX_VERIFICATION] = API_YES;
-
-<a name="line385">385: </a>  <font color="#B22222">/* convert mpi A to seq mat A */</font>
-<a name="line386">386: </a>  <A href="../../../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,M,0,1,&amp;isrow);
-<a name="line387">387: </a>  <A href="../../../../../../docs/manualpages/Mat/MatGetSubMatrices.html#MatGetSubMatrices">MatGetSubMatrices</A>(A,1,&amp;isrow,&amp;isrow,MAT_INITIAL_MATRIX,&amp;tseq);
-<a name="line388">388: </a>  <A href="../../../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(isrow);
-
-<a name="line390">390: </a>  MatConvertToCSC(*tseq,valOnly, &amp;lu-&gt;n, &amp;lu-&gt;colptr, &amp;lu-&gt;row, &amp;lu-&gt;val);
-<a name="line391">391: </a>  <A href="../../../../../../docs/manualpages/Mat/MatIsSymmetric.html#MatIsSymmetric">MatIsSymmetric</A>(*tseq,0.0,&amp;isSym);
-<a name="line392">392: </a>  <A href="../../../../../../docs/manualpages/Mat/MatDestroyMatrices.html#MatDestroyMatrices">MatDestroyMatrices</A>(1,&amp;tseq);
-
-<a name="line394">394: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((lu-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)   ,&amp;(lu-&gt;perm));
-<a name="line395">395: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((lu-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)   ,&amp;(lu-&gt;invp));
-
-<a name="line397">397: </a>  <font color="#4169E1">if</font> (isSym) {
-<a name="line398">398: </a>    <font color="#B22222">/* On symmetric matrix, LLT */</font>
-<a name="line399">399: </a>    lu-&gt;iparm[IPARM_SYM] = API_SYM_YES;
-<a name="line400">400: </a>    lu-&gt;iparm[IPARM_FACTORIZATION] = API_FACT_LDLT;
-<a name="line401">401: </a>  } <font color="#4169E1">else</font> {
-<a name="line402">402: </a>    <font color="#B22222">/* On unsymmetric matrix, LU */</font>
-<a name="line403">403: </a>    lu-&gt;iparm[IPARM_SYM] = API_SYM_NO;
-<a name="line404">404: </a>    lu-&gt;iparm[IPARM_FACTORIZATION] = API_FACT_LU;
-<a name="line405">405: </a>  }
-<a name="line406">406: </a>
-<a name="line407">407: </a>  <font color="#B22222">/*----------------*/</font>
-<a name="line408">408: </a>  <font color="#4169E1">if</font> (lu-&gt;matstruc == DIFFERENT_NONZERO_PATTERN){
-<a name="line409">409: </a>    <font color="#4169E1">if</font> (!(isSeqAIJ || isSeqSBAIJ)) {
-<a name="line410">410: </a>      <font color="#B22222">/* PaStiX only supports centralized rhs. Create scatter scat_rhs for repeated use in <A href="../../../../../../docs/manualpages/Mat/MatSolve.html#MatSolve">MatSolve</A>() */</font>
-<a name="line411">411: </a>        <A href="../../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,A-&gt;cmap-&gt;N,&amp;lu-&gt;b_seq);
-<a name="line412">412: </a>        <A href="../../../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,A-&gt;cmap-&gt;N,0,1,&amp;is_iden);
-<a name="line413">413: </a>        <A href="../../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;b);
-<a name="line414">414: </a>        <A href="../../../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(b,A-&gt;rmap-&gt;n,<A href="../../../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>);
-<a name="line415">415: </a>        <A href="../../../../../../docs/manualpages/Vec/VecSetFromOptions.html#VecSetFromOptions">VecSetFromOptions</A>(b);
-<a name="line416">416: </a>
-<a name="line417">417: </a>        <A href="../../../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(b,is_iden,lu-&gt;b_seq,is_iden,&amp;lu-&gt;scat_rhs);
-<a name="line418">418: </a>        <A href="../../../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(lu-&gt;b_seq,is_iden,b,is_iden,&amp;lu-&gt;scat_sol);
-<a name="line419">419: </a>        <A href="../../../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(is_iden);
-<a name="line420">420: </a>        <A href="../../../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(b);
-<a name="line421">421: </a>    }
-<a name="line422">422: </a>    lu-&gt;iparm[IPARM_START_TASK] = API_TASK_ORDERING;
-<a name="line423">423: </a>    lu-&gt;iparm[IPARM_END_TASK]   = API_TASK_NUMFACT;
-
-<a name="line425">425: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
-<a name="line426">426: </a>           (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
-<a name="line427">427: </a>           (pastix_int_t)     lu-&gt;n,
-<a name="line428">428: </a>           (pastix_int_t*)    lu-&gt;colptr,
-<a name="line429">429: </a>           (pastix_int_t*)    lu-&gt;row,
-<a name="line430">430: </a>           (pastix_float_t*)  lu-&gt;val,
-<a name="line431">431: </a>           (pastix_int_t*)    lu-&gt;perm,
-<a name="line432">432: </a>           (pastix_int_t*)    lu-&gt;invp,
-<a name="line433">433: </a>           (pastix_float_t*)  lu-&gt;rhs,
-<a name="line434">434: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
-<a name="line435">435: </a>           (pastix_int_t*)    lu-&gt;iparm,
-<a name="line436">436: </a>           (double*)          lu-&gt;dparm);
-<a name="line437">437: </a>    <font color="#4169E1">if</font> (lu-&gt;iparm[IPARM_ERROR_NUMBER] &lt; 0) {
-<a name="line438">438: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_LIB,<font color="#666666">"Error reported by PaStiX in analysis phase: iparm(IPARM_ERROR_NUMBER)=%d\n"</font>,lu-&gt;iparm[IPARM_ERROR_NUMBER]);
-<a name="line439">439: </a>    }
-<a name="line440">440: </a>  } <font color="#4169E1">else</font> {
-<a name="line441">441: </a>    lu-&gt;iparm[IPARM_START_TASK] = API_TASK_NUMFACT;
-<a name="line442">442: </a>    lu-&gt;iparm[IPARM_END_TASK]   = API_TASK_NUMFACT;
-<a name="line443">443: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
-<a name="line444">444: </a>           (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
-<a name="line445">445: </a>           (pastix_int_t)     lu-&gt;n,
-<a name="line446">446: </a>           (pastix_int_t*)    lu-&gt;colptr,
-<a name="line447">447: </a>           (pastix_int_t*)    lu-&gt;row,
-<a name="line448">448: </a>           (pastix_float_t*)  lu-&gt;val,
-<a name="line449">449: </a>           (pastix_int_t*)    lu-&gt;perm,
-<a name="line450">450: </a>           (pastix_int_t*)    lu-&gt;invp,
-<a name="line451">451: </a>           (pastix_float_t*)  lu-&gt;rhs,
-<a name="line452">452: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
-<a name="line453">453: </a>           (pastix_int_t*)    lu-&gt;iparm,
-<a name="line454">454: </a>           (double*)          lu-&gt;dparm);
-
-<a name="line456">456: </a>    <font color="#4169E1">if</font> (lu-&gt;iparm[IPARM_ERROR_NUMBER] &lt; 0) {
-<a name="line457">457: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_LIB,<font color="#666666">"Error reported by PaStiX in analysis phase: iparm(IPARM_ERROR_NUMBER)=%d\n"</font>,lu-&gt;iparm[IPARM_ERROR_NUMBER]);
-<a name="line458">458: </a>    }
-<a name="line459">459: </a>  }
-
-<a name="line461">461: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize &gt; 1){
-<a name="line462">462: </a>    <font color="#4169E1">if</font> ((F)-&gt;factor == MAT_FACTOR_LU){
-<a name="line463">463: </a>      F_diag = ((Mat_MPIAIJ *)(F)-&gt;data)-&gt;A;
-<a name="line464">464: </a>    } <font color="#4169E1">else</font> {
-<a name="line465">465: </a>      F_diag = ((Mat_MPISBAIJ *)(F)-&gt;data)-&gt;A;
-<a name="line466">466: </a>    }
-<a name="line467">467: </a>    F_diag-&gt;assembled = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line468">468: </a>  }
-<a name="line469">469: </a>  (F)-&gt;assembled     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line470">470: </a>  lu-&gt;matstruc       = SAME_NONZERO_PATTERN;
-<a name="line471">471: </a>  lu-&gt;CleanUpPastix  = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line472">472: </a>  <font color="#4169E1">return</font>(0);
-<a name="line473">473: </a>}
-
-<a name="line475">475: </a><font color="#B22222">/* Note the Petsc r and c permutations are ignored */</font>
-<a name="line478">478: </a><strong><font color="#4169E1"><a name="MatLUFactorSymbolic_AIJPASTIX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatLUFactorSymbolic_AIJPASTIX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> F,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A> r,<A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A> c,const <A href="../../../../../../docs/manualpages/Mat/MatFactorInfo.html#MatFactorInfo">MatFactorInfo</A> *info)</font></strong>
-<a name="line479">479: </a>{
-<a name="line480">480: </a>  Mat_Pastix      *lu = (Mat_Pastix*)F-&gt;spptr;
-
-<a name="line483">483: </a>  lu-&gt;iparm[IPARM_FACTORIZATION] = API_FACT_LU;
-<a name="line484">484: </a>  lu-&gt;iparm[IPARM_SYM]           = API_SYM_YES;
-<a name="line485">485: </a>  lu-&gt;matstruc                   = DIFFERENT_NONZERO_PATTERN;
-<a name="line486">486: </a>  F-&gt;ops-&gt;lufactornumeric        = MatFactorNumeric_PaStiX;
-<a name="line487">487: </a>  <font color="#4169E1">return</font>(0);
-<a name="line488">488: </a>}
-
-
-<a name="line491">491: </a><font color="#B22222">/* Note the Petsc r permutation is ignored */</font>
-<a name="line494">494: </a><strong><font color="#4169E1"><a name="MatCholeskyFactorSymbolic_SBAIJPASTIX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatCholeskyFactorSymbolic_SBAIJPASTIX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> F,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A> r,const <A href="../../../../../../docs/manualpages/Mat/MatFactorInfo.html#MatFactorInfo">MatFactorInfo</A> *info)</font></strong>
-<a name="line495">495: </a>{
-<a name="line496">496: </a>  Mat_Pastix      *lu = (Mat_Pastix*)(F)-&gt;spptr;
-
-<a name="line499">499: </a>  lu-&gt;iparm[IPARM_FACTORIZATION]  = API_FACT_LLT;
-<a name="line500">500: </a>  lu-&gt;iparm[IPARM_SYM]            = API_SYM_NO;
-<a name="line501">501: </a>  lu-&gt;matstruc                    = DIFFERENT_NONZERO_PATTERN;
-<a name="line502">502: </a>  (F)-&gt;ops-&gt;choleskyfactornumeric = MatFactorNumeric_PaStiX;
-<a name="line503">503: </a>  <font color="#4169E1">return</font>(0);
-<a name="line504">504: </a>}
-
-<a name="line508">508: </a><strong><font color="#4169E1"><a name="MatView_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatView_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line509">509: </a>{
-<a name="line510">510: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line511">511: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
-<a name="line512">512: </a>  <A href="../../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
-
-<a name="line515">515: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
-<a name="line516">516: </a>  <font color="#4169E1">if</font> (iascii) {
-<a name="line517">517: </a>    PetscViewerGetFormat(viewer,&amp;format);
-<a name="line518">518: </a>    <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_INFO){
-<a name="line519">519: </a>      Mat_Pastix      *lu=(Mat_Pastix*)A-&gt;spptr;
-
-<a name="line521">521: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"PaStiX run parameters:\n"</font>);
-<a name="line522">522: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Matrix type :                      %s \n"</font>,((lu-&gt;iparm[IPARM_SYM] == API_SYM_YES)?<font color="#666666">"Symmetric"</font>:<font color="#666666">"Unsymmetric"</font>));
-<a name="line523">523: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Level of printing (0,1,2):         %d \n"</font>,lu-&gt;iparm[IPARM_VERBOSE]);
-<a name="line524">524: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Number of refinements iterations : %d \n"</font>,lu-&gt;iparm[IPARM_NBITER]);
-<a name="line525">525: </a>      <A href="../../../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,<font color="#666666">"  Error :                        %g \n"</font>,lu-&gt;dparm[DPARM_RELATIVE_ERROR]);
-<a name="line526">526: </a>    }
-<a name="line527">527: </a>  }
-<a name="line528">528: </a>  <font color="#4169E1">return</font>(0);
-<a name="line529">529: </a>}
-
-
-<a name="line532">532: </a><font color="#B22222">/*MC</font>
-<a name="line533">533: </a><font color="#B22222">     <A href="../../../../../../docs/manualpages/Mat/MAT_SOLVER_PASTIX.html#MAT_SOLVER_PASTIX">MAT_SOLVER_PASTIX</A>  - A solver package providing direct solvers (LU) for distributed</font>
-<a name="line534">534: </a><font color="#B22222">  and sequential matrices via the external package PaStiX.</font>
-
-<a name="line536">536: </a><font color="#B22222">  Use config/configure.py --download-pastix to have PETSc installed with PaStiX</font>
-
-<a name="line538">538: </a><font color="#B22222">  Options Database Keys:</font>
-<a name="line539">539: </a><font color="#B22222">+ -mat_pastix_verbose   &lt;0,1,2&gt;   - print level</font>
-<a name="line540">540: </a><font color="#B22222">- -mat_pastix_threadnbr &lt;integer&gt; - Set the thread number by MPI task.</font>
-
-<a name="line542">542: </a><font color="#B22222">  Level: beginner</font>
-
-<a name="line544">544: </a><font color="#B22222">.seealso: <A href="../../../../../../docs/manualpages/PC/PCFactorSetMatSolverPackage.html#PCFactorSetMatSolverPackage">PCFactorSetMatSolverPackage</A>(), <A href="../../../../../../docs/manualpages/Mat/MatSolverPackage.html#MatSolverPackage">MatSolverPackage</A></font>
-
-<a name="line546">546: </a><font color="#B22222">M*/</font>
-
-
-<a name="line551">551: </a><strong><font color="#4169E1"><a name="MatGetInfo_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetInfo_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatInfoType.html#MatInfoType">MatInfoType</A> flag,<A href="../../../../../../docs/manualpages/Mat/MatInfo.html#MatInfo">MatInfo</A> *info)</font></strong>
-<a name="line552">552: </a>{
-<a name="line553">553: </a>    Mat_Pastix  *lu =(Mat_Pastix*)A-&gt;spptr;
-
-<a name="line556">556: </a>    info-&gt;block_size        = 1.0;
-<a name="line557">557: </a>    info-&gt;nz_allocated      = lu-&gt;iparm[IPARM_NNZEROS];
-<a name="line558">558: </a>    info-&gt;nz_used           = lu-&gt;iparm[IPARM_NNZEROS];
-<a name="line559">559: </a>    info-&gt;nz_unneeded       = 0.0;
-<a name="line560">560: </a>    info-&gt;assemblies        = 0.0;
-<a name="line561">561: </a>    info-&gt;mallocs           = 0.0;
-<a name="line562">562: </a>    info-&gt;memory            = 0.0;
-<a name="line563">563: </a>    info-&gt;fill_ratio_given  = 0;
-<a name="line564">564: </a>    info-&gt;fill_ratio_needed = 0;
-<a name="line565">565: </a>    info-&gt;factor_mallocs    = 0;
-<a name="line566">566: </a>    <font color="#4169E1">return</font>(0);
-<a name="line567">567: </a>}
-
-<a name="line572">572: </a><strong><font color="#4169E1"><a name="MatFactorGetSolverPackage_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatFactorGetSolverPackage_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,const <A href="../../../../../../docs/manualpages/Mat/MatSolverPackage.html#MatSolverPackage">MatSolverPackage</A> *type)</font></strong>
-<a name="line573">573: </a>{
-<a name="line575">575: </a>  *type = <A href="../../../../../../docs/manualpages/Mat/MAT_SOLVER_PASTIX.html#MAT_SOLVER_PASTIX">MAT_SOLVER_PASTIX</A>;
-<a name="line576">576: </a>  <font color="#4169E1">return</font>(0);
-<a name="line577">577: </a>}
-
-<a name="line581">581: </a><font color="#B22222">/*</font>
-<a name="line582">582: </a><font color="#B22222">    The seq and mpi versions of this function are the same </font>
-<a name="line583">583: </a><font color="#B22222">*/</font>
-<a name="line586">586: </a><strong><font color="#4169E1"><a name="MatGetFactor_seqaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_seqaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
-<a name="line587">587: </a>{
-<a name="line588">588: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
-<a name="line590">590: </a>  Mat_Pastix    *pastix;
-
-<a name="line593">593: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_LU) {
-<a name="line594">594: </a>    <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc AIJ matrices with PaStiX Cholesky, use SBAIJ matrix"</font>);
-<a name="line595">595: </a>  }
-<a name="line596">596: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
-<a name="line597">597: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
-<a name="line598">598: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
-<a name="line599">599: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
-<a name="line600">600: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqAIJSetPreallocation.html#MatSeqAIJSetPreallocation">MatSeqAIJSetPreallocation</A>(B,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-
-<a name="line602">602: </a>  B-&gt;ops-&gt;lufactorsymbolic = MatLUFactorSymbolic_AIJPASTIX;
-<a name="line603">603: </a>  B-&gt;ops-&gt;view             = MatView_PaStiX;
-<a name="line604">604: </a>  B-&gt;ops-&gt;getinfo          = MatGetInfo_PaStiX;
-<a name="line605">605: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>, MatFactorGetSolverPackage_pastix);
-<a name="line606">606: </a>  B-&gt;factor                = MAT_FACTOR_LU;
-
-<a name="line608">608: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
-<a name="line609">609: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line610">610: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line611">611: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line612">612: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line613">613: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
-<a name="line614">614: </a>  B-&gt;ops-&gt;destroy                   = MatDestroy_Pastix;
-<a name="line615">615: </a>  B-&gt;spptr                          = (void*)pastix;
-
-<a name="line617">617: </a>  *F = B;
-<a name="line618">618: </a>  <font color="#4169E1">return</font>(0);
-<a name="line619">619: </a>}
-
-
-<a name="line626">626: </a><strong><font color="#4169E1"><a name="MatGetFactor_mpiaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_mpiaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
-<a name="line627">627: </a>{
-<a name="line628">628: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
-<a name="line630">630: </a>  Mat_Pastix    *pastix;
-
-<a name="line633">633: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_LU) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc AIJ matrices with PaStiX Cholesky, use SBAIJ matrix"</font>);
-<a name="line634">634: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
-<a name="line635">635: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
-<a name="line636">636: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
-<a name="line637">637: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
-<a name="line638">638: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqAIJSetPreallocation.html#MatSeqAIJSetPreallocation">MatSeqAIJSetPreallocation</A>(B,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line639">639: </a>  <A href="../../../../../../docs/manualpages/Mat/MatMPIAIJSetPreallocation.html#MatMPIAIJSetPreallocation">MatMPIAIJSetPreallocation</A>(B,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-
-<a name="line641">641: </a>  B-&gt;ops-&gt;lufactorsymbolic = MatLUFactorSymbolic_AIJPASTIX;
-<a name="line642">642: </a>  B-&gt;ops-&gt;view             = MatView_PaStiX;
-<a name="line643">643: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>,MatFactorGetSolverPackage_pastix);
-<a name="line644">644: </a>  B-&gt;factor                = MAT_FACTOR_LU;
-
-<a name="line646">646: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
-<a name="line647">647: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line648">648: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line649">649: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line650">650: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line651">651: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
-<a name="line652">652: </a>  B-&gt;ops-&gt;destroy                  = MatDestroy_Pastix;
-<a name="line653">653: </a>  B-&gt;spptr                         = (void*)pastix;
-
-<a name="line655">655: </a>  *F = B;
-<a name="line656">656: </a>  <font color="#4169E1">return</font>(0);
-<a name="line657">657: </a>}
-
-<a name="line663">663: </a><strong><font color="#4169E1"><a name="MatGetFactor_seqsbaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_seqsbaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
-<a name="line664">664: </a>{
-<a name="line665">665: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
-<a name="line667">667: </a>  Mat_Pastix    *pastix;
-
-<a name="line670">670: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_CHOLESKY) {
-<a name="line671">671: </a>    <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc SBAIJ matrices with PaStiX LU, use AIJ matrix"</font>);
-<a name="line672">672: </a>  }
-<a name="line673">673: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
-<a name="line674">674: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
-<a name="line675">675: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
-<a name="line676">676: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
-<a name="line677">677: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqSBAIJSetPreallocation.html#MatSeqSBAIJSetPreallocation">MatSeqSBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line678">678: </a>  <A href="../../../../../../docs/manualpages/Mat/MatMPISBAIJSetPreallocation.html#MatMPISBAIJSetPreallocation">MatMPISBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-
-<a name="line680">680: </a>  B-&gt;ops-&gt;choleskyfactorsymbolic = MatCholeskyFactorSymbolic_SBAIJPASTIX;
-<a name="line681">681: </a>  B-&gt;ops-&gt;view                   = MatView_PaStiX;
-<a name="line682">682: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>,MatFactorGetSolverPackage_pastix);
-
-<a name="line684">684: </a>  B-&gt;factor                      = MAT_FACTOR_CHOLESKY;
-
-<a name="line686">686: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
-<a name="line687">687: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line688">688: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line689">689: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line690">690: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line691">691: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
-<a name="line692">692: </a>  B-&gt;ops-&gt;destroy                  = MatDestroy_Pastix;
-<a name="line693">693: </a>  B-&gt;spptr                         = (void*)pastix;
-
-<a name="line695">695: </a>  *F = B;
-<a name="line696">696: </a>  <font color="#4169E1">return</font>(0);
-<a name="line697">697: </a>}
-
-<a name="line703">703: </a><strong><font color="#4169E1"><a name="MatGetFactor_mpisbaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_mpisbaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
-<a name="line704">704: </a>{
-<a name="line705">705: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
-<a name="line707">707: </a>  Mat_Pastix    *pastix;
-<a name="line708">708: </a>
-<a name="line710">710: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_CHOLESKY) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc SBAIJ matrices with PaStiX LU, use AIJ matrix"</font>);
-
-<a name="line712">712: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
-<a name="line713">713: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
-<a name="line714">714: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
-<a name="line715">715: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
-<a name="line716">716: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqSBAIJSetPreallocation.html#MatSeqSBAIJSetPreallocation">MatSeqSBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line717">717: </a>  <A href="../../../../../../docs/manualpages/Mat/MatMPISBAIJSetPreallocation.html#MatMPISBAIJSetPreallocation">MatMPISBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-
-<a name="line719">719: </a>  B-&gt;ops-&gt;choleskyfactorsymbolic = MatCholeskyFactorSymbolic_SBAIJPASTIX;
-<a name="line720">720: </a>  B-&gt;ops-&gt;view                   = MatView_PaStiX;
-<a name="line721">721: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>,MatFactorGetSolverPackage_pastix);
-<a name="line722">722: </a>  B-&gt;factor                      = MAT_FACTOR_CHOLESKY;
-
-<a name="line724">724: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
-<a name="line725">725: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line726">726: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line727">727: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line728">728: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line729">729: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
-<a name="line730">730: </a>  B-&gt;ops-&gt;destroy                   = MatDestroy_Pastix;
-<a name="line731">731: </a>  B-&gt;spptr                          = (void*)pastix;
-
-<a name="line733">733: </a>  *F = B;
-<a name="line734">734: </a>  <font color="#4169E1">return</font>(0);
-<a name="line735">735: </a>}
+<a name="line373">373: </a>    lu-&gt;iparm[IPARM_VERBOSE] = API_VERBOSE_NOT;
+<a name="line374">374: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(<font color="#666666">"-mat_pastix_verbose"</font>,<font color="#666666">"iparm[IPARM_VERBOSE] : level of printing (0 to 2)"</font>,<font color="#666666">"None"</font>,lu-&gt;iparm[IPARM_VERBOSE],&amp;icntl,&amp;flg);
+<a name="line375">375: </a>    <font color="#4169E1">if</font> ((flg &amp;&amp; icntl &gt; 0) || PetscLogPrintInfo) {
+<a name="line376">376: </a>      lu-&gt;iparm[IPARM_VERBOSE] =  icntl;
+<a name="line377">377: </a>    }
+<a name="line378">378: </a>    icntl=-1;
+<a name="line379">379: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(<font color="#666666">"-mat_pastix_threadnbr"</font>,<font color="#666666">"iparm[IPARM_THREAD_NBR] : Number of thread by MPI node"</font>,<font color="#666666">"None"</font>,lu-&gt;iparm[IPARM_THREAD_NBR],&amp;icntl,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line380">380: </a>    <font color="#4169E1">if</font> ((flg &amp;&amp; icntl &gt; 0)) {
+<a name="line381">381: </a>      lu-&gt;iparm[IPARM_THREAD_NBR] = icntl;
+<a name="line382">382: </a>    }
+<a name="line383">383: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>();
+<a name="line384">384: </a>    valOnly = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line385">385: </a>  }  <font color="#4169E1">else</font> {
+<a name="line386">386: </a>    <font color="#4169E1">if</font> (isSeqAIJ || isMPIAIJ)  {
+<a name="line387">387: </a>      <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;colptr);
+<a name="line388">388: </a>      <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;row);
+<a name="line389">389: </a>      <A href="../../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(lu-&gt;val);
+<a name="line390">390: </a>      valOnly = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line391">391: </a>    } <font color="#4169E1">else</font> valOnly = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line392">392: </a>  }
+
+<a name="line394">394: </a>  lu-&gt;iparm[IPARM_MATRIX_VERIFICATION] = API_YES;
+
+<a name="line396">396: </a>  <font color="#B22222">/* convert mpi A to seq mat A */</font>
+<a name="line397">397: </a>  <A href="../../../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,M,0,1,&amp;isrow);
+<a name="line398">398: </a>  <A href="../../../../../../docs/manualpages/Mat/MatGetSubMatrices.html#MatGetSubMatrices">MatGetSubMatrices</A>(A,1,&amp;isrow,&amp;isrow,MAT_INITIAL_MATRIX,&amp;tseq);
+<a name="line399">399: </a>  <A href="../../../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(isrow);
+
+<a name="line401">401: </a>  MatConvertToCSC(*tseq,valOnly, &amp;lu-&gt;n, &amp;lu-&gt;colptr, &amp;lu-&gt;row, &amp;lu-&gt;val);
+<a name="line402">402: </a>  <A href="../../../../../../docs/manualpages/Mat/MatIsSymmetric.html#MatIsSymmetric">MatIsSymmetric</A>(*tseq,0.0,&amp;isSym);
+<a name="line403">403: </a>  <A href="../../../../../../docs/manualpages/Mat/MatDestroyMatrices.html#MatDestroyMatrices">MatDestroyMatrices</A>(1,&amp;tseq);
+
+<a name="line405">405: </a>  <font color="#4169E1">if</font> (!lu-&gt;perm) {
+<a name="line406">406: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((lu-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)   ,&amp;(lu-&gt;perm));
+<a name="line407">407: </a>    <A href="../../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((lu-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)   ,&amp;(lu-&gt;invp));
+<a name="line408">408: </a>  }
+
+<a name="line410">410: </a>  <font color="#4169E1">if</font> (isSym) {
+<a name="line411">411: </a>    <font color="#B22222">/* On symmetric matrix, LLT */</font>
+<a name="line412">412: </a>    lu-&gt;iparm[IPARM_SYM] = API_SYM_YES;
+<a name="line413">413: </a>    lu-&gt;iparm[IPARM_FACTORIZATION] = API_FACT_LDLT;
+<a name="line414">414: </a>  } <font color="#4169E1">else</font> {
+<a name="line415">415: </a>    <font color="#B22222">/* On unsymmetric matrix, LU */</font>
+<a name="line416">416: </a>    lu-&gt;iparm[IPARM_SYM] = API_SYM_NO;
+<a name="line417">417: </a>    lu-&gt;iparm[IPARM_FACTORIZATION] = API_FACT_LU;
+<a name="line418">418: </a>  }
+<a name="line419">419: </a>
+<a name="line420">420: </a>  <font color="#B22222">/*----------------*/</font>
+<a name="line421">421: </a>  <font color="#4169E1">if</font> (lu-&gt;matstruc == DIFFERENT_NONZERO_PATTERN){
+<a name="line422">422: </a>    <font color="#4169E1">if</font> (!(isSeqAIJ || isSeqSBAIJ)) {
+<a name="line423">423: </a>      <font color="#B22222">/* PaStiX only supports centralized rhs. Create scatter scat_rhs for repeated use in <A href="../../../../../../docs/manualpages/Mat/MatSolve.html#MatSolve">MatSolve</A>() */</font>
+<a name="line424">424: </a>        <A href="../../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,A-&gt;cmap-&gt;N,&amp;lu-&gt;b_seq);
+<a name="line425">425: </a>        <A href="../../../../../../docs/manualpages/IS/ISCreateStride.html#ISCreateStride">ISCreateStride</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,A-&gt;cmap-&gt;N,0,1,&amp;is_iden);
+<a name="line426">426: </a>        <A href="../../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;b);
+<a name="line427">427: </a>        <A href="../../../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(b,A-&gt;rmap-&gt;n,<A href="../../../../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>);
+<a name="line428">428: </a>        <A href="../../../../../../docs/manualpages/Vec/VecSetFromOptions.html#VecSetFromOptions">VecSetFromOptions</A>(b);
+<a name="line429">429: </a>
+<a name="line430">430: </a>        <A href="../../../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(b,is_iden,lu-&gt;b_seq,is_iden,&amp;lu-&gt;scat_rhs);
+<a name="line431">431: </a>        <A href="../../../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(lu-&gt;b_seq,is_iden,b,is_iden,&amp;lu-&gt;scat_sol);
+<a name="line432">432: </a>        <A href="../../../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(is_iden);
+<a name="line433">433: </a>        <A href="../../../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(b);
+<a name="line434">434: </a>    }
+<a name="line435">435: </a>    lu-&gt;iparm[IPARM_START_TASK] = API_TASK_ORDERING;
+<a name="line436">436: </a>    lu-&gt;iparm[IPARM_END_TASK]   = API_TASK_NUMFACT;
+
+<a name="line438">438: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
+<a name="line439">439: </a>           (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
+<a name="line440">440: </a>           (pastix_int_t)     lu-&gt;n,
+<a name="line441">441: </a>           (pastix_int_t*)    lu-&gt;colptr,
+<a name="line442">442: </a>           (pastix_int_t*)    lu-&gt;row,
+<a name="line443">443: </a>           (pastix_float_t*)  lu-&gt;val,
+<a name="line444">444: </a>           (pastix_int_t*)    lu-&gt;perm,
+<a name="line445">445: </a>           (pastix_int_t*)    lu-&gt;invp,
+<a name="line446">446: </a>           (pastix_float_t*)  lu-&gt;rhs,
+<a name="line447">447: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
+<a name="line448">448: </a>           (pastix_int_t*)    lu-&gt;iparm,
+<a name="line449">449: </a>           (double*)          lu-&gt;dparm);
+<a name="line450">450: </a>    <font color="#4169E1">if</font> (lu-&gt;iparm[IPARM_ERROR_NUMBER] &lt; 0) {
+<a name="line451">451: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_LIB,<font color="#666666">"Error reported by PaStiX in analysis phase: iparm(IPARM_ERROR_NUMBER)=%d\n"</font>,lu-&gt;iparm[IPARM_ERROR_NUMBER]);
+<a name="line452">452: </a>    }
+<a name="line453">453: </a>  } <font color="#4169E1">else</font> {
+<a name="line454">454: </a>    lu-&gt;iparm[IPARM_START_TASK] = API_TASK_NUMFACT;
+<a name="line455">455: </a>    lu-&gt;iparm[IPARM_END_TASK]   = API_TASK_NUMFACT;
+<a name="line456">456: </a>    pastix((pastix_data_t **)&amp;(lu-&gt;pastix_data),
+<a name="line457">457: </a>           (<A href="../../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>)         lu-&gt;pastix_comm,
+<a name="line458">458: </a>           (pastix_int_t)     lu-&gt;n,
+<a name="line459">459: </a>           (pastix_int_t*)    lu-&gt;colptr,
+<a name="line460">460: </a>           (pastix_int_t*)    lu-&gt;row,
+<a name="line461">461: </a>           (pastix_float_t*)  lu-&gt;val,
+<a name="line462">462: </a>           (pastix_int_t*)    lu-&gt;perm,
+<a name="line463">463: </a>           (pastix_int_t*)    lu-&gt;invp,
+<a name="line464">464: </a>           (pastix_float_t*)  lu-&gt;rhs,
+<a name="line465">465: </a>           (pastix_int_t)     lu-&gt;rhsnbr,
+<a name="line466">466: </a>           (pastix_int_t*)    lu-&gt;iparm,
+<a name="line467">467: </a>           (double*)          lu-&gt;dparm);
+
+<a name="line469">469: </a>    <font color="#4169E1">if</font> (lu-&gt;iparm[IPARM_ERROR_NUMBER] &lt; 0) {
+<a name="line470">470: </a>      <A href="../../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_LIB,<font color="#666666">"Error reported by PaStiX in analysis phase: iparm(IPARM_ERROR_NUMBER)=%d\n"</font>,lu-&gt;iparm[IPARM_ERROR_NUMBER]);
+<a name="line471">471: </a>    }
+<a name="line472">472: </a>  }
+
+<a name="line474">474: </a>  <font color="#4169E1">if</font> (lu-&gt;commSize &gt; 1){
+<a name="line475">475: </a>    <font color="#4169E1">if</font> ((F)-&gt;factor == MAT_FACTOR_LU){
+<a name="line476">476: </a>      F_diag = ((Mat_MPIAIJ *)(F)-&gt;data)-&gt;A;
+<a name="line477">477: </a>    } <font color="#4169E1">else</font> {
+<a name="line478">478: </a>      F_diag = ((Mat_MPISBAIJ *)(F)-&gt;data)-&gt;A;
+<a name="line479">479: </a>    }
+<a name="line480">480: </a>    F_diag-&gt;assembled = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line481">481: </a>  }
+<a name="line482">482: </a>  (F)-&gt;assembled     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line483">483: </a>  lu-&gt;matstruc       = SAME_NONZERO_PATTERN;
+<a name="line484">484: </a>  lu-&gt;CleanUpPastix  = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line485">485: </a>  <font color="#4169E1">return</font>(0);
+<a name="line486">486: </a>}
+
+<a name="line488">488: </a><font color="#B22222">/* Note the Petsc r and c permutations are ignored */</font>
+<a name="line491">491: </a><strong><font color="#4169E1"><a name="MatLUFactorSymbolic_AIJPASTIX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatLUFactorSymbolic_AIJPASTIX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> F,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A> r,<A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A> c,const <A href="../../../../../../docs/manualpages/Mat/MatFactorInfo.html#MatFactorInfo">MatFactorInfo</A> *info)</font></strong>
+<a name="line492">492: </a>{
+<a name="line493">493: </a>  Mat_Pastix      *lu = (Mat_Pastix*)F-&gt;spptr;
+
+<a name="line496">496: </a>  lu-&gt;iparm[IPARM_FACTORIZATION] = API_FACT_LU;
+<a name="line497">497: </a>  lu-&gt;iparm[IPARM_SYM]           = API_SYM_YES;
+<a name="line498">498: </a>  lu-&gt;matstruc                   = DIFFERENT_NONZERO_PATTERN;
+<a name="line499">499: </a>  F-&gt;ops-&gt;lufactornumeric        = MatFactorNumeric_PaStiX;
+<a name="line500">500: </a>  <font color="#4169E1">return</font>(0);
+<a name="line501">501: </a>}
+
+
+<a name="line504">504: </a><font color="#B22222">/* Note the Petsc r permutation is ignored */</font>
+<a name="line507">507: </a><strong><font color="#4169E1"><a name="MatCholeskyFactorSymbolic_SBAIJPASTIX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatCholeskyFactorSymbolic_SBAIJPASTIX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> F,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/IS/IS.html#IS">IS</A> r,const <A href="../../../../../../docs/manualpages/Mat/MatFactorInfo.html#MatFactorInfo">MatFactorInfo</A> *info)</font></strong>
+<a name="line508">508: </a>{
+<a name="line509">509: </a>  Mat_Pastix      *lu = (Mat_Pastix*)(F)-&gt;spptr;
+
+<a name="line512">512: </a>  lu-&gt;iparm[IPARM_FACTORIZATION]  = API_FACT_LLT;
+<a name="line513">513: </a>  lu-&gt;iparm[IPARM_SYM]            = API_SYM_NO;
+<a name="line514">514: </a>  lu-&gt;matstruc                    = DIFFERENT_NONZERO_PATTERN;
+<a name="line515">515: </a>  (F)-&gt;ops-&gt;choleskyfactornumeric = MatFactorNumeric_PaStiX;
+<a name="line516">516: </a>  <font color="#4169E1">return</font>(0);
+<a name="line517">517: </a>}
+
+<a name="line521">521: </a><strong><font color="#4169E1"><a name="MatView_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatView_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line522">522: </a>{
+<a name="line523">523: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line524">524: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
+<a name="line525">525: </a>  <A href="../../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
+
+<a name="line528">528: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
+<a name="line529">529: </a>  <font color="#4169E1">if</font> (iascii) {
+<a name="line530">530: </a>    PetscViewerGetFormat(viewer,&amp;format);
+<a name="line531">531: </a>    <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_INFO){
+<a name="line532">532: </a>      Mat_Pastix      *lu=(Mat_Pastix*)A-&gt;spptr;
+
+<a name="line534">534: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"PaStiX run parameters:\n"</font>);
+<a name="line535">535: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Matrix type :                      %s \n"</font>,((lu-&gt;iparm[IPARM_SYM] == API_SYM_YES)?<font color="#666666">"Symmetric"</font>:<font color="#666666">"Unsymmetric"</font>));
+<a name="line536">536: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Level of printing (0,1,2):         %d \n"</font>,lu-&gt;iparm[IPARM_VERBOSE]);
+<a name="line537">537: </a>      <A href="../../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Number of refinements iterations : %d \n"</font>,lu-&gt;iparm[IPARM_NBITER]);
+<a name="line538">538: </a>      <A href="../../../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,<font color="#666666">"  Error :                        %g \n"</font>,lu-&gt;dparm[DPARM_RELATIVE_ERROR]);
+<a name="line539">539: </a>    }
+<a name="line540">540: </a>  }
+<a name="line541">541: </a>  <font color="#4169E1">return</font>(0);
+<a name="line542">542: </a>}
+
+
+<a name="line545">545: </a><font color="#B22222">/*MC</font>
+<a name="line546">546: </a><font color="#B22222">     <A href="../../../../../../docs/manualpages/Mat/MAT_SOLVER_PASTIX.html#MAT_SOLVER_PASTIX">MAT_SOLVER_PASTIX</A>  - A solver package providing direct solvers (LU) for distributed</font>
+<a name="line547">547: </a><font color="#B22222">  and sequential matrices via the external package PaStiX.</font>
+
+<a name="line549">549: </a><font color="#B22222">  Use config/configure.py --download-pastix to have PETSc installed with PaStiX</font>
+
+<a name="line551">551: </a><font color="#B22222">  Options Database Keys:</font>
+<a name="line552">552: </a><font color="#B22222">+ -mat_pastix_verbose   &lt;0,1,2&gt;   - print level</font>
+<a name="line553">553: </a><font color="#B22222">- -mat_pastix_threadnbr &lt;integer&gt; - Set the thread number by MPI task.</font>
+
+<a name="line555">555: </a><font color="#B22222">  Level: beginner</font>
+
+<a name="line557">557: </a><font color="#B22222">.seealso: <A href="../../../../../../docs/manualpages/PC/PCFactorSetMatSolverPackage.html#PCFactorSetMatSolverPackage">PCFactorSetMatSolverPackage</A>(), <A href="../../../../../../docs/manualpages/Mat/MatSolverPackage.html#MatSolverPackage">MatSolverPackage</A></font>
+
+<a name="line559">559: </a><font color="#B22222">M*/</font>
+
+
+<a name="line564">564: </a><strong><font color="#4169E1"><a name="MatGetInfo_PaStiX"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetInfo_PaStiX(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatInfoType.html#MatInfoType">MatInfoType</A> flag,<A href="../../../../../../docs/manualpages/Mat/MatInfo.html#MatInfo">MatInfo</A> *info)</font></strong>
+<a name="line565">565: </a>{
+<a name="line566">566: </a>    Mat_Pastix  *lu =(Mat_Pastix*)A-&gt;spptr;
+
+<a name="line569">569: </a>    info-&gt;block_size        = 1.0;
+<a name="line570">570: </a>    info-&gt;nz_allocated      = lu-&gt;iparm[IPARM_NNZEROS];
+<a name="line571">571: </a>    info-&gt;nz_used           = lu-&gt;iparm[IPARM_NNZEROS];
+<a name="line572">572: </a>    info-&gt;nz_unneeded       = 0.0;
+<a name="line573">573: </a>    info-&gt;assemblies        = 0.0;
+<a name="line574">574: </a>    info-&gt;mallocs           = 0.0;
+<a name="line575">575: </a>    info-&gt;memory            = 0.0;
+<a name="line576">576: </a>    info-&gt;fill_ratio_given  = 0;
+<a name="line577">577: </a>    info-&gt;fill_ratio_needed = 0;
+<a name="line578">578: </a>    info-&gt;factor_mallocs    = 0;
+<a name="line579">579: </a>    <font color="#4169E1">return</font>(0);
+<a name="line580">580: </a>}
+
+<a name="line585">585: </a><strong><font color="#4169E1"><a name="MatFactorGetSolverPackage_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatFactorGetSolverPackage_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,const <A href="../../../../../../docs/manualpages/Mat/MatSolverPackage.html#MatSolverPackage">MatSolverPackage</A> *type)</font></strong>
+<a name="line586">586: </a>{
+<a name="line588">588: </a>  *type = <A href="../../../../../../docs/manualpages/Mat/MAT_SOLVER_PASTIX.html#MAT_SOLVER_PASTIX">MAT_SOLVER_PASTIX</A>;
+<a name="line589">589: </a>  <font color="#4169E1">return</font>(0);
+<a name="line590">590: </a>}
+
+<a name="line594">594: </a><font color="#B22222">/*</font>
+<a name="line595">595: </a><font color="#B22222">    The seq and mpi versions of this function are the same </font>
+<a name="line596">596: </a><font color="#B22222">*/</font>
+<a name="line599">599: </a><strong><font color="#4169E1"><a name="MatGetFactor_seqaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_seqaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
+<a name="line600">600: </a>{
+<a name="line601">601: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
+<a name="line603">603: </a>  Mat_Pastix    *pastix;
+
+<a name="line606">606: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_LU) {
+<a name="line607">607: </a>    <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc AIJ matrices with PaStiX Cholesky, use SBAIJ matrix"</font>);
+<a name="line608">608: </a>  }
+<a name="line609">609: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
+<a name="line610">610: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
+<a name="line611">611: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
+<a name="line612">612: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
+<a name="line613">613: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqAIJSetPreallocation.html#MatSeqAIJSetPreallocation">MatSeqAIJSetPreallocation</A>(B,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+
+<a name="line615">615: </a>  B-&gt;ops-&gt;lufactorsymbolic = MatLUFactorSymbolic_AIJPASTIX;
+<a name="line616">616: </a>  B-&gt;ops-&gt;view             = MatView_PaStiX;
+<a name="line617">617: </a>  B-&gt;ops-&gt;getinfo          = MatGetInfo_PaStiX;
+<a name="line618">618: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>, MatFactorGetSolverPackage_pastix);
+<a name="line619">619: </a>  B-&gt;factor                = MAT_FACTOR_LU;
+
+<a name="line621">621: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
+<a name="line622">622: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line623">623: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line624">624: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line625">625: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line626">626: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
+<a name="line627">627: </a>  B-&gt;ops-&gt;destroy                   = MatDestroy_Pastix;
+<a name="line628">628: </a>  B-&gt;spptr                          = (void*)pastix;
+
+<a name="line630">630: </a>  *F = B;
+<a name="line631">631: </a>  <font color="#4169E1">return</font>(0);
+<a name="line632">632: </a>}
+
+
+<a name="line639">639: </a><strong><font color="#4169E1"><a name="MatGetFactor_mpiaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_mpiaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
+<a name="line640">640: </a>{
+<a name="line641">641: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
+<a name="line643">643: </a>  Mat_Pastix    *pastix;
+
+<a name="line646">646: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_LU) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc AIJ matrices with PaStiX Cholesky, use SBAIJ matrix"</font>);
+<a name="line647">647: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
+<a name="line648">648: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
+<a name="line649">649: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
+<a name="line650">650: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
+<a name="line651">651: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqAIJSetPreallocation.html#MatSeqAIJSetPreallocation">MatSeqAIJSetPreallocation</A>(B,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line652">652: </a>  <A href="../../../../../../docs/manualpages/Mat/MatMPIAIJSetPreallocation.html#MatMPIAIJSetPreallocation">MatMPIAIJSetPreallocation</A>(B,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+
+<a name="line654">654: </a>  B-&gt;ops-&gt;lufactorsymbolic = MatLUFactorSymbolic_AIJPASTIX;
+<a name="line655">655: </a>  B-&gt;ops-&gt;view             = MatView_PaStiX;
+<a name="line656">656: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>,MatFactorGetSolverPackage_pastix);
+<a name="line657">657: </a>  B-&gt;factor                = MAT_FACTOR_LU;
+
+<a name="line659">659: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
+<a name="line660">660: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line661">661: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line662">662: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line663">663: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line664">664: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
+<a name="line665">665: </a>  B-&gt;ops-&gt;destroy                  = MatDestroy_Pastix;
+<a name="line666">666: </a>  B-&gt;spptr                         = (void*)pastix;
+
+<a name="line668">668: </a>  *F = B;
+<a name="line669">669: </a>  <font color="#4169E1">return</font>(0);
+<a name="line670">670: </a>}
+
+<a name="line676">676: </a><strong><font color="#4169E1"><a name="MatGetFactor_seqsbaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_seqsbaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
+<a name="line677">677: </a>{
+<a name="line678">678: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
+<a name="line680">680: </a>  Mat_Pastix    *pastix;
+
+<a name="line683">683: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_CHOLESKY) {
+<a name="line684">684: </a>    <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc SBAIJ matrices with PaStiX LU, use AIJ matrix"</font>);
+<a name="line685">685: </a>  }
+<a name="line686">686: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
+<a name="line687">687: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
+<a name="line688">688: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
+<a name="line689">689: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
+<a name="line690">690: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqSBAIJSetPreallocation.html#MatSeqSBAIJSetPreallocation">MatSeqSBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line691">691: </a>  <A href="../../../../../../docs/manualpages/Mat/MatMPISBAIJSetPreallocation.html#MatMPISBAIJSetPreallocation">MatMPISBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+
+<a name="line693">693: </a>  B-&gt;ops-&gt;choleskyfactorsymbolic = MatCholeskyFactorSymbolic_SBAIJPASTIX;
+<a name="line694">694: </a>  B-&gt;ops-&gt;view                   = MatView_PaStiX;
+<a name="line695">695: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>,MatFactorGetSolverPackage_pastix);
+
+<a name="line697">697: </a>  B-&gt;factor                      = MAT_FACTOR_CHOLESKY;
+
+<a name="line699">699: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
+<a name="line700">700: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line701">701: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line702">702: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line703">703: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line704">704: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
+<a name="line705">705: </a>  B-&gt;ops-&gt;destroy                  = MatDestroy_Pastix;
+<a name="line706">706: </a>  B-&gt;spptr                         = (void*)pastix;
+
+<a name="line708">708: </a>  *F = B;
+<a name="line709">709: </a>  <font color="#4169E1">return</font>(0);
+<a name="line710">710: </a>}
+
+<a name="line716">716: </a><strong><font color="#4169E1"><a name="MatGetFactor_mpisbaij_pastix"></a><A href="../../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatGetFactor_mpisbaij_pastix(<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../../docs/manualpages/Mat/MatFactorType.html#MatFactorType">MatFactorType</A> ftype,<A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *F)</font></strong>
+<a name="line717">717: </a>{
+<a name="line718">718: </a>  <A href="../../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            B;
+<a name="line720">720: </a>  Mat_Pastix    *pastix;
+<a name="line721">721: </a>
+<a name="line723">723: </a>  <font color="#4169E1">if</font> (ftype != MAT_FACTOR_CHOLESKY) <A href="../../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Cannot use PETSc SBAIJ matrices with PaStiX LU, use AIJ matrix"</font>);
+
+<a name="line725">725: </a>  <font color="#B22222">/* Create the factorization matrix */</font>
+<a name="line726">726: </a>  <A href="../../../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;B);
+<a name="line727">727: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(B,A-&gt;rmap-&gt;n,A-&gt;cmap-&gt;n,A-&gt;rmap-&gt;N,A-&gt;cmap-&gt;N);
+<a name="line728">728: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSetType.html#MatSetType">MatSetType</A>(B,((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;type_name);
+<a name="line729">729: </a>  <A href="../../../../../../docs/manualpages/Mat/MatSeqSBAIJSetPreallocation.html#MatSeqSBAIJSetPreallocation">MatSeqSBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line730">730: </a>  <A href="../../../../../../docs/manualpages/Mat/MatMPISBAIJSetPreallocation.html#MatMPISBAIJSetPreallocation">MatMPISBAIJSetPreallocation</A>(B,1,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,0,<A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+
+<a name="line732">732: </a>  B-&gt;ops-&gt;choleskyfactorsymbolic = MatCholeskyFactorSymbolic_SBAIJPASTIX;
+<a name="line733">733: </a>  B-&gt;ops-&gt;view                   = MatView_PaStiX;
+<a name="line734">734: </a>  <A href="../../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)B,<font color="#666666">"MatFactorGetSolverPackage_C"</font>,<font color="#666666">"MatFactorGetSolverPackage_pastix"</font>,MatFactorGetSolverPackage_pastix);
+<a name="line735">735: </a>  B-&gt;factor                      = MAT_FACTOR_CHOLESKY;
+
+<a name="line737">737: </a>  PetscNewLog(B,Mat_Pastix,&amp;pastix);
+<a name="line738">738: </a>  pastix-&gt;CleanUpPastix             = <A href="../../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line739">739: </a>  pastix-&gt;isAIJ                     = <A href="../../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line740">740: </a>  pastix-&gt;scat_rhs                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line741">741: </a>  pastix-&gt;scat_sol                  = <A href="../../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line742">742: </a>  pastix-&gt;<A href="../../../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>                = B-&gt;ops-&gt;destroy;
+<a name="line743">743: </a>  B-&gt;ops-&gt;destroy                   = MatDestroy_Pastix;
+<a name="line744">744: </a>  B-&gt;spptr                          = (void*)pastix;
+
+<a name="line746">746: </a>  *F = B;
+<a name="line747">747: </a>  <font color="#4169E1">return</font>(0);
+<a name="line748">748: </a>}
 </pre>
 </body>
 
Index: petsc/src/mat/impls/aij/mpi/superlu_dist/superlu_dist.c
===================================================================
--- petsc.orig/src/mat/impls/aij/mpi/superlu_dist/superlu_dist.c
+++ petsc/src/mat/impls/aij/mpi/superlu_dist/superlu_dist.c
@@ -701,8 +701,6 @@
     ierr = PetscViewerASCIIPrintf(viewer,"  Column permutation MMD_ATA\n");CHKERRQ(ierr);
   } else if (options.ColPerm == PARMETIS) {
     ierr = PetscViewerASCIIPrintf(viewer,"  Column permutation PARMETIS\n");CHKERRQ(ierr);
-  } else {
-    SETERRQ(PETSC_ERR_ARG_WRONG,"Unknown column permutation");
   }
 
   ierr = PetscViewerASCIIPrintf(viewer,"  Parallel symbolic factorization %s \n",PetscTruths[options.ParSymbFact != NO]);CHKERRQ(ierr);
Index: petsc/src/mat/impls/aij/mpi/superlu_dist/superlu_dist.c.html
===================================================================
--- petsc.orig/src/mat/impls/aij/mpi/superlu_dist/superlu_dist.c.html
+++ petsc/src/mat/impls/aij/mpi/superlu_dist/superlu_dist.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:29:58+00:00">
+<meta name="date" content="2011-03-17T18:50:56+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -664,61 +664,59 @@
 <a name="line701">701: </a>    <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Column permutation MMD_ATA\n"</font>);
 <a name="line702">702: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (options.ColPerm == PARMETIS) {
 <a name="line703">703: </a>    <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Column permutation PARMETIS\n"</font>);
-<a name="line704">704: </a>  } <font color="#4169E1">else</font> {
-<a name="line705">705: </a>    <A href="../../../../.._dist/../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Unknown column permutation"</font>);
-<a name="line706">706: </a>  }
-
-<a name="line708">708: </a>  <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Parallel symbolic factorization %s \n"</font>,PetscTruths[options.ParSymbFact != NO]);
-<a name="line709">709: </a>
-<a name="line710">710: </a>  <font color="#4169E1">if</font> (lu-&gt;FactPattern == SamePattern){
-<a name="line711">711: </a>    <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Repeated factorization SamePattern\n"</font>);
-<a name="line712">712: </a>  } <font color="#4169E1">else</font> {
-<a name="line713">713: </a>    <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Repeated factorization SamePattern_SameRowPerm\n"</font>);
-<a name="line714">714: </a>  }
-<a name="line715">715: </a>  <font color="#4169E1">return</font>(0);
-<a name="line716">716: </a>}
-
-<a name="line720">720: </a><strong><font color="#4169E1"><a name="MatView_SuperLU_DIST"></a><A href="../../../../.._dist/../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatView_SuperLU_DIST(<A href="../../../../.._dist/../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line721">721: </a>{
-<a name="line722">722: </a>  <A href="../../../../.._dist/../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line723">723: </a>  <A href="../../../../.._dist/../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
-<a name="line724">724: </a>  <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
-
-<a name="line727">727: </a>  <A href="../../../../.._dist/../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../.._dist/../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
-<a name="line728">728: </a>  <font color="#4169E1">if</font> (iascii) {
-<a name="line729">729: </a>    PetscViewerGetFormat(viewer,&amp;format);
-<a name="line730">730: </a>    <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_INFO) {
-<a name="line731">731: </a>      MatFactorInfo_SuperLU_DIST(A,viewer);
-<a name="line732">732: </a>    }
-<a name="line733">733: </a>  }
-<a name="line734">734: </a>  <font color="#4169E1">return</font>(0);
-<a name="line735">735: </a>}
-
-
-<a name="line738">738: </a><font color="#B22222">/*MC</font>
-<a name="line739">739: </a><font color="#B22222">  <A href="../../../../.._dist/../docs/manualpages/Mat/MAT_SOLVER_SUPERLU_DIST.html#MAT_SOLVER_SUPERLU_DIST">MAT_SOLVER_SUPERLU_DIST</A> - Parallel direct solver package for LU factorization</font>
-
-<a name="line741">741: </a><font color="#B22222">   Works with AIJ matrices  </font>
-
-<a name="line743">743: </a><font color="#B22222">  Options Database Keys:</font>
-<a name="line744">744: </a><font color="#B22222">+ -mat_superlu_dist_r &lt;n&gt; - number of rows in processor partition</font>
-<a name="line745">745: </a><font color="#B22222">. -mat_superlu_dist_c &lt;n&gt; - number of columns in processor partition</font>
-<a name="line746">746: </a><font color="#B22222">. -mat_superlu_dist_matinput &lt;0,1&gt; - matrix input mode; 0=global, 1=distributed</font>
-<a name="line747">747: </a><font color="#B22222">. -mat_superlu_dist_equil - equilibrate the matrix</font>
-<a name="line748">748: </a><font color="#B22222">. -mat_superlu_dist_rowperm &lt;LargeDiag,NATURAL&gt; - row permutation</font>
-<a name="line749">749: </a><font color="#B22222">. -mat_superlu_dist_colperm &lt;MMD_AT_PLUS_A,MMD_ATA,NATURAL&gt; - column permutation</font>
-<a name="line750">750: </a><font color="#B22222">. -mat_superlu_dist_replacetinypivot - replace tiny pivots</font>
-<a name="line751">751: </a><font color="#B22222">. -mat_superlu_dist_fact &lt;SamePattern&gt; (choose one of) SamePattern SamePattern_SameRowPerm</font>
-<a name="line752">752: </a><font color="#B22222">. -mat_superlu_dist_iterrefine - use iterative refinement</font>
-<a name="line753">753: </a><font color="#B22222">- -mat_superlu_dist_statprint - print factorization information</font>
+<a name="line704">704: </a>  }
 
-<a name="line755">755: </a><font color="#B22222">   Level: beginner</font>
+<a name="line706">706: </a>  <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Parallel symbolic factorization %s \n"</font>,PetscTruths[options.ParSymbFact != NO]);
+<a name="line707">707: </a>
+<a name="line708">708: </a>  <font color="#4169E1">if</font> (lu-&gt;FactPattern == SamePattern){
+<a name="line709">709: </a>    <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Repeated factorization SamePattern\n"</font>);
+<a name="line710">710: </a>  } <font color="#4169E1">else</font> {
+<a name="line711">711: </a>    <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"  Repeated factorization SamePattern_SameRowPerm\n"</font>);
+<a name="line712">712: </a>  }
+<a name="line713">713: </a>  <font color="#4169E1">return</font>(0);
+<a name="line714">714: </a>}
+
+<a name="line718">718: </a><strong><font color="#4169E1"><a name="MatView_SuperLU_DIST"></a><A href="../../../../.._dist/../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatView_SuperLU_DIST(<A href="../../../../.._dist/../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line719">719: </a>{
+<a name="line720">720: </a>  <A href="../../../../.._dist/../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line721">721: </a>  <A href="../../../../.._dist/../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
+<a name="line722">722: </a>  <A href="../../../../.._dist/../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
+
+<a name="line725">725: </a>  <A href="../../../../.._dist/../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../.._dist/../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
+<a name="line726">726: </a>  <font color="#4169E1">if</font> (iascii) {
+<a name="line727">727: </a>    PetscViewerGetFormat(viewer,&amp;format);
+<a name="line728">728: </a>    <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_INFO) {
+<a name="line729">729: </a>      MatFactorInfo_SuperLU_DIST(A,viewer);
+<a name="line730">730: </a>    }
+<a name="line731">731: </a>  }
+<a name="line732">732: </a>  <font color="#4169E1">return</font>(0);
+<a name="line733">733: </a>}
+
+
+<a name="line736">736: </a><font color="#B22222">/*MC</font>
+<a name="line737">737: </a><font color="#B22222">  <A href="../../../../.._dist/../docs/manualpages/Mat/MAT_SOLVER_SUPERLU_DIST.html#MAT_SOLVER_SUPERLU_DIST">MAT_SOLVER_SUPERLU_DIST</A> - Parallel direct solver package for LU factorization</font>
+
+<a name="line739">739: </a><font color="#B22222">   Works with AIJ matrices  </font>
+
+<a name="line741">741: </a><font color="#B22222">  Options Database Keys:</font>
+<a name="line742">742: </a><font color="#B22222">+ -mat_superlu_dist_r &lt;n&gt; - number of rows in processor partition</font>
+<a name="line743">743: </a><font color="#B22222">. -mat_superlu_dist_c &lt;n&gt; - number of columns in processor partition</font>
+<a name="line744">744: </a><font color="#B22222">. -mat_superlu_dist_matinput &lt;0,1&gt; - matrix input mode; 0=global, 1=distributed</font>
+<a name="line745">745: </a><font color="#B22222">. -mat_superlu_dist_equil - equilibrate the matrix</font>
+<a name="line746">746: </a><font color="#B22222">. -mat_superlu_dist_rowperm &lt;LargeDiag,NATURAL&gt; - row permutation</font>
+<a name="line747">747: </a><font color="#B22222">. -mat_superlu_dist_colperm &lt;MMD_AT_PLUS_A,MMD_ATA,NATURAL&gt; - column permutation</font>
+<a name="line748">748: </a><font color="#B22222">. -mat_superlu_dist_replacetinypivot - replace tiny pivots</font>
+<a name="line749">749: </a><font color="#B22222">. -mat_superlu_dist_fact &lt;SamePattern&gt; (choose one of) SamePattern SamePattern_SameRowPerm</font>
+<a name="line750">750: </a><font color="#B22222">. -mat_superlu_dist_iterrefine - use iterative refinement</font>
+<a name="line751">751: </a><font color="#B22222">- -mat_superlu_dist_statprint - print factorization information</font>
 
-<a name="line757">757: </a><font color="#B22222">.seealso: <A href="../../../../.._dist/../docs/manualpages/PC/PCLU.html#PCLU">PCLU</A></font>
+<a name="line753">753: </a><font color="#B22222">   Level: beginner</font>
 
-<a name="line759">759: </a><font color="#B22222">.seealso: <A href="../../../../.._dist/../docs/manualpages/PC/PCFactorSetMatSolverPackage.html#PCFactorSetMatSolverPackage">PCFactorSetMatSolverPackage</A>(), <A href="../../../../.._dist/../docs/manualpages/Mat/MatSolverPackage.html#MatSolverPackage">MatSolverPackage</A></font>
+<a name="line755">755: </a><font color="#B22222">.seealso: <A href="../../../../.._dist/../docs/manualpages/PC/PCLU.html#PCLU">PCLU</A></font>
 
-<a name="line761">761: </a><font color="#B22222">M*/</font>
+<a name="line757">757: </a><font color="#B22222">.seealso: <A href="../../../../.._dist/../docs/manualpages/PC/PCFactorSetMatSolverPackage.html#PCFactorSetMatSolverPackage">PCFactorSetMatSolverPackage</A>(), <A href="../../../../.._dist/../docs/manualpages/Mat/MatSolverPackage.html#MatSolverPackage">MatSolverPackage</A></font>
+
+<a name="line759">759: </a><font color="#B22222">M*/</font>
 
 </pre>
 </body>
Index: petsc/src/mat/impls/aij/seq/aijfact.c
===================================================================
--- petsc.orig/src/mat/impls/aij/seq/aijfact.c
+++ petsc/src/mat/impls/aij/seq/aijfact.c
@@ -2795,7 +2795,7 @@
   PetscFunctionReturn(0); 
 }
 
-#undef __FUNCT__
+#undef __FUNCT__  
 #define __FUNCT__ "MatCholeskyFactorSymbolic_SeqAIJ"
 PetscErrorCode MatCholeskyFactorSymbolic_SeqAIJ(Mat fact,Mat A,IS perm,const MatFactorInfo *info)
 {
Index: petsc/src/mat/impls/aij/seq/superlu/superlu.c
===================================================================
--- petsc.orig/src/mat/impls/aij/seq/superlu/superlu.c
+++ petsc/src/mat/impls/aij/seq/superlu/superlu.c
@@ -407,7 +407,7 @@
   
 
 /*MC
-  MAT_SOLVER_SUPERLU = "superlu" - A solver package providing solvers LU and ILU for sequential matrices
+  MAT_SOLVER_SUPERLU = "superlu" - A solver package providing solvers LU and ILU for sequential matrices 
   via the external package SuperLU.
 
   Use config/configure.py --download-superlu to have PETSc installed with SuperLU
Index: petsc/src/mat/impls/baij/mpi/mpibaij.c
===================================================================
--- petsc.orig/src/mat/impls/baij/mpi/mpibaij.c
+++ petsc/src/mat/impls/baij/mpi/mpibaij.c
@@ -930,7 +930,7 @@
   if (!mat->was_assembled && mode == MAT_FINAL_ASSEMBLY) {
     ierr = MatSetUpMultiply_MPIBAIJ(mat);CHKERRQ(ierr);
   }
-  ((Mat_SeqBAIJ*)baij->B->data)->compressedrow.use = PETSC_TRUE; /* b->compressedrow.use */
+  ((Mat_SeqBAIJ*)baij->B->data)->compressedrow.use = PETSC_FALSE; /* b->compressedrow.use */
   ierr = MatAssemblyBegin(baij->B,mode);CHKERRQ(ierr);
   ierr = MatAssemblyEnd(baij->B,mode);CHKERRQ(ierr);
   
Index: petsc/src/mat/impls/baij/mpi/mpibaij.c.html
===================================================================
--- petsc.orig/src/mat/impls/baij/mpi/mpibaij.c.html
+++ petsc/src/mat/impls/baij/mpi/mpibaij.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:31:52+00:00">
+<meta name="date" content="2011-03-17T18:52:34+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -884,7 +884,7 @@
 <a name="line930">930: </a>  <font color="#4169E1">if</font> (!mat-&gt;was_assembled &amp;&amp; mode == MAT_FINAL_ASSEMBLY) {
 <a name="line931">931: </a>    MatSetUpMultiply_MPIBAIJ(mat);
 <a name="line932">932: </a>  }
-<a name="line933">933: </a>  ((Mat_SeqBAIJ*)baij-&gt;B-&gt;data)-&gt;compressedrow.use = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#B22222">/* b-&gt;compressedrow.use */</font>
+<a name="line933">933: </a>  ((Mat_SeqBAIJ*)baij-&gt;B-&gt;data)-&gt;compressedrow.use = <A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#B22222">/* b-&gt;compressedrow.use */</font>
 <a name="line934">934: </a>  <A href="../../../../../docs/manualpages/Mat/MatAssemblyBegin.html#MatAssemblyBegin">MatAssemblyBegin</A>(baij-&gt;B,mode);
 <a name="line935">935: </a>  <A href="../../../../../docs/manualpages/Mat/MatAssemblyEnd.html#MatAssemblyEnd">MatAssemblyEnd</A>(baij-&gt;B,mode);
 <a name="line936">936: </a>
Index: petsc/src/mat/impls/sbaij/seq/aijsbaij.c
===================================================================
--- petsc.orig/src/mat/impls/sbaij/seq/aijsbaij.c
+++ petsc/src/mat/impls/sbaij/seq/aijsbaij.c
@@ -75,11 +75,11 @@
 	itmp = i*bs+j;
 	for (k=0; k<bs; k++){ /* col i*bs+k */
 	  *(bj + rowstart[itmp]) = (*aj)*bs+k;
-	  *(bv + rowstart[itmp]) = *(av+k*bs+j);
+	  *(bv + rowstart[itmp]) = *(av+k*bs+j); 
 	  rowstart[itmp]++;
 	}
       }
-      aj++; av += bs2;
+      aj++; av += bs2; 
     }
     
     while (nz--){
Index: petsc/src/mat/impls/sbaij/seq/relax.h
===================================================================
--- petsc.orig/src/mat/impls/sbaij/seq/relax.h
+++ petsc/src/mat/impls/sbaij/seq/relax.h
@@ -25,6 +25,7 @@
   const PetscInt       *ib=a->j;
   PetscInt             ibt;
 #endif
+  PetscInt             nonzerorow = 0;
 
   PetscFunctionBegin;
   ierr = VecSet(zz,0.0);CHKERRQ(ierr);
@@ -33,7 +34,9 @@
 
   v  = a->a; 
   for (i=0; i<mbs; i++) {
-    nz   = ai[i+1] - ai[i];  /* length of i_th row of A */    
+    nz   = ai[i+1] - ai[i];  /* length of i_th row of A */
+    if (!nz) continue; /* Move to the next row if the current row is empty */
+    nonzerorow++;
     x1   = x[i];
     sum  = v[0]*x1;          /* diagonal term */
     for (j=1; j<nz; j++) {
@@ -49,7 +52,7 @@
 
   ierr = VecRestoreArray(xx,(PetscScalar**)&x);CHKERRQ(ierr);
   ierr = VecRestoreArray(zz,&z);CHKERRQ(ierr);
-  ierr = PetscLogFlops(2.0*(2.0*a->nz - mbs) - mbs);CHKERRQ(ierr); 
+  ierr = PetscLogFlops(2.0*(2.0*a->nz - nonzerorow) - nonzerorow);CHKERRQ(ierr); 
   PetscFunctionReturn(0);
 }
 
@@ -76,6 +79,7 @@
   const PetscInt       *ib=a->j;
   PetscInt             ibt;
 #endif
+  PetscInt             nonzerorow=0;
 
   PetscFunctionBegin;
   ierr = VecSet(zz,0.0);CHKERRQ(ierr);
@@ -84,7 +88,9 @@
 
   v  = a->a; 
   for (i=0; i<mbs; i++) {
-    nz   = ai[i+1] - ai[i];        /* length of i_th row of A */    
+    nz   = ai[i+1] - ai[i];        /* length of i_th row of A */
+    if (!nz) continue; /* Move to the next row if the current row is empty */
+    nonzerorow++;
     x1   = x[i];
     sum  = v[0]*x1;                /* diagonal term */
     for (j=1; j<nz; j++) {
@@ -100,7 +106,7 @@
 
   ierr = VecRestoreArray(xx,(PetscScalar**)&x);CHKERRQ(ierr);
   ierr = VecRestoreArray(zz,&z);CHKERRQ(ierr);
-  ierr = PetscLogFlops(2.0*(2.0*a->nz - mbs) - mbs);CHKERRQ(ierr); 
+  ierr = PetscLogFlops(2.0*(2.0*a->nz - nonzerorow) - nonzerorow);CHKERRQ(ierr); 
   PetscFunctionReturn(0);
 }
 
Index: petsc/src/mat/impls/sbaij/seq/relax.h.html
===================================================================
--- petsc.orig/src/mat/impls/sbaij/seq/relax.h.html
+++ petsc/src/mat/impls/sbaij/seq/relax.h.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:33:24+00:00">
+<meta name="date" content="2011-03-17T18:54:15+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -33,272 +33,278 @@
 <a name="line25"> 25: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ib=a-&gt;j;
 <a name="line26"> 26: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             ibt;
 <a name="line27"> 27: </a><font color="#A020F0">#endif</font>
+<a name="line28"> 28: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             nonzerorow = 0;
 
-<a name="line30"> 30: </a>  <A href="../../../../../docs/manualpages/Vec/VecSet.html#VecSet">VecSet</A>(zz,0.0);
-<a name="line31"> 31: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
-<a name="line32"> 32: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(zz,&amp;z);
-
-<a name="line34"> 34: </a>  v  = a-&gt;a;
-<a name="line35"> 35: </a>  <font color="#4169E1">for</font> (i=0; i&lt;mbs; i++) {
-<a name="line36"> 36: </a>    nz   = ai[i+1] - ai[i];  <font color="#B22222">/* length of i_th row of A */</font>
-<a name="line37"> 37: </a>    x1   = x[i];
-<a name="line38"> 38: </a>    sum  = v[0]*x1;          <font color="#B22222">/* diagonal term */</font>
-<a name="line39"> 39: </a>    <font color="#4169E1">for</font> (j=1; j&lt;nz; j++) {
-<a name="line40"> 40: </a>      ibt  = ib[j];
-<a name="line41"> 41: </a>      vj   = v[j];
-<a name="line42"> 42: </a>      sum += vj * x[ibt];   <font color="#B22222">/* (strict upper triangular part of A)*x  */</font>
-<a name="line43"> 43: </a>      z[ibt] += PetscConj(v[j]) * x1;    <font color="#B22222">/* (strict lower triangular part of A)*x  */</font>
-<a name="line44"> 44: </a>    }
-<a name="line45"> 45: </a>    z[i] += sum;
-<a name="line46"> 46: </a>    v    += nz;
-<a name="line47"> 47: </a>    ib   += nz;
-<a name="line48"> 48: </a>  }
-
-<a name="line50"> 50: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
-<a name="line51"> 51: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(zz,&amp;z);
-<a name="line52"> 52: </a>  <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*(2.0*a-&gt;nz - mbs) - mbs);
-<a name="line53"> 53: </a>  <font color="#4169E1">return</font>(0);
-<a name="line54"> 54: </a>}
-
-<a name="line58"> 58: </a><font color="#A020F0">#if defined(USESHORT)</font>
-<a name="line59"> 59: </a><strong><font color="#4169E1"><a name="MatMult_SeqSBAIJ_1_ushort"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMult_SeqSBAIJ_1_ushort(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> zz)</font></strong>
-<a name="line60"> 60: </a><font color="#A020F0">#else</font>
-<a name="line61"> 61: </a><strong><font color="#4169E1"><a name="MatMult_SeqSBAIJ_1"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMult_SeqSBAIJ_1(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> zz)</font></strong>
-<a name="line62"> 62: </a><font color="#A020F0">#endif</font>
-<a name="line63"> 63: </a>{
-<a name="line64"> 64: </a>  Mat_SeqSBAIJ         *a = (Mat_SeqSBAIJ*)A-&gt;data;
-<a name="line65"> 65: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *x;
-<a name="line66"> 66: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>          *z,x1,sum;
-<a name="line67"> 67: </a>  const MatScalar      *v;
-<a name="line68"> 68: </a>  MatScalar            vj;
-<a name="line69"> 69: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>       ierr;
-<a name="line70"> 70: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             mbs=a-&gt;mbs,i,j,nz;
-<a name="line71"> 71: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ai=a-&gt;i;
-<a name="line72"> 72: </a><font color="#A020F0">#if defined(USESHORT)</font>
-<a name="line73"> 73: </a>  const unsigned short *ib=a-&gt;jshort;
-<a name="line74"> 74: </a>  unsigned short       ibt;
-<a name="line75"> 75: </a><font color="#A020F0">#else</font>
-<a name="line76"> 76: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ib=a-&gt;j;
-<a name="line77"> 77: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             ibt;
-<a name="line78"> 78: </a><font color="#A020F0">#endif</font>
-
-<a name="line81"> 81: </a>  <A href="../../../../../docs/manualpages/Vec/VecSet.html#VecSet">VecSet</A>(zz,0.0);
-<a name="line82"> 82: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
-<a name="line83"> 83: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(zz,&amp;z);
-
-<a name="line85"> 85: </a>  v  = a-&gt;a;
-<a name="line86"> 86: </a>  <font color="#4169E1">for</font> (i=0; i&lt;mbs; i++) {
-<a name="line87"> 87: </a>    nz   = ai[i+1] - ai[i];        <font color="#B22222">/* length of i_th row of A */</font>
-<a name="line88"> 88: </a>    x1   = x[i];
-<a name="line89"> 89: </a>    sum  = v[0]*x1;                <font color="#B22222">/* diagonal term */</font>
-<a name="line90"> 90: </a>    <font color="#4169E1">for</font> (j=1; j&lt;nz; j++) {
-<a name="line91"> 91: </a>      ibt = ib[j];
-<a name="line92"> 92: </a>      vj  = v[j];
-<a name="line93"> 93: </a>      z[ibt] += vj * x1;       <font color="#B22222">/* (strict lower triangular part of A)*x  */</font>
-<a name="line94"> 94: </a>      sum    += vj * x[ibt]; <font color="#B22222">/* (strict upper triangular part of A)*x  */</font>
-<a name="line95"> 95: </a>    }
-<a name="line96"> 96: </a>    z[i] += sum;
-<a name="line97"> 97: </a>    v    += nz;
-<a name="line98"> 98: </a>    ib   += nz;
-<a name="line99"> 99: </a>  }
-
-<a name="line101">101: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
-<a name="line102">102: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(zz,&amp;z);
-<a name="line103">103: </a>  <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*(2.0*a-&gt;nz - mbs) - mbs);
-<a name="line104">104: </a>  <font color="#4169E1">return</font>(0);
-<a name="line105">105: </a>}
-
-<a name="line109">109: </a><font color="#A020F0">#if defined(USESHORT)</font>
-<a name="line110">110: </a><strong><font color="#4169E1"><a name="MatSOR_SeqSBAIJ_ushort"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatSOR_SeqSBAIJ_ushort(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> bb,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> omega,<A href="../../../../../docs/manualpages/Mat/MatSORType.html#MatSORType">MatSORType</A> flag,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> fshift,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> its,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> lits,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx)</font></strong>
-<a name="line111">111: </a><font color="#A020F0">#else</font>
-<a name="line112">112: </a><strong><font color="#4169E1"><a name="MatSOR_SeqSBAIJ"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatSOR_SeqSBAIJ(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> bb,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> omega,<A href="../../../../../docs/manualpages/Mat/MatSORType.html#MatSORType">MatSORType</A> flag,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> fshift,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> its,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> lits,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx)</font></strong>
-<a name="line113">113: </a><font color="#A020F0">#endif</font>
-<a name="line114">114: </a>{
-<a name="line115">115: </a>  Mat_SeqSBAIJ         *a = (Mat_SeqSBAIJ*)A-&gt;data;
-<a name="line116">116: </a>  const MatScalar      *aa=a-&gt;a,*v,*v1,*aidiag;
-<a name="line117">117: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>          *x,*t,sum;
-<a name="line118">118: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *b;
-<a name="line119">119: </a>  MatScalar            tmp;
-<a name="line120">120: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>       ierr;
-<a name="line121">121: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             m=a-&gt;mbs,bs=A-&gt;rmap-&gt;bs,j;
-<a name="line122">122: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ai=a-&gt;i;
-<a name="line123">123: </a><font color="#A020F0">#if defined(USESHORT)</font>
-<a name="line124">124: </a>  const unsigned short *aj=a-&gt;jshort,*vj,*vj1;
-<a name="line125">125: </a><font color="#A020F0">#else</font>
-<a name="line126">126: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *aj=a-&gt;j,*vj,*vj1;
-<a name="line127">127: </a><font color="#A020F0">#endif</font>
-<a name="line128">128: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             nz,nz1,i;
-
-<a name="line131">131: </a>  <font color="#4169E1">if</font> (flag &amp; SOR_EISENSTAT) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"No support yet for Eisenstat"</font>);
-
-<a name="line133">133: </a>  its = its*lits;
-<a name="line134">134: </a>  <font color="#4169E1">if</font> (its &lt;= 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Relaxation requires global its %D and local its %D both positive"</font>,its,lits);
-
-<a name="line136">136: </a>  <font color="#4169E1">if</font> (bs &gt; 1) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"SSOR for block size &gt; 1 is not yet implemented"</font>);
-
-<a name="line138">138: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xx,&amp;x);
-<a name="line139">139: </a>  <font color="#4169E1">if</font> (xx != bb) {
-<a name="line140">140: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(bb,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;b);
-<a name="line141">141: </a>  } <font color="#4169E1">else</font> {
-<a name="line142">142: </a>    b = x;
-<a name="line143">143: </a>  }
-
-<a name="line145">145: </a>  <font color="#4169E1">if</font> (!a-&gt;idiagvalid) {
-<a name="line146">146: </a>    <font color="#4169E1">if</font> (!a-&gt;idiag) {
-<a name="line147">147: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;a-&gt;idiag);
-<a name="line148">148: </a>    }
-<a name="line149">149: </a>    <font color="#4169E1">for</font> (i=0; i&lt;a-&gt;mbs; i++) a-&gt;idiag[i] = 1.0/a-&gt;a[a-&gt;i[i]];
-<a name="line150">150: </a>    a-&gt;idiagvalid = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line151">151: </a>  }
-
-<a name="line153">153: </a>  <font color="#4169E1">if</font> (!a-&gt;sor_work) {
-<a name="line154">154: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;a-&gt;sor_work);
-<a name="line155">155: </a>  }
-<a name="line156">156: </a>  t = a-&gt;sor_work;
-
-<a name="line158">158: </a>  aidiag = a-&gt;idiag;
-
-<a name="line160">160: </a>  <font color="#4169E1">if</font> (flag == SOR_APPLY_UPPER) {
-<a name="line161">161: </a>    <font color="#B22222">/* apply (U + D/omega) to the vector */</font>
-<a name="line162">162: </a>    <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> d;
-<a name="line163">163: </a>    <font color="#4169E1">for</font> (i=0; i&lt;m; i++) {
-<a name="line164">164: </a>      d    = fshift + aa[ai[i]];
-<a name="line165">165: </a>      nz   = ai[i+1] - ai[i] - 1;
-<a name="line166">166: </a>      vj   = aj + ai[i] + 1;
-<a name="line167">167: </a>      v    = aa + ai[i] + 1;
-<a name="line168">168: </a>      sum  = b[i]*d/omega;
-<a name="line169">169: </a>      PetscSparseDensePlusDot(sum,b,v,vj,nz);
-<a name="line170">170: </a>      x[i] = sum;
-<a name="line171">171: </a>    }
-<a name="line172">172: </a>    <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(a-&gt;nz);
-<a name="line173">173: </a>  }
-
-<a name="line175">175: </a>  <font color="#4169E1">if</font> (flag &amp; SOR_ZERO_INITIAL_GUESS) {
-<a name="line176">176: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_FORWARD_SWEEP || flag &amp; SOR_LOCAL_FORWARD_SWEEP){
-<a name="line177">177: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(t,b,m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-
-<a name="line179">179: </a>      v  = aa + 1;
-<a name="line180">180: </a>      vj = aj + 1;
-<a name="line181">181: </a>      <font color="#4169E1">for</font> (i=0; i&lt;m; i++){
-<a name="line182">182: </a>        nz = ai[i+1] - ai[i] - 1;
-<a name="line183">183: </a>        tmp = - (x[i] = omega*t[i]*aidiag[i]);
-<a name="line184">184: </a>        <font color="#4169E1">for</font> (j=0; j&lt;nz; j++) {
-<a name="line185">185: </a>          t[vj[j]] += tmp*v[j];
-<a name="line186">186: </a>        }
-<a name="line187">187: </a>        v  += nz + 1;
-<a name="line188">188: </a>        vj += nz + 1;
-<a name="line189">189: </a>      }
-<a name="line190">190: </a>      <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2*a-&gt;nz);
-<a name="line191">191: </a>    }
-
-<a name="line193">193: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_BACKWARD_SWEEP || flag &amp; SOR_LOCAL_BACKWARD_SWEEP){
-<a name="line194">194: </a>      int nz2;
-<a name="line195">195: </a>      <font color="#4169E1">if</font> (!(flag &amp; SOR_FORWARD_SWEEP || flag &amp; SOR_LOCAL_FORWARD_SWEEP)){
-<a name="line196">196: </a><font color="#A020F0">#if defined(PETSC_USE_BACKWARD_LOOP)</font>
-<a name="line197">197: </a>        v  = aa + ai[m] - 1;
-<a name="line198">198: </a>        vj = aj + ai[m] - 1;
-<a name="line199">199: </a>        <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
-<a name="line200">200: </a>          sum = b[i];
-<a name="line201">201: </a>          nz  = ai[i+1] - ai[i] - 1;
-<a name="line202">202: </a>          {<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> __i;<font color="#4169E1">for</font>(__i=0;__i&lt;nz;__i++) sum -= v[-__i] * x[vj[-__i]];}
-<a name="line203">203: </a><font color="#A020F0">#else</font>
-<a name="line204">204: </a>        v  = aa + ai[m-1] + 1;
-<a name="line205">205: </a>        vj = aj + ai[m-1] + 1;
-<a name="line206">206: </a>        nz = 0;
-<a name="line207">207: </a>        <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
-<a name="line208">208: </a>          sum = b[i];
-<a name="line209">209: </a>          nz2 = ai[i] - ai[i-1] - 1;
-<a name="line210">210: </a>          PETSC_Prefetch(v-nz2-1,0,1);
-<a name="line211">211: </a>          PETSC_Prefetch(vj-nz2-1,0,1);
-<a name="line212">212: </a>          PetscSparseDenseMinusDot(sum,x,v,vj,nz);
-<a name="line213">213: </a>          nz   = nz2;
-<a name="line214">214: </a><font color="#A020F0">#endif</font>
-<a name="line215">215: </a>          x[i] = omega*sum*aidiag[i];
-<a name="line216">216: </a>          v  -= nz + 1;
-<a name="line217">217: </a>          vj -= nz + 1;
-<a name="line218">218: </a>        }
-<a name="line219">219: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2*a-&gt;nz);
-<a name="line220">220: </a>      } <font color="#4169E1">else</font> {
-<a name="line221">221: </a>        v  = aa + ai[m-1] + 1;
-<a name="line222">222: </a>        vj = aj + ai[m-1] + 1;
-<a name="line223">223: </a>        nz = 0;
-<a name="line224">224: </a>        <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
-<a name="line225">225: </a>          sum = t[i];
-<a name="line226">226: </a>          nz2 = ai[i] - ai[i-1] - 1;
-<a name="line227">227: </a>          PETSC_Prefetch(v-nz2-1,0,1);
-<a name="line228">228: </a>          PETSC_Prefetch(vj-nz2-1,0,1);
-<a name="line229">229: </a>          PetscSparseDenseMinusDot(sum,x,v,vj,nz);
-<a name="line230">230: </a>          x[i] = (1-omega)*x[i] + omega*sum*aidiag[i];
-<a name="line231">231: </a>          nz  = nz2;
-<a name="line232">232: </a>          v  -= nz + 1;
-<a name="line233">233: </a>          vj -= nz + 1;
-<a name="line234">234: </a>        }
-<a name="line235">235: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2*a-&gt;nz);
-<a name="line236">236: </a>      }
-<a name="line237">237: </a>    }
-<a name="line238">238: </a>    its--;
-<a name="line239">239: </a>  }
-
-<a name="line241">241: </a>  <font color="#4169E1">while</font> (its--) {
-<a name="line242">242: </a>    <font color="#B22222">/* </font>
-<a name="line243">243: </a><font color="#B22222">       forward sweep:</font>
-<a name="line244">244: </a><font color="#B22222">       for i=0,...,m-1:</font>
-<a name="line245">245: </a><font color="#B22222">         sum[i] = (b[i] - U(i,:)x )/d[i];</font>
-<a name="line246">246: </a><font color="#B22222">         x[i]   = (1-omega)x[i] + omega*sum[i];</font>
-<a name="line247">247: </a><font color="#B22222">         b      = b - x[i]*U^T(i,:);</font>
-<a name="line248">248: </a><font color="#B22222">         </font>
-<a name="line249">249: </a><font color="#B22222">    */</font>
-<a name="line250">250: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_FORWARD_SWEEP || flag &amp; SOR_LOCAL_FORWARD_SWEEP){
-<a name="line251">251: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(t,b,m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-
-<a name="line253">253: </a>      <font color="#4169E1">for</font> (i=0; i&lt;m; i++){
-<a name="line254">254: </a>        v  = aa + ai[i] + 1; v1=v;
-<a name="line255">255: </a>        vj = aj + ai[i] + 1; vj1=vj;
-<a name="line256">256: </a>        nz = ai[i+1] - ai[i] - 1; nz1=nz;
-<a name="line257">257: </a>        sum = t[i];
-<a name="line258">258: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(4.0*nz-2);
-<a name="line259">259: </a>        <font color="#4169E1">while</font> (nz1--) sum -= (*v1++)*x[*vj1++];
-<a name="line260">260: </a>        x[i] = (1-omega)*x[i] + omega*sum*aidiag[i];
-<a name="line261">261: </a>        <font color="#4169E1">while</font> (nz--) t[*vj++] -= x[i]*(*v++);
-<a name="line262">262: </a>      }
-<a name="line263">263: </a>    }
-<a name="line264">264: </a>
-<a name="line265">265: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_BACKWARD_SWEEP || flag &amp; SOR_LOCAL_BACKWARD_SWEEP){
-<a name="line266">266: </a>      <font color="#B22222">/* </font>
-<a name="line267">267: </a><font color="#B22222">       backward sweep:</font>
-<a name="line268">268: </a><font color="#B22222">       b = b - x[i]*U^T(i,:), i=0,...,n-2</font>
-<a name="line269">269: </a><font color="#B22222">       for i=m-1,...,0:</font>
-<a name="line270">270: </a><font color="#B22222">         sum[i] = (b[i] - U(i,:)x )/d[i];</font>
-<a name="line271">271: </a><font color="#B22222">         x[i]   = (1-omega)x[i] + omega*sum[i];</font>
-<a name="line272">272: </a><font color="#B22222">      */</font>
-<a name="line273">273: </a>      <font color="#B22222">/* if there was a forward sweep done above then I thing the next two for loops are not needed */</font>
-<a name="line274">274: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(t,b,m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-<a name="line275">275: </a>
-<a name="line276">276: </a>      <font color="#4169E1">for</font> (i=0; i&lt;m-1; i++){  <font color="#B22222">/* update rhs */</font>
-<a name="line277">277: </a>        v  = aa + ai[i] + 1;
-<a name="line278">278: </a>        vj = aj + ai[i] + 1;
-<a name="line279">279: </a>        nz = ai[i+1] - ai[i] - 1;
-<a name="line280">280: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*nz-1);
-<a name="line281">281: </a>        <font color="#4169E1">while</font> (nz--) t[*vj++] -= x[i]*(*v++);
-<a name="line282">282: </a>      }
-<a name="line283">283: </a>      <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
-<a name="line284">284: </a>        v  = aa + ai[i] + 1;
-<a name="line285">285: </a>        vj = aj + ai[i] + 1;
-<a name="line286">286: </a>        nz = ai[i+1] - ai[i] - 1;
-<a name="line287">287: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*nz-1);
-<a name="line288">288: </a>        sum = t[i];
-<a name="line289">289: </a>        <font color="#4169E1">while</font> (nz--) sum -= x[*vj++]*(*v++);
-<a name="line290">290: </a>        x[i] =   (1-omega)*x[i] + omega*sum*aidiag[i];
-<a name="line291">291: </a>      }
-<a name="line292">292: </a>    }
-<a name="line293">293: </a>  }
-
-<a name="line295">295: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xx,&amp;x);
-<a name="line296">296: </a>  <font color="#4169E1">if</font> (bb != xx) {
-<a name="line297">297: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(bb,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;b);
-<a name="line298">298: </a>  }
-<a name="line299">299: </a>  <font color="#4169E1">return</font>(0);
-<a name="line300">300: </a>}
+<a name="line31"> 31: </a>  <A href="../../../../../docs/manualpages/Vec/VecSet.html#VecSet">VecSet</A>(zz,0.0);
+<a name="line32"> 32: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
+<a name="line33"> 33: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(zz,&amp;z);
+
+<a name="line35"> 35: </a>  v  = a-&gt;a;
+<a name="line36"> 36: </a>  <font color="#4169E1">for</font> (i=0; i&lt;mbs; i++) {
+<a name="line37"> 37: </a>    nz   = ai[i+1] - ai[i];  <font color="#B22222">/* length of i_th row of A */</font>
+<a name="line38"> 38: </a>    <font color="#4169E1">if</font> (!nz) <font color="#4169E1">continue</font>; <font color="#B22222">/* Move to the next row if the current row is empty */</font>
+<a name="line39"> 39: </a>    nonzerorow++;
+<a name="line40"> 40: </a>    x1   = x[i];
+<a name="line41"> 41: </a>    sum  = v[0]*x1;          <font color="#B22222">/* diagonal term */</font>
+<a name="line42"> 42: </a>    <font color="#4169E1">for</font> (j=1; j&lt;nz; j++) {
+<a name="line43"> 43: </a>      ibt  = ib[j];
+<a name="line44"> 44: </a>      vj   = v[j];
+<a name="line45"> 45: </a>      sum += vj * x[ibt];   <font color="#B22222">/* (strict upper triangular part of A)*x  */</font>
+<a name="line46"> 46: </a>      z[ibt] += PetscConj(v[j]) * x1;    <font color="#B22222">/* (strict lower triangular part of A)*x  */</font>
+<a name="line47"> 47: </a>    }
+<a name="line48"> 48: </a>    z[i] += sum;
+<a name="line49"> 49: </a>    v    += nz;
+<a name="line50"> 50: </a>    ib   += nz;
+<a name="line51"> 51: </a>  }
+
+<a name="line53"> 53: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
+<a name="line54"> 54: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(zz,&amp;z);
+<a name="line55"> 55: </a>  <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*(2.0*a-&gt;nz - nonzerorow) - nonzerorow);
+<a name="line56"> 56: </a>  <font color="#4169E1">return</font>(0);
+<a name="line57"> 57: </a>}
+
+<a name="line61"> 61: </a><font color="#A020F0">#if defined(USESHORT)</font>
+<a name="line62"> 62: </a><strong><font color="#4169E1"><a name="MatMult_SeqSBAIJ_1_ushort"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMult_SeqSBAIJ_1_ushort(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> zz)</font></strong>
+<a name="line63"> 63: </a><font color="#A020F0">#else</font>
+<a name="line64"> 64: </a><strong><font color="#4169E1"><a name="MatMult_SeqSBAIJ_1"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMult_SeqSBAIJ_1(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> zz)</font></strong>
+<a name="line65"> 65: </a><font color="#A020F0">#endif</font>
+<a name="line66"> 66: </a>{
+<a name="line67"> 67: </a>  Mat_SeqSBAIJ         *a = (Mat_SeqSBAIJ*)A-&gt;data;
+<a name="line68"> 68: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *x;
+<a name="line69"> 69: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>          *z,x1,sum;
+<a name="line70"> 70: </a>  const MatScalar      *v;
+<a name="line71"> 71: </a>  MatScalar            vj;
+<a name="line72"> 72: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>       ierr;
+<a name="line73"> 73: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             mbs=a-&gt;mbs,i,j,nz;
+<a name="line74"> 74: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ai=a-&gt;i;
+<a name="line75"> 75: </a><font color="#A020F0">#if defined(USESHORT)</font>
+<a name="line76"> 76: </a>  const unsigned short *ib=a-&gt;jshort;
+<a name="line77"> 77: </a>  unsigned short       ibt;
+<a name="line78"> 78: </a><font color="#A020F0">#else</font>
+<a name="line79"> 79: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ib=a-&gt;j;
+<a name="line80"> 80: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             ibt;
+<a name="line81"> 81: </a><font color="#A020F0">#endif</font>
+<a name="line82"> 82: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             nonzerorow=0;
+
+<a name="line85"> 85: </a>  <A href="../../../../../docs/manualpages/Vec/VecSet.html#VecSet">VecSet</A>(zz,0.0);
+<a name="line86"> 86: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
+<a name="line87"> 87: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(zz,&amp;z);
+
+<a name="line89"> 89: </a>  v  = a-&gt;a;
+<a name="line90"> 90: </a>  <font color="#4169E1">for</font> (i=0; i&lt;mbs; i++) {
+<a name="line91"> 91: </a>    nz   = ai[i+1] - ai[i];        <font color="#B22222">/* length of i_th row of A */</font>
+<a name="line92"> 92: </a>    <font color="#4169E1">if</font> (!nz) <font color="#4169E1">continue</font>; <font color="#B22222">/* Move to the next row if the current row is empty */</font>
+<a name="line93"> 93: </a>    nonzerorow++;
+<a name="line94"> 94: </a>    x1   = x[i];
+<a name="line95"> 95: </a>    sum  = v[0]*x1;                <font color="#B22222">/* diagonal term */</font>
+<a name="line96"> 96: </a>    <font color="#4169E1">for</font> (j=1; j&lt;nz; j++) {
+<a name="line97"> 97: </a>      ibt = ib[j];
+<a name="line98"> 98: </a>      vj  = v[j];
+<a name="line99"> 99: </a>      z[ibt] += vj * x1;       <font color="#B22222">/* (strict lower triangular part of A)*x  */</font>
+<a name="line100">100: </a>      sum    += vj * x[ibt]; <font color="#B22222">/* (strict upper triangular part of A)*x  */</font>
+<a name="line101">101: </a>    }
+<a name="line102">102: </a>    z[i] += sum;
+<a name="line103">103: </a>    v    += nz;
+<a name="line104">104: </a>    ib   += nz;
+<a name="line105">105: </a>  }
+
+<a name="line107">107: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xx,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;x);
+<a name="line108">108: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(zz,&amp;z);
+<a name="line109">109: </a>  <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*(2.0*a-&gt;nz - nonzerorow) - nonzerorow);
+<a name="line110">110: </a>  <font color="#4169E1">return</font>(0);
+<a name="line111">111: </a>}
+
+<a name="line115">115: </a><font color="#A020F0">#if defined(USESHORT)</font>
+<a name="line116">116: </a><strong><font color="#4169E1"><a name="MatSOR_SeqSBAIJ_ushort"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatSOR_SeqSBAIJ_ushort(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> bb,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> omega,<A href="../../../../../docs/manualpages/Mat/MatSORType.html#MatSORType">MatSORType</A> flag,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> fshift,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> its,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> lits,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx)</font></strong>
+<a name="line117">117: </a><font color="#A020F0">#else</font>
+<a name="line118">118: </a><strong><font color="#4169E1"><a name="MatSOR_SeqSBAIJ"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatSOR_SeqSBAIJ(<A href="../../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> bb,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> omega,<A href="../../../../../docs/manualpages/Mat/MatSORType.html#MatSORType">MatSORType</A> flag,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> fshift,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> its,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> lits,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xx)</font></strong>
+<a name="line119">119: </a><font color="#A020F0">#endif</font>
+<a name="line120">120: </a>{
+<a name="line121">121: </a>  Mat_SeqSBAIJ         *a = (Mat_SeqSBAIJ*)A-&gt;data;
+<a name="line122">122: </a>  const MatScalar      *aa=a-&gt;a,*v,*v1,*aidiag;
+<a name="line123">123: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>          *x,*t,sum;
+<a name="line124">124: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *b;
+<a name="line125">125: </a>  MatScalar            tmp;
+<a name="line126">126: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>       ierr;
+<a name="line127">127: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             m=a-&gt;mbs,bs=A-&gt;rmap-&gt;bs,j;
+<a name="line128">128: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *ai=a-&gt;i;
+<a name="line129">129: </a><font color="#A020F0">#if defined(USESHORT)</font>
+<a name="line130">130: </a>  const unsigned short *aj=a-&gt;jshort,*vj,*vj1;
+<a name="line131">131: </a><font color="#A020F0">#else</font>
+<a name="line132">132: </a>  const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *aj=a-&gt;j,*vj,*vj1;
+<a name="line133">133: </a><font color="#A020F0">#endif</font>
+<a name="line134">134: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>             nz,nz1,i;
+
+<a name="line137">137: </a>  <font color="#4169E1">if</font> (flag &amp; SOR_EISENSTAT) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"No support yet for Eisenstat"</font>);
+
+<a name="line139">139: </a>  its = its*lits;
+<a name="line140">140: </a>  <font color="#4169E1">if</font> (its &lt;= 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Relaxation requires global its %D and local its %D both positive"</font>,its,lits);
+
+<a name="line142">142: </a>  <font color="#4169E1">if</font> (bs &gt; 1) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"SSOR for block size &gt; 1 is not yet implemented"</font>);
+
+<a name="line144">144: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xx,&amp;x);
+<a name="line145">145: </a>  <font color="#4169E1">if</font> (xx != bb) {
+<a name="line146">146: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(bb,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;b);
+<a name="line147">147: </a>  } <font color="#4169E1">else</font> {
+<a name="line148">148: </a>    b = x;
+<a name="line149">149: </a>  }
+
+<a name="line151">151: </a>  <font color="#4169E1">if</font> (!a-&gt;idiagvalid) {
+<a name="line152">152: </a>    <font color="#4169E1">if</font> (!a-&gt;idiag) {
+<a name="line153">153: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;a-&gt;idiag);
+<a name="line154">154: </a>    }
+<a name="line155">155: </a>    <font color="#4169E1">for</font> (i=0; i&lt;a-&gt;mbs; i++) a-&gt;idiag[i] = 1.0/a-&gt;a[a-&gt;i[i]];
+<a name="line156">156: </a>    a-&gt;idiagvalid = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line157">157: </a>  }
+
+<a name="line159">159: </a>  <font color="#4169E1">if</font> (!a-&gt;sor_work) {
+<a name="line160">160: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;a-&gt;sor_work);
+<a name="line161">161: </a>  }
+<a name="line162">162: </a>  t = a-&gt;sor_work;
+
+<a name="line164">164: </a>  aidiag = a-&gt;idiag;
+
+<a name="line166">166: </a>  <font color="#4169E1">if</font> (flag == SOR_APPLY_UPPER) {
+<a name="line167">167: </a>    <font color="#B22222">/* apply (U + D/omega) to the vector */</font>
+<a name="line168">168: </a>    <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> d;
+<a name="line169">169: </a>    <font color="#4169E1">for</font> (i=0; i&lt;m; i++) {
+<a name="line170">170: </a>      d    = fshift + aa[ai[i]];
+<a name="line171">171: </a>      nz   = ai[i+1] - ai[i] - 1;
+<a name="line172">172: </a>      vj   = aj + ai[i] + 1;
+<a name="line173">173: </a>      v    = aa + ai[i] + 1;
+<a name="line174">174: </a>      sum  = b[i]*d/omega;
+<a name="line175">175: </a>      PetscSparseDensePlusDot(sum,b,v,vj,nz);
+<a name="line176">176: </a>      x[i] = sum;
+<a name="line177">177: </a>    }
+<a name="line178">178: </a>    <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(a-&gt;nz);
+<a name="line179">179: </a>  }
+
+<a name="line181">181: </a>  <font color="#4169E1">if</font> (flag &amp; SOR_ZERO_INITIAL_GUESS) {
+<a name="line182">182: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_FORWARD_SWEEP || flag &amp; SOR_LOCAL_FORWARD_SWEEP){
+<a name="line183">183: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(t,b,m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+
+<a name="line185">185: </a>      v  = aa + 1;
+<a name="line186">186: </a>      vj = aj + 1;
+<a name="line187">187: </a>      <font color="#4169E1">for</font> (i=0; i&lt;m; i++){
+<a name="line188">188: </a>        nz = ai[i+1] - ai[i] - 1;
+<a name="line189">189: </a>        tmp = - (x[i] = omega*t[i]*aidiag[i]);
+<a name="line190">190: </a>        <font color="#4169E1">for</font> (j=0; j&lt;nz; j++) {
+<a name="line191">191: </a>          t[vj[j]] += tmp*v[j];
+<a name="line192">192: </a>        }
+<a name="line193">193: </a>        v  += nz + 1;
+<a name="line194">194: </a>        vj += nz + 1;
+<a name="line195">195: </a>      }
+<a name="line196">196: </a>      <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2*a-&gt;nz);
+<a name="line197">197: </a>    }
+
+<a name="line199">199: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_BACKWARD_SWEEP || flag &amp; SOR_LOCAL_BACKWARD_SWEEP){
+<a name="line200">200: </a>      int nz2;
+<a name="line201">201: </a>      <font color="#4169E1">if</font> (!(flag &amp; SOR_FORWARD_SWEEP || flag &amp; SOR_LOCAL_FORWARD_SWEEP)){
+<a name="line202">202: </a><font color="#A020F0">#if defined(PETSC_USE_BACKWARD_LOOP)</font>
+<a name="line203">203: </a>        v  = aa + ai[m] - 1;
+<a name="line204">204: </a>        vj = aj + ai[m] - 1;
+<a name="line205">205: </a>        <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
+<a name="line206">206: </a>          sum = b[i];
+<a name="line207">207: </a>          nz  = ai[i+1] - ai[i] - 1;
+<a name="line208">208: </a>          {<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> __i;<font color="#4169E1">for</font>(__i=0;__i&lt;nz;__i++) sum -= v[-__i] * x[vj[-__i]];}
+<a name="line209">209: </a><font color="#A020F0">#else</font>
+<a name="line210">210: </a>        v  = aa + ai[m-1] + 1;
+<a name="line211">211: </a>        vj = aj + ai[m-1] + 1;
+<a name="line212">212: </a>        nz = 0;
+<a name="line213">213: </a>        <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
+<a name="line214">214: </a>          sum = b[i];
+<a name="line215">215: </a>          nz2 = ai[i] - ai[i-1] - 1;
+<a name="line216">216: </a>          PETSC_Prefetch(v-nz2-1,0,1);
+<a name="line217">217: </a>          PETSC_Prefetch(vj-nz2-1,0,1);
+<a name="line218">218: </a>          PetscSparseDenseMinusDot(sum,x,v,vj,nz);
+<a name="line219">219: </a>          nz   = nz2;
+<a name="line220">220: </a><font color="#A020F0">#endif</font>
+<a name="line221">221: </a>          x[i] = omega*sum*aidiag[i];
+<a name="line222">222: </a>          v  -= nz + 1;
+<a name="line223">223: </a>          vj -= nz + 1;
+<a name="line224">224: </a>        }
+<a name="line225">225: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2*a-&gt;nz);
+<a name="line226">226: </a>      } <font color="#4169E1">else</font> {
+<a name="line227">227: </a>        v  = aa + ai[m-1] + 1;
+<a name="line228">228: </a>        vj = aj + ai[m-1] + 1;
+<a name="line229">229: </a>        nz = 0;
+<a name="line230">230: </a>        <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
+<a name="line231">231: </a>          sum = t[i];
+<a name="line232">232: </a>          nz2 = ai[i] - ai[i-1] - 1;
+<a name="line233">233: </a>          PETSC_Prefetch(v-nz2-1,0,1);
+<a name="line234">234: </a>          PETSC_Prefetch(vj-nz2-1,0,1);
+<a name="line235">235: </a>          PetscSparseDenseMinusDot(sum,x,v,vj,nz);
+<a name="line236">236: </a>          x[i] = (1-omega)*x[i] + omega*sum*aidiag[i];
+<a name="line237">237: </a>          nz  = nz2;
+<a name="line238">238: </a>          v  -= nz + 1;
+<a name="line239">239: </a>          vj -= nz + 1;
+<a name="line240">240: </a>        }
+<a name="line241">241: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2*a-&gt;nz);
+<a name="line242">242: </a>      }
+<a name="line243">243: </a>    }
+<a name="line244">244: </a>    its--;
+<a name="line245">245: </a>  }
+
+<a name="line247">247: </a>  <font color="#4169E1">while</font> (its--) {
+<a name="line248">248: </a>    <font color="#B22222">/* </font>
+<a name="line249">249: </a><font color="#B22222">       forward sweep:</font>
+<a name="line250">250: </a><font color="#B22222">       for i=0,...,m-1:</font>
+<a name="line251">251: </a><font color="#B22222">         sum[i] = (b[i] - U(i,:)x )/d[i];</font>
+<a name="line252">252: </a><font color="#B22222">         x[i]   = (1-omega)x[i] + omega*sum[i];</font>
+<a name="line253">253: </a><font color="#B22222">         b      = b - x[i]*U^T(i,:);</font>
+<a name="line254">254: </a><font color="#B22222">         </font>
+<a name="line255">255: </a><font color="#B22222">    */</font>
+<a name="line256">256: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_FORWARD_SWEEP || flag &amp; SOR_LOCAL_FORWARD_SWEEP){
+<a name="line257">257: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(t,b,m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+
+<a name="line259">259: </a>      <font color="#4169E1">for</font> (i=0; i&lt;m; i++){
+<a name="line260">260: </a>        v  = aa + ai[i] + 1; v1=v;
+<a name="line261">261: </a>        vj = aj + ai[i] + 1; vj1=vj;
+<a name="line262">262: </a>        nz = ai[i+1] - ai[i] - 1; nz1=nz;
+<a name="line263">263: </a>        sum = t[i];
+<a name="line264">264: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(4.0*nz-2);
+<a name="line265">265: </a>        <font color="#4169E1">while</font> (nz1--) sum -= (*v1++)*x[*vj1++];
+<a name="line266">266: </a>        x[i] = (1-omega)*x[i] + omega*sum*aidiag[i];
+<a name="line267">267: </a>        <font color="#4169E1">while</font> (nz--) t[*vj++] -= x[i]*(*v++);
+<a name="line268">268: </a>      }
+<a name="line269">269: </a>    }
+<a name="line270">270: </a>
+<a name="line271">271: </a>    <font color="#4169E1">if</font> (flag &amp; SOR_BACKWARD_SWEEP || flag &amp; SOR_LOCAL_BACKWARD_SWEEP){
+<a name="line272">272: </a>      <font color="#B22222">/* </font>
+<a name="line273">273: </a><font color="#B22222">       backward sweep:</font>
+<a name="line274">274: </a><font color="#B22222">       b = b - x[i]*U^T(i,:), i=0,...,n-2</font>
+<a name="line275">275: </a><font color="#B22222">       for i=m-1,...,0:</font>
+<a name="line276">276: </a><font color="#B22222">         sum[i] = (b[i] - U(i,:)x )/d[i];</font>
+<a name="line277">277: </a><font color="#B22222">         x[i]   = (1-omega)x[i] + omega*sum[i];</font>
+<a name="line278">278: </a><font color="#B22222">      */</font>
+<a name="line279">279: </a>      <font color="#B22222">/* if there was a forward sweep done above then I thing the next two for loops are not needed */</font>
+<a name="line280">280: </a>      <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(t,b,m*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+<a name="line281">281: </a>
+<a name="line282">282: </a>      <font color="#4169E1">for</font> (i=0; i&lt;m-1; i++){  <font color="#B22222">/* update rhs */</font>
+<a name="line283">283: </a>        v  = aa + ai[i] + 1;
+<a name="line284">284: </a>        vj = aj + ai[i] + 1;
+<a name="line285">285: </a>        nz = ai[i+1] - ai[i] - 1;
+<a name="line286">286: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*nz-1);
+<a name="line287">287: </a>        <font color="#4169E1">while</font> (nz--) t[*vj++] -= x[i]*(*v++);
+<a name="line288">288: </a>      }
+<a name="line289">289: </a>      <font color="#4169E1">for</font> (i=m-1; i&gt;=0; i--){
+<a name="line290">290: </a>        v  = aa + ai[i] + 1;
+<a name="line291">291: </a>        vj = aj + ai[i] + 1;
+<a name="line292">292: </a>        nz = ai[i+1] - ai[i] - 1;
+<a name="line293">293: </a>        <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(2.0*nz-1);
+<a name="line294">294: </a>        sum = t[i];
+<a name="line295">295: </a>        <font color="#4169E1">while</font> (nz--) sum -= x[*vj++]*(*v++);
+<a name="line296">296: </a>        x[i] =   (1-omega)*x[i] + omega*sum*aidiag[i];
+<a name="line297">297: </a>      }
+<a name="line298">298: </a>    }
+<a name="line299">299: </a>  }
+
+<a name="line301">301: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xx,&amp;x);
+<a name="line302">302: </a>  <font color="#4169E1">if</font> (bb != xx) {
+<a name="line303">303: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(bb,(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>**)&amp;b);
+<a name="line304">304: </a>  }
+<a name="line305">305: </a>  <font color="#4169E1">return</font>(0);
+<a name="line306">306: </a>}
 </pre>
 </body>
 
Index: petsc/src/mat/impls/submat/submat.c
===================================================================
--- petsc.orig/src/mat/impls/submat/submat.c
+++ petsc/src/mat/impls/submat/submat.c
@@ -26,7 +26,7 @@
     if (!Na->olwork) {
       ierr = VecDuplicate(Na->left,&Na->olwork);CHKERRQ(ierr);
     }
-    ierr = VecPointwiseMult(Na->left,x,Na->olwork);CHKERRQ(ierr);
+    ierr = VecPointwiseMult(Na->olwork,x,Na->left);CHKERRQ(ierr);
     *xx = Na->olwork;
   }
   PetscFunctionReturn(0);
@@ -46,7 +46,7 @@
     if (!Na->orwork) {
       ierr = VecDuplicate(Na->right,&Na->orwork);CHKERRQ(ierr);
     }
-    ierr = VecPointwiseMult(Na->right,x,Na->orwork);CHKERRQ(ierr);
+    ierr = VecPointwiseMult(Na->orwork,x,Na->right);CHKERRQ(ierr);
     *xx = Na->orwork;
   }
   PetscFunctionReturn(0);
@@ -153,10 +153,23 @@
   ierr = VecScatterBegin(Na->rprolong,xx,Na->rwork,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
   ierr = VecScatterEnd  (Na->rprolong,xx,Na->rwork,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
   ierr = MatMult(Na->A,Na->rwork,Na->lwork);CHKERRQ(ierr);
-  ierr = VecScatterBegin(Na->lrestrict,Na->lwork,v3,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
-  ierr = VecScatterEnd  (Na->lrestrict,Na->lwork,v3,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
-  ierr = PostScaleLeft(N,v3);CHKERRQ(ierr);
-  ierr = VecAYPX(v3,Na->scale,v2);CHKERRQ(ierr);
+  if (v2 == v3) {
+    if (Na->scale == 1.0 && !Na->left) {
+      ierr = VecScatterBegin(Na->lrestrict,Na->lwork,v3,ADD_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+      ierr = VecScatterEnd  (Na->lrestrict,Na->lwork,v3,ADD_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+    } else {
+      if (!Na->olwork) {ierr = VecDuplicate(v3,&Na->olwork);CHKERRQ(ierr);}
+      ierr = VecScatterBegin(Na->lrestrict,Na->lwork,Na->olwork,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+      ierr = VecScatterEnd  (Na->lrestrict,Na->lwork,Na->olwork,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+      ierr = PostScaleLeft(N,Na->olwork);CHKERRQ(ierr);
+      ierr = VecAXPY(v3,Na->scale,Na->olwork);CHKERRQ(ierr);
+    }
+  } else {
+    ierr = VecScatterBegin(Na->lrestrict,Na->lwork,v3,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+    ierr = VecScatterEnd  (Na->lrestrict,Na->lwork,v3,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+    ierr = PostScaleLeft(N,v3);CHKERRQ(ierr);
+    ierr = VecAYPX(v3,Na->scale,v2);CHKERRQ(ierr);
+  }
   PetscFunctionReturn(0);
 }
 
@@ -174,8 +187,8 @@
   ierr = VecScatterBegin(Na->lrestrict,xx,Na->lwork,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
   ierr = VecScatterEnd  (Na->lrestrict,xx,Na->lwork,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
   ierr = MatMultTranspose(Na->A,Na->lwork,Na->rwork);CHKERRQ(ierr);
-  ierr = VecScatterBegin(Na->rprolong,Na->rwork,y,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
-  ierr = VecScatterEnd  (Na->rprolong,Na->rwork,y,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
+  ierr = VecScatterBegin(Na->rprolong,Na->rwork,y,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+  ierr = VecScatterEnd  (Na->rprolong,Na->rwork,y,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
   ierr = PostScaleRight(N,y);CHKERRQ(ierr);
   ierr = VecScale(y,Na->scale);CHKERRQ(ierr);
   PetscFunctionReturn(0);
@@ -195,10 +208,23 @@
   ierr = VecScatterBegin(Na->lrestrict,xx,Na->lwork,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
   ierr = VecScatterEnd  (Na->lrestrict,xx,Na->lwork,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
   ierr = MatMultTranspose(Na->A,Na->lwork,Na->rwork);CHKERRQ(ierr);
-  ierr = VecScatterBegin(Na->rprolong,Na->rwork,v3,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
-  ierr = VecScatterEnd  (Na->rprolong,Na->rwork,v3,INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);
-  ierr = PostScaleRight(N,v3);CHKERRQ(ierr);
-  ierr = VecAYPX(v3,Na->scale,v2);CHKERRQ(ierr);
+  if (v2 == v3) {
+    if (Na->scale == 1.0 && !Na->right) {
+      ierr = VecScatterBegin(Na->rprolong,Na->rwork,v3,ADD_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+      ierr = VecScatterEnd  (Na->rprolong,Na->rwork,v3,ADD_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+    } else {
+      if (!Na->orwork) {ierr = VecDuplicate(v3,&Na->orwork);CHKERRQ(ierr);}
+      ierr = VecScatterBegin(Na->rprolong,Na->rwork,Na->orwork,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+      ierr = VecScatterEnd  (Na->rprolong,Na->rwork,Na->orwork,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+      ierr = PostScaleRight(N,Na->orwork);CHKERRQ(ierr);
+      ierr = VecAXPY(v3,Na->scale,Na->orwork);CHKERRQ(ierr);
+    }
+  } else {
+    ierr = VecScatterBegin(Na->rprolong,Na->rwork,v3,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+    ierr = VecScatterEnd  (Na->rprolong,Na->rwork,v3,INSERT_VALUES,SCATTER_REVERSE);CHKERRQ(ierr);
+    ierr = PostScaleRight(N,v3);CHKERRQ(ierr);
+    ierr = VecAYPX(v3,Na->scale,v2);CHKERRQ(ierr);
+  }
   PetscFunctionReturn(0);
 }
 
Index: petsc/src/mat/impls/submat/submat.c.html
===================================================================
--- petsc.orig/src/mat/impls/submat/submat.c.html
+++ petsc/src/mat/impls/submat/submat.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:34:13+00:00">
+<meta name="date" content="2011-03-17T18:55:09+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -32,7 +32,7 @@
 <a name="line26"> 26: </a>    <font color="#4169E1">if</font> (!Na-&gt;olwork) {
 <a name="line27"> 27: </a>      <A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(Na-&gt;left,&amp;Na-&gt;olwork);
 <a name="line28"> 28: </a>    }
-<a name="line29"> 29: </a>    <A href="../../../../docs/manualpages/Vec/VecPointwiseMult.html#VecPointwiseMult">VecPointwiseMult</A>(Na-&gt;left,x,Na-&gt;olwork);
+<a name="line29"> 29: </a>    <A href="../../../../docs/manualpages/Vec/VecPointwiseMult.html#VecPointwiseMult">VecPointwiseMult</A>(Na-&gt;olwork,x,Na-&gt;left);
 <a name="line30"> 30: </a>    *xx = Na-&gt;olwork;
 <a name="line31"> 31: </a>  }
 <a name="line32"> 32: </a>  <font color="#4169E1">return</font>(0);
@@ -48,7 +48,7 @@
 <a name="line46"> 46: </a>    <font color="#4169E1">if</font> (!Na-&gt;orwork) {
 <a name="line47"> 47: </a>      <A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(Na-&gt;right,&amp;Na-&gt;orwork);
 <a name="line48"> 48: </a>    }
-<a name="line49"> 49: </a>    <A href="../../../../docs/manualpages/Vec/VecPointwiseMult.html#VecPointwiseMult">VecPointwiseMult</A>(Na-&gt;right,x,Na-&gt;orwork);
+<a name="line49"> 49: </a>    <A href="../../../../docs/manualpages/Vec/VecPointwiseMult.html#VecPointwiseMult">VecPointwiseMult</A>(Na-&gt;orwork,x,Na-&gt;right);
 <a name="line50"> 50: </a>    *xx = Na-&gt;orwork;
 <a name="line51"> 51: </a>  }
 <a name="line52"> 52: </a>  <font color="#4169E1">return</font>(0);
@@ -134,185 +134,211 @@
 <a name="line153">153: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,xx,Na-&gt;rwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
 <a name="line154">154: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,xx,Na-&gt;rwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
 <a name="line155">155: </a>  <A href="../../../../docs/manualpages/Mat/MatMult.html#MatMult">MatMult</A>(Na-&gt;A,Na-&gt;rwork,Na-&gt;lwork);
-<a name="line156">156: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,Na-&gt;lwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line157">157: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,Na-&gt;lwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line158">158: </a>  PostScaleLeft(N,v3);
-<a name="line159">159: </a>  <A href="../../../../docs/manualpages/Vec/VecAYPX.html#VecAYPX">VecAYPX</A>(v3,Na-&gt;scale,v2);
-<a name="line160">160: </a>  <font color="#4169E1">return</font>(0);
-<a name="line161">161: </a>}
-
-<a name="line165">165: </a><strong><font color="#4169E1"><a name="MatMultTranspose_SubMatrix"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMultTranspose_SubMatrix(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> x,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> y)</font></strong>
-<a name="line166">166: </a>{
-<a name="line167">167: </a>  Mat_SubMatrix  *Na = (Mat_SubMatrix*)N-&gt;data;
-<a name="line168">168: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>             xx=0;
-
-<a name="line172">172: </a>  PreScaleLeft(N,x,&amp;xx);
-<a name="line173">173: </a>  <A href="../../../../docs/manualpages/Vec/VecZeroEntries.html#VecZeroEntries">VecZeroEntries</A>(Na-&gt;lwork);
-<a name="line174">174: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
-<a name="line175">175: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
-<a name="line176">176: </a>  <A href="../../../../docs/manualpages/Mat/MatMultTranspose.html#MatMultTranspose">MatMultTranspose</A>(Na-&gt;A,Na-&gt;lwork,Na-&gt;rwork);
-<a name="line177">177: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,Na-&gt;rwork,y,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line178">178: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,Na-&gt;rwork,y,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line179">179: </a>  PostScaleRight(N,y);
-<a name="line180">180: </a>  <A href="../../../../docs/manualpages/Vec/VecScale.html#VecScale">VecScale</A>(y,Na-&gt;scale);
-<a name="line181">181: </a>  <font color="#4169E1">return</font>(0);
-<a name="line182">182: </a>}
-
-<a name="line186">186: </a><strong><font color="#4169E1"><a name="MatMultTransposeAdd_SubMatrix"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMultTransposeAdd_SubMatrix(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v1,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v2,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v3)</font></strong>
-<a name="line187">187: </a>{
-<a name="line188">188: </a>  Mat_SubMatrix  *Na = (Mat_SubMatrix*)N-&gt;data;
-<a name="line189">189: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>             xx =0;
-
-<a name="line193">193: </a>  PreScaleLeft(N,v1,&amp;xx);
-<a name="line194">194: </a>  <A href="../../../../docs/manualpages/Vec/VecZeroEntries.html#VecZeroEntries">VecZeroEntries</A>(Na-&gt;lwork);
-<a name="line195">195: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
-<a name="line196">196: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
-<a name="line197">197: </a>  <A href="../../../../docs/manualpages/Mat/MatMultTranspose.html#MatMultTranspose">MatMultTranspose</A>(Na-&gt;A,Na-&gt;lwork,Na-&gt;rwork);
-<a name="line198">198: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,Na-&gt;rwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line199">199: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,Na-&gt;rwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
-<a name="line200">200: </a>  PostScaleRight(N,v3);
-<a name="line201">201: </a>  <A href="../../../../docs/manualpages/Vec/VecAYPX.html#VecAYPX">VecAYPX</A>(v3,Na-&gt;scale,v2);
-<a name="line202">202: </a>  <font color="#4169E1">return</font>(0);
-<a name="line203">203: </a>}
-
-<a name="line207">207: </a><strong><font color="#4169E1"><a name="MatDestroy_SubMatrix"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatDestroy_SubMatrix(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N)</font></strong>
-<a name="line208">208: </a>{
-<a name="line209">209: </a>  Mat_SubMatrix  *Na = (Mat_SubMatrix*)N-&gt;data;
-
-<a name="line213">213: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(Na-&gt;isrow);
-<a name="line214">214: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(Na-&gt;iscol);
-<a name="line215">215: </a>  <font color="#4169E1">if</font> (Na-&gt;left) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;left);}
-<a name="line216">216: </a>  <font color="#4169E1">if</font> (Na-&gt;right) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;right);}
-<a name="line217">217: </a>  <font color="#4169E1">if</font> (Na-&gt;olwork) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;olwork);}
-<a name="line218">218: </a>  <font color="#4169E1">if</font> (Na-&gt;orwork) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;orwork);}
-<a name="line219">219: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;lwork);
-<a name="line220">220: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;rwork);
-<a name="line221">221: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(Na-&gt;lrestrict);
-<a name="line222">222: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(Na-&gt;rprolong);
-<a name="line223">223: </a>  <A href="../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>(Na-&gt;A);
-<a name="line224">224: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(Na);
-<a name="line225">225: </a>  <font color="#4169E1">return</font>(0);
-<a name="line226">226: </a>}
-
-<a name="line230">230: </a><font color="#B22222">/*@</font>
-<a name="line231">231: </a><font color="#B22222">   <A href="../../../../docs/manualpages/Mat/MatCreateSubMatrix.html#MatCreateSubMatrix">MatCreateSubMatrix</A> - Creates a composite matrix that acts as a submatrix</font>
-
-<a name="line233">233: </a><font color="#B22222">   Collective on <A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A></font>
-
-<a name="line235">235: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line236">236: </a><font color="#B22222">+  A - matrix that we will extract a submatrix of</font>
-<a name="line237">237: </a><font color="#B22222">.  isrow - rows to be present in the submatrix</font>
-<a name="line238">238: </a><font color="#B22222">-  iscol - columns to be present in the submatrix</font>
-
-<a name="line240">240: </a><font color="#B22222">   Output Parameters:</font>
-<a name="line241">241: </a><font color="#B22222">.  newmat - new matrix</font>
-
-<a name="line243">243: </a><font color="#B22222">   Level: developer</font>
-
-<a name="line245">245: </a><font color="#B22222">   Notes:</font>
-<a name="line246">246: </a><font color="#B22222">   Most will use <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A> which provides a more efficient representation if it is available.</font>
-
-<a name="line248">248: </a><font color="#B22222">.seealso: <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A>(), <A href="../../../../docs/manualpages/Mat/MatSubMatrixUpdate.html#MatSubMatrixUpdate">MatSubMatrixUpdate</A>()</font>
-<a name="line249">249: </a><font color="#B22222">@*/</font>
-<a name="line250">250: </a><strong><font color="#4169E1"><a name="MatCreateSubMatrix"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../docs/manualpages/Mat/MatCreateSubMatrix.html#MatCreateSubMatrix">MatCreateSubMatrix</A>(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> isrow,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> iscol,<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *newmat)</font></strong>
-<a name="line251">251: </a>{
-<a name="line252">252: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>            left,right;
-<a name="line253">253: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       m,n;
-<a name="line254">254: </a>  <A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            N;
-<a name="line255">255: </a>  Mat_SubMatrix *Na;
-
-<a name="line263">263: </a>  *newmat = 0;
-
-<a name="line265">265: </a>  <A href="../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;N);
-<a name="line266">266: </a>  <A href="../../../../docs/manualpages/IS/ISGetLocalSize.html#ISGetLocalSize">ISGetLocalSize</A>(isrow,&amp;m);
-<a name="line267">267: </a>  <A href="../../../../docs/manualpages/IS/ISGetLocalSize.html#ISGetLocalSize">ISGetLocalSize</A>(iscol,&amp;n);
-<a name="line268">268: </a>  <A href="../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(N,m,n,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>);
-<a name="line269">269: </a>  PetscObjectChangeTypeName((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)N,MATSUBMATRIX);
-
-<a name="line271">271: </a>  PetscNewLog(N,Mat_SubMatrix,&amp;Na);
-<a name="line272">272: </a>  N-&gt;data   = (void*)Na;
-<a name="line273">273: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A);
-<a name="line274">274: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)isrow);
-<a name="line275">275: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)iscol);
-<a name="line276">276: </a>  Na-&gt;A     = A;
-<a name="line277">277: </a>  Na-&gt;isrow = isrow;
-<a name="line278">278: </a>  Na-&gt;iscol = iscol;
-<a name="line279">279: </a>  Na-&gt;scale = 1.0;
-
-<a name="line281">281: </a>  N-&gt;ops-&gt;destroy          = MatDestroy_SubMatrix;
-<a name="line282">282: </a>  N-&gt;ops-&gt;mult             = MatMult_SubMatrix;
-<a name="line283">283: </a>  N-&gt;ops-&gt;multadd          = MatMultAdd_SubMatrix;
-<a name="line284">284: </a>  N-&gt;ops-&gt;multtranspose    = MatMultTranspose_SubMatrix;
-<a name="line285">285: </a>  N-&gt;ops-&gt;multtransposeadd = MatMultTransposeAdd_SubMatrix;
-<a name="line286">286: </a>  N-&gt;ops-&gt;scale            = MatScale_SubMatrix;
-<a name="line287">287: </a>  N-&gt;ops-&gt;diagonalscale    = MatDiagonalScale_SubMatrix;
-
-<a name="line289">289: </a>  N-&gt;assembled = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-
-<a name="line291">291: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetBlockSize.html#PetscLayoutSetBlockSize">PetscLayoutSetBlockSize</A>(N-&gt;rmap,A-&gt;rmap-&gt;bs);
-<a name="line292">292: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetBlockSize.html#PetscLayoutSetBlockSize">PetscLayoutSetBlockSize</A>(N-&gt;cmap,A-&gt;cmap-&gt;bs);
-<a name="line293">293: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetUp.html#PetscLayoutSetUp">PetscLayoutSetUp</A>(N-&gt;rmap);
-<a name="line294">294: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetUp.html#PetscLayoutSetUp">PetscLayoutSetUp</A>(N-&gt;cmap);
-
-<a name="line296">296: </a>  <A href="../../../../docs/manualpages/Mat/MatGetVecs.html#MatGetVecs">MatGetVecs</A>(A,&amp;Na-&gt;rwork,&amp;Na-&gt;lwork);
-<a name="line297">297: </a>  <A href="../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)isrow)-&gt;comm,&amp;left);
-<a name="line298">298: </a>  <A href="../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)iscol)-&gt;comm,&amp;right);
-<a name="line299">299: </a>  <A href="../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(left,m,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>);
-<a name="line300">300: </a>  <A href="../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(right,n,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>);
-<a name="line301">301: </a>  <A href="../../../../docs/manualpages/Vec/VecSetUp.html#VecSetUp">VecSetUp</A>(left);
-<a name="line302">302: </a>  <A href="../../../../docs/manualpages/Vec/VecSetUp.html#VecSetUp">VecSetUp</A>(right);
-<a name="line303">303: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(Na-&gt;lwork,isrow,left,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,&amp;Na-&gt;lrestrict);
-<a name="line304">304: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(right,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,Na-&gt;rwork,iscol,&amp;Na-&gt;rprolong);
-<a name="line305">305: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(left);
-<a name="line306">306: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(right);
-
-<a name="line308">308: </a>  *newmat = N;
-<a name="line309">309: </a>  <font color="#4169E1">return</font>(0);
-<a name="line310">310: </a>}
-
-
-<a name="line315">315: </a><font color="#B22222">/*@</font>
-<a name="line316">316: </a><font color="#B22222">   <A href="../../../../docs/manualpages/Mat/MatSubMatrixUpdate.html#MatSubMatrixUpdate">MatSubMatrixUpdate</A> - Updates a submatrix</font>
-
-<a name="line318">318: </a><font color="#B22222">   Collective on <A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A></font>
-
-<a name="line320">320: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line321">321: </a><font color="#B22222">+  N - submatrix to update</font>
-<a name="line322">322: </a><font color="#B22222">.  A - full matrix in the submatrix</font>
-<a name="line323">323: </a><font color="#B22222">.  isrow - rows in the update (same as the first time the submatrix was created)</font>
-<a name="line324">324: </a><font color="#B22222">-  iscol - columns in the update (same as the first time the submatrix was created)</font>
-
-<a name="line326">326: </a><font color="#B22222">   Level: developer</font>
-
-<a name="line328">328: </a><font color="#B22222">   Notes:</font>
-<a name="line329">329: </a><font color="#B22222">   Most will use <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A> which provides a more efficient representation if it is available.</font>
-
-<a name="line331">331: </a><font color="#B22222">.seealso: <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A>(), <A href="../../../../docs/manualpages/Mat/MatCreateSubMatrix.html#MatCreateSubMatrix">MatCreateSubMatrix</A>()</font>
-<a name="line332">332: </a><font color="#B22222">@*/</font>
-<a name="line333">333: </a><strong><font color="#4169E1"><a name="MatSubMatrixUpdate"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../docs/manualpages/Mat/MatSubMatrixUpdate.html#MatSubMatrixUpdate">MatSubMatrixUpdate</A>(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N,<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> isrow,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> iscol)</font></strong>
-<a name="line334">334: </a>{
-<a name="line335">335: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  ierr;
-<a name="line336">336: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>      flg;
-<a name="line337">337: </a>  Mat_SubMatrix  *Na;
-
-<a name="line344">344: </a>  <A href="../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)N,MATSUBMATRIX,&amp;flg);
-<a name="line345">345: </a>  <font color="#4169E1">if</font> (!flg) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Matrix has wrong type"</font>);
-
-<a name="line347">347: </a>  Na = (Mat_SubMatrix*)N-&gt;data;
-<a name="line348">348: </a>  <A href="../../../../docs/manualpages/IS/ISEqual.html#ISEqual">ISEqual</A>(isrow,Na-&gt;isrow,&amp;flg);
-<a name="line349">349: </a>  <font color="#4169E1">if</font> (!flg) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_INCOMP,<font color="#666666">"Cannot update submatrix with different row indices"</font>);
-<a name="line350">350: </a>  <A href="../../../../docs/manualpages/IS/ISEqual.html#ISEqual">ISEqual</A>(iscol,Na-&gt;iscol,&amp;flg);
-<a name="line351">351: </a>  <font color="#4169E1">if</font> (!flg) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_INCOMP,<font color="#666666">"Cannot update submatrix with different column indices"</font>);
-
-<a name="line353">353: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A);
-<a name="line354">354: </a>  <A href="../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>(Na-&gt;A);
-<a name="line355">355: </a>  Na-&gt;A = A;
-
-<a name="line357">357: </a>  Na-&gt;scale = 1.0;
-<a name="line358">358: </a>  <font color="#4169E1">if</font> (Na-&gt;left) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;left);}
-<a name="line359">359: </a>  <font color="#4169E1">if</font> (Na-&gt;right) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;right);}
-<a name="line360">360: </a>  <font color="#4169E1">return</font>(0);
-<a name="line361">361: </a>}
+<a name="line156">156: </a>  <font color="#4169E1">if</font> (v2 == v3) {
+<a name="line157">157: </a>    <font color="#4169E1">if</font> (Na-&gt;scale == 1.0 &amp;&amp; !Na-&gt;left) {
+<a name="line158">158: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,Na-&gt;lwork,v3,<A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line159">159: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,Na-&gt;lwork,v3,<A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line160">160: </a>    } <font color="#4169E1">else</font> {
+<a name="line161">161: </a>      <font color="#4169E1">if</font> (!Na-&gt;olwork) {<A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(v3,&amp;Na-&gt;olwork);}
+<a name="line162">162: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,Na-&gt;lwork,Na-&gt;olwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line163">163: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,Na-&gt;lwork,Na-&gt;olwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line164">164: </a>      PostScaleLeft(N,Na-&gt;olwork);
+<a name="line165">165: </a>      <A href="../../../../docs/manualpages/Vec/VecAXPY.html#VecAXPY">VecAXPY</A>(v3,Na-&gt;scale,Na-&gt;olwork);
+<a name="line166">166: </a>    }
+<a name="line167">167: </a>  } <font color="#4169E1">else</font> {
+<a name="line168">168: </a>    <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,Na-&gt;lwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line169">169: </a>    <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,Na-&gt;lwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_FORWARD.html#SCATTER_FORWARD">SCATTER_FORWARD</A>);
+<a name="line170">170: </a>    PostScaleLeft(N,v3);
+<a name="line171">171: </a>    <A href="../../../../docs/manualpages/Vec/VecAYPX.html#VecAYPX">VecAYPX</A>(v3,Na-&gt;scale,v2);
+<a name="line172">172: </a>  }
+<a name="line173">173: </a>  <font color="#4169E1">return</font>(0);
+<a name="line174">174: </a>}
+
+<a name="line178">178: </a><strong><font color="#4169E1"><a name="MatMultTranspose_SubMatrix"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMultTranspose_SubMatrix(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> x,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> y)</font></strong>
+<a name="line179">179: </a>{
+<a name="line180">180: </a>  Mat_SubMatrix  *Na = (Mat_SubMatrix*)N-&gt;data;
+<a name="line181">181: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>             xx=0;
+
+<a name="line185">185: </a>  PreScaleLeft(N,x,&amp;xx);
+<a name="line186">186: </a>  <A href="../../../../docs/manualpages/Vec/VecZeroEntries.html#VecZeroEntries">VecZeroEntries</A>(Na-&gt;lwork);
+<a name="line187">187: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line188">188: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line189">189: </a>  <A href="../../../../docs/manualpages/Mat/MatMultTranspose.html#MatMultTranspose">MatMultTranspose</A>(Na-&gt;A,Na-&gt;lwork,Na-&gt;rwork);
+<a name="line190">190: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,Na-&gt;rwork,y,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line191">191: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,Na-&gt;rwork,y,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line192">192: </a>  PostScaleRight(N,y);
+<a name="line193">193: </a>  <A href="../../../../docs/manualpages/Vec/VecScale.html#VecScale">VecScale</A>(y,Na-&gt;scale);
+<a name="line194">194: </a>  <font color="#4169E1">return</font>(0);
+<a name="line195">195: </a>}
+
+<a name="line199">199: </a><strong><font color="#4169E1"><a name="MatMultTransposeAdd_SubMatrix"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatMultTransposeAdd_SubMatrix(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v1,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v2,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v3)</font></strong>
+<a name="line200">200: </a>{
+<a name="line201">201: </a>  Mat_SubMatrix  *Na = (Mat_SubMatrix*)N-&gt;data;
+<a name="line202">202: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>             xx =0;
+
+<a name="line206">206: </a>  PreScaleLeft(N,v1,&amp;xx);
+<a name="line207">207: </a>  <A href="../../../../docs/manualpages/Vec/VecZeroEntries.html#VecZeroEntries">VecZeroEntries</A>(Na-&gt;lwork);
+<a name="line208">208: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line209">209: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;lrestrict,xx,Na-&gt;lwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line210">210: </a>  <A href="../../../../docs/manualpages/Mat/MatMultTranspose.html#MatMultTranspose">MatMultTranspose</A>(Na-&gt;A,Na-&gt;lwork,Na-&gt;rwork);
+<a name="line211">211: </a>  <font color="#4169E1">if</font> (v2 == v3) {
+<a name="line212">212: </a>    <font color="#4169E1">if</font> (Na-&gt;scale == 1.0 &amp;&amp; !Na-&gt;right) {
+<a name="line213">213: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,Na-&gt;rwork,v3,<A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line214">214: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,Na-&gt;rwork,v3,<A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line215">215: </a>    } <font color="#4169E1">else</font> {
+<a name="line216">216: </a>      <font color="#4169E1">if</font> (!Na-&gt;orwork) {<A href="../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(v3,&amp;Na-&gt;orwork);}
+<a name="line217">217: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,Na-&gt;rwork,Na-&gt;orwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line218">218: </a>      <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,Na-&gt;rwork,Na-&gt;orwork,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line219">219: </a>      PostScaleRight(N,Na-&gt;orwork);
+<a name="line220">220: </a>      <A href="../../../../docs/manualpages/Vec/VecAXPY.html#VecAXPY">VecAXPY</A>(v3,Na-&gt;scale,Na-&gt;orwork);
+<a name="line221">221: </a>    }
+<a name="line222">222: </a>  } <font color="#4169E1">else</font> {
+<a name="line223">223: </a>    <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>(Na-&gt;rprolong,Na-&gt;rwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line224">224: </a>    <A href="../../../../docs/manualpages/Vec/VecScatterEnd.html#VecScatterEnd">VecScatterEnd</A>  (Na-&gt;rprolong,Na-&gt;rwork,v3,<A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>,<A href="../../../../docs/manualpages/Sys/SCATTER_REVERSE.html#SCATTER_REVERSE">SCATTER_REVERSE</A>);
+<a name="line225">225: </a>    PostScaleRight(N,v3);
+<a name="line226">226: </a>    <A href="../../../../docs/manualpages/Vec/VecAYPX.html#VecAYPX">VecAYPX</A>(v3,Na-&gt;scale,v2);
+<a name="line227">227: </a>  }
+<a name="line228">228: </a>  <font color="#4169E1">return</font>(0);
+<a name="line229">229: </a>}
+
+<a name="line233">233: </a><strong><font color="#4169E1"><a name="MatDestroy_SubMatrix"></a>static <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> MatDestroy_SubMatrix(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N)</font></strong>
+<a name="line234">234: </a>{
+<a name="line235">235: </a>  Mat_SubMatrix  *Na = (Mat_SubMatrix*)N-&gt;data;
+
+<a name="line239">239: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(Na-&gt;isrow);
+<a name="line240">240: </a>  <A href="../../../../docs/manualpages/IS/ISDestroy.html#ISDestroy">ISDestroy</A>(Na-&gt;iscol);
+<a name="line241">241: </a>  <font color="#4169E1">if</font> (Na-&gt;left) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;left);}
+<a name="line242">242: </a>  <font color="#4169E1">if</font> (Na-&gt;right) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;right);}
+<a name="line243">243: </a>  <font color="#4169E1">if</font> (Na-&gt;olwork) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;olwork);}
+<a name="line244">244: </a>  <font color="#4169E1">if</font> (Na-&gt;orwork) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;orwork);}
+<a name="line245">245: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;lwork);
+<a name="line246">246: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;rwork);
+<a name="line247">247: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(Na-&gt;lrestrict);
+<a name="line248">248: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterDestroy.html#VecScatterDestroy">VecScatterDestroy</A>(Na-&gt;rprolong);
+<a name="line249">249: </a>  <A href="../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>(Na-&gt;A);
+<a name="line250">250: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(Na);
+<a name="line251">251: </a>  <font color="#4169E1">return</font>(0);
+<a name="line252">252: </a>}
+
+<a name="line256">256: </a><font color="#B22222">/*@</font>
+<a name="line257">257: </a><font color="#B22222">   <A href="../../../../docs/manualpages/Mat/MatCreateSubMatrix.html#MatCreateSubMatrix">MatCreateSubMatrix</A> - Creates a composite matrix that acts as a submatrix</font>
+
+<a name="line259">259: </a><font color="#B22222">   Collective on <A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A></font>
+
+<a name="line261">261: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line262">262: </a><font color="#B22222">+  A - matrix that we will extract a submatrix of</font>
+<a name="line263">263: </a><font color="#B22222">.  isrow - rows to be present in the submatrix</font>
+<a name="line264">264: </a><font color="#B22222">-  iscol - columns to be present in the submatrix</font>
+
+<a name="line266">266: </a><font color="#B22222">   Output Parameters:</font>
+<a name="line267">267: </a><font color="#B22222">.  newmat - new matrix</font>
+
+<a name="line269">269: </a><font color="#B22222">   Level: developer</font>
+
+<a name="line271">271: </a><font color="#B22222">   Notes:</font>
+<a name="line272">272: </a><font color="#B22222">   Most will use <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A> which provides a more efficient representation if it is available.</font>
+
+<a name="line274">274: </a><font color="#B22222">.seealso: <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A>(), <A href="../../../../docs/manualpages/Mat/MatSubMatrixUpdate.html#MatSubMatrixUpdate">MatSubMatrixUpdate</A>()</font>
+<a name="line275">275: </a><font color="#B22222">@*/</font>
+<a name="line276">276: </a><strong><font color="#4169E1"><a name="MatCreateSubMatrix"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../docs/manualpages/Mat/MatCreateSubMatrix.html#MatCreateSubMatrix">MatCreateSubMatrix</A>(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> isrow,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> iscol,<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> *newmat)</font></strong>
+<a name="line277">277: </a>{
+<a name="line278">278: </a>  <A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>            left,right;
+<a name="line279">279: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       m,n;
+<a name="line280">280: </a>  <A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A>            N;
+<a name="line281">281: </a>  Mat_SubMatrix *Na;
+
+<a name="line289">289: </a>  *newmat = 0;
+
+<a name="line291">291: </a>  <A href="../../../../docs/manualpages/Mat/MatCreate.html#MatCreate">MatCreate</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A)-&gt;comm,&amp;N);
+<a name="line292">292: </a>  <A href="../../../../docs/manualpages/IS/ISGetLocalSize.html#ISGetLocalSize">ISGetLocalSize</A>(isrow,&amp;m);
+<a name="line293">293: </a>  <A href="../../../../docs/manualpages/IS/ISGetLocalSize.html#ISGetLocalSize">ISGetLocalSize</A>(iscol,&amp;n);
+<a name="line294">294: </a>  <A href="../../../../docs/manualpages/Mat/MatSetSizes.html#MatSetSizes">MatSetSizes</A>(N,m,n,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>);
+<a name="line295">295: </a>  PetscObjectChangeTypeName((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)N,MATSUBMATRIX);
+
+<a name="line297">297: </a>  PetscNewLog(N,Mat_SubMatrix,&amp;Na);
+<a name="line298">298: </a>  N-&gt;data   = (void*)Na;
+<a name="line299">299: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A);
+<a name="line300">300: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)isrow);
+<a name="line301">301: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)iscol);
+<a name="line302">302: </a>  Na-&gt;A     = A;
+<a name="line303">303: </a>  Na-&gt;isrow = isrow;
+<a name="line304">304: </a>  Na-&gt;iscol = iscol;
+<a name="line305">305: </a>  Na-&gt;scale = 1.0;
+
+<a name="line307">307: </a>  N-&gt;ops-&gt;destroy          = MatDestroy_SubMatrix;
+<a name="line308">308: </a>  N-&gt;ops-&gt;mult             = MatMult_SubMatrix;
+<a name="line309">309: </a>  N-&gt;ops-&gt;multadd          = MatMultAdd_SubMatrix;
+<a name="line310">310: </a>  N-&gt;ops-&gt;multtranspose    = MatMultTranspose_SubMatrix;
+<a name="line311">311: </a>  N-&gt;ops-&gt;multtransposeadd = MatMultTransposeAdd_SubMatrix;
+<a name="line312">312: </a>  N-&gt;ops-&gt;scale            = MatScale_SubMatrix;
+<a name="line313">313: </a>  N-&gt;ops-&gt;diagonalscale    = MatDiagonalScale_SubMatrix;
+
+<a name="line315">315: </a>  N-&gt;assembled = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+
+<a name="line317">317: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetBlockSize.html#PetscLayoutSetBlockSize">PetscLayoutSetBlockSize</A>(N-&gt;rmap,A-&gt;rmap-&gt;bs);
+<a name="line318">318: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetBlockSize.html#PetscLayoutSetBlockSize">PetscLayoutSetBlockSize</A>(N-&gt;cmap,A-&gt;cmap-&gt;bs);
+<a name="line319">319: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetUp.html#PetscLayoutSetUp">PetscLayoutSetUp</A>(N-&gt;rmap);
+<a name="line320">320: </a>  <A href="../../../../docs/manualpages/Vec/PetscLayoutSetUp.html#PetscLayoutSetUp">PetscLayoutSetUp</A>(N-&gt;cmap);
+
+<a name="line322">322: </a>  <A href="../../../../docs/manualpages/Mat/MatGetVecs.html#MatGetVecs">MatGetVecs</A>(A,&amp;Na-&gt;rwork,&amp;Na-&gt;lwork);
+<a name="line323">323: </a>  <A href="../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)isrow)-&gt;comm,&amp;left);
+<a name="line324">324: </a>  <A href="../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)iscol)-&gt;comm,&amp;right);
+<a name="line325">325: </a>  <A href="../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(left,m,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>);
+<a name="line326">326: </a>  <A href="../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(right,n,<A href="../../../../docs/manualpages/Sys/PETSC_DETERMINE.html#PETSC_DETERMINE">PETSC_DETERMINE</A>);
+<a name="line327">327: </a>  <A href="../../../../docs/manualpages/Vec/VecSetUp.html#VecSetUp">VecSetUp</A>(left);
+<a name="line328">328: </a>  <A href="../../../../docs/manualpages/Vec/VecSetUp.html#VecSetUp">VecSetUp</A>(right);
+<a name="line329">329: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(Na-&gt;lwork,isrow,left,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,&amp;Na-&gt;lrestrict);
+<a name="line330">330: </a>  <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(right,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,Na-&gt;rwork,iscol,&amp;Na-&gt;rprolong);
+<a name="line331">331: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(left);
+<a name="line332">332: </a>  <A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(right);
+
+<a name="line334">334: </a>  *newmat = N;
+<a name="line335">335: </a>  <font color="#4169E1">return</font>(0);
+<a name="line336">336: </a>}
+
+
+<a name="line341">341: </a><font color="#B22222">/*@</font>
+<a name="line342">342: </a><font color="#B22222">   <A href="../../../../docs/manualpages/Mat/MatSubMatrixUpdate.html#MatSubMatrixUpdate">MatSubMatrixUpdate</A> - Updates a submatrix</font>
+
+<a name="line344">344: </a><font color="#B22222">   Collective on <A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A></font>
+
+<a name="line346">346: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line347">347: </a><font color="#B22222">+  N - submatrix to update</font>
+<a name="line348">348: </a><font color="#B22222">.  A - full matrix in the submatrix</font>
+<a name="line349">349: </a><font color="#B22222">.  isrow - rows in the update (same as the first time the submatrix was created)</font>
+<a name="line350">350: </a><font color="#B22222">-  iscol - columns in the update (same as the first time the submatrix was created)</font>
+
+<a name="line352">352: </a><font color="#B22222">   Level: developer</font>
+
+<a name="line354">354: </a><font color="#B22222">   Notes:</font>
+<a name="line355">355: </a><font color="#B22222">   Most will use <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A> which provides a more efficient representation if it is available.</font>
+
+<a name="line357">357: </a><font color="#B22222">.seealso: <A href="../../../../docs/manualpages/Mat/MatGetSubMatrix.html#MatGetSubMatrix">MatGetSubMatrix</A>(), <A href="../../../../docs/manualpages/Mat/MatCreateSubMatrix.html#MatCreateSubMatrix">MatCreateSubMatrix</A>()</font>
+<a name="line358">358: </a><font color="#B22222">@*/</font>
+<a name="line359">359: </a><strong><font color="#4169E1"><a name="MatSubMatrixUpdate"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../docs/manualpages/Mat/MatSubMatrixUpdate.html#MatSubMatrixUpdate">MatSubMatrixUpdate</A>(<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> N,<A href="../../../../docs/manualpages/Mat/Mat.html#Mat">Mat</A> A,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> isrow,<A href="../../../../docs/manualpages/IS/IS.html#IS">IS</A> iscol)</font></strong>
+<a name="line360">360: </a>{
+<a name="line361">361: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  ierr;
+<a name="line362">362: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>      flg;
+<a name="line363">363: </a>  Mat_SubMatrix  *Na;
+
+<a name="line370">370: </a>  <A href="../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)N,MATSUBMATRIX,&amp;flg);
+<a name="line371">371: </a>  <font color="#4169E1">if</font> (!flg) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Matrix has wrong type"</font>);
+
+<a name="line373">373: </a>  Na = (Mat_SubMatrix*)N-&gt;data;
+<a name="line374">374: </a>  <A href="../../../../docs/manualpages/IS/ISEqual.html#ISEqual">ISEqual</A>(isrow,Na-&gt;isrow,&amp;flg);
+<a name="line375">375: </a>  <font color="#4169E1">if</font> (!flg) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_INCOMP,<font color="#666666">"Cannot update submatrix with different row indices"</font>);
+<a name="line376">376: </a>  <A href="../../../../docs/manualpages/IS/ISEqual.html#ISEqual">ISEqual</A>(iscol,Na-&gt;iscol,&amp;flg);
+<a name="line377">377: </a>  <font color="#4169E1">if</font> (!flg) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_INCOMP,<font color="#666666">"Cannot update submatrix with different column indices"</font>);
+
+<a name="line379">379: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)A);
+<a name="line380">380: </a>  <A href="../../../../docs/manualpages/Mat/MatDestroy.html#MatDestroy">MatDestroy</A>(Na-&gt;A);
+<a name="line381">381: </a>  Na-&gt;A = A;
+
+<a name="line383">383: </a>  Na-&gt;scale = 1.0;
+<a name="line384">384: </a>  <font color="#4169E1">if</font> (Na-&gt;left) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;left);}
+<a name="line385">385: </a>  <font color="#4169E1">if</font> (Na-&gt;right) {<A href="../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>(Na-&gt;right);}
+<a name="line386">386: </a>  <font color="#4169E1">return</font>(0);
+<a name="line387">387: </a>}
 </pre>
 </body>
 
Index: petsc/src/mat/utils/getcolv.c
===================================================================
--- petsc.orig/src/mat/utils/getcolv.c
+++ petsc/src/mat/utils/getcolv.c
@@ -127,21 +127,21 @@
   ierr = PetscMemzero(work,n*sizeof(PetscReal));CHKERRQ(ierr);  
   if (type == NORM_2) {
     for (i=0; i<a_aij->i[aij->A->rmap->n]; i++) {
-      work[A->rmap->rstart + a_aij->j[i]] += PetscAbsScalar(a_aij->a[i]*a_aij->a[i]);
+      work[A->cmap->rstart + a_aij->j[i]] += PetscAbsScalar(a_aij->a[i]*a_aij->a[i]);
     }
     for (i=0; i<b_aij->i[aij->B->rmap->n]; i++) {
       work[garray[b_aij->j[i]]] += PetscAbsScalar(b_aij->a[i]*b_aij->a[i]);
     }
   } else if (type == NORM_1) {
     for (i=0; i<a_aij->i[aij->A->rmap->n]; i++) {
-      work[A->rmap->rstart + a_aij->j[i]] += PetscAbsScalar(a_aij->a[i]);
+      work[A->cmap->rstart + a_aij->j[i]] += PetscAbsScalar(a_aij->a[i]);
     }
     for (i=0; i<b_aij->i[aij->B->rmap->n]; i++) {
       work[garray[b_aij->j[i]]] += PetscAbsScalar(b_aij->a[i]);
     }
   } else if (type == NORM_INFINITY) {
     for (i=0; i<a_aij->i[aij->A->rmap->n]; i++) {
-      work[A->rmap->rstart + a_aij->j[i]] = PetscMax(PetscAbsScalar(a_aij->a[i]), work[A->rmap->rstart + a_aij->j[i]]);
+      work[A->cmap->rstart + a_aij->j[i]] = PetscMax(PetscAbsScalar(a_aij->a[i]), work[A->cmap->rstart + a_aij->j[i]]);
     }
     for (i=0; i<b_aij->i[aij->B->rmap->n]; i++) {
       work[garray[b_aij->j[i]]] = PetscMax(PetscAbsScalar(b_aij->a[i]),work[garray[b_aij->j[i]]]);
Index: petsc/src/mat/utils/getcolv.c.html
===================================================================
--- petsc.orig/src/mat/utils/getcolv.c.html
+++ petsc/src/mat/utils/getcolv.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:35:29+00:00">
+<meta name="date" content="2011-03-17T18:56:26+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -124,21 +124,21 @@
 <a name="line127">127: </a>  <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(work,n*<font color="#4169E1">sizeof</font>(<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>));
 <a name="line128">128: </a>  <font color="#4169E1">if</font> (type == <A href="../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>) {
 <a name="line129">129: </a>    <font color="#4169E1">for</font> (i=0; i&lt;a_aij-&gt;i[aij-&gt;A-&gt;rmap-&gt;n]; i++) {
-<a name="line130">130: </a>      work[A-&gt;rmap-&gt;rstart + a_aij-&gt;j[i]] += PetscAbsScalar(a_aij-&gt;a[i]*a_aij-&gt;a[i]);
+<a name="line130">130: </a>      work[A-&gt;cmap-&gt;rstart + a_aij-&gt;j[i]] += PetscAbsScalar(a_aij-&gt;a[i]*a_aij-&gt;a[i]);
 <a name="line131">131: </a>    }
 <a name="line132">132: </a>    <font color="#4169E1">for</font> (i=0; i&lt;b_aij-&gt;i[aij-&gt;B-&gt;rmap-&gt;n]; i++) {
 <a name="line133">133: </a>      work[garray[b_aij-&gt;j[i]]] += PetscAbsScalar(b_aij-&gt;a[i]*b_aij-&gt;a[i]);
 <a name="line134">134: </a>    }
 <a name="line135">135: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../docs/manualpages/Vec/NORM_1.html#NORM_1">NORM_1</A>) {
 <a name="line136">136: </a>    <font color="#4169E1">for</font> (i=0; i&lt;a_aij-&gt;i[aij-&gt;A-&gt;rmap-&gt;n]; i++) {
-<a name="line137">137: </a>      work[A-&gt;rmap-&gt;rstart + a_aij-&gt;j[i]] += PetscAbsScalar(a_aij-&gt;a[i]);
+<a name="line137">137: </a>      work[A-&gt;cmap-&gt;rstart + a_aij-&gt;j[i]] += PetscAbsScalar(a_aij-&gt;a[i]);
 <a name="line138">138: </a>    }
 <a name="line139">139: </a>    <font color="#4169E1">for</font> (i=0; i&lt;b_aij-&gt;i[aij-&gt;B-&gt;rmap-&gt;n]; i++) {
 <a name="line140">140: </a>      work[garray[b_aij-&gt;j[i]]] += PetscAbsScalar(b_aij-&gt;a[i]);
 <a name="line141">141: </a>    }
 <a name="line142">142: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>) {
 <a name="line143">143: </a>    <font color="#4169E1">for</font> (i=0; i&lt;a_aij-&gt;i[aij-&gt;A-&gt;rmap-&gt;n]; i++) {
-<a name="line144">144: </a>      work[A-&gt;rmap-&gt;rstart + a_aij-&gt;j[i]] = PetscMax(PetscAbsScalar(a_aij-&gt;a[i]), work[A-&gt;rmap-&gt;rstart + a_aij-&gt;j[i]]);
+<a name="line144">144: </a>      work[A-&gt;cmap-&gt;rstart + a_aij-&gt;j[i]] = PetscMax(PetscAbsScalar(a_aij-&gt;a[i]), work[A-&gt;cmap-&gt;rstart + a_aij-&gt;j[i]]);
 <a name="line145">145: </a>    }
 <a name="line146">146: </a>    <font color="#4169E1">for</font> (i=0; i&lt;b_aij-&gt;i[aij-&gt;B-&gt;rmap-&gt;n]; i++) {
 <a name="line147">147: </a>      work[garray[b_aij-&gt;j[i]]] = PetscMax(PetscAbsScalar(b_aij-&gt;a[i]),work[garray[b_aij-&gt;j[i]]]);
Index: petsc/src/snes/interface/snesj.c
===================================================================
--- petsc.orig/src/snes/interface/snesj.c
+++ petsc/src/snes/interface/snesj.c
@@ -110,6 +110,8 @@
     } else {
       wscale = 0.0;
     }
+    ierr = VecAssemblyBegin(x2);CHKERRQ(ierr);
+    ierr = VecAssemblyEnd(x2);CHKERRQ(ierr);
     ierr = (*eval_fct)(snes,x2,j2a);CHKERRQ(ierr);
     ierr = VecAXPY(j2a,-1.0,j1a);CHKERRQ(ierr);
     /* Communicate scale=1/dx_i to all processors */
Index: petsc/src/snes/interface/snesj.c.html
===================================================================
--- petsc.orig/src/snes/interface/snesj.c.html
+++ petsc/src/snes/interface/snesj.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:42:47+00:00">
+<meta name="date" content="2011-03-17T19:06:38+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -116,36 +116,38 @@
 <a name="line110">110: </a>    } <font color="#4169E1">else</font> {
 <a name="line111">111: </a>      wscale = 0.0;
 <a name="line112">112: </a>    }
-<a name="line113">113: </a>    (*eval_fct)(snes,x2,j2a);
-<a name="line114">114: </a>    <A href="../../../docs/manualpages/Vec/VecAXPY.html#VecAXPY">VecAXPY</A>(j2a,-1.0,j1a);
-<a name="line115">115: </a>    <font color="#B22222">/* Communicate scale=1/dx_i to all processors */</font>
-<a name="line116">116: </a>    <A href="../../../docs/manualpages/Vec/VecGetOwnershipRanges.html#VecGetOwnershipRanges">VecGetOwnershipRanges</A>(x1,&amp;ranges);
-<a name="line117">117: </a>    root = size;
-<a name="line118">118: </a>    <font color="#4169E1">for</font> (j=size-1; j&gt;-1; j--){
-<a name="line119">119: </a>      root--;
-<a name="line120">120: </a>      <font color="#4169E1">if</font> (i&gt;=ranges[j]) <font color="#4169E1">break</font>;
-<a name="line121">121: </a>    }
-<a name="line122">122: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;wscale,1,<A href="../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,root,comm);
-
-<a name="line124">124: </a>    <A href="../../../docs/manualpages/Vec/VecScale.html#VecScale">VecScale</A>(j2a,wscale);
-<a name="line125">125: </a>    <A href="../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(j2a,<A href="../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>,&amp;amax); amax *= 1.e-14;
-<a name="line126">126: </a>    <A href="../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(j2a,&amp;y);
-<a name="line127">127: </a>    <font color="#4169E1">for</font> (j=start; j&lt;end; j++) {
-<a name="line128">128: </a>      <font color="#4169E1">if</font> (PetscAbsScalar(y[j-start]) &gt; amax || j == i) {
-<a name="line129">129: </a>        <A href="../../../docs/manualpages/Mat/MatSetValues.html#MatSetValues">MatSetValues</A>(*B,1,&amp;j,1,&amp;i,y+j-start,<A href="../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>);
-<a name="line130">130: </a>      }
-<a name="line131">131: </a>    }
-<a name="line132">132: </a>    <A href="../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(j2a,&amp;y);
-<a name="line133">133: </a>  }
-<a name="line134">134: </a>  <A href="../../../docs/manualpages/Mat/MatAssemblyBegin.html#MatAssemblyBegin">MatAssemblyBegin</A>(*B,MAT_FINAL_ASSEMBLY);
-<a name="line135">135: </a>  <A href="../../../docs/manualpages/Mat/MatAssemblyEnd.html#MatAssemblyEnd">MatAssemblyEnd</A>(*B,MAT_FINAL_ASSEMBLY);
-<a name="line136">136: </a>  <font color="#4169E1">if</font> (*B != *J) {
-<a name="line137">137: </a>    <A href="../../../docs/manualpages/Mat/MatAssemblyBegin.html#MatAssemblyBegin">MatAssemblyBegin</A>(*J,MAT_FINAL_ASSEMBLY);
-<a name="line138">138: </a>    <A href="../../../docs/manualpages/Mat/MatAssemblyEnd.html#MatAssemblyEnd">MatAssemblyEnd</A>(*J,MAT_FINAL_ASSEMBLY);
-<a name="line139">139: </a>  }
-<a name="line140">140: </a>  *flag =  DIFFERENT_NONZERO_PATTERN;
-<a name="line141">141: </a>  <font color="#4169E1">return</font>(0);
-<a name="line142">142: </a>}
+<a name="line113">113: </a>    <A href="../../../docs/manualpages/Vec/VecAssemblyBegin.html#VecAssemblyBegin">VecAssemblyBegin</A>(x2);
+<a name="line114">114: </a>    <A href="../../../docs/manualpages/Vec/VecAssemblyEnd.html#VecAssemblyEnd">VecAssemblyEnd</A>(x2);
+<a name="line115">115: </a>    (*eval_fct)(snes,x2,j2a);
+<a name="line116">116: </a>    <A href="../../../docs/manualpages/Vec/VecAXPY.html#VecAXPY">VecAXPY</A>(j2a,-1.0,j1a);
+<a name="line117">117: </a>    <font color="#B22222">/* Communicate scale=1/dx_i to all processors */</font>
+<a name="line118">118: </a>    <A href="../../../docs/manualpages/Vec/VecGetOwnershipRanges.html#VecGetOwnershipRanges">VecGetOwnershipRanges</A>(x1,&amp;ranges);
+<a name="line119">119: </a>    root = size;
+<a name="line120">120: </a>    <font color="#4169E1">for</font> (j=size-1; j&gt;-1; j--){
+<a name="line121">121: </a>      root--;
+<a name="line122">122: </a>      <font color="#4169E1">if</font> (i&gt;=ranges[j]) <font color="#4169E1">break</font>;
+<a name="line123">123: </a>    }
+<a name="line124">124: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;wscale,1,<A href="../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,root,comm);
+
+<a name="line126">126: </a>    <A href="../../../docs/manualpages/Vec/VecScale.html#VecScale">VecScale</A>(j2a,wscale);
+<a name="line127">127: </a>    <A href="../../../docs/manualpages/Vec/VecNorm.html#VecNorm">VecNorm</A>(j2a,<A href="../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>,&amp;amax); amax *= 1.e-14;
+<a name="line128">128: </a>    <A href="../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(j2a,&amp;y);
+<a name="line129">129: </a>    <font color="#4169E1">for</font> (j=start; j&lt;end; j++) {
+<a name="line130">130: </a>      <font color="#4169E1">if</font> (PetscAbsScalar(y[j-start]) &gt; amax || j == i) {
+<a name="line131">131: </a>        <A href="../../../docs/manualpages/Mat/MatSetValues.html#MatSetValues">MatSetValues</A>(*B,1,&amp;j,1,&amp;i,y+j-start,<A href="../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>);
+<a name="line132">132: </a>      }
+<a name="line133">133: </a>    }
+<a name="line134">134: </a>    <A href="../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(j2a,&amp;y);
+<a name="line135">135: </a>  }
+<a name="line136">136: </a>  <A href="../../../docs/manualpages/Mat/MatAssemblyBegin.html#MatAssemblyBegin">MatAssemblyBegin</A>(*B,MAT_FINAL_ASSEMBLY);
+<a name="line137">137: </a>  <A href="../../../docs/manualpages/Mat/MatAssemblyEnd.html#MatAssemblyEnd">MatAssemblyEnd</A>(*B,MAT_FINAL_ASSEMBLY);
+<a name="line138">138: </a>  <font color="#4169E1">if</font> (*B != *J) {
+<a name="line139">139: </a>    <A href="../../../docs/manualpages/Mat/MatAssemblyBegin.html#MatAssemblyBegin">MatAssemblyBegin</A>(*J,MAT_FINAL_ASSEMBLY);
+<a name="line140">140: </a>    <A href="../../../docs/manualpages/Mat/MatAssemblyEnd.html#MatAssemblyEnd">MatAssemblyEnd</A>(*J,MAT_FINAL_ASSEMBLY);
+<a name="line141">141: </a>  }
+<a name="line142">142: </a>  *flag =  DIFFERENT_NONZERO_PATTERN;
+<a name="line143">143: </a>  <font color="#4169E1">return</font>(0);
+<a name="line144">144: </a>}
 
 
 </pre>
Index: petsc/src/sys/f90-mod/petscmod.F
===================================================================
--- petsc.orig/src/sys/f90-mod/petscmod.F
+++ /dev/null
@@ -1,20 +0,0 @@
-#define PETSC_USE_FORTRAN_MODULES
-
-        module petscsysdef
-#include "petscconf.h"
-#if defined(PETSC_HAVE_MPI_F90MODULE) || defined(PETSC_HAVE_MPIUNI)
-        use mpi
-#define PETSC_AVOID_MPIF_H
-#endif
-#include "finclude/petscsys.h"
-#include "finclude/petscviewer.h"
-#include "finclude/ftn-custom/petscviewerdef.h90"
-#include "finclude/petscdraw.h"
-#include "finclude/petsclog.h"
-        end module
-
-        module petscsys
-        use petscsysdef
-#include "finclude/petscviewer.h90"
-        end module
-
Index: petsc/src/sys/f90-src/f90_cwrap.c
===================================================================
--- petsc.orig/src/sys/f90-src/f90_cwrap.c
+++ petsc/src/sys/f90-src/f90_cwrap.c
@@ -51,10 +51,13 @@
 {
   PetscFunctionBegin;
   if (type == PETSC_SCALAR) {
+    if (!len) array = PETSC_NULL_SCALAR_Fortran;
     f90array1dcreatescalar_(array,&start,&len,ptr PETSC_F90_2PTR_PARAM(ptrd));
   } else if (type == PETSC_REAL) {
+    if (!len) array = PETSC_NULL_REAL_Fortran;
     f90array1dcreatereal_(array,&start,&len,ptr PETSC_F90_2PTR_PARAM(ptrd));
   } else if (type == PETSC_INT) {
+    if (!len) array = PETSC_NULL_INTEGER_Fortran;
     f90array1dcreateint_(array,&start,&len,ptr PETSC_F90_2PTR_PARAM(ptrd));
   } else if (type == PETSC_FORTRANADDR) {
     f90array1dcreatefortranaddr_(array,&start,&len,ptr PETSC_F90_2PTR_PARAM(ptrd));
Index: petsc/src/sys/f90-src/f90_cwrap.c.html
===================================================================
--- petsc.orig/src/sys/f90-src/f90_cwrap.c.html
+++ petsc/src/sys/f90-src/f90_cwrap.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:23:47+00:00">
+<meta name="date" content="2011-03-17T18:44:59+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -44,191 +44,194 @@
 <a name="line50"> 50: </a><strong><font color="#4169E1"><a name="F90Array1dCreate"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> F90Array1dCreate(void *array,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> start,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> len,F90Array1d *ptr PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
 <a name="line51"> 51: </a>{
 <a name="line53"> 53: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
-<a name="line54"> 54: </a>    f90array1dcreatescalar_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line55"> 55: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
-<a name="line56"> 56: </a>    f90array1dcreatereal_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line57"> 57: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
-<a name="line58"> 58: </a>    f90array1dcreateint_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line59"> 59: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
-<a name="line60"> 60: </a>    f90array1dcreatefortranaddr_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line61"> 61: </a>  } <font color="#4169E1">else</font> {
-<a name="line62"> 62: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
-<a name="line63"> 63: </a>  }
-<a name="line64"> 64: </a>  <font color="#4169E1">return</font>(0);
-<a name="line65"> 65: </a>}
-
-<a name="line69"> 69: </a><strong><font color="#4169E1"><a name="F90Array1dAccess"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array1dAccess(F90Array1d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,void **array PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
-<a name="line70"> 70: </a>{
-<a name="line72"> 72: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
-<a name="line73"> 73: </a>    f90array1daccessscalar_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line74"> 74: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
-<a name="line75"> 75: </a>    f90array1daccessreal_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line76"> 76: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
-<a name="line77"> 77: </a>    f90array1daccessint_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line78"> 78: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
-<a name="line79"> 79: </a>    f90array1daccessfortranaddr_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line80"> 80: </a>  } <font color="#4169E1">else</font> {
-<a name="line81"> 81: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
-<a name="line82"> 82: </a>  }
-<a name="line83"> 83: </a>  <font color="#4169E1">return</font>(0);
-<a name="line84"> 84: </a>}
-
-<a name="line88"> 88: </a><strong><font color="#4169E1"><a name="F90Array1dDestroy"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array1dDestroy(F90Array1d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
-<a name="line89"> 89: </a>{
-<a name="line91"> 91: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
-<a name="line92"> 92: </a>    f90array1ddestroyscalar_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line93"> 93: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
-<a name="line94"> 94: </a>    f90array1ddestroyreal_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line95"> 95: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
-<a name="line96"> 96: </a>    f90array1ddestroyint_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line97"> 97: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
-<a name="line98"> 98: </a>    f90array1ddestroyfortranaddr_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line99"> 99: </a>  } <font color="#4169E1">else</font> {
-<a name="line100">100: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
-<a name="line101">101: </a>  }
-<a name="line102">102: </a>  <font color="#4169E1">return</font>(0);
-<a name="line103">103: </a>}
-
-<a name="line105">105: </a><font color="#B22222">/*************************************************************************/</font>
-
-<a name="line107">107: </a><font color="#A020F0">#if defined(PETSC_HAVE_FORTRAN_CAPS)</font>
-<a name="line108">108: </a><strong><font color="#228B22">#define f90array2dcreatescalar_           F90ARRAY2DCREATESCALAR</font></strong>
-<a name="line109">109: </a><strong><font color="#228B22">#define f90array2daccessscalar_           F90ARRAY2DACCESSSCALAR</font></strong>
-<a name="line110">110: </a><strong><font color="#228B22">#define f90array2ddestroyscalar_          F90ARRAY2DDESTROYSCALAR</font></strong>
-<a name="line111">111: </a><strong><font color="#228B22">#define f90array2dcreatereal_             F90ARRAY2DCREATEREAL</font></strong>
-<a name="line112">112: </a><strong><font color="#228B22">#define f90array2daccessreal_             F90ARRAY2DACCESSREAL</font></strong>
-<a name="line113">113: </a><strong><font color="#228B22">#define f90array2ddestroyreal_            F90ARRAY2DDESTROYREAL</font></strong>
-<a name="line114">114: </a><strong><font color="#228B22">#define f90array2dcreateint_              F90ARRAY2DCREATEINT</font></strong>
-<a name="line115">115: </a><strong><font color="#228B22">#define f90array2daccessint_              F90ARRAY2DACCESSINT</font></strong>
-<a name="line116">116: </a><strong><font color="#228B22">#define f90array2ddestroyint_             F90ARRAY2DDESTROYINT</font></strong>
-<a name="line117">117: </a><strong><font color="#228B22">#define f90array2dcreatefortranaddr_      F90ARRAY2DCREATEFORTRANADDR</font></strong>
-<a name="line118">118: </a><strong><font color="#228B22">#define f90array2daccessfortranaddr_      F90ARRAY2DACCESSFORTRANADDR</font></strong>
-<a name="line119">119: </a><strong><font color="#228B22">#define f90array2ddestroyfortranaddr_     F90ARRAY2DDESTROYFORTRANADDR</font></strong>
-<a name="line120">120: </a><font color="#A020F0">#elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)</font>
-<a name="line121">121: </a><strong><font color="#228B22">#define f90array2dcreatescalar_           f90array2dcreatescalar</font></strong>
-<a name="line122">122: </a><strong><font color="#228B22">#define f90array2daccessscalar_           f90array2daccessscalar</font></strong>
-<a name="line123">123: </a><strong><font color="#228B22">#define f90array2ddestroyscalar_          f90array2ddestroyscalar</font></strong>
-<a name="line124">124: </a><strong><font color="#228B22">#define f90array2dcreatereal_             f90array2dcreatereal</font></strong>
-<a name="line125">125: </a><strong><font color="#228B22">#define f90array2daccessreal_             f90array2daccessreal</font></strong>
-<a name="line126">126: </a><strong><font color="#228B22">#define f90array2ddestroyreal_            f90array2ddestroyreal</font></strong>
-<a name="line127">127: </a><strong><font color="#228B22">#define f90array2dcreateint_              f90array2dcreateint</font></strong>
-<a name="line128">128: </a><strong><font color="#228B22">#define f90array2daccessint_              f90array2daccessint</font></strong>
-<a name="line129">129: </a><strong><font color="#228B22">#define f90array2ddestroyint_             f90array2ddestroyint</font></strong>
-<a name="line130">130: </a><strong><font color="#228B22">#define f90array2dcreatefortranaddr_      f90array2dcreatefortranaddr</font></strong>
-<a name="line131">131: </a><strong><font color="#228B22">#define f90array2daccessfortranaddr_      f90array2daccessfortranaddr</font></strong>
-<a name="line132">132: </a><strong><font color="#228B22">#define f90array2ddestroyfortranaddr_     f90array2ddestroyfortranaddr</font></strong>
-<a name="line133">133: </a><font color="#A020F0">#endif</font>
-
-
-<a name="line152">152: </a><strong><font color="#4169E1"><a name="F90Array2dCreate"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> F90Array2dCreate(void *array,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> start1,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> len1,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> start2,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> len2,F90Array2d *ptr PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
-<a name="line153">153: </a>{
-<a name="line155">155: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
-<a name="line156">156: </a>    f90array2dcreatescalar_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line157">157: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
-<a name="line158">158: </a>    f90array2dcreatereal_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line159">159: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
-<a name="line160">160: </a>    f90array2dcreateint_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line161">161: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
-<a name="line162">162: </a>    f90array2dcreatefortranaddr_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line163">163: </a>  } <font color="#4169E1">else</font> {
-<a name="line164">164: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
-<a name="line165">165: </a>  }
-<a name="line166">166: </a>  <font color="#4169E1">return</font>(0);
-<a name="line167">167: </a>}
-
-<a name="line171">171: </a><strong><font color="#4169E1"><a name="F90Array2dAccess"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array2dAccess(F90Array2d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,void **array PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
-<a name="line172">172: </a>{
-<a name="line174">174: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
-<a name="line175">175: </a>    f90array2daccessscalar_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line176">176: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
-<a name="line177">177: </a>    f90array2daccessreal_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line178">178: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
-<a name="line179">179: </a>    f90array2daccessint_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line180">180: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
-<a name="line181">181: </a>    f90array2daccessfortranaddr_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line182">182: </a>  } <font color="#4169E1">else</font> {
-<a name="line183">183: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
-<a name="line184">184: </a>  }
-<a name="line185">185: </a>  <font color="#4169E1">return</font>(0);
-<a name="line186">186: </a>}
-
-<a name="line190">190: </a><strong><font color="#4169E1"><a name="F90Array2dDestroy"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array2dDestroy(F90Array2d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
-<a name="line191">191: </a>{
-<a name="line193">193: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
-<a name="line194">194: </a>    f90array2ddestroyscalar_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line195">195: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
-<a name="line196">196: </a>    f90array2ddestroyreal_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line197">197: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
-<a name="line198">198: </a>    f90array2ddestroyint_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line199">199: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
-<a name="line200">200: </a>    f90array2ddestroyfortranaddr_(ptr PETSC_F90_2PTR_PARAM(ptrd));
-<a name="line201">201: </a>  } <font color="#4169E1">else</font> {
-<a name="line202">202: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
-<a name="line203">203: </a>  }
-<a name="line204">204: </a>  <font color="#4169E1">return</font>(0);
-<a name="line205">205: </a>}
-
-<a name="line207">207: </a><font color="#B22222">/*************************************************************************/</font>
-<a name="line208">208: </a><font color="#A020F0">#if defined(PETSC_HAVE_FORTRAN_CAPS)</font>
-<a name="line209">209: </a><strong><font color="#228B22">#define f90array1dgetaddrscalar_            F90ARRAY1DGETADDRSCALAR</font></strong>
-<a name="line210">210: </a><strong><font color="#228B22">#define f90array1dgetaddrreal_              F90ARRAY1DGETADDRREAL</font></strong>
-<a name="line211">211: </a><strong><font color="#228B22">#define f90array1dgetaddrint_               F90ARRAY1DGETADDRINT</font></strong>
-<a name="line212">212: </a><strong><font color="#228B22">#define f90array1dgetaddrfortranaddr_       F90ARRAY1DGETADDRFORTRANADDR</font></strong>
-<a name="line213">213: </a><font color="#A020F0">#elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)</font>
-<a name="line214">214: </a><strong><font color="#228B22">#define f90array1dgetaddrscalar_            f90array1dgetaddrscalar</font></strong>
-<a name="line215">215: </a><strong><font color="#228B22">#define f90array1dgetaddrreal_              f90array1dgetaddrreal</font></strong>
-<a name="line216">216: </a><strong><font color="#228B22">#define f90array1dgetaddrint_               f90array1dgetaddrint</font></strong>
-<a name="line217">217: </a><strong><font color="#228B22">#define f90array1dgetaddrfortranaddr_       f90array1dgetaddrfortranaddr</font></strong>
-<a name="line218">218: </a><font color="#A020F0">#endif</font>
-
-<a name="line221">221: </a><strong><font color="#4169E1">void PETSC_STDCALL f90array1dgetaddrscalar_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line222">222: </a>{
-<a name="line223">223: </a>  *address = (PetscFortranAddr)array;
-<a name="line224">224: </a>}
-<a name="line225">225: </a><strong><font color="#4169E1"><a name="f90array1dgetaddrreal_"></a>void PETSC_STDCALL f90array1dgetaddrreal_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line226">226: </a>{
-<a name="line227">227: </a>  *address = (PetscFortranAddr)array;
-<a name="line228">228: </a>}
-<a name="line229">229: </a><strong><font color="#4169E1"><a name="f90array1dgetaddrint_"></a>void PETSC_STDCALL f90array1dgetaddrint_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line230">230: </a>{
-<a name="line231">231: </a>  *address = (PetscFortranAddr)array;
-<a name="line232">232: </a>}
-<a name="line233">233: </a><strong><font color="#4169E1"><a name="f90array1dgetaddrfortranaddr_"></a>void PETSC_STDCALL f90array1dgetaddrfortranaddr_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line234">234: </a>{
-<a name="line235">235: </a>  *address = (PetscFortranAddr)array;
-<a name="line236">236: </a>}
-
-<a name="line239">239: </a><font color="#B22222">/*************************************************************************/</font>
-<a name="line240">240: </a><font color="#A020F0">#if defined(PETSC_HAVE_FORTRAN_CAPS)</font>
-<a name="line241">241: </a><strong><font color="#228B22">#define f90array2dgetaddrscalar_            F90ARRAY2DGETADDRSCALAR</font></strong>
-<a name="line242">242: </a><strong><font color="#228B22">#define f90array2dgetaddrreal_              F90ARRAY2DGETADDRREAL</font></strong>
-<a name="line243">243: </a><strong><font color="#228B22">#define f90array2dgetaddrint_               F90ARRAY2DGETADDRINT</font></strong>
-<a name="line244">244: </a><strong><font color="#228B22">#define f90array2dgetaddrfortranaddr_       F90ARRAY2DGETADDRFORTRANADDR</font></strong>
-<a name="line245">245: </a><font color="#A020F0">#elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)</font>
-<a name="line246">246: </a><strong><font color="#228B22">#define f90array2dgetaddrscalar_            f90array2dgetaddrscalar</font></strong>
-<a name="line247">247: </a><strong><font color="#228B22">#define f90array2dgetaddrreal_              f90array2dgetaddrreal</font></strong>
-<a name="line248">248: </a><strong><font color="#228B22">#define f90array2dgetaddrint_               f90array2dgetaddrint</font></strong>
-<a name="line249">249: </a><strong><font color="#228B22">#define f90array2dgetaddrfortranaddr_       f90array2dgetaddrfortranaddr</font></strong>
-<a name="line250">250: </a><font color="#A020F0">#endif</font>
-
-<a name="line253">253: </a><strong><font color="#4169E1">void PETSC_STDCALL f90array2dgetaddrscalar_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line254">254: </a>{
-<a name="line255">255: </a>  *address = (PetscFortranAddr)array;
-<a name="line256">256: </a>}
-<a name="line257">257: </a><strong><font color="#4169E1"><a name="f90array2dgetaddrreal_"></a>void PETSC_STDCALL f90array2dgetaddrreal_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line258">258: </a>{
-<a name="line259">259: </a>  *address = (PetscFortranAddr)array;
-<a name="line260">260: </a>}
-<a name="line261">261: </a><strong><font color="#4169E1"><a name="f90array2dgetaddrint_"></a>void PETSC_STDCALL f90array2dgetaddrint_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line262">262: </a>{
-<a name="line263">263: </a>  *address = (PetscFortranAddr)array;
-<a name="line264">264: </a>}
-<a name="line265">265: </a><strong><font color="#4169E1"><a name="f90array2dgetaddrfortranaddr_"></a>void PETSC_STDCALL f90array2dgetaddrfortranaddr_(void *array, PetscFortranAddr *address)</font></strong>
-<a name="line266">266: </a>{
-<a name="line267">267: </a>  *address = (PetscFortranAddr)array;
-<a name="line268">268: </a>}
+<a name="line54"> 54: </a>    <font color="#4169E1">if</font> (!len) array = PETSC_NULL_SCALAR_Fortran;
+<a name="line55"> 55: </a>    f90array1dcreatescalar_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line56"> 56: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
+<a name="line57"> 57: </a>    <font color="#4169E1">if</font> (!len) array = PETSC_NULL_REAL_Fortran;
+<a name="line58"> 58: </a>    f90array1dcreatereal_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line59"> 59: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
+<a name="line60"> 60: </a>    <font color="#4169E1">if</font> (!len) array = PETSC_NULL_INTEGER_Fortran;
+<a name="line61"> 61: </a>    f90array1dcreateint_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line62"> 62: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
+<a name="line63"> 63: </a>    f90array1dcreatefortranaddr_(array,&amp;start,&amp;len,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line64"> 64: </a>  } <font color="#4169E1">else</font> {
+<a name="line65"> 65: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
+<a name="line66"> 66: </a>  }
+<a name="line67"> 67: </a>  <font color="#4169E1">return</font>(0);
+<a name="line68"> 68: </a>}
+
+<a name="line72"> 72: </a><strong><font color="#4169E1"><a name="F90Array1dAccess"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array1dAccess(F90Array1d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,void **array PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
+<a name="line73"> 73: </a>{
+<a name="line75"> 75: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
+<a name="line76"> 76: </a>    f90array1daccessscalar_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line77"> 77: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
+<a name="line78"> 78: </a>    f90array1daccessreal_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line79"> 79: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
+<a name="line80"> 80: </a>    f90array1daccessint_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line81"> 81: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
+<a name="line82"> 82: </a>    f90array1daccessfortranaddr_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line83"> 83: </a>  } <font color="#4169E1">else</font> {
+<a name="line84"> 84: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
+<a name="line85"> 85: </a>  }
+<a name="line86"> 86: </a>  <font color="#4169E1">return</font>(0);
+<a name="line87"> 87: </a>}
+
+<a name="line91"> 91: </a><strong><font color="#4169E1"><a name="F90Array1dDestroy"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array1dDestroy(F90Array1d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
+<a name="line92"> 92: </a>{
+<a name="line94"> 94: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
+<a name="line95"> 95: </a>    f90array1ddestroyscalar_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line96"> 96: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
+<a name="line97"> 97: </a>    f90array1ddestroyreal_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line98"> 98: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
+<a name="line99"> 99: </a>    f90array1ddestroyint_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line100">100: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
+<a name="line101">101: </a>    f90array1ddestroyfortranaddr_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line102">102: </a>  } <font color="#4169E1">else</font> {
+<a name="line103">103: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
+<a name="line104">104: </a>  }
+<a name="line105">105: </a>  <font color="#4169E1">return</font>(0);
+<a name="line106">106: </a>}
+
+<a name="line108">108: </a><font color="#B22222">/*************************************************************************/</font>
+
+<a name="line110">110: </a><font color="#A020F0">#if defined(PETSC_HAVE_FORTRAN_CAPS)</font>
+<a name="line111">111: </a><strong><font color="#228B22">#define f90array2dcreatescalar_           F90ARRAY2DCREATESCALAR</font></strong>
+<a name="line112">112: </a><strong><font color="#228B22">#define f90array2daccessscalar_           F90ARRAY2DACCESSSCALAR</font></strong>
+<a name="line113">113: </a><strong><font color="#228B22">#define f90array2ddestroyscalar_          F90ARRAY2DDESTROYSCALAR</font></strong>
+<a name="line114">114: </a><strong><font color="#228B22">#define f90array2dcreatereal_             F90ARRAY2DCREATEREAL</font></strong>
+<a name="line115">115: </a><strong><font color="#228B22">#define f90array2daccessreal_             F90ARRAY2DACCESSREAL</font></strong>
+<a name="line116">116: </a><strong><font color="#228B22">#define f90array2ddestroyreal_            F90ARRAY2DDESTROYREAL</font></strong>
+<a name="line117">117: </a><strong><font color="#228B22">#define f90array2dcreateint_              F90ARRAY2DCREATEINT</font></strong>
+<a name="line118">118: </a><strong><font color="#228B22">#define f90array2daccessint_              F90ARRAY2DACCESSINT</font></strong>
+<a name="line119">119: </a><strong><font color="#228B22">#define f90array2ddestroyint_             F90ARRAY2DDESTROYINT</font></strong>
+<a name="line120">120: </a><strong><font color="#228B22">#define f90array2dcreatefortranaddr_      F90ARRAY2DCREATEFORTRANADDR</font></strong>
+<a name="line121">121: </a><strong><font color="#228B22">#define f90array2daccessfortranaddr_      F90ARRAY2DACCESSFORTRANADDR</font></strong>
+<a name="line122">122: </a><strong><font color="#228B22">#define f90array2ddestroyfortranaddr_     F90ARRAY2DDESTROYFORTRANADDR</font></strong>
+<a name="line123">123: </a><font color="#A020F0">#elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)</font>
+<a name="line124">124: </a><strong><font color="#228B22">#define f90array2dcreatescalar_           f90array2dcreatescalar</font></strong>
+<a name="line125">125: </a><strong><font color="#228B22">#define f90array2daccessscalar_           f90array2daccessscalar</font></strong>
+<a name="line126">126: </a><strong><font color="#228B22">#define f90array2ddestroyscalar_          f90array2ddestroyscalar</font></strong>
+<a name="line127">127: </a><strong><font color="#228B22">#define f90array2dcreatereal_             f90array2dcreatereal</font></strong>
+<a name="line128">128: </a><strong><font color="#228B22">#define f90array2daccessreal_             f90array2daccessreal</font></strong>
+<a name="line129">129: </a><strong><font color="#228B22">#define f90array2ddestroyreal_            f90array2ddestroyreal</font></strong>
+<a name="line130">130: </a><strong><font color="#228B22">#define f90array2dcreateint_              f90array2dcreateint</font></strong>
+<a name="line131">131: </a><strong><font color="#228B22">#define f90array2daccessint_              f90array2daccessint</font></strong>
+<a name="line132">132: </a><strong><font color="#228B22">#define f90array2ddestroyint_             f90array2ddestroyint</font></strong>
+<a name="line133">133: </a><strong><font color="#228B22">#define f90array2dcreatefortranaddr_      f90array2dcreatefortranaddr</font></strong>
+<a name="line134">134: </a><strong><font color="#228B22">#define f90array2daccessfortranaddr_      f90array2daccessfortranaddr</font></strong>
+<a name="line135">135: </a><strong><font color="#228B22">#define f90array2ddestroyfortranaddr_     f90array2ddestroyfortranaddr</font></strong>
+<a name="line136">136: </a><font color="#A020F0">#endif</font>
+
+
+<a name="line155">155: </a><strong><font color="#4169E1"><a name="F90Array2dCreate"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> F90Array2dCreate(void *array,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> start1,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> len1,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> start2,<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> len2,F90Array2d *ptr PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
+<a name="line156">156: </a>{
+<a name="line158">158: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
+<a name="line159">159: </a>    f90array2dcreatescalar_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line160">160: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
+<a name="line161">161: </a>    f90array2dcreatereal_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line162">162: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
+<a name="line163">163: </a>    f90array2dcreateint_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line164">164: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
+<a name="line165">165: </a>    f90array2dcreatefortranaddr_(array,&amp;start1,&amp;len1,&amp;start2,&amp;len2,ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line166">166: </a>  } <font color="#4169E1">else</font> {
+<a name="line167">167: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
+<a name="line168">168: </a>  }
+<a name="line169">169: </a>  <font color="#4169E1">return</font>(0);
+<a name="line170">170: </a>}
+
+<a name="line174">174: </a><strong><font color="#4169E1"><a name="F90Array2dAccess"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array2dAccess(F90Array2d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type,void **array PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
+<a name="line175">175: </a>{
+<a name="line177">177: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
+<a name="line178">178: </a>    f90array2daccessscalar_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line179">179: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
+<a name="line180">180: </a>    f90array2daccessreal_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line181">181: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
+<a name="line182">182: </a>    f90array2daccessint_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line183">183: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
+<a name="line184">184: </a>    f90array2daccessfortranaddr_(ptr,array PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line185">185: </a>  } <font color="#4169E1">else</font> {
+<a name="line186">186: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
+<a name="line187">187: </a>  }
+<a name="line188">188: </a>  <font color="#4169E1">return</font>(0);
+<a name="line189">189: </a>}
+
+<a name="line193">193: </a><strong><font color="#4169E1"><a name="F90Array2dDestroy"></a><A href="../..90-../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  F90Array2dDestroy(F90Array2d *ptr,<A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A> type PETSC_F90_2PTR_PROTO(ptrd))</font></strong>
+<a name="line194">194: </a>{
+<a name="line196">196: </a>  <font color="#4169E1">if</font> (type == PETSC_SCALAR) {
+<a name="line197">197: </a>    f90array2ddestroyscalar_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line198">198: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_REAL) {
+<a name="line199">199: </a>    f90array2ddestroyreal_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line200">200: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_INT) {
+<a name="line201">201: </a>    f90array2ddestroyint_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line202">202: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == PETSC_FORTRANADDR) {
+<a name="line203">203: </a>    f90array2ddestroyfortranaddr_(ptr PETSC_F90_2PTR_PARAM(ptrd));
+<a name="line204">204: </a>  } <font color="#4169E1">else</font> {
+<a name="line205">205: </a>    <A href="../..90-../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"unsupported <A href="../..90-../docs/manualpages/Sys/PetscDataType.html#PetscDataType">PetscDataType</A>: %d"</font>,(<A href="../..90-../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)type);
+<a name="line206">206: </a>  }
+<a name="line207">207: </a>  <font color="#4169E1">return</font>(0);
+<a name="line208">208: </a>}
+
+<a name="line210">210: </a><font color="#B22222">/*************************************************************************/</font>
+<a name="line211">211: </a><font color="#A020F0">#if defined(PETSC_HAVE_FORTRAN_CAPS)</font>
+<a name="line212">212: </a><strong><font color="#228B22">#define f90array1dgetaddrscalar_            F90ARRAY1DGETADDRSCALAR</font></strong>
+<a name="line213">213: </a><strong><font color="#228B22">#define f90array1dgetaddrreal_              F90ARRAY1DGETADDRREAL</font></strong>
+<a name="line214">214: </a><strong><font color="#228B22">#define f90array1dgetaddrint_               F90ARRAY1DGETADDRINT</font></strong>
+<a name="line215">215: </a><strong><font color="#228B22">#define f90array1dgetaddrfortranaddr_       F90ARRAY1DGETADDRFORTRANADDR</font></strong>
+<a name="line216">216: </a><font color="#A020F0">#elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)</font>
+<a name="line217">217: </a><strong><font color="#228B22">#define f90array1dgetaddrscalar_            f90array1dgetaddrscalar</font></strong>
+<a name="line218">218: </a><strong><font color="#228B22">#define f90array1dgetaddrreal_              f90array1dgetaddrreal</font></strong>
+<a name="line219">219: </a><strong><font color="#228B22">#define f90array1dgetaddrint_               f90array1dgetaddrint</font></strong>
+<a name="line220">220: </a><strong><font color="#228B22">#define f90array1dgetaddrfortranaddr_       f90array1dgetaddrfortranaddr</font></strong>
+<a name="line221">221: </a><font color="#A020F0">#endif</font>
+
+<a name="line224">224: </a><strong><font color="#4169E1">void PETSC_STDCALL f90array1dgetaddrscalar_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line225">225: </a>{
+<a name="line226">226: </a>  *address = (PetscFortranAddr)array;
+<a name="line227">227: </a>}
+<a name="line228">228: </a><strong><font color="#4169E1"><a name="f90array1dgetaddrreal_"></a>void PETSC_STDCALL f90array1dgetaddrreal_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line229">229: </a>{
+<a name="line230">230: </a>  *address = (PetscFortranAddr)array;
+<a name="line231">231: </a>}
+<a name="line232">232: </a><strong><font color="#4169E1"><a name="f90array1dgetaddrint_"></a>void PETSC_STDCALL f90array1dgetaddrint_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line233">233: </a>{
+<a name="line234">234: </a>  *address = (PetscFortranAddr)array;
+<a name="line235">235: </a>}
+<a name="line236">236: </a><strong><font color="#4169E1"><a name="f90array1dgetaddrfortranaddr_"></a>void PETSC_STDCALL f90array1dgetaddrfortranaddr_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line237">237: </a>{
+<a name="line238">238: </a>  *address = (PetscFortranAddr)array;
+<a name="line239">239: </a>}
+
+<a name="line242">242: </a><font color="#B22222">/*************************************************************************/</font>
+<a name="line243">243: </a><font color="#A020F0">#if defined(PETSC_HAVE_FORTRAN_CAPS)</font>
+<a name="line244">244: </a><strong><font color="#228B22">#define f90array2dgetaddrscalar_            F90ARRAY2DGETADDRSCALAR</font></strong>
+<a name="line245">245: </a><strong><font color="#228B22">#define f90array2dgetaddrreal_              F90ARRAY2DGETADDRREAL</font></strong>
+<a name="line246">246: </a><strong><font color="#228B22">#define f90array2dgetaddrint_               F90ARRAY2DGETADDRINT</font></strong>
+<a name="line247">247: </a><strong><font color="#228B22">#define f90array2dgetaddrfortranaddr_       F90ARRAY2DGETADDRFORTRANADDR</font></strong>
+<a name="line248">248: </a><font color="#A020F0">#elif !defined(PETSC_HAVE_FORTRAN_UNDERSCORE)</font>
+<a name="line249">249: </a><strong><font color="#228B22">#define f90array2dgetaddrscalar_            f90array2dgetaddrscalar</font></strong>
+<a name="line250">250: </a><strong><font color="#228B22">#define f90array2dgetaddrreal_              f90array2dgetaddrreal</font></strong>
+<a name="line251">251: </a><strong><font color="#228B22">#define f90array2dgetaddrint_               f90array2dgetaddrint</font></strong>
+<a name="line252">252: </a><strong><font color="#228B22">#define f90array2dgetaddrfortranaddr_       f90array2dgetaddrfortranaddr</font></strong>
+<a name="line253">253: </a><font color="#A020F0">#endif</font>
+
+<a name="line256">256: </a><strong><font color="#4169E1">void PETSC_STDCALL f90array2dgetaddrscalar_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line257">257: </a>{
+<a name="line258">258: </a>  *address = (PetscFortranAddr)array;
+<a name="line259">259: </a>}
+<a name="line260">260: </a><strong><font color="#4169E1"><a name="f90array2dgetaddrreal_"></a>void PETSC_STDCALL f90array2dgetaddrreal_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line261">261: </a>{
+<a name="line262">262: </a>  *address = (PetscFortranAddr)array;
+<a name="line263">263: </a>}
+<a name="line264">264: </a><strong><font color="#4169E1"><a name="f90array2dgetaddrint_"></a>void PETSC_STDCALL f90array2dgetaddrint_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line265">265: </a>{
+<a name="line266">266: </a>  *address = (PetscFortranAddr)array;
+<a name="line267">267: </a>}
+<a name="line268">268: </a><strong><font color="#4169E1"><a name="f90array2dgetaddrfortranaddr_"></a>void PETSC_STDCALL f90array2dgetaddrfortranaddr_(void *array, PetscFortranAddr *address)</font></strong>
+<a name="line269">269: </a>{
+<a name="line270">270: </a>  *address = (PetscFortranAddr)array;
+<a name="line271">271: </a>}
 
-<a name="line271">271: </a><font color="#B22222">/*************************************************************************/</font>
+<a name="line274">274: </a><font color="#B22222">/*************************************************************************/</font>
 </pre>
 </body>
 
Index: petsc/src/sys/f90-src/f90impl.h
===================================================================
--- petsc.orig/src/sys/f90-src/f90impl.h
+++ petsc/src/sys/f90-src/f90impl.h
@@ -1,7 +1,7 @@
 
 #if !defined(__PETSCF90_H)
 #define __PETSCF90_H
-#include "petscsys.h"
+#include "private/fortranimpl.h" /*I petscsys.h I*/
 PETSC_EXTERN_CXX_BEGIN
 
 /* PGI compilers pass in f90 pointers as 2 arguments */
Index: petsc/src/sys/f90-src/f90impl.h.html
===================================================================
--- petsc.orig/src/sys/f90-src/f90impl.h.html
+++ petsc/src/sys/f90-src/f90impl.h.html
@@ -4,12 +4,12 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:23:48+00:00">
+<meta name="date" content="2011-03-17T18:45:00+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
 <pre width="80">
-<a name="line4">  4: </a><font color="#A020F0">#include </font><font color="#666666">"petscsys.h"</font><font color="#A020F0"></font>
+<a name="line4">  4: </a><font color="#A020F0">#include </font><font color="#666666">"private/fortranimpl.h"</font><font color="#A020F0"> </font><font color="#B22222">/*I petscsys.h I*/</font><font color="#A020F0"></font>
 
 <a name="line7">  7: </a><font color="#B22222">/* PGI compilers pass in f90 pointers as 2 arguments */</font>
 <a name="line8">  8: </a><font color="#A020F0">#if defined(PETSC_HAVE_F90_2PTR_ARG)</font>
Index: petsc/src/sys/fileio/mprint.c
===================================================================
--- petsc.orig/src/sys/fileio/mprint.c
+++ petsc/src/sys/fileio/mprint.c
@@ -274,6 +274,7 @@
     va_start(Argp,format);
     ierr = (*PetscVFPrintf)(PETSC_STDOUT,format,Argp);CHKERRQ(ierr);
     if (petsc_history) {
+      va_start(Argp,format);
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
     }
     va_end(Argp);
@@ -338,7 +339,8 @@
     va_start(Argp,format);
     ierr = (*PetscVFPrintf)(fp,format,Argp);CHKERRQ(ierr);
     queuefile = fp;
-    if (petsc_history) {
+    if (petsc_history && (fp !=petsc_history)) {
+      va_start(Argp,format);
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
     }
     va_end(Argp);
@@ -472,9 +474,10 @@
     va_list Argp;
     va_start(Argp,format);
     ierr = (*PetscVFPrintf)(fd,format,Argp);CHKERRQ(ierr);
-    if (petsc_history) {
+    if (petsc_history && (fd !=petsc_history)) {
+      va_start(Argp,format);
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
-    }
+      }
     va_end(Argp);
   }
   PetscFunctionReturn(0);
@@ -544,6 +547,7 @@
     }
     ierr = (*PetscVFPrintf)(PETSC_STDOUT,nformat,Argp);CHKERRQ(ierr);
     if (petsc_history) {
+      va_start(Argp,format);
       ierr = (*PetscVFPrintf)(petsc_history,nformat,Argp);CHKERRQ(ierr);
     }
     va_end(Argp);
@@ -568,6 +572,7 @@
     va_start(Argp,format);
     ierr = (*PetscVFPrintf)(PETSC_STDOUT,format,Argp);CHKERRQ(ierr);
     if (petsc_history) {
+      va_start(Argp,format);
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
     }
     va_end(Argp);
Index: petsc/src/sys/fileio/mprint.c.html
===================================================================
--- petsc.orig/src/sys/fileio/mprint.c.html
+++ petsc/src/sys/fileio/mprint.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:21:19+00:00">
+<meta name="date" content="2011-03-17T18:42:34+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -264,321 +264,326 @@
 <a name="line274">274: </a>    va_start(Argp,format);
 <a name="line275">275: </a>    (*PetscVFPrintf)(PETSC_STDOUT,format,Argp);
 <a name="line276">276: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line277">277: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line278">278: </a>    }
-<a name="line279">279: </a>    va_end(Argp);
-<a name="line280">280: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors add to local queue */</font>
-<a name="line281">281: </a>    va_list     Argp;
-<a name="line282">282: </a>    PrintfQueue next;
-<a name="line283">283: </a>    int         fullLength = 8191;
-
-<a name="line285">285: </a>    <A href="../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
-<a name="line286">286: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next; queue-&gt;next = 0;}
-<a name="line287">287: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
-<a name="line288">288: </a>    queuelength++;
-<a name="line289">289: </a>    next-&gt;size = -1;
-<a name="line290">290: </a>    <font color="#4169E1">while</font>(fullLength &gt;= next-&gt;size) {
-<a name="line291">291: </a>      next-&gt;size = fullLength+1;
-<a name="line292">292: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size * <font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
-<a name="line293">293: </a>      va_start(Argp,format);
-<a name="line294">294: </a>      <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
-<a name="line295">295: </a>      PetscVSNPrintf(next-&gt;string,next-&gt;size,format, &amp;fullLength,Argp);
-<a name="line296">296: </a>      va_end(Argp);
-<a name="line297">297: </a>    }
-<a name="line298">298: </a>  }
-<a name="line299">299: </a>
-<a name="line300">300: </a>  <font color="#4169E1">return</font>(0);
-<a name="line301">301: </a>}
-<a name="line302">302: </a>
-<a name="line305">305: </a><font color="#B22222">/*@C</font>
-<a name="line306">306: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscSynchronizedFPrintf.html#PetscSynchronizedFPrintf">PetscSynchronizedFPrintf</A> - Prints synchronized output to the specified file from</font>
-<a name="line307">307: </a><font color="#B22222">    several processors.  Output of the first processor is followed by that of the </font>
-<a name="line308">308: </a><font color="#B22222">    second, etc.</font>
-
-<a name="line310">310: </a><font color="#B22222">    Not Collective</font>
-
-<a name="line312">312: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line313">313: </a><font color="#B22222">+   comm - the communicator</font>
-<a name="line314">314: </a><font color="#B22222">.   fd - the file pointer</font>
-<a name="line315">315: </a><font color="#B22222">-   format - the usual printf() format string </font>
-
-<a name="line317">317: </a><font color="#B22222">    Level: intermediate</font>
-
-<a name="line319">319: </a><font color="#B22222">    Notes:</font>
-<a name="line320">320: </a><font color="#B22222">    REQUIRES a intervening call to <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>() for the information </font>
-<a name="line321">321: </a><font color="#B22222">    from all the processors to be printed.</font>
-
-<a name="line323">323: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(), <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(),</font>
-<a name="line324">324: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscFOpen.html#PetscFOpen">PetscFOpen</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
-
-<a name="line326">326: </a><font color="#B22222">@*/</font>
-<a name="line327">327: </a><strong><font color="#4169E1"><a name="PetscSynchronizedFPrintf"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscSynchronizedFPrintf.html#PetscSynchronizedFPrintf">PetscSynchronizedFPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,FILE* fp,const char format[],...)</font></strong>
-<a name="line328">328: </a>{
-<a name="line330">330: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
-
-<a name="line333">333: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line334">334: </a>
-<a name="line335">335: </a>  <font color="#B22222">/* First processor prints immediately to fp */</font>
-<a name="line336">336: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line337">337: </a>    va_list Argp;
-<a name="line338">338: </a>    va_start(Argp,format);
-<a name="line339">339: </a>    (*PetscVFPrintf)(fp,format,Argp);
-<a name="line340">340: </a>    queuefile = fp;
-<a name="line341">341: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line342">342: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line343">343: </a>    }
-<a name="line344">344: </a>    va_end(Argp);
-<a name="line345">345: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors add to local queue */</font>
-<a name="line346">346: </a>    va_list     Argp;
-<a name="line347">347: </a>    PrintfQueue next;
-<a name="line348">348: </a>    int         fullLength = 8191;
-<a name="line349">349: </a>    <A href="../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
-<a name="line350">350: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next; queue-&gt;next = 0;}
-<a name="line351">351: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
-<a name="line352">352: </a>    queuelength++;
-<a name="line353">353: </a>    next-&gt;size = -1;
-<a name="line354">354: </a>    <font color="#4169E1">while</font>(fullLength &gt;= next-&gt;size) {
-<a name="line355">355: </a>      next-&gt;size = fullLength+1;
-<a name="line356">356: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size * <font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
-<a name="line357">357: </a>      va_start(Argp,format);
-<a name="line358">358: </a>      <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
-<a name="line359">359: </a>      PetscVSNPrintf(next-&gt;string,next-&gt;size,format,&amp;fullLength,Argp);
-<a name="line360">360: </a>      va_end(Argp);
-<a name="line361">361: </a>    }
-<a name="line362">362: </a>  }
-<a name="line363">363: </a>  <font color="#4169E1">return</font>(0);
-<a name="line364">364: </a>}
-
-<a name="line368">368: </a><font color="#B22222">/*@</font>
-<a name="line369">369: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A> - Flushes to the screen output from all processors </font>
-<a name="line370">370: </a><font color="#B22222">    involved in previous <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>() calls.</font>
-
-<a name="line372">372: </a><font color="#B22222">    Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line374">374: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line375">375: </a><font color="#B22222">.   comm - the communicator</font>
-
-<a name="line377">377: </a><font color="#B22222">    Level: intermediate</font>
-
-<a name="line379">379: </a><font color="#B22222">    Notes:</font>
-<a name="line380">380: </a><font color="#B22222">    Usage of <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>() and <A href="../../../docs/manualpages/Sys/PetscSynchronizedFPrintf.html#PetscSynchronizedFPrintf">PetscSynchronizedFPrintf</A>() with</font>
-<a name="line381">381: </a><font color="#B22222">    different MPI communicators REQUIRES an intervening call to <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>().</font>
-
-<a name="line383">383: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(),</font>
-<a name="line384">384: </a><font color="#B22222">          <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>()</font>
-<a name="line385">385: </a><font color="#B22222">@*/</font>
-<a name="line386">386: </a><strong><font color="#4169E1"><a name="PetscSynchronizedFlush"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
-<a name="line387">387: </a>{
-<a name="line389">389: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank,size,tag,i,j,n;
-<a name="line390">390: </a>  char          *message;
-<a name="line391">391: </a>  MPI_Status     status;
-<a name="line392">392: </a>  FILE           *fd;
-
-<a name="line395">395: </a>  <A href="../../../docs/manualpages/Sys/PetscCommDuplicate.html#PetscCommDuplicate">PetscCommDuplicate</A>(comm,&amp;comm,&amp;tag);
-<a name="line396">396: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line397">397: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
-
-<a name="line399">399: </a>  <font color="#B22222">/* First processor waits for messages from all other processors */</font>
-<a name="line400">400: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line401">401: </a>    <font color="#4169E1">if</font> (queuefile) {
-<a name="line402">402: </a>      fd = queuefile;
-<a name="line403">403: </a>    } <font color="#4169E1">else</font> {
-<a name="line404">404: </a>      fd = PETSC_STDOUT;
-<a name="line405">405: </a>    }
-<a name="line406">406: </a>    <font color="#4169E1">for</font> (i=1; i&lt;size; i++) {
-<a name="line407">407: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv.html#MPI_Recv">MPI_Recv</A>(&amp;n,1,MPI_INT,i,tag,comm,&amp;status);
-<a name="line408">408: </a>      <font color="#4169E1">for</font> (j=0; j&lt;n; j++) {
-<a name="line409">409: </a>        int size;
-
-<a name="line411">411: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv.html#MPI_Recv">MPI_Recv</A>(&amp;size,1,MPI_INT,i,tag,comm,&amp;status);
-<a name="line412">412: </a>        <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(size * <font color="#4169E1">sizeof</font>(char), &amp;message);
-<a name="line413">413: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv.html#MPI_Recv">MPI_Recv</A>(message,size,MPI_CHAR,i,tag,comm,&amp;status);
-<a name="line414">414: </a>        <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(comm,fd,<font color="#666666">"%s"</font>,message);
-<a name="line415">415: </a>        <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(message);
-<a name="line416">416: </a>      }
-<a name="line417">417: </a>    }
-<a name="line418">418: </a>    queuefile = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line419">419: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors send queue to processor 0 */</font>
-<a name="line420">420: </a>    PrintfQueue next = queuebase,previous;
-
-<a name="line422">422: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(&amp;queuelength,1,MPI_INT,0,tag,comm);
-<a name="line423">423: </a>    <font color="#4169E1">for</font> (i=0; i&lt;queuelength; i++) {
-<a name="line424">424: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(&amp;next-&gt;size,1,MPI_INT,0,tag,comm);
-<a name="line425">425: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(next-&gt;string,next-&gt;size,MPI_CHAR,0,tag,comm);
-<a name="line426">426: </a>      previous = next;
-<a name="line427">427: </a>      next     = next-&gt;next;
-<a name="line428">428: </a>      <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(previous-&gt;string);
-<a name="line429">429: </a>      <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(previous);
-<a name="line430">430: </a>    }
-<a name="line431">431: </a>    queue       = 0;
-<a name="line432">432: </a>    queuelength = 0;
-<a name="line433">433: </a>  }
-<a name="line434">434: </a>  <A href="../../../docs/manualpages/Sys/PetscCommDestroy.html#PetscCommDestroy">PetscCommDestroy</A>(&amp;comm);
-<a name="line435">435: </a>  <font color="#4169E1">return</font>(0);
-<a name="line436">436: </a>}
-
-<a name="line438">438: </a><font color="#B22222">/* ---------------------------------------------------------------------------------------*/</font>
-
-<a name="line442">442: </a><font color="#B22222">/*@C</font>
-<a name="line443">443: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A> - Prints to a file, only from the first</font>
-<a name="line444">444: </a><font color="#B22222">    processor in the communicator.</font>
-
-<a name="line446">446: </a><font color="#B22222">    Not Collective</font>
-
-<a name="line448">448: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line449">449: </a><font color="#B22222">+   comm - the communicator</font>
-<a name="line450">450: </a><font color="#B22222">.   fd - the file pointer</font>
-<a name="line451">451: </a><font color="#B22222">-   format - the usual printf() format string </font>
-
-<a name="line453">453: </a><font color="#B22222">    Level: intermediate</font>
-
-<a name="line455">455: </a><font color="#B22222">    Fortran Note:</font>
-<a name="line456">456: </a><font color="#B22222">    This routine is not supported in Fortran.</font>
-
-<a name="line458">458: </a><font color="#B22222">   Concepts: printing^in parallel</font>
-<a name="line459">459: </a><font color="#B22222">   Concepts: printf^in parallel</font>
-
-<a name="line461">461: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(),</font>
-<a name="line462">462: </a><font color="#B22222">          <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>()</font>
-<a name="line463">463: </a><font color="#B22222">@*/</font>
-<a name="line464">464: </a><strong><font color="#4169E1"><a name="PetscFPrintf"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,FILE* fd,const char format[],...)</font></strong>
-<a name="line465">465: </a>{
-<a name="line467">467: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
-
-<a name="line470">470: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line471">471: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line472">472: </a>    va_list Argp;
-<a name="line473">473: </a>    va_start(Argp,format);
-<a name="line474">474: </a>    (*PetscVFPrintf)(fd,format,Argp);
-<a name="line475">475: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line476">476: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line477">477: </a>    }
-<a name="line478">478: </a>    va_end(Argp);
-<a name="line479">479: </a>  }
-<a name="line480">480: </a>  <font color="#4169E1">return</font>(0);
-<a name="line481">481: </a>}
-
-<a name="line485">485: </a><font color="#B22222">/*@C</font>
-<a name="line486">486: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A> - Prints to standard out, only from the first</font>
-<a name="line487">487: </a><font color="#B22222">    processor in the communicator.</font>
-
-<a name="line489">489: </a><font color="#B22222">    Not Collective</font>
-
-<a name="line491">491: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line492">492: </a><font color="#B22222">+   comm - the communicator</font>
-<a name="line493">493: </a><font color="#B22222">-   format - the usual printf() format string </font>
-
-<a name="line495">495: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line497">497: </a><font color="#B22222">    Fortran Note:</font>
-<a name="line498">498: </a><font color="#B22222">    The call sequence is <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>, character(*), <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> ierr) from Fortran. </font>
-<a name="line499">499: </a><font color="#B22222">    That is, you can only pass a single character string from Fortran.</font>
-
-<a name="line501">501: </a><font color="#B22222">   Notes: %A is replace with %g unless the value is &lt; 1.e-12 when it is </font>
-<a name="line502">502: </a><font color="#B22222">          replaced with &lt; 1.e-12</font>
-
-<a name="line504">504: </a><font color="#B22222">   Concepts: printing^in parallel</font>
-<a name="line505">505: </a><font color="#B22222">   Concepts: printf^in parallel</font>
-
-<a name="line507">507: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>()</font>
-<a name="line508">508: </a><font color="#B22222">@*/</font>
-<a name="line509">509: </a><strong><font color="#4169E1"><a name="PetscPrintf"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char format[],...)</font></strong>
-<a name="line510">510: </a>{
-<a name="line512">512: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
-<a name="line513">513: </a>  size_t         len;
-<a name="line514">514: </a>  char           *nformat,*sub1,*sub2;
-<a name="line515">515: </a>  <A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      value;
-
-<a name="line518">518: </a>  <font color="#4169E1">if</font> (!comm) comm = <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>;
-<a name="line519">519: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line520">520: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line521">521: </a>    va_list Argp;
-<a name="line522">522: </a>    va_start(Argp,format);
-
-<a name="line524">524: </a>    <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(format,<font color="#666666">"%A"</font>,&amp;sub1);
-<a name="line525">525: </a>    <font color="#4169E1">if</font> (sub1) {
-<a name="line526">526: </a>      <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(format,<font color="#666666">"%"</font>,&amp;sub2);
-<a name="line527">527: </a>      <font color="#4169E1">if</font> (sub1 != sub2) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"%%A format must be first in format string"</font>);
-<a name="line528">528: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(format,&amp;len);
-<a name="line529">529: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((len+16)*<font color="#4169E1">sizeof</font>(char),&amp;nformat);
-<a name="line530">530: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(nformat,format);
-<a name="line531">531: </a>      <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(nformat,<font color="#666666">"%"</font>,&amp;sub2);
-<a name="line532">532: </a>      sub2[0] = 0;
-<a name="line533">533: </a>      value   = (double)va_arg(Argp,double);
-<a name="line534">534: </a>      <font color="#4169E1">if</font> (PetscAbsReal(value) &lt; 1.e-12) {
-<a name="line535">535: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(nformat,<font color="#666666">"&lt; 1.e-12"</font>);
-<a name="line536">536: </a>      } <font color="#4169E1">else</font> {
-<a name="line537">537: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(nformat,<font color="#666666">"%g"</font>);
-<a name="line538">538: </a>        va_end(Argp);
-<a name="line539">539: </a>        va_start(Argp,format);
-<a name="line540">540: </a>      }
-<a name="line541">541: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(nformat,sub1+2);
-<a name="line542">542: </a>    } <font color="#4169E1">else</font> {
-<a name="line543">543: </a>      nformat = (char*)format;
-<a name="line544">544: </a>    }
-<a name="line545">545: </a>    (*PetscVFPrintf)(PETSC_STDOUT,nformat,Argp);
-<a name="line546">546: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line547">547: </a>      (*PetscVFPrintf)(petsc_history,nformat,Argp);
-<a name="line548">548: </a>    }
-<a name="line549">549: </a>    va_end(Argp);
-<a name="line550">550: </a>    <font color="#4169E1">if</font> (sub1) {<A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(nformat);}
-<a name="line551">551: </a>  }
-<a name="line552">552: </a>  <font color="#4169E1">return</font>(0);
-<a name="line553">553: </a>}
-
-<a name="line555">555: </a><font color="#B22222">/* ---------------------------------------------------------------------------------------*/</font>
-<a name="line558">558: </a><strong><font color="#4169E1"><a name="PetscHelpPrintfDefault"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscHelpPrintfDefault(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char format[],...)</font></strong>
-<a name="line559">559: </a>{
-<a name="line561">561: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
-
-<a name="line564">564: </a>  <font color="#4169E1">if</font> (!comm) comm = <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>;
-<a name="line565">565: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line566">566: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line567">567: </a>    va_list Argp;
-<a name="line568">568: </a>    va_start(Argp,format);
-<a name="line569">569: </a>    (*PetscVFPrintf)(PETSC_STDOUT,format,Argp);
-<a name="line570">570: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line571">571: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line572">572: </a>    }
-<a name="line573">573: </a>    va_end(Argp);
-<a name="line574">574: </a>  }
-<a name="line575">575: </a>  <font color="#4169E1">return</font>(0);
-<a name="line576">576: </a>}
-
-<a name="line578">578: </a><font color="#B22222">/* ---------------------------------------------------------------------------------------*/</font>
-
-
-<a name="line583">583: </a><font color="#B22222">/*@C</font>
-<a name="line584">584: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscSynchronizedFGets.html#PetscSynchronizedFGets">PetscSynchronizedFGets</A> - Several processors all get the same line from a file.</font>
-
-<a name="line586">586: </a><font color="#B22222">    Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line588">588: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line589">589: </a><font color="#B22222">+   comm - the communicator</font>
-<a name="line590">590: </a><font color="#B22222">.   fd - the file pointer</font>
-<a name="line591">591: </a><font color="#B22222">-   len - the length of the output buffer</font>
-
-<a name="line593">593: </a><font color="#B22222">    Output Parameter:</font>
-<a name="line594">594: </a><font color="#B22222">.   string - the line read from the file</font>
-
-<a name="line596">596: </a><font color="#B22222">    Level: intermediate</font>
-
-<a name="line598">598: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(), </font>
-<a name="line599">599: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscFOpen.html#PetscFOpen">PetscFOpen</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
-
-<a name="line601">601: </a><font color="#B22222">@*/</font>
-<a name="line602">602: </a><strong><font color="#4169E1"><a name="PetscSynchronizedFGets"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscSynchronizedFGets.html#PetscSynchronizedFGets">PetscSynchronizedFGets</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,FILE* fp,size_t len,char string[])</font></strong>
-<a name="line603">603: </a>{
-<a name="line605">605: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
-
-<a name="line608">608: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line609">609: </a>
-<a name="line610">610: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line611">611: </a>    fgets(string,len,fp);
-<a name="line612">612: </a>  }
-<a name="line613">613: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(string,len,MPI_BYTE,0,comm);
-<a name="line614">614: </a>  <font color="#4169E1">return</font>(0);
-<a name="line615">615: </a>}
+<a name="line277">277: </a>      va_start(Argp,format);
+<a name="line278">278: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line279">279: </a>    }
+<a name="line280">280: </a>    va_end(Argp);
+<a name="line281">281: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors add to local queue */</font>
+<a name="line282">282: </a>    va_list     Argp;
+<a name="line283">283: </a>    PrintfQueue next;
+<a name="line284">284: </a>    int         fullLength = 8191;
+
+<a name="line286">286: </a>    <A href="../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
+<a name="line287">287: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next; queue-&gt;next = 0;}
+<a name="line288">288: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
+<a name="line289">289: </a>    queuelength++;
+<a name="line290">290: </a>    next-&gt;size = -1;
+<a name="line291">291: </a>    <font color="#4169E1">while</font>(fullLength &gt;= next-&gt;size) {
+<a name="line292">292: </a>      next-&gt;size = fullLength+1;
+<a name="line293">293: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size * <font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
+<a name="line294">294: </a>      va_start(Argp,format);
+<a name="line295">295: </a>      <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
+<a name="line296">296: </a>      PetscVSNPrintf(next-&gt;string,next-&gt;size,format, &amp;fullLength,Argp);
+<a name="line297">297: </a>      va_end(Argp);
+<a name="line298">298: </a>    }
+<a name="line299">299: </a>  }
+<a name="line300">300: </a>
+<a name="line301">301: </a>  <font color="#4169E1">return</font>(0);
+<a name="line302">302: </a>}
+<a name="line303">303: </a>
+<a name="line306">306: </a><font color="#B22222">/*@C</font>
+<a name="line307">307: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscSynchronizedFPrintf.html#PetscSynchronizedFPrintf">PetscSynchronizedFPrintf</A> - Prints synchronized output to the specified file from</font>
+<a name="line308">308: </a><font color="#B22222">    several processors.  Output of the first processor is followed by that of the </font>
+<a name="line309">309: </a><font color="#B22222">    second, etc.</font>
+
+<a name="line311">311: </a><font color="#B22222">    Not Collective</font>
+
+<a name="line313">313: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line314">314: </a><font color="#B22222">+   comm - the communicator</font>
+<a name="line315">315: </a><font color="#B22222">.   fd - the file pointer</font>
+<a name="line316">316: </a><font color="#B22222">-   format - the usual printf() format string </font>
+
+<a name="line318">318: </a><font color="#B22222">    Level: intermediate</font>
+
+<a name="line320">320: </a><font color="#B22222">    Notes:</font>
+<a name="line321">321: </a><font color="#B22222">    REQUIRES a intervening call to <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>() for the information </font>
+<a name="line322">322: </a><font color="#B22222">    from all the processors to be printed.</font>
+
+<a name="line324">324: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(), <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(),</font>
+<a name="line325">325: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscFOpen.html#PetscFOpen">PetscFOpen</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
+
+<a name="line327">327: </a><font color="#B22222">@*/</font>
+<a name="line328">328: </a><strong><font color="#4169E1"><a name="PetscSynchronizedFPrintf"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscSynchronizedFPrintf.html#PetscSynchronizedFPrintf">PetscSynchronizedFPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,FILE* fp,const char format[],...)</font></strong>
+<a name="line329">329: </a>{
+<a name="line331">331: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
+
+<a name="line334">334: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line335">335: </a>
+<a name="line336">336: </a>  <font color="#B22222">/* First processor prints immediately to fp */</font>
+<a name="line337">337: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line338">338: </a>    va_list Argp;
+<a name="line339">339: </a>    va_start(Argp,format);
+<a name="line340">340: </a>    (*PetscVFPrintf)(fp,format,Argp);
+<a name="line341">341: </a>    queuefile = fp;
+<a name="line342">342: </a>    <font color="#4169E1">if</font> (petsc_history &amp;&amp; (fp !=petsc_history)) {
+<a name="line343">343: </a>      va_start(Argp,format);
+<a name="line344">344: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line345">345: </a>    }
+<a name="line346">346: </a>    va_end(Argp);
+<a name="line347">347: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors add to local queue */</font>
+<a name="line348">348: </a>    va_list     Argp;
+<a name="line349">349: </a>    PrintfQueue next;
+<a name="line350">350: </a>    int         fullLength = 8191;
+<a name="line351">351: </a>    <A href="../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
+<a name="line352">352: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next; queue-&gt;next = 0;}
+<a name="line353">353: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
+<a name="line354">354: </a>    queuelength++;
+<a name="line355">355: </a>    next-&gt;size = -1;
+<a name="line356">356: </a>    <font color="#4169E1">while</font>(fullLength &gt;= next-&gt;size) {
+<a name="line357">357: </a>      next-&gt;size = fullLength+1;
+<a name="line358">358: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size * <font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
+<a name="line359">359: </a>      va_start(Argp,format);
+<a name="line360">360: </a>      <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
+<a name="line361">361: </a>      PetscVSNPrintf(next-&gt;string,next-&gt;size,format,&amp;fullLength,Argp);
+<a name="line362">362: </a>      va_end(Argp);
+<a name="line363">363: </a>    }
+<a name="line364">364: </a>  }
+<a name="line365">365: </a>  <font color="#4169E1">return</font>(0);
+<a name="line366">366: </a>}
+
+<a name="line370">370: </a><font color="#B22222">/*@</font>
+<a name="line371">371: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A> - Flushes to the screen output from all processors </font>
+<a name="line372">372: </a><font color="#B22222">    involved in previous <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>() calls.</font>
+
+<a name="line374">374: </a><font color="#B22222">    Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line376">376: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line377">377: </a><font color="#B22222">.   comm - the communicator</font>
+
+<a name="line379">379: </a><font color="#B22222">    Level: intermediate</font>
+
+<a name="line381">381: </a><font color="#B22222">    Notes:</font>
+<a name="line382">382: </a><font color="#B22222">    Usage of <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>() and <A href="../../../docs/manualpages/Sys/PetscSynchronizedFPrintf.html#PetscSynchronizedFPrintf">PetscSynchronizedFPrintf</A>() with</font>
+<a name="line383">383: </a><font color="#B22222">    different MPI communicators REQUIRES an intervening call to <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>().</font>
+
+<a name="line385">385: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(),</font>
+<a name="line386">386: </a><font color="#B22222">          <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>()</font>
+<a name="line387">387: </a><font color="#B22222">@*/</font>
+<a name="line388">388: </a><strong><font color="#4169E1"><a name="PetscSynchronizedFlush"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
+<a name="line389">389: </a>{
+<a name="line391">391: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank,size,tag,i,j,n;
+<a name="line392">392: </a>  char          *message;
+<a name="line393">393: </a>  MPI_Status     status;
+<a name="line394">394: </a>  FILE           *fd;
+
+<a name="line397">397: </a>  <A href="../../../docs/manualpages/Sys/PetscCommDuplicate.html#PetscCommDuplicate">PetscCommDuplicate</A>(comm,&amp;comm,&amp;tag);
+<a name="line398">398: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line399">399: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
+
+<a name="line401">401: </a>  <font color="#B22222">/* First processor waits for messages from all other processors */</font>
+<a name="line402">402: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line403">403: </a>    <font color="#4169E1">if</font> (queuefile) {
+<a name="line404">404: </a>      fd = queuefile;
+<a name="line405">405: </a>    } <font color="#4169E1">else</font> {
+<a name="line406">406: </a>      fd = PETSC_STDOUT;
+<a name="line407">407: </a>    }
+<a name="line408">408: </a>    <font color="#4169E1">for</font> (i=1; i&lt;size; i++) {
+<a name="line409">409: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv.html#MPI_Recv">MPI_Recv</A>(&amp;n,1,MPI_INT,i,tag,comm,&amp;status);
+<a name="line410">410: </a>      <font color="#4169E1">for</font> (j=0; j&lt;n; j++) {
+<a name="line411">411: </a>        int size;
+
+<a name="line413">413: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv.html#MPI_Recv">MPI_Recv</A>(&amp;size,1,MPI_INT,i,tag,comm,&amp;status);
+<a name="line414">414: </a>        <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(size * <font color="#4169E1">sizeof</font>(char), &amp;message);
+<a name="line415">415: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv.html#MPI_Recv">MPI_Recv</A>(message,size,MPI_CHAR,i,tag,comm,&amp;status);
+<a name="line416">416: </a>        <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(comm,fd,<font color="#666666">"%s"</font>,message);
+<a name="line417">417: </a>        <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(message);
+<a name="line418">418: </a>      }
+<a name="line419">419: </a>    }
+<a name="line420">420: </a>    queuefile = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line421">421: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors send queue to processor 0 */</font>
+<a name="line422">422: </a>    PrintfQueue next = queuebase,previous;
+
+<a name="line424">424: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(&amp;queuelength,1,MPI_INT,0,tag,comm);
+<a name="line425">425: </a>    <font color="#4169E1">for</font> (i=0; i&lt;queuelength; i++) {
+<a name="line426">426: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(&amp;next-&gt;size,1,MPI_INT,0,tag,comm);
+<a name="line427">427: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(next-&gt;string,next-&gt;size,MPI_CHAR,0,tag,comm);
+<a name="line428">428: </a>      previous = next;
+<a name="line429">429: </a>      next     = next-&gt;next;
+<a name="line430">430: </a>      <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(previous-&gt;string);
+<a name="line431">431: </a>      <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(previous);
+<a name="line432">432: </a>    }
+<a name="line433">433: </a>    queue       = 0;
+<a name="line434">434: </a>    queuelength = 0;
+<a name="line435">435: </a>  }
+<a name="line436">436: </a>  <A href="../../../docs/manualpages/Sys/PetscCommDestroy.html#PetscCommDestroy">PetscCommDestroy</A>(&amp;comm);
+<a name="line437">437: </a>  <font color="#4169E1">return</font>(0);
+<a name="line438">438: </a>}
+
+<a name="line440">440: </a><font color="#B22222">/* ---------------------------------------------------------------------------------------*/</font>
+
+<a name="line444">444: </a><font color="#B22222">/*@C</font>
+<a name="line445">445: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A> - Prints to a file, only from the first</font>
+<a name="line446">446: </a><font color="#B22222">    processor in the communicator.</font>
+
+<a name="line448">448: </a><font color="#B22222">    Not Collective</font>
+
+<a name="line450">450: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line451">451: </a><font color="#B22222">+   comm - the communicator</font>
+<a name="line452">452: </a><font color="#B22222">.   fd - the file pointer</font>
+<a name="line453">453: </a><font color="#B22222">-   format - the usual printf() format string </font>
+
+<a name="line455">455: </a><font color="#B22222">    Level: intermediate</font>
+
+<a name="line457">457: </a><font color="#B22222">    Fortran Note:</font>
+<a name="line458">458: </a><font color="#B22222">    This routine is not supported in Fortran.</font>
+
+<a name="line460">460: </a><font color="#B22222">   Concepts: printing^in parallel</font>
+<a name="line461">461: </a><font color="#B22222">   Concepts: printf^in parallel</font>
+
+<a name="line463">463: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(),</font>
+<a name="line464">464: </a><font color="#B22222">          <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>()</font>
+<a name="line465">465: </a><font color="#B22222">@*/</font>
+<a name="line466">466: </a><strong><font color="#4169E1"><a name="PetscFPrintf"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,FILE* fd,const char format[],...)</font></strong>
+<a name="line467">467: </a>{
+<a name="line469">469: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
+
+<a name="line472">472: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line473">473: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line474">474: </a>    va_list Argp;
+<a name="line475">475: </a>    va_start(Argp,format);
+<a name="line476">476: </a>    (*PetscVFPrintf)(fd,format,Argp);
+<a name="line477">477: </a>    <font color="#4169E1">if</font> (petsc_history &amp;&amp; (fd !=petsc_history)) {
+<a name="line478">478: </a>      va_start(Argp,format);
+<a name="line479">479: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line480">480: </a>      }
+<a name="line481">481: </a>    va_end(Argp);
+<a name="line482">482: </a>  }
+<a name="line483">483: </a>  <font color="#4169E1">return</font>(0);
+<a name="line484">484: </a>}
+
+<a name="line488">488: </a><font color="#B22222">/*@C</font>
+<a name="line489">489: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A> - Prints to standard out, only from the first</font>
+<a name="line490">490: </a><font color="#B22222">    processor in the communicator.</font>
+
+<a name="line492">492: </a><font color="#B22222">    Not Collective</font>
+
+<a name="line494">494: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line495">495: </a><font color="#B22222">+   comm - the communicator</font>
+<a name="line496">496: </a><font color="#B22222">-   format - the usual printf() format string </font>
+
+<a name="line498">498: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line500">500: </a><font color="#B22222">    Fortran Note:</font>
+<a name="line501">501: </a><font color="#B22222">    The call sequence is <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>, character(*), <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> ierr) from Fortran. </font>
+<a name="line502">502: </a><font color="#B22222">    That is, you can only pass a single character string from Fortran.</font>
+
+<a name="line504">504: </a><font color="#B22222">   Notes: %A is replace with %g unless the value is &lt; 1.e-12 when it is </font>
+<a name="line505">505: </a><font color="#B22222">          replaced with &lt; 1.e-12</font>
+
+<a name="line507">507: </a><font color="#B22222">   Concepts: printing^in parallel</font>
+<a name="line508">508: </a><font color="#B22222">   Concepts: printf^in parallel</font>
+
+<a name="line510">510: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>()</font>
+<a name="line511">511: </a><font color="#B22222">@*/</font>
+<a name="line512">512: </a><strong><font color="#4169E1"><a name="PetscPrintf"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char format[],...)</font></strong>
+<a name="line513">513: </a>{
+<a name="line515">515: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
+<a name="line516">516: </a>  size_t         len;
+<a name="line517">517: </a>  char           *nformat,*sub1,*sub2;
+<a name="line518">518: </a>  <A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      value;
+
+<a name="line521">521: </a>  <font color="#4169E1">if</font> (!comm) comm = <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>;
+<a name="line522">522: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line523">523: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line524">524: </a>    va_list Argp;
+<a name="line525">525: </a>    va_start(Argp,format);
+
+<a name="line527">527: </a>    <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(format,<font color="#666666">"%A"</font>,&amp;sub1);
+<a name="line528">528: </a>    <font color="#4169E1">if</font> (sub1) {
+<a name="line529">529: </a>      <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(format,<font color="#666666">"%"</font>,&amp;sub2);
+<a name="line530">530: </a>      <font color="#4169E1">if</font> (sub1 != sub2) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"%%A format must be first in format string"</font>);
+<a name="line531">531: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(format,&amp;len);
+<a name="line532">532: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((len+16)*<font color="#4169E1">sizeof</font>(char),&amp;nformat);
+<a name="line533">533: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(nformat,format);
+<a name="line534">534: </a>      <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(nformat,<font color="#666666">"%"</font>,&amp;sub2);
+<a name="line535">535: </a>      sub2[0] = 0;
+<a name="line536">536: </a>      value   = (double)va_arg(Argp,double);
+<a name="line537">537: </a>      <font color="#4169E1">if</font> (PetscAbsReal(value) &lt; 1.e-12) {
+<a name="line538">538: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(nformat,<font color="#666666">"&lt; 1.e-12"</font>);
+<a name="line539">539: </a>      } <font color="#4169E1">else</font> {
+<a name="line540">540: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(nformat,<font color="#666666">"%g"</font>);
+<a name="line541">541: </a>        va_end(Argp);
+<a name="line542">542: </a>        va_start(Argp,format);
+<a name="line543">543: </a>      }
+<a name="line544">544: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(nformat,sub1+2);
+<a name="line545">545: </a>    } <font color="#4169E1">else</font> {
+<a name="line546">546: </a>      nformat = (char*)format;
+<a name="line547">547: </a>    }
+<a name="line548">548: </a>    (*PetscVFPrintf)(PETSC_STDOUT,nformat,Argp);
+<a name="line549">549: </a>    <font color="#4169E1">if</font> (petsc_history) {
+<a name="line550">550: </a>      va_start(Argp,format);
+<a name="line551">551: </a>      (*PetscVFPrintf)(petsc_history,nformat,Argp);
+<a name="line552">552: </a>    }
+<a name="line553">553: </a>    va_end(Argp);
+<a name="line554">554: </a>    <font color="#4169E1">if</font> (sub1) {<A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(nformat);}
+<a name="line555">555: </a>  }
+<a name="line556">556: </a>  <font color="#4169E1">return</font>(0);
+<a name="line557">557: </a>}
+
+<a name="line559">559: </a><font color="#B22222">/* ---------------------------------------------------------------------------------------*/</font>
+<a name="line562">562: </a><strong><font color="#4169E1"><a name="PetscHelpPrintfDefault"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscHelpPrintfDefault(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char format[],...)</font></strong>
+<a name="line563">563: </a>{
+<a name="line565">565: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
+
+<a name="line568">568: </a>  <font color="#4169E1">if</font> (!comm) comm = <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>;
+<a name="line569">569: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line570">570: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line571">571: </a>    va_list Argp;
+<a name="line572">572: </a>    va_start(Argp,format);
+<a name="line573">573: </a>    (*PetscVFPrintf)(PETSC_STDOUT,format,Argp);
+<a name="line574">574: </a>    <font color="#4169E1">if</font> (petsc_history) {
+<a name="line575">575: </a>      va_start(Argp,format);
+<a name="line576">576: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line577">577: </a>    }
+<a name="line578">578: </a>    va_end(Argp);
+<a name="line579">579: </a>  }
+<a name="line580">580: </a>  <font color="#4169E1">return</font>(0);
+<a name="line581">581: </a>}
+
+<a name="line583">583: </a><font color="#B22222">/* ---------------------------------------------------------------------------------------*/</font>
+
+
+<a name="line588">588: </a><font color="#B22222">/*@C</font>
+<a name="line589">589: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscSynchronizedFGets.html#PetscSynchronizedFGets">PetscSynchronizedFGets</A> - Several processors all get the same line from a file.</font>
+
+<a name="line591">591: </a><font color="#B22222">    Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line593">593: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line594">594: </a><font color="#B22222">+   comm - the communicator</font>
+<a name="line595">595: </a><font color="#B22222">.   fd - the file pointer</font>
+<a name="line596">596: </a><font color="#B22222">-   len - the length of the output buffer</font>
+
+<a name="line598">598: </a><font color="#B22222">    Output Parameter:</font>
+<a name="line599">599: </a><font color="#B22222">.   string - the line read from the file</font>
+
+<a name="line601">601: </a><font color="#B22222">    Level: intermediate</font>
+
+<a name="line603">603: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(), </font>
+<a name="line604">604: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscFOpen.html#PetscFOpen">PetscFOpen</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(), <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
+
+<a name="line606">606: </a><font color="#B22222">@*/</font>
+<a name="line607">607: </a><strong><font color="#4169E1"><a name="PetscSynchronizedFGets"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscSynchronizedFGets.html#PetscSynchronizedFGets">PetscSynchronizedFGets</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,FILE* fp,size_t len,char string[])</font></strong>
+<a name="line608">608: </a>{
+<a name="line610">610: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
+
+<a name="line613">613: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line614">614: </a>
+<a name="line615">615: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line616">616: </a>    fgets(string,len,fp);
+<a name="line617">617: </a>  }
+<a name="line618">618: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(string,len,MPI_BYTE,0,comm);
+<a name="line619">619: </a>  <font color="#4169E1">return</font>(0);
+<a name="line620">620: </a>}
 </pre>
 </body>
 
Index: petsc/src/sys/objects/init.c
===================================================================
--- petsc.orig/src/sys/objects/init.c
+++ petsc/src/sys/objects/init.c
@@ -239,7 +239,7 @@
   /*
       Setup the memory management; support for tracing malloc() usage 
   */
-  ierr = PetscOptionsGetTruth(PETSC_NULL,"-malloc_log",&flg3,PETSC_NULL);CHKERRQ(ierr);
+  ierr = PetscOptionsHasName(PETSC_NULL,"-malloc_log",&flg3);CHKERRQ(ierr);
 #if defined(PETSC_USE_DEBUG)
   ierr = PetscOptionsGetTruth(PETSC_NULL,"-malloc",&flg1,&flg2);CHKERRQ(ierr);
   if ((!flg2 || flg1) && !petscsetmallocvisited) {
@@ -435,14 +435,12 @@
         Setup profiling and logging
   */
 #if defined (PETSC_USE_INFO)
-  flg1 = PETSC_FALSE;
-  ierr = PetscOptionsGetTruth(PETSC_NULL,"-info",&flg1,PETSC_NULL);CHKERRQ(ierr);
-  if (flg1) { 
+  { 
     char logname[PETSC_MAX_PATH_LEN]; logname[0] = 0;
     ierr = PetscOptionsGetString(PETSC_NULL,"-info",logname,250,&flg1);CHKERRQ(ierr);
-    if (logname[0]) {
+    if (flg1 && logname[0]) {
       PetscInfoAllow(PETSC_TRUE,logname); 
-    } else {
+    } else if (flg1) {
       PetscInfoAllow(PETSC_TRUE,PETSC_NULL); 
     }
   }
Index: petsc/src/sys/objects/init.c.html
===================================================================
--- petsc.orig/src/sys/objects/init.c.html
+++ petsc/src/sys/objects/init.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:21:53+00:00">
+<meta name="date" content="2011-03-17T18:43:05+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -223,7 +223,7 @@
 <a name="line239">239: </a>  <font color="#B22222">/*</font>
 <a name="line240">240: </a><font color="#B22222">      Setup the memory management; support for tracing malloc() usage </font>
 <a name="line241">241: </a><font color="#B22222">  */</font>
-<a name="line242">242: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_log"</font>,&amp;flg3,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line242">242: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_log"</font>,&amp;flg3);
 <a name="line243">243: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
 <a name="line244">244: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc"</font>,&amp;flg1,&amp;flg2);
 <a name="line245">245: </a>  <font color="#4169E1">if</font> ((!flg2 || flg1) &amp;&amp; !petscsetmallocvisited) {
@@ -418,136 +418,134 @@
 <a name="line435">435: </a><font color="#B22222">        Setup profiling and logging</font>
 <a name="line436">436: </a><font color="#B22222">  */</font>
 <a name="line437">437: </a><font color="#A020F0">#if defined (PETSC_USE_INFO)</font>
-<a name="line438">438: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line439">439: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-info"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line440">440: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line441">441: </a>    char logname[PETSC_MAX_PATH_LEN]; logname[0] = 0;
-<a name="line442">442: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-info"</font>,logname,250,&amp;flg1);
-<a name="line443">443: </a>    <font color="#4169E1">if</font> (logname[0]) {
-<a name="line444">444: </a>      <A href="../../../docs/manualpages/Profiling/PetscInfoAllow.html#PetscInfoAllow">PetscInfoAllow</A>(<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>,logname);
-<a name="line445">445: </a>    } <font color="#4169E1">else</font> {
-<a name="line446">446: </a>      <A href="../../../docs/manualpages/Profiling/PetscInfoAllow.html#PetscInfoAllow">PetscInfoAllow</A>(<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line447">447: </a>    }
-<a name="line448">448: </a>  }
-<a name="line449">449: </a><font color="#A020F0">#endif</font>
-<a name="line450">450: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
-<a name="line451">451: </a>  mname[0] = 0;
-<a name="line452">452: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_history"</font>,mname,PETSC_MAX_PATH_LEN,&amp;flg1);
-<a name="line453">453: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line454">454: </a>    <font color="#4169E1">if</font> (mname[0]) {
-<a name="line455">455: </a>      PetscLogOpenHistoryFile(mname,&amp;petsc_history);
-<a name="line456">456: </a>    } <font color="#4169E1">else</font> {
-<a name="line457">457: </a>      PetscLogOpenHistoryFile(0,&amp;petsc_history);
-<a name="line458">458: </a>    }
-<a name="line459">459: </a>  }
-<a name="line460">460: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPE)</font>
-<a name="line461">461: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line462">462: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_mpe"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line463">463: </a>  <font color="#4169E1">if</font> (flg1) <A href="../../../docs/manualpages/Profiling/PetscLogMPEBegin.html#PetscLogMPEBegin">PetscLogMPEBegin</A>();
-<a name="line464">464: </a><font color="#A020F0">#endif</font>
-<a name="line465">465: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line466">466: </a>  flg2 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line467">467: </a>  flg3 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line468">468: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_all"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line469">469: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log"</font>,&amp;flg2,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line470">470: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_summary"</font>,&amp;flg3);
-<a name="line471">471: </a>  <font color="#4169E1">if</font> (flg1)              {  <A href="../../../docs/manualpages/Profiling/PetscLogAllBegin.html#PetscLogAllBegin">PetscLogAllBegin</A>(); }
-<a name="line472">472: </a>  <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg2 || flg3) {  <A href="../../../docs/manualpages/Profiling/PetscLogBegin.html#PetscLogBegin">PetscLogBegin</A>();}
-<a name="line473">473: </a>
-<a name="line474">474: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_trace"</font>,mname,250,&amp;flg1);
-<a name="line475">475: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line476">476: </a>    char name[PETSC_MAX_PATH_LEN],fname[PETSC_MAX_PATH_LEN];
-<a name="line477">477: </a>    FILE *file;
-<a name="line478">478: </a>    <font color="#4169E1">if</font> (mname[0]) {
-<a name="line479">479: </a>      sprintf(name,<font color="#666666">"%s.%d"</font>,mname,rank);
-<a name="line480">480: </a>      <A href="../../../docs/manualpages/Sys/PetscFixFilename.html#PetscFixFilename">PetscFixFilename</A>(name,fname);
-<a name="line481">481: </a>      file = fopen(fname,<font color="#666666">"w"</font>);
-<a name="line482">482: </a>      <font color="#4169E1">if</font> (!file) {
-<a name="line483">483: </a>        <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Unable to open trace file: %s"</font>,fname);
-<a name="line484">484: </a>      }
-<a name="line485">485: </a>    } <font color="#4169E1">else</font> {
-<a name="line486">486: </a>      file = PETSC_STDOUT;
-<a name="line487">487: </a>    }
-<a name="line488">488: </a>    <A href="../../../docs/manualpages/Profiling/PetscLogTraceBegin.html#PetscLogTraceBegin">PetscLogTraceBegin</A>(file);
-<a name="line489">489: </a>  }
-<a name="line490">490: </a><font color="#A020F0">#endif</font>
-
-<a name="line492">492: </a>  <font color="#B22222">/*</font>
-<a name="line493">493: </a><font color="#B22222">      Setup building of stack frames for all function calls</font>
-<a name="line494">494: </a><font color="#B22222">  */</font>
-<a name="line495">495: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line496">496: </a>  PetscStackCreate();
-<a name="line497">497: </a><font color="#A020F0">#endif</font>
-
-<a name="line499">499: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-options_gui"</font>,&amp;PetscOptionsPublish,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-
-<a name="line501">501: </a>  <font color="#B22222">/*</font>
-<a name="line502">502: </a><font color="#B22222">       Print basic help message</font>
-<a name="line503">503: </a><font color="#B22222">  */</font>
-<a name="line504">504: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-help"</font>,&amp;flg1);
-<a name="line505">505: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line506">506: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"Options for all PETSc programs:\n"</font>);
-<a name="line507">507: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -help: prints help method for each option"</font>);
-<a name="line508">508: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -on_error_abort: cause an abort when an error is"</font>);
-<a name="line509">509: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" detected. Useful \n       only when run in the debugger\n"</font>);
-<a name="line510">510: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -on_error_attach_debugger [gdb,dbx,xxgdb,ups,noxterm]\n"</font>);
-<a name="line511">511: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"       start the debugger in new xterm\n"</font>);
-<a name="line512">512: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"       unless noxterm is given\n"</font>);
-<a name="line513">513: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -start_in_debugger [gdb,dbx,xxgdb,ups,noxterm]\n"</font>);
-<a name="line514">514: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"       start all processes in the debugger\n"</font>);
-<a name="line515">515: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -on_error_emacs &lt;machinename&gt;\n"</font>);
-<a name="line516">516: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"    emacs jumps to error file\n"</font>);
-<a name="line517">517: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -debugger_nodes [n1,n2,..] Nodes to start in debugger\n"</font>);
-<a name="line518">518: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -debugger_pause [m] : delay (in seconds) to attach debugger\n"</font>);
-<a name="line519">519: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -stop_for_debugger : prints message on how to attach debugger manually\n"</font>);
-<a name="line520">520: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"                      waits the delay for you to attach\n"</font>);
-<a name="line521">521: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -display display: Location where graphics and debuggers are displayed\n"</font>);
-<a name="line522">522: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -no_signal_handler: do not trap error signals\n"</font>);
-<a name="line523">523: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -mpi_return_on_error: MPI returns error code, rather than abort on internal error\n"</font>);
-<a name="line524">524: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -fp_trap: stop on floating point exceptions\n"</font>);
-<a name="line525">525: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"           note on IBM RS6000 this slows run greatly\n"</font>);
-<a name="line526">526: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_dump &lt;optional filename&gt;: dump list of unfreed memory at conclusion\n"</font>);
-<a name="line527">527: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc: use our error checking malloc\n"</font>);
-<a name="line528">528: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc no: don't use error checking malloc\n"</font>);
-<a name="line529">529: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_info: prints total memory usage\n"</font>);
-<a name="line530">530: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_log: keeps log of all memory allocations\n"</font>);
-<a name="line531">531: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_debug: enables extended checking for memory corruption\n"</font>);
-<a name="line532">532: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_table: dump list of options inputted\n"</font>);
-<a name="line533">533: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_left: dump list of unused options\n"</font>);
-<a name="line534">534: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_left no: don't dump list of unused options\n"</font>);
-<a name="line535">535: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -tmp tmpdir: alternative /tmp directory\n"</font>);
-<a name="line536">536: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -shared_tmp: tmp directory is shared by all processors\n"</font>);
-<a name="line537">537: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -not_shared_tmp: each processor has separate tmp directory\n"</font>);
-<a name="line538">538: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -memory_info: print memory usage at end of run\n"</font>);
-<a name="line539">539: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
-<a name="line540">540: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -get_total_flops: total flops over all processors\n"</font>);
-<a name="line541">541: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -log[_all _summary]: logging objects and events\n"</font>);
-<a name="line542">542: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -log_trace [filename]: prints trace of all PETSc calls\n"</font>);
-<a name="line543">543: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPE)</font>
-<a name="line544">544: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -log_mpe: Also create logfile viewable through upshot\n"</font>);
+<a name="line438">438: </a>  {
+<a name="line439">439: </a>    char logname[PETSC_MAX_PATH_LEN]; logname[0] = 0;
+<a name="line440">440: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-info"</font>,logname,250,&amp;flg1);
+<a name="line441">441: </a>    <font color="#4169E1">if</font> (flg1 &amp;&amp; logname[0]) {
+<a name="line442">442: </a>      <A href="../../../docs/manualpages/Profiling/PetscInfoAllow.html#PetscInfoAllow">PetscInfoAllow</A>(<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>,logname);
+<a name="line443">443: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg1) {
+<a name="line444">444: </a>      <A href="../../../docs/manualpages/Profiling/PetscInfoAllow.html#PetscInfoAllow">PetscInfoAllow</A>(<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line445">445: </a>    }
+<a name="line446">446: </a>  }
+<a name="line447">447: </a><font color="#A020F0">#endif</font>
+<a name="line448">448: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
+<a name="line449">449: </a>  mname[0] = 0;
+<a name="line450">450: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_history"</font>,mname,PETSC_MAX_PATH_LEN,&amp;flg1);
+<a name="line451">451: </a>  <font color="#4169E1">if</font> (flg1) {
+<a name="line452">452: </a>    <font color="#4169E1">if</font> (mname[0]) {
+<a name="line453">453: </a>      PetscLogOpenHistoryFile(mname,&amp;petsc_history);
+<a name="line454">454: </a>    } <font color="#4169E1">else</font> {
+<a name="line455">455: </a>      PetscLogOpenHistoryFile(0,&amp;petsc_history);
+<a name="line456">456: </a>    }
+<a name="line457">457: </a>  }
+<a name="line458">458: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPE)</font>
+<a name="line459">459: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line460">460: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_mpe"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line461">461: </a>  <font color="#4169E1">if</font> (flg1) <A href="../../../docs/manualpages/Profiling/PetscLogMPEBegin.html#PetscLogMPEBegin">PetscLogMPEBegin</A>();
+<a name="line462">462: </a><font color="#A020F0">#endif</font>
+<a name="line463">463: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line464">464: </a>  flg2 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line465">465: </a>  flg3 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line466">466: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_all"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line467">467: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log"</font>,&amp;flg2,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line468">468: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_summary"</font>,&amp;flg3);
+<a name="line469">469: </a>  <font color="#4169E1">if</font> (flg1)              {  <A href="../../../docs/manualpages/Profiling/PetscLogAllBegin.html#PetscLogAllBegin">PetscLogAllBegin</A>(); }
+<a name="line470">470: </a>  <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg2 || flg3) {  <A href="../../../docs/manualpages/Profiling/PetscLogBegin.html#PetscLogBegin">PetscLogBegin</A>();}
+<a name="line471">471: </a>
+<a name="line472">472: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_trace"</font>,mname,250,&amp;flg1);
+<a name="line473">473: </a>  <font color="#4169E1">if</font> (flg1) {
+<a name="line474">474: </a>    char name[PETSC_MAX_PATH_LEN],fname[PETSC_MAX_PATH_LEN];
+<a name="line475">475: </a>    FILE *file;
+<a name="line476">476: </a>    <font color="#4169E1">if</font> (mname[0]) {
+<a name="line477">477: </a>      sprintf(name,<font color="#666666">"%s.%d"</font>,mname,rank);
+<a name="line478">478: </a>      <A href="../../../docs/manualpages/Sys/PetscFixFilename.html#PetscFixFilename">PetscFixFilename</A>(name,fname);
+<a name="line479">479: </a>      file = fopen(fname,<font color="#666666">"w"</font>);
+<a name="line480">480: </a>      <font color="#4169E1">if</font> (!file) {
+<a name="line481">481: </a>        <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Unable to open trace file: %s"</font>,fname);
+<a name="line482">482: </a>      }
+<a name="line483">483: </a>    } <font color="#4169E1">else</font> {
+<a name="line484">484: </a>      file = PETSC_STDOUT;
+<a name="line485">485: </a>    }
+<a name="line486">486: </a>    <A href="../../../docs/manualpages/Profiling/PetscLogTraceBegin.html#PetscLogTraceBegin">PetscLogTraceBegin</A>(file);
+<a name="line487">487: </a>  }
+<a name="line488">488: </a><font color="#A020F0">#endif</font>
+
+<a name="line490">490: </a>  <font color="#B22222">/*</font>
+<a name="line491">491: </a><font color="#B22222">      Setup building of stack frames for all function calls</font>
+<a name="line492">492: </a><font color="#B22222">  */</font>
+<a name="line493">493: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line494">494: </a>  PetscStackCreate();
+<a name="line495">495: </a><font color="#A020F0">#endif</font>
+
+<a name="line497">497: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-options_gui"</font>,&amp;PetscOptionsPublish,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+
+<a name="line499">499: </a>  <font color="#B22222">/*</font>
+<a name="line500">500: </a><font color="#B22222">       Print basic help message</font>
+<a name="line501">501: </a><font color="#B22222">  */</font>
+<a name="line502">502: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-help"</font>,&amp;flg1);
+<a name="line503">503: </a>  <font color="#4169E1">if</font> (flg1) {
+<a name="line504">504: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"Options for all PETSc programs:\n"</font>);
+<a name="line505">505: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -help: prints help method for each option"</font>);
+<a name="line506">506: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -on_error_abort: cause an abort when an error is"</font>);
+<a name="line507">507: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" detected. Useful \n       only when run in the debugger\n"</font>);
+<a name="line508">508: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -on_error_attach_debugger [gdb,dbx,xxgdb,ups,noxterm]\n"</font>);
+<a name="line509">509: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"       start the debugger in new xterm\n"</font>);
+<a name="line510">510: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"       unless noxterm is given\n"</font>);
+<a name="line511">511: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -start_in_debugger [gdb,dbx,xxgdb,ups,noxterm]\n"</font>);
+<a name="line512">512: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"       start all processes in the debugger\n"</font>);
+<a name="line513">513: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -on_error_emacs &lt;machinename&gt;\n"</font>);
+<a name="line514">514: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"    emacs jumps to error file\n"</font>);
+<a name="line515">515: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -debugger_nodes [n1,n2,..] Nodes to start in debugger\n"</font>);
+<a name="line516">516: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -debugger_pause [m] : delay (in seconds) to attach debugger\n"</font>);
+<a name="line517">517: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -stop_for_debugger : prints message on how to attach debugger manually\n"</font>);
+<a name="line518">518: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"                      waits the delay for you to attach\n"</font>);
+<a name="line519">519: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -display display: Location where graphics and debuggers are displayed\n"</font>);
+<a name="line520">520: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -no_signal_handler: do not trap error signals\n"</font>);
+<a name="line521">521: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -mpi_return_on_error: MPI returns error code, rather than abort on internal error\n"</font>);
+<a name="line522">522: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -fp_trap: stop on floating point exceptions\n"</font>);
+<a name="line523">523: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"           note on IBM RS6000 this slows run greatly\n"</font>);
+<a name="line524">524: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_dump &lt;optional filename&gt;: dump list of unfreed memory at conclusion\n"</font>);
+<a name="line525">525: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc: use our error checking malloc\n"</font>);
+<a name="line526">526: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc no: don't use error checking malloc\n"</font>);
+<a name="line527">527: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_info: prints total memory usage\n"</font>);
+<a name="line528">528: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_log: keeps log of all memory allocations\n"</font>);
+<a name="line529">529: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -malloc_debug: enables extended checking for memory corruption\n"</font>);
+<a name="line530">530: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_table: dump list of options inputted\n"</font>);
+<a name="line531">531: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_left: dump list of unused options\n"</font>);
+<a name="line532">532: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_left no: don't dump list of unused options\n"</font>);
+<a name="line533">533: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -tmp tmpdir: alternative /tmp directory\n"</font>);
+<a name="line534">534: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -shared_tmp: tmp directory is shared by all processors\n"</font>);
+<a name="line535">535: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -not_shared_tmp: each processor has separate tmp directory\n"</font>);
+<a name="line536">536: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -memory_info: print memory usage at end of run\n"</font>);
+<a name="line537">537: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
+<a name="line538">538: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -get_total_flops: total flops over all processors\n"</font>);
+<a name="line539">539: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -log[_all _summary]: logging objects and events\n"</font>);
+<a name="line540">540: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -log_trace [filename]: prints trace of all PETSc calls\n"</font>);
+<a name="line541">541: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPE)</font>
+<a name="line542">542: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -log_mpe: Also create logfile viewable through upshot\n"</font>);
+<a name="line543">543: </a><font color="#A020F0">#endif</font>
+<a name="line544">544: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -info &lt;optional filename&gt;: print informative messages about the calculations\n"</font>);
 <a name="line545">545: </a><font color="#A020F0">#endif</font>
-<a name="line546">546: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -info &lt;optional filename&gt;: print informative messages about the calculations\n"</font>);
-<a name="line547">547: </a><font color="#A020F0">#endif</font>
-<a name="line548">548: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -v: prints PETSc version number and release date\n"</font>);
-<a name="line549">549: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_file &lt;file&gt;: reads options from file\n"</font>);
-<a name="line550">550: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -petsc_sleep n: sleeps n seconds before running program\n"</font>);
-<a name="line551">551: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"-----------------------------------------------\n"</font>);
-<a name="line552">552: </a>  }
-
-<a name="line554">554: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-petsc_sleep"</font>,&amp;si,&amp;flg1);
-<a name="line555">555: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line556">556: </a>    <A href="../../../docs/manualpages/Sys/PetscSleep.html#PetscSleep">PetscSleep</A>(si);
-<a name="line557">557: </a>  }
-
-<a name="line559">559: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-info_exclude"</font>,mname,PETSC_MAX_PATH_LEN,&amp;flg1);
-<a name="line560">560: </a>  <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(mname,<font color="#666666">"null"</font>,&amp;f);
-<a name="line561">561: </a>  <font color="#4169E1">if</font> (f) {
-<a name="line562">562: </a>    <A href="../../../docs/manualpages/Profiling/PetscInfoDeactivateClass.html#PetscInfoDeactivateClass">PetscInfoDeactivateClass</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line563">563: </a>  }
+<a name="line546">546: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -v: prints PETSc version number and release date\n"</font>);
+<a name="line547">547: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -options_file &lt;file&gt;: reads options from file\n"</font>);
+<a name="line548">548: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">" -petsc_sleep n: sleeps n seconds before running program\n"</font>);
+<a name="line549">549: </a>    (*<A href="../../../docs/manualpages/Sys/PetscHelpPrintf.html#PetscHelpPrintf">PetscHelpPrintf</A>)(comm,<font color="#666666">"-----------------------------------------------\n"</font>);
+<a name="line550">550: </a>  }
+
+<a name="line552">552: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-petsc_sleep"</font>,&amp;si,&amp;flg1);
+<a name="line553">553: </a>  <font color="#4169E1">if</font> (flg1) {
+<a name="line554">554: </a>    <A href="../../../docs/manualpages/Sys/PetscSleep.html#PetscSleep">PetscSleep</A>(si);
+<a name="line555">555: </a>  }
+
+<a name="line557">557: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-info_exclude"</font>,mname,PETSC_MAX_PATH_LEN,&amp;flg1);
+<a name="line558">558: </a>  <A href="../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(mname,<font color="#666666">"null"</font>,&amp;f);
+<a name="line559">559: </a>  <font color="#4169E1">if</font> (f) {
+<a name="line560">560: </a>    <A href="../../../docs/manualpages/Profiling/PetscInfoDeactivateClass.html#PetscInfoDeactivateClass">PetscInfoDeactivateClass</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line561">561: </a>  }
 
 
-<a name="line566">566: </a>  <font color="#4169E1">return</font>(0);
-<a name="line567">567: </a>}
+<a name="line564">564: </a>  <font color="#4169E1">return</font>(0);
+<a name="line565">565: </a>}
 
 
 </pre>
Index: petsc/src/sys/objects/options.c
===================================================================
--- petsc.orig/src/sys/objects/options.c
+++ petsc/src/sys/objects/options.c
@@ -1,4 +1,8 @@
 #define PETSC_DLL
+
+/* Feature test macros to make sure atoll is available (SVr4, POSIX.1-2001, 4.3BSD, C99), not in (C89 and POSIX.1-1996) */
+#define _XOPEN_SOURCE 600
+#define _BSD_SOURCE
 /*
    These routines simplify the use of command line, file options, etc., and are used to manipulate the options database.
    This provides the low-level interface, the high level interface is in aoptions.c
@@ -95,7 +99,11 @@
         SETERRQ1(PETSC_ERR_ARG_OUTOFRANGE,"Input string %s has no integer value (do not include . in it)",name);
       }
     }
-    *a  = atoi(name);
+#if defined(PETSC_USE_64BIT_INDICES)
+    *a = atoll(name);
+#else
+    *a = atoi(name);
+#endif
   }
   PetscFunctionReturn(0);
 }
Index: petsc/src/sys/objects/options.c.html
===================================================================
--- petsc.orig/src/sys/objects/options.c.html
+++ petsc/src/sys/objects/options.c.html
@@ -4,1870 +4,1878 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:21:43+00:00">
+<meta name="date" content="2011-03-17T18:42:57+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
 <pre width="80"><a name="line1">  1: </a><strong><font color="#228B22">#define PETSC_DLL</font></strong>
-<a name="line2">  2: </a><font color="#B22222">/*</font>
-<a name="line3">  3: </a><font color="#B22222">   These routines simplify the use of command line, file options, etc., and are used to manipulate the options database.</font>
-<a name="line4">  4: </a><font color="#B22222">   This provides the low-level interface, the high level interface is in aoptions.c</font>
-
-<a name="line6">  6: </a><font color="#B22222">   Some routines use regular malloc and free because it cannot know  what malloc is requested with the </font>
-<a name="line7">  7: </a><font color="#B22222">   options database until it has already processed the input.</font>
-<a name="line8">  8: </a><font color="#B22222">*/</font>
-
-<a name="line10"> 10: </a> #include <A href="../../../include/petscsys.h.html">petscsys.h</A>
-<a name="line11"> 11: </a><font color="#A020F0">#if defined(PETSC_HAVE_STDLIB_H)</font>
-<a name="line12"> 12: </a><font color="#A020F0">#include &lt;stdlib.h&gt;</font>
-<a name="line13"> 13: </a><font color="#A020F0">#endif</font>
-<a name="line14"> 14: </a><font color="#A020F0">#if defined(PETSC_HAVE_MALLOC_H)</font>
-<a name="line15"> 15: </a><font color="#A020F0">#include &lt;malloc.h&gt;</font>
-<a name="line16"> 16: </a><font color="#A020F0">#endif</font>
-<a name="line17"> 17: </a><font color="#A020F0">#if defined(PETSC_HAVE_SYS_PARAM_H)</font>
-<a name="line18"> 18: </a><font color="#A020F0">#include </font><font color="#666666">"sys/param.h"</font><font color="#A020F0"></font>
-<a name="line19"> 19: </a><font color="#A020F0">#endif</font>
-
-<a name="line21"> 21: </a><font color="#B22222">/* </font>
-<a name="line22"> 22: </a><font color="#B22222">    This table holds all the options set by the user. For simplicity, we use a static size database</font>
-<a name="line23"> 23: </a><font color="#B22222">*/</font>
-<a name="line24"> 24: </a><strong><font color="#228B22">#define MAXOPTIONS 512</font></strong>
-<a name="line25"> 25: </a><strong><font color="#228B22">#define MAXALIASES 25</font></strong>
-<a name="line26"> 26: </a><strong><font color="#228B22">#define MAXOPTIONSMONITORS 5</font></strong>
-
-<a name="line28"> 28: </a><font color="#4169E1">typedef</font> <font color="#4169E1">struct</font> {
-<a name="line29"> 29: </a>  int            N,argc,Naliases;
-<a name="line30"> 30: </a>  char           **args,*names[MAXOPTIONS],*values[MAXOPTIONS];
-<a name="line31"> 31: </a>  char           *aliases1[MAXALIASES],*aliases2[MAXALIASES];
-<a name="line32"> 32: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     used[MAXOPTIONS];
-<a name="line33"> 33: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     namegiven;
-<a name="line34"> 34: </a>  char           programname[PETSC_MAX_PATH_LEN]; <font color="#B22222">/* HP includes entire path in name */</font>
-
-<a name="line36"> 36: </a>  <font color="#B22222">/* --------User (or default) routines (most return -1 on error) --------*/</font>
-<a name="line37"> 37: </a>  <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitor[MAXOPTIONSMONITORS])(const char[], const char[], void*); <font color="#B22222">/* returns control to user after */</font>
-<a name="line38"> 38: </a>  <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitordestroy[MAXOPTIONSMONITORS])(void*);         <font color="#B22222">/* */</font>
-<a name="line39"> 39: </a>  void           *monitorcontext[MAXOPTIONSMONITORS];                  <font color="#B22222">/* to pass arbitrary user data into monitor */</font>
-<a name="line40"> 40: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       numbermonitors;                                       <font color="#B22222">/* to, for instance, detect options being set */</font>
-
-<a name="line42"> 42: </a>} PetscOptionsTable;
-
-
-<a name="line45"> 45: </a>static PetscOptionsTable      *options = 0;
-
-<a name="line48"> 48: </a><font color="#B22222">/*</font>
-<a name="line49"> 49: </a><font color="#B22222">    Options events monitor</font>
-<a name="line50"> 50: </a><font color="#B22222">*/</font>
-<a name="line51"> 51: </a><strong><font color="#228B22">#define PetscOptionsMonitor(name,value)                                     \</font></strong>
-<a name="line52"> 52: </a><strong><font color="#228B22">        { <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> _ierr; <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> _i,_im = options-&gt;numbermonitors; \</font></strong>
-<a name="line53"> 53: </a><strong><font color="#228B22">          for (_i=0; _i&lt;_im; _i++) {\</font></strong>
-<a name="line54"> 54: </a><strong><font color="#228B22">            _(*options-&gt;monitor[_i])(name, value, options-&gt;monitorcontext[_i]);<A href="../../../docs/manualpages/Sys/CHKERRQ.html#CHKERRQ">CHKERRQ</A>(_ierr); \</font></strong>
-<a name="line55"> 55: </a><strong><font color="#228B22">          } \</font></strong>
-<a name="line56"> 56: </a><strong><font color="#228B22">        }</font></strong>
-
-<a name="line60"> 60: </a><font color="#B22222">/*</font>
-<a name="line61"> 61: </a><font color="#B22222">   PetscOptionsAtoi - Converts a string to an integer value. Handles special cases such as "default" and "decide"</font>
-<a name="line62"> 62: </a><font color="#B22222">*/</font>
-<a name="line63"> 63: </a><strong><font color="#4169E1"><a name="PetscOptionsAtoi"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsAtoi(const char name[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *a)</font></strong>
-<a name="line64"> 64: </a>{
-<a name="line66"> 66: </a>  size_t         i,len;
-<a name="line67"> 67: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     decide,tdefault,mouse;
-
-<a name="line70"> 70: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(name,&amp;len);
-<a name="line71"> 71: </a>  <font color="#4169E1">if</font> (!len) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"character string of length zero has no numerical value"</font>);
-
-<a name="line73"> 73: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>"</font>,&amp;tdefault);
-<a name="line74"> 74: </a>  <font color="#4169E1">if</font> (!tdefault) {
-<a name="line75"> 75: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DEFAULT"</font>,&amp;tdefault);
-<a name="line76"> 76: </a>  }
-<a name="line77"> 77: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>"</font>,&amp;decide);
-<a name="line78"> 78: </a>  <font color="#4169E1">if</font> (!decide) {
-<a name="line79"> 79: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DECIDE"</font>,&amp;decide);
-<a name="line80"> 80: </a>  }
-<a name="line81"> 81: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"mouse"</font>,&amp;mouse);
 
-<a name="line83"> 83: </a>  <font color="#4169E1">if</font> (tdefault) {
-<a name="line84"> 84: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>;
-<a name="line85"> 85: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (decide) {
-<a name="line86"> 86: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>;
-<a name="line87"> 87: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (mouse) {
-<a name="line88"> 88: </a>    *a = -1;
-<a name="line89"> 89: </a>  } <font color="#4169E1">else</font> {
-<a name="line90"> 90: </a>    <font color="#4169E1">if</font> (name[0] != '+' &amp;&amp; name[0] != '-' &amp;&amp; name[0] &lt; '0' &amp;&amp; name[0] &gt; '9') {
-<a name="line91"> 91: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Input string %s has no integer value (do not include . in it)"</font>,name);
-<a name="line92"> 92: </a>    }
-<a name="line93"> 93: </a>    <font color="#4169E1">for</font> (i=1; i&lt;len; i++) {
-<a name="line94"> 94: </a>      <font color="#4169E1">if</font> (name[i] &lt; '0' || name[i] &gt; '9') {
-<a name="line95"> 95: </a>        <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Input string %s has no integer value (do not include . in it)"</font>,name);
-<a name="line96"> 96: </a>      }
-<a name="line97"> 97: </a>    }
-<a name="line98"> 98: </a>    *a  = atoi(name);
-<a name="line99"> 99: </a>  }
-<a name="line100">100: </a>  <font color="#4169E1">return</font>(0);
-<a name="line101">101: </a>}
-
-<a name="line105">105: </a><font color="#B22222">/*</font>
-<a name="line106">106: </a><font color="#B22222">   Converts a string to <A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> value. Handles special cases like "default" and "decide"</font>
-<a name="line107">107: </a><font color="#B22222">*/</font>
-<a name="line108">108: </a><strong><font color="#4169E1"><a name="PetscOptionsAtod"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsAtod(const char name[],<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *a)</font></strong>
-<a name="line109">109: </a>{
-<a name="line111">111: </a>  size_t         len;
-<a name="line112">112: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     decide,tdefault;
-
-<a name="line115">115: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(name,&amp;len);
-<a name="line116">116: </a>  <font color="#4169E1">if</font> (!len) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"character string of length zero has no numerical value"</font>);
-
-<a name="line118">118: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>"</font>,&amp;tdefault);
-<a name="line119">119: </a>  <font color="#4169E1">if</font> (!tdefault) {
-<a name="line120">120: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DEFAULT"</font>,&amp;tdefault);
-<a name="line121">121: </a>  }
-<a name="line122">122: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>"</font>,&amp;decide);
-<a name="line123">123: </a>  <font color="#4169E1">if</font> (!decide) {
-<a name="line124">124: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DECIDE"</font>,&amp;decide);
-<a name="line125">125: </a>  }
-
-<a name="line127">127: </a>  <font color="#4169E1">if</font> (tdefault) {
-<a name="line128">128: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>;
-<a name="line129">129: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (decide) {
-<a name="line130">130: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>;
-<a name="line131">131: </a>  } <font color="#4169E1">else</font> {
-<a name="line132">132: </a>    <font color="#4169E1">if</font> (name[0] != '+' &amp;&amp; name[0] != '-' &amp;&amp; name[0] != '.' &amp;&amp; name[0] &lt; '0' &amp;&amp; name[0] &gt; '9') {
-<a name="line133">133: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Input string %s has no numeric value "</font>,name);
-<a name="line134">134: </a>    }
-<a name="line135">135: </a>    *a  = atof(name);
-<a name="line136">136: </a>  }
-<a name="line137">137: </a>  <font color="#4169E1">return</font>(0);
-<a name="line138">138: </a>}
-
-<a name="line142">142: </a><font color="#B22222">/*</font>
-<a name="line143">143: </a><font color="#B22222">   PetscOptionsAtol - Converts string to <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>, handles cases like "yes", "no", "true", "false", "0", "1"</font>
-<a name="line144">144: </a><font color="#B22222">*/</font>
-<a name="line145">145: </a><strong><font color="#4169E1"><a name="PetscOptionsAtol"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsAtol(const char value[], <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *a)</font></strong>
-<a name="line146">146: </a>{
-<a name="line147">147: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     istrue, isfalse;
-<a name="line148">148: </a>  size_t         len;
-
-<a name="line152">152: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value, &amp;len);
-<a name="line153">153: </a>  <font color="#4169E1">if</font> (!len) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG, <font color="#666666">"Character string of length zero has no logical value"</font>);
-<a name="line154">154: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"TRUE"</font>,&amp;istrue);
-<a name="line155">155: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line156">156: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"YES"</font>,&amp;istrue);
-<a name="line157">157: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line158">158: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"1"</font>,&amp;istrue);
-<a name="line159">159: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line160">160: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"on"</font>,&amp;istrue);
-<a name="line161">161: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line162">162: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"FALSE"</font>,&amp;isfalse);
-<a name="line163">163: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line164">164: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"NO"</font>,&amp;isfalse);
-<a name="line165">165: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line166">166: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"0"</font>,&amp;isfalse);
-<a name="line167">167: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line168">168: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"off"</font>,&amp;isfalse);
-<a name="line169">169: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line170">170: </a>  <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG, <font color="#666666">"Unknown logical value: %s"</font>, value);
-<a name="line171">171: </a>  <font color="#4169E1">return</font>(0);
-<a name="line172">172: </a>}
-
-<a name="line176">176: </a><font color="#B22222">/*@C</font>
-<a name="line177">177: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscGetProgramName.html#PetscGetProgramName">PetscGetProgramName</A> - Gets the name of the running program. </font>
-
-<a name="line179">179: </a><font color="#B22222">    Not Collective</font>
-
-<a name="line181">181: </a><font color="#B22222">    Input Parameter:</font>
-<a name="line182">182: </a><font color="#B22222">.   len - length of the string name</font>
-
-<a name="line184">184: </a><font color="#B22222">    Output Parameter:</font>
-<a name="line185">185: </a><font color="#B22222">.   name - the name of the running program</font>
-
-<a name="line187">187: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line189">189: </a><font color="#B22222">    Notes:</font>
-<a name="line190">190: </a><font color="#B22222">    The name of the program is copied into the user-provided character</font>
-<a name="line191">191: </a><font color="#B22222">    array of length len.  On some machines the program name includes </font>
-<a name="line192">192: </a><font color="#B22222">    its entire path, so one should generally set len &gt;= PETSC_MAX_PATH_LEN.</font>
-<a name="line193">193: </a><font color="#B22222">@*/</font>
-<a name="line194">194: </a><strong><font color="#4169E1"><a name="PetscGetProgramName"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGetProgramName.html#PetscGetProgramName">PetscGetProgramName</A>(char name[],size_t len)</font></strong>
-<a name="line195">195: </a>{
-
-<a name="line199">199: </a>  <font color="#4169E1">if</font> (!options) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONGSTATE,<font color="#666666">"Must call <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>() first"</font>);
-<a name="line200">200: </a>  <font color="#4169E1">if</font> (!options-&gt;namegiven) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_PLIB,<font color="#666666">"Unable to determine program name"</font>);
-<a name="line201">201: </a>  <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(name,options-&gt;programname,len);
-<a name="line202">202: </a>  <font color="#4169E1">return</font>(0);
-<a name="line203">203: </a>}
-
-<a name="line207">207: </a><strong><font color="#4169E1"><a name="PetscSetProgramName"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscSetProgramName(const char name[])</font></strong>
-<a name="line208">208: </a>{
-
-<a name="line212">212: </a>  options-&gt;namegiven = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line213">213: </a>  <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(options-&gt;programname,name,PETSC_MAX_PATH_LEN);
-<a name="line214">214: </a>  <font color="#4169E1">return</font>(0);
-<a name="line215">215: </a>}
-
-<a name="line219">219: </a><font color="#B22222">/*@</font>
-<a name="line220">220: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A> - PETSc Options database keys must begin with a - followed by a letter.</font>
-
-<a name="line222">222: </a><font color="#B22222">   Input Parameter:</font>
-<a name="line223">223: </a><font color="#B22222">.    in_str - string to check if valid</font>
-
-<a name="line225">225: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line226">226: </a><font color="#B22222">.    key - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if a valid key</font>
-
-<a name="line228">228: </a><font color="#B22222">  Level: intermediate</font>
-
-<a name="line230">230: </a><font color="#B22222">@*/</font>
-<a name="line231">231: </a><strong><font color="#4169E1"><a name="PetscOptionsValidKey"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A>(const char in_str[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *key)</font></strong>
-<a name="line232">232: </a>{
-<a name="line234">234: </a>  *key = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line235">235: </a>  <font color="#4169E1">if</font> (!in_str) <font color="#4169E1">return</font>(0);
-<a name="line236">236: </a>  <font color="#4169E1">if</font> (in_str[0] != '-') <font color="#4169E1">return</font>(0);
-<a name="line237">237: </a>  <font color="#4169E1">if</font> ((in_str[1] &lt; 'A') || (in_str[1] &gt; 'z')) <font color="#4169E1">return</font>(0);
-<a name="line238">238: </a>  *key = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line239">239: </a>  <font color="#4169E1">return</font>(0);
-<a name="line240">240: </a>}
-
-<a name="line244">244: </a><font color="#B22222">/*@C</font>
-<a name="line245">245: </a><font color="#B22222">     <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A> - Inserts options into the database from a string</font>
-
-<a name="line247">247: </a><font color="#B22222">     Not collective: but only processes that call this routine will set the options</font>
-<a name="line248">248: </a><font color="#B22222">                     included in the file</font>
-
-<a name="line250">250: </a><font color="#B22222">  Input Parameter:</font>
-<a name="line251">251: </a><font color="#B22222">.   in_str - string that contains options separated by blanks</font>
-
-
-<a name="line254">254: </a><font color="#B22222">  Level: intermediate</font>
-
-<a name="line256">256: </a><font color="#B22222">  Contributed by Boyana Norris</font>
-
-<a name="line258">258: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(),</font>
-<a name="line259">259: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line260">260: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line261">261: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line262">262: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line263">263: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>()</font>
-
-<a name="line265">265: </a><font color="#B22222">@*/</font>
-<a name="line266">266: </a><strong><font color="#4169E1"><a name="PetscOptionsInsertString"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(const char in_str[])</font></strong>
-<a name="line267">267: </a>{
-<a name="line268">268: </a>  char           *first,*second;
-<a name="line270">270: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
-<a name="line271">271: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     key;
-
-<a name="line274">274: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(in_str,' ',&amp;token);
-<a name="line275">275: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
-<a name="line276">276: </a>  <font color="#4169E1">while</font> (first) {
-<a name="line277">277: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A>(first,&amp;key);
-<a name="line278">278: </a>    <font color="#4169E1">if</font> (key) {
-<a name="line279">279: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;second);
-<a name="line280">280: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A>(second,&amp;key);
-<a name="line281">281: </a>      <font color="#4169E1">if</font> (!key) {
-<a name="line282">282: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(first,second);
-<a name="line283">283: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
-<a name="line284">284: </a>      } <font color="#4169E1">else</font> {
-<a name="line285">285: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(first,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line286">286: </a>        first = second;
-<a name="line287">287: </a>      }
-<a name="line288">288: </a>    } <font color="#4169E1">else</font> {
-<a name="line289">289: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
-<a name="line290">290: </a>    }
-<a name="line291">291: </a>  }
-<a name="line292">292: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line293">293: </a>  <font color="#4169E1">return</font>(0);
-<a name="line294">294: </a>}
-
-<a name="line296">296: </a><font color="#B22222">/*</font>
-<a name="line297">297: </a><font color="#B22222">    Returns a line (ended by a \n, \r or null character of any length. Result should be freed with free()</font>
-<a name="line298">298: </a><font color="#B22222">*/</font>
-<a name="line299">299: </a><strong><font color="#4169E1"><a name="Petscgetline"></a>static char *Petscgetline(FILE * f)</font></strong>
-<a name="line300">300: </a>{
-<a name="line301">301: </a>  size_t size = 0;
-<a name="line302">302: </a>  size_t len  = 0;
-<a name="line303">303: </a>  size_t last = 0;
-<a name="line304">304: </a>  char * buf  = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-
-<a name="line306">306: </a>  <font color="#4169E1">if</font> (feof(f)) <font color="#4169E1">return</font> 0;
-<a name="line307">307: </a>  <font color="#4169E1">do</font> {
-<a name="line308">308: </a>    size += 1024; <font color="#B22222">/* BUFSIZ is defined as "the optimal read size for this platform" */</font>
-<a name="line309">309: </a>    buf = (char*)realloc((void *)buf,size); <font color="#B22222">/* realloc(NULL,n) is the same as malloc(n) */</font>
-<a name="line310">310: </a>    <font color="#B22222">/* Actually do the read. Note that fgets puts a terminal '\0' on the</font>
-<a name="line311">311: </a><font color="#B22222">    end of the string, so we make sure we overwrite this */</font>
-<a name="line312">312: </a>    <font color="#4169E1">if</font> (!fgets(buf+len,size,f)) buf[len]=0;
-<a name="line313">313: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(buf,&amp;len);
-<a name="line314">314: </a>    last = len - 1;
-<a name="line315">315: </a>  } <font color="#4169E1">while</font> (!feof(f) &amp;&amp; buf[last] != '\n' &amp;&amp; buf[last] != '\r');
-<a name="line316">316: </a>  <font color="#4169E1">if</font> (len) <font color="#4169E1">return</font> buf;
-<a name="line317">317: </a>  free(buf);
-<a name="line318">318: </a>  <font color="#4169E1">return</font> 0;
-<a name="line319">319: </a>}
-
-
-<a name="line324">324: </a><font color="#B22222">/*@C</font>
-<a name="line325">325: </a><font color="#B22222">     <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A> - Inserts options into the database from a file.</font>
-
-<a name="line327">327: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line329">329: </a><font color="#B22222">  Input Parameter:</font>
-<a name="line330">330: </a><font color="#B22222">+   comm - the processes that will share the options (usually <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>)</font>
-<a name="line331">331: </a><font color="#B22222">.   file - name of file</font>
-<a name="line332">332: </a><font color="#B22222">-   require - if <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> will generate an error if the file does not exist</font>
-
-
-<a name="line335">335: </a><font color="#B22222">  Level: intermediate</font>
-
-<a name="line337">337: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(),</font>
-<a name="line338">338: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line339">339: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line340">340: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line341">341: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line342">342: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-
-<a name="line344">344: </a><font color="#B22222">@*/</font>
-<a name="line345">345: </a><strong><font color="#4169E1"><a name="PetscOptionsInsertFile"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char file[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> require)</font></strong>
-<a name="line346">346: </a>{
-<a name="line347">347: </a>  char           *string,fname[PETSC_MAX_PATH_LEN],*first,*second,*third,*vstring = 0,*astring = 0;
-<a name="line349">349: </a>  size_t         i,len;
-<a name="line350">350: </a>  FILE           *fd;
-<a name="line351">351: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
-<a name="line352">352: </a>  int            err;
-<a name="line353">353: </a>  char           cmt[3]={'#','!','%'},*cmatch;
-<a name="line354">354: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank,cnt=0,acnt=0;
-
-<a name="line357">357: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line358">358: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line359">359: </a>    <font color="#B22222">/* Warning: assume a maximum size for all options in a string */</font>
-<a name="line360">360: </a>    <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(128000*<font color="#4169E1">sizeof</font>(char),&amp;vstring);
-<a name="line361">361: </a>    vstring[0] = 0;
-<a name="line362">362: </a>    <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(64000*<font color="#4169E1">sizeof</font>(char),&amp;astring);
-<a name="line363">363: </a>    astring[0] = 0;
-<a name="line364">364: </a>    cnt     = 0;
-<a name="line365">365: </a>    acnt    = 0;
-
-<a name="line367">367: </a>    <A href="../../../docs/manualpages/Sys/PetscFixFilename.html#PetscFixFilename">PetscFixFilename</A>(file,fname);
-<a name="line368">368: </a>    fd   = fopen(fname,<font color="#666666">"r"</font>);
-<a name="line369">369: </a>    <font color="#4169E1">if</font> (fd) {
-<a name="line370">370: </a>      <font color="#B22222">/* the following line will not work when opening initial files (like .petscrc) since info is not yet set */</font>
-<a name="line371">371: </a>      PetscInfo1(0,<font color="#666666">"Opened options file %s\n"</font>,file);
-<a name="line372">372: </a>      <font color="#4169E1">while</font> ((string = Petscgetline(fd))) {
-<a name="line373">373: </a>        <font color="#B22222">/* eliminate comments from each line */</font>
-<a name="line374">374: </a>        <font color="#4169E1">for</font> (i=0; i&lt;3; i++){
-<a name="line375">375: </a>          <A href="../../../docs/manualpages/Sys/PetscStrchr.html#PetscStrchr">PetscStrchr</A>(string,cmt[i],&amp;cmatch);
-<a name="line376">376: </a>          <font color="#4169E1">if</font> (cmatch) *cmatch = 0;
-<a name="line377">377: </a>        }
-<a name="line378">378: </a>        <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(string,&amp;len);
-<a name="line379">379: </a>        <font color="#B22222">/* replace tabs, ^M, \n with " " */</font>
-<a name="line380">380: </a>        <font color="#4169E1">for</font> (i=0; i&lt;len; i++) {
-<a name="line381">381: </a>          <font color="#4169E1">if</font> (string[i] == '\t' || string[i] == '\r' || string[i] == '\n') {
-<a name="line382">382: </a>            string[i] = ' ';
-<a name="line383">383: </a>          }
-<a name="line384">384: </a>        }
-<a name="line385">385: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(string,' ',&amp;token);
-<a name="line386">386: </a>        free(string);
-<a name="line387">387: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
-<a name="line388">388: </a>        <font color="#4169E1">if</font> (!first) {
-<a name="line389">389: </a>          <font color="#4169E1">goto</font> destroy;
-<a name="line390">390: </a>        } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!first[0]) { <font color="#B22222">/* if first token is empty spaces, redo first token */</font>
-<a name="line391">391: </a>          <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line3">  3: </a><font color="#B22222">/* Feature test macros to make sure atoll is available (SVr4, POSIX.1-2001, 4.3BSD, C99), not in (C89 and POSIX.1-1996) */</font>
+<a name="line4">  4: </a><strong><font color="#228B22">#define _XOPEN_SOURCE 600</font></strong>
+<a name="line5">  5: </a><strong><font color="#228B22">#define _BSD_SOURCE</font></strong>
+<a name="line6">  6: </a><font color="#B22222">/*</font>
+<a name="line7">  7: </a><font color="#B22222">   These routines simplify the use of command line, file options, etc., and are used to manipulate the options database.</font>
+<a name="line8">  8: </a><font color="#B22222">   This provides the low-level interface, the high level interface is in aoptions.c</font>
+
+<a name="line10"> 10: </a><font color="#B22222">   Some routines use regular malloc and free because it cannot know  what malloc is requested with the </font>
+<a name="line11"> 11: </a><font color="#B22222">   options database until it has already processed the input.</font>
+<a name="line12"> 12: </a><font color="#B22222">*/</font>
+
+<a name="line14"> 14: </a> #include <A href="../../../include/petscsys.h.html">petscsys.h</A>
+<a name="line15"> 15: </a><font color="#A020F0">#if defined(PETSC_HAVE_STDLIB_H)</font>
+<a name="line16"> 16: </a><font color="#A020F0">#include &lt;stdlib.h&gt;</font>
+<a name="line17"> 17: </a><font color="#A020F0">#endif</font>
+<a name="line18"> 18: </a><font color="#A020F0">#if defined(PETSC_HAVE_MALLOC_H)</font>
+<a name="line19"> 19: </a><font color="#A020F0">#include &lt;malloc.h&gt;</font>
+<a name="line20"> 20: </a><font color="#A020F0">#endif</font>
+<a name="line21"> 21: </a><font color="#A020F0">#if defined(PETSC_HAVE_SYS_PARAM_H)</font>
+<a name="line22"> 22: </a><font color="#A020F0">#include </font><font color="#666666">"sys/param.h"</font><font color="#A020F0"></font>
+<a name="line23"> 23: </a><font color="#A020F0">#endif</font>
+
+<a name="line25"> 25: </a><font color="#B22222">/* </font>
+<a name="line26"> 26: </a><font color="#B22222">    This table holds all the options set by the user. For simplicity, we use a static size database</font>
+<a name="line27"> 27: </a><font color="#B22222">*/</font>
+<a name="line28"> 28: </a><strong><font color="#228B22">#define MAXOPTIONS 512</font></strong>
+<a name="line29"> 29: </a><strong><font color="#228B22">#define MAXALIASES 25</font></strong>
+<a name="line30"> 30: </a><strong><font color="#228B22">#define MAXOPTIONSMONITORS 5</font></strong>
+
+<a name="line32"> 32: </a><font color="#4169E1">typedef</font> <font color="#4169E1">struct</font> {
+<a name="line33"> 33: </a>  int            N,argc,Naliases;
+<a name="line34"> 34: </a>  char           **args,*names[MAXOPTIONS],*values[MAXOPTIONS];
+<a name="line35"> 35: </a>  char           *aliases1[MAXALIASES],*aliases2[MAXALIASES];
+<a name="line36"> 36: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     used[MAXOPTIONS];
+<a name="line37"> 37: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     namegiven;
+<a name="line38"> 38: </a>  char           programname[PETSC_MAX_PATH_LEN]; <font color="#B22222">/* HP includes entire path in name */</font>
+
+<a name="line40"> 40: </a>  <font color="#B22222">/* --------User (or default) routines (most return -1 on error) --------*/</font>
+<a name="line41"> 41: </a>  <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitor[MAXOPTIONSMONITORS])(const char[], const char[], void*); <font color="#B22222">/* returns control to user after */</font>
+<a name="line42"> 42: </a>  <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitordestroy[MAXOPTIONSMONITORS])(void*);         <font color="#B22222">/* */</font>
+<a name="line43"> 43: </a>  void           *monitorcontext[MAXOPTIONSMONITORS];                  <font color="#B22222">/* to pass arbitrary user data into monitor */</font>
+<a name="line44"> 44: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       numbermonitors;                                       <font color="#B22222">/* to, for instance, detect options being set */</font>
+
+<a name="line46"> 46: </a>} PetscOptionsTable;
+
+
+<a name="line49"> 49: </a>static PetscOptionsTable      *options = 0;
+
+<a name="line52"> 52: </a><font color="#B22222">/*</font>
+<a name="line53"> 53: </a><font color="#B22222">    Options events monitor</font>
+<a name="line54"> 54: </a><font color="#B22222">*/</font>
+<a name="line55"> 55: </a><strong><font color="#228B22">#define PetscOptionsMonitor(name,value)                                     \</font></strong>
+<a name="line56"> 56: </a><strong><font color="#228B22">        { <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> _ierr; <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> _i,_im = options-&gt;numbermonitors; \</font></strong>
+<a name="line57"> 57: </a><strong><font color="#228B22">          for (_i=0; _i&lt;_im; _i++) {\</font></strong>
+<a name="line58"> 58: </a><strong><font color="#228B22">            _(*options-&gt;monitor[_i])(name, value, options-&gt;monitorcontext[_i]);<A href="../../../docs/manualpages/Sys/CHKERRQ.html#CHKERRQ">CHKERRQ</A>(_ierr); \</font></strong>
+<a name="line59"> 59: </a><strong><font color="#228B22">          } \</font></strong>
+<a name="line60"> 60: </a><strong><font color="#228B22">        }</font></strong>
+
+<a name="line64"> 64: </a><font color="#B22222">/*</font>
+<a name="line65"> 65: </a><font color="#B22222">   PetscOptionsAtoi - Converts a string to an integer value. Handles special cases such as "default" and "decide"</font>
+<a name="line66"> 66: </a><font color="#B22222">*/</font>
+<a name="line67"> 67: </a><strong><font color="#4169E1"><a name="PetscOptionsAtoi"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsAtoi(const char name[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *a)</font></strong>
+<a name="line68"> 68: </a>{
+<a name="line70"> 70: </a>  size_t         i,len;
+<a name="line71"> 71: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     decide,tdefault,mouse;
+
+<a name="line74"> 74: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(name,&amp;len);
+<a name="line75"> 75: </a>  <font color="#4169E1">if</font> (!len) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"character string of length zero has no numerical value"</font>);
+
+<a name="line77"> 77: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>"</font>,&amp;tdefault);
+<a name="line78"> 78: </a>  <font color="#4169E1">if</font> (!tdefault) {
+<a name="line79"> 79: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DEFAULT"</font>,&amp;tdefault);
+<a name="line80"> 80: </a>  }
+<a name="line81"> 81: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>"</font>,&amp;decide);
+<a name="line82"> 82: </a>  <font color="#4169E1">if</font> (!decide) {
+<a name="line83"> 83: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DECIDE"</font>,&amp;decide);
+<a name="line84"> 84: </a>  }
+<a name="line85"> 85: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"mouse"</font>,&amp;mouse);
+
+<a name="line87"> 87: </a>  <font color="#4169E1">if</font> (tdefault) {
+<a name="line88"> 88: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>;
+<a name="line89"> 89: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (decide) {
+<a name="line90"> 90: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>;
+<a name="line91"> 91: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (mouse) {
+<a name="line92"> 92: </a>    *a = -1;
+<a name="line93"> 93: </a>  } <font color="#4169E1">else</font> {
+<a name="line94"> 94: </a>    <font color="#4169E1">if</font> (name[0] != '+' &amp;&amp; name[0] != '-' &amp;&amp; name[0] &lt; '0' &amp;&amp; name[0] &gt; '9') {
+<a name="line95"> 95: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Input string %s has no integer value (do not include . in it)"</font>,name);
+<a name="line96"> 96: </a>    }
+<a name="line97"> 97: </a>    <font color="#4169E1">for</font> (i=1; i&lt;len; i++) {
+<a name="line98"> 98: </a>      <font color="#4169E1">if</font> (name[i] &lt; '0' || name[i] &gt; '9') {
+<a name="line99"> 99: </a>        <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Input string %s has no integer value (do not include . in it)"</font>,name);
+<a name="line100">100: </a>      }
+<a name="line101">101: </a>    }
+<a name="line102">102: </a><font color="#A020F0">#if defined(PETSC_USE_64BIT_INDICES)</font>
+<a name="line103">103: </a>    *a = atoll(name);
+<a name="line104">104: </a><font color="#A020F0">#else</font>
+<a name="line105">105: </a>    *a = atoi(name);
+<a name="line106">106: </a><font color="#A020F0">#endif</font>
+<a name="line107">107: </a>  }
+<a name="line108">108: </a>  <font color="#4169E1">return</font>(0);
+<a name="line109">109: </a>}
+
+<a name="line113">113: </a><font color="#B22222">/*</font>
+<a name="line114">114: </a><font color="#B22222">   Converts a string to <A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> value. Handles special cases like "default" and "decide"</font>
+<a name="line115">115: </a><font color="#B22222">*/</font>
+<a name="line116">116: </a><strong><font color="#4169E1"><a name="PetscOptionsAtod"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsAtod(const char name[],<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *a)</font></strong>
+<a name="line117">117: </a>{
+<a name="line119">119: </a>  size_t         len;
+<a name="line120">120: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     decide,tdefault;
+
+<a name="line123">123: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(name,&amp;len);
+<a name="line124">124: </a>  <font color="#4169E1">if</font> (!len) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"character string of length zero has no numerical value"</font>);
+
+<a name="line126">126: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>"</font>,&amp;tdefault);
+<a name="line127">127: </a>  <font color="#4169E1">if</font> (!tdefault) {
+<a name="line128">128: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DEFAULT"</font>,&amp;tdefault);
+<a name="line129">129: </a>  }
+<a name="line130">130: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>"</font>,&amp;decide);
+<a name="line131">131: </a>  <font color="#4169E1">if</font> (!decide) {
+<a name="line132">132: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"DECIDE"</font>,&amp;decide);
+<a name="line133">133: </a>  }
+
+<a name="line135">135: </a>  <font color="#4169E1">if</font> (tdefault) {
+<a name="line136">136: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DEFAULT.html#PETSC_DEFAULT">PETSC_DEFAULT</A>;
+<a name="line137">137: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (decide) {
+<a name="line138">138: </a>    *a = <A href="../../../docs/manualpages/Sys/PETSC_DECIDE.html#PETSC_DECIDE">PETSC_DECIDE</A>;
+<a name="line139">139: </a>  } <font color="#4169E1">else</font> {
+<a name="line140">140: </a>    <font color="#4169E1">if</font> (name[0] != '+' &amp;&amp; name[0] != '-' &amp;&amp; name[0] != '.' &amp;&amp; name[0] &lt; '0' &amp;&amp; name[0] &gt; '9') {
+<a name="line141">141: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Input string %s has no numeric value "</font>,name);
+<a name="line142">142: </a>    }
+<a name="line143">143: </a>    *a  = atof(name);
+<a name="line144">144: </a>  }
+<a name="line145">145: </a>  <font color="#4169E1">return</font>(0);
+<a name="line146">146: </a>}
+
+<a name="line150">150: </a><font color="#B22222">/*</font>
+<a name="line151">151: </a><font color="#B22222">   PetscOptionsAtol - Converts string to <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>, handles cases like "yes", "no", "true", "false", "0", "1"</font>
+<a name="line152">152: </a><font color="#B22222">*/</font>
+<a name="line153">153: </a><strong><font color="#4169E1"><a name="PetscOptionsAtol"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsAtol(const char value[], <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *a)</font></strong>
+<a name="line154">154: </a>{
+<a name="line155">155: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     istrue, isfalse;
+<a name="line156">156: </a>  size_t         len;
+
+<a name="line160">160: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value, &amp;len);
+<a name="line161">161: </a>  <font color="#4169E1">if</font> (!len) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG, <font color="#666666">"Character string of length zero has no logical value"</font>);
+<a name="line162">162: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"TRUE"</font>,&amp;istrue);
+<a name="line163">163: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line164">164: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"YES"</font>,&amp;istrue);
+<a name="line165">165: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line166">166: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"1"</font>,&amp;istrue);
+<a name="line167">167: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line168">168: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"on"</font>,&amp;istrue);
+<a name="line169">169: </a>  <font color="#4169E1">if</font> (istrue) {*a = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line170">170: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"FALSE"</font>,&amp;isfalse);
+<a name="line171">171: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line172">172: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"NO"</font>,&amp;isfalse);
+<a name="line173">173: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line174">174: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"0"</font>,&amp;isfalse);
+<a name="line175">175: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line176">176: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(value,<font color="#666666">"off"</font>,&amp;isfalse);
+<a name="line177">177: </a>  <font color="#4169E1">if</font> (isfalse) {*a = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line178">178: </a>  <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG, <font color="#666666">"Unknown logical value: %s"</font>, value);
+<a name="line179">179: </a>  <font color="#4169E1">return</font>(0);
+<a name="line180">180: </a>}
+
+<a name="line184">184: </a><font color="#B22222">/*@C</font>
+<a name="line185">185: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscGetProgramName.html#PetscGetProgramName">PetscGetProgramName</A> - Gets the name of the running program. </font>
+
+<a name="line187">187: </a><font color="#B22222">    Not Collective</font>
+
+<a name="line189">189: </a><font color="#B22222">    Input Parameter:</font>
+<a name="line190">190: </a><font color="#B22222">.   len - length of the string name</font>
+
+<a name="line192">192: </a><font color="#B22222">    Output Parameter:</font>
+<a name="line193">193: </a><font color="#B22222">.   name - the name of the running program</font>
+
+<a name="line195">195: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line197">197: </a><font color="#B22222">    Notes:</font>
+<a name="line198">198: </a><font color="#B22222">    The name of the program is copied into the user-provided character</font>
+<a name="line199">199: </a><font color="#B22222">    array of length len.  On some machines the program name includes </font>
+<a name="line200">200: </a><font color="#B22222">    its entire path, so one should generally set len &gt;= PETSC_MAX_PATH_LEN.</font>
+<a name="line201">201: </a><font color="#B22222">@*/</font>
+<a name="line202">202: </a><strong><font color="#4169E1"><a name="PetscGetProgramName"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGetProgramName.html#PetscGetProgramName">PetscGetProgramName</A>(char name[],size_t len)</font></strong>
+<a name="line203">203: </a>{
+
+<a name="line207">207: </a>  <font color="#4169E1">if</font> (!options) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONGSTATE,<font color="#666666">"Must call <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>() first"</font>);
+<a name="line208">208: </a>  <font color="#4169E1">if</font> (!options-&gt;namegiven) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_PLIB,<font color="#666666">"Unable to determine program name"</font>);
+<a name="line209">209: </a>  <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(name,options-&gt;programname,len);
+<a name="line210">210: </a>  <font color="#4169E1">return</font>(0);
+<a name="line211">211: </a>}
+
+<a name="line215">215: </a><strong><font color="#4169E1"><a name="PetscSetProgramName"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscSetProgramName(const char name[])</font></strong>
+<a name="line216">216: </a>{
+
+<a name="line220">220: </a>  options-&gt;namegiven = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line221">221: </a>  <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(options-&gt;programname,name,PETSC_MAX_PATH_LEN);
+<a name="line222">222: </a>  <font color="#4169E1">return</font>(0);
+<a name="line223">223: </a>}
+
+<a name="line227">227: </a><font color="#B22222">/*@</font>
+<a name="line228">228: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A> - PETSc Options database keys must begin with a - followed by a letter.</font>
+
+<a name="line230">230: </a><font color="#B22222">   Input Parameter:</font>
+<a name="line231">231: </a><font color="#B22222">.    in_str - string to check if valid</font>
+
+<a name="line233">233: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line234">234: </a><font color="#B22222">.    key - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if a valid key</font>
+
+<a name="line236">236: </a><font color="#B22222">  Level: intermediate</font>
+
+<a name="line238">238: </a><font color="#B22222">@*/</font>
+<a name="line239">239: </a><strong><font color="#4169E1"><a name="PetscOptionsValidKey"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A>(const char in_str[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *key)</font></strong>
+<a name="line240">240: </a>{
+<a name="line242">242: </a>  *key = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line243">243: </a>  <font color="#4169E1">if</font> (!in_str) <font color="#4169E1">return</font>(0);
+<a name="line244">244: </a>  <font color="#4169E1">if</font> (in_str[0] != '-') <font color="#4169E1">return</font>(0);
+<a name="line245">245: </a>  <font color="#4169E1">if</font> ((in_str[1] &lt; 'A') || (in_str[1] &gt; 'z')) <font color="#4169E1">return</font>(0);
+<a name="line246">246: </a>  *key = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line247">247: </a>  <font color="#4169E1">return</font>(0);
+<a name="line248">248: </a>}
+
+<a name="line252">252: </a><font color="#B22222">/*@C</font>
+<a name="line253">253: </a><font color="#B22222">     <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A> - Inserts options into the database from a string</font>
+
+<a name="line255">255: </a><font color="#B22222">     Not collective: but only processes that call this routine will set the options</font>
+<a name="line256">256: </a><font color="#B22222">                     included in the file</font>
+
+<a name="line258">258: </a><font color="#B22222">  Input Parameter:</font>
+<a name="line259">259: </a><font color="#B22222">.   in_str - string that contains options separated by blanks</font>
+
+
+<a name="line262">262: </a><font color="#B22222">  Level: intermediate</font>
+
+<a name="line264">264: </a><font color="#B22222">  Contributed by Boyana Norris</font>
+
+<a name="line266">266: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(),</font>
+<a name="line267">267: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line268">268: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line269">269: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line270">270: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line271">271: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>()</font>
+
+<a name="line273">273: </a><font color="#B22222">@*/</font>
+<a name="line274">274: </a><strong><font color="#4169E1"><a name="PetscOptionsInsertString"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(const char in_str[])</font></strong>
+<a name="line275">275: </a>{
+<a name="line276">276: </a>  char           *first,*second;
+<a name="line278">278: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
+<a name="line279">279: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     key;
+
+<a name="line282">282: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(in_str,' ',&amp;token);
+<a name="line283">283: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line284">284: </a>  <font color="#4169E1">while</font> (first) {
+<a name="line285">285: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A>(first,&amp;key);
+<a name="line286">286: </a>    <font color="#4169E1">if</font> (key) {
+<a name="line287">287: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;second);
+<a name="line288">288: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsValidKey.html#PetscOptionsValidKey">PetscOptionsValidKey</A>(second,&amp;key);
+<a name="line289">289: </a>      <font color="#4169E1">if</font> (!key) {
+<a name="line290">290: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(first,second);
+<a name="line291">291: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line292">292: </a>      } <font color="#4169E1">else</font> {
+<a name="line293">293: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(first,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line294">294: </a>        first = second;
+<a name="line295">295: </a>      }
+<a name="line296">296: </a>    } <font color="#4169E1">else</font> {
+<a name="line297">297: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line298">298: </a>    }
+<a name="line299">299: </a>  }
+<a name="line300">300: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line301">301: </a>  <font color="#4169E1">return</font>(0);
+<a name="line302">302: </a>}
+
+<a name="line304">304: </a><font color="#B22222">/*</font>
+<a name="line305">305: </a><font color="#B22222">    Returns a line (ended by a \n, \r or null character of any length. Result should be freed with free()</font>
+<a name="line306">306: </a><font color="#B22222">*/</font>
+<a name="line307">307: </a><strong><font color="#4169E1"><a name="Petscgetline"></a>static char *Petscgetline(FILE * f)</font></strong>
+<a name="line308">308: </a>{
+<a name="line309">309: </a>  size_t size = 0;
+<a name="line310">310: </a>  size_t len  = 0;
+<a name="line311">311: </a>  size_t last = 0;
+<a name="line312">312: </a>  char * buf  = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+
+<a name="line314">314: </a>  <font color="#4169E1">if</font> (feof(f)) <font color="#4169E1">return</font> 0;
+<a name="line315">315: </a>  <font color="#4169E1">do</font> {
+<a name="line316">316: </a>    size += 1024; <font color="#B22222">/* BUFSIZ is defined as "the optimal read size for this platform" */</font>
+<a name="line317">317: </a>    buf = (char*)realloc((void *)buf,size); <font color="#B22222">/* realloc(NULL,n) is the same as malloc(n) */</font>
+<a name="line318">318: </a>    <font color="#B22222">/* Actually do the read. Note that fgets puts a terminal '\0' on the</font>
+<a name="line319">319: </a><font color="#B22222">    end of the string, so we make sure we overwrite this */</font>
+<a name="line320">320: </a>    <font color="#4169E1">if</font> (!fgets(buf+len,size,f)) buf[len]=0;
+<a name="line321">321: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(buf,&amp;len);
+<a name="line322">322: </a>    last = len - 1;
+<a name="line323">323: </a>  } <font color="#4169E1">while</font> (!feof(f) &amp;&amp; buf[last] != '\n' &amp;&amp; buf[last] != '\r');
+<a name="line324">324: </a>  <font color="#4169E1">if</font> (len) <font color="#4169E1">return</font> buf;
+<a name="line325">325: </a>  free(buf);
+<a name="line326">326: </a>  <font color="#4169E1">return</font> 0;
+<a name="line327">327: </a>}
+
+
+<a name="line332">332: </a><font color="#B22222">/*@C</font>
+<a name="line333">333: </a><font color="#B22222">     <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A> - Inserts options into the database from a file.</font>
+
+<a name="line335">335: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line337">337: </a><font color="#B22222">  Input Parameter:</font>
+<a name="line338">338: </a><font color="#B22222">+   comm - the processes that will share the options (usually <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>)</font>
+<a name="line339">339: </a><font color="#B22222">.   file - name of file</font>
+<a name="line340">340: </a><font color="#B22222">-   require - if <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> will generate an error if the file does not exist</font>
+
+
+<a name="line343">343: </a><font color="#B22222">  Level: intermediate</font>
+
+<a name="line345">345: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(),</font>
+<a name="line346">346: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line347">347: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line348">348: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line349">349: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line350">350: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+
+<a name="line352">352: </a><font color="#B22222">@*/</font>
+<a name="line353">353: </a><strong><font color="#4169E1"><a name="PetscOptionsInsertFile"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char file[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> require)</font></strong>
+<a name="line354">354: </a>{
+<a name="line355">355: </a>  char           *string,fname[PETSC_MAX_PATH_LEN],*first,*second,*third,*vstring = 0,*astring = 0;
+<a name="line357">357: </a>  size_t         i,len;
+<a name="line358">358: </a>  FILE           *fd;
+<a name="line359">359: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
+<a name="line360">360: </a>  int            err;
+<a name="line361">361: </a>  char           cmt[3]={'#','!','%'},*cmatch;
+<a name="line362">362: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank,cnt=0,acnt=0;
+
+<a name="line365">365: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line366">366: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line367">367: </a>    <font color="#B22222">/* Warning: assume a maximum size for all options in a string */</font>
+<a name="line368">368: </a>    <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(128000*<font color="#4169E1">sizeof</font>(char),&amp;vstring);
+<a name="line369">369: </a>    vstring[0] = 0;
+<a name="line370">370: </a>    <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(64000*<font color="#4169E1">sizeof</font>(char),&amp;astring);
+<a name="line371">371: </a>    astring[0] = 0;
+<a name="line372">372: </a>    cnt     = 0;
+<a name="line373">373: </a>    acnt    = 0;
+
+<a name="line375">375: </a>    <A href="../../../docs/manualpages/Sys/PetscFixFilename.html#PetscFixFilename">PetscFixFilename</A>(file,fname);
+<a name="line376">376: </a>    fd   = fopen(fname,<font color="#666666">"r"</font>);
+<a name="line377">377: </a>    <font color="#4169E1">if</font> (fd) {
+<a name="line378">378: </a>      <font color="#B22222">/* the following line will not work when opening initial files (like .petscrc) since info is not yet set */</font>
+<a name="line379">379: </a>      PetscInfo1(0,<font color="#666666">"Opened options file %s\n"</font>,file);
+<a name="line380">380: </a>      <font color="#4169E1">while</font> ((string = Petscgetline(fd))) {
+<a name="line381">381: </a>        <font color="#B22222">/* eliminate comments from each line */</font>
+<a name="line382">382: </a>        <font color="#4169E1">for</font> (i=0; i&lt;3; i++){
+<a name="line383">383: </a>          <A href="../../../docs/manualpages/Sys/PetscStrchr.html#PetscStrchr">PetscStrchr</A>(string,cmt[i],&amp;cmatch);
+<a name="line384">384: </a>          <font color="#4169E1">if</font> (cmatch) *cmatch = 0;
+<a name="line385">385: </a>        }
+<a name="line386">386: </a>        <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(string,&amp;len);
+<a name="line387">387: </a>        <font color="#B22222">/* replace tabs, ^M, \n with " " */</font>
+<a name="line388">388: </a>        <font color="#4169E1">for</font> (i=0; i&lt;len; i++) {
+<a name="line389">389: </a>          <font color="#4169E1">if</font> (string[i] == '\t' || string[i] == '\r' || string[i] == '\n') {
+<a name="line390">390: </a>            string[i] = ' ';
+<a name="line391">391: </a>          }
 <a name="line392">392: </a>        }
-<a name="line393">393: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;second);
-<a name="line394">394: </a>        <font color="#4169E1">if</font> (!first) {
-<a name="line395">395: </a>          <font color="#4169E1">goto</font> destroy;
-<a name="line396">396: </a>        } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (first[0] == '-') {
-<a name="line397">397: </a>          <font color="#B22222">/* warning: should be making sure we do not overfill vstring */</font>
-<a name="line398">398: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,first);
-<a name="line399">399: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">" "</font>);
-<a name="line400">400: </a>          <font color="#4169E1">if</font> (second) {
-<a name="line401">401: </a>            <font color="#B22222">/* protect second with quotes in case it contains strings */</font>
-<a name="line402">402: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">"\""</font>);
-<a name="line403">403: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,second);
-<a name="line404">404: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">"\""</font>);
-<a name="line405">405: </a>          }
-<a name="line406">406: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">" "</font>);
-<a name="line407">407: </a>        } <font color="#4169E1">else</font> {
-<a name="line408">408: </a>          <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> match;
-
-<a name="line410">410: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(first,<font color="#666666">"alias"</font>,&amp;match);
-<a name="line411">411: </a>          <font color="#4169E1">if</font> (match) {
-<a name="line412">412: </a>            <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;third);
-<a name="line413">413: </a>            <font color="#4169E1">if</font> (!third) <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Error in options file:alias missing (%s)"</font>,second);
-<a name="line414">414: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,second);
-<a name="line415">415: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,<font color="#666666">" "</font>);
-<a name="line416">416: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,third);
-<a name="line417">417: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,<font color="#666666">" "</font>);
-<a name="line418">418: </a>          } <font color="#4169E1">else</font> {
-<a name="line419">419: </a>            <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Unknown statement in options file: (%s)"</font>,string);
-<a name="line420">420: </a>          }
-<a name="line421">421: </a>        }
-<a name="line422">422: </a><strong><font color="#FF0000">        destroy:</font></strong>
-<a name="line423">423: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line424">424: </a>      }
-<a name="line425">425: </a>      err = fclose(fd);
-<a name="line426">426: </a>      <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fclose() failed on file"</font>);
-<a name="line427">427: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(astring,&amp;len);
-<a name="line428">428: </a>      acnt = PetscMPIIntCast(len);
-<a name="line429">429: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(vstring,&amp;len);
-<a name="line430">430: </a>      cnt  = PetscMPIIntCast(len);
-<a name="line431">431: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (require) {
-<a name="line432">432: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_USER,<font color="#666666">"Unable to open Options File %s"</font>,fname);
-<a name="line433">433: </a>    }
-<a name="line434">434: </a>  }
-
-<a name="line436">436: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;acnt,1,MPI_INT,0,comm);
-<a name="line437">437: </a>  <font color="#4169E1">if</font> (acnt) {
-<a name="line438">438: </a>    <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A> token;
-<a name="line439">439: </a>    char       *first,*second;
-
-<a name="line441">441: </a>    <font color="#4169E1">if</font> (rank) {
-<a name="line442">442: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((acnt+1)*<font color="#4169E1">sizeof</font>(char),&amp;astring);
-<a name="line443">443: </a>    }
-<a name="line444">444: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(astring,acnt,MPI_CHAR,0,comm);
-<a name="line445">445: </a>    astring[acnt] = 0;
-<a name="line446">446: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(astring,' ',&amp;token);
-<a name="line447">447: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
-<a name="line448">448: </a>    <font color="#4169E1">while</font> (first) {
-<a name="line449">449: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;second);
-<a name="line450">450: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsSetAlias.html#PetscOptionsSetAlias">PetscOptionsSetAlias</A>(first,second);
-<a name="line451">451: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
-<a name="line452">452: </a>    }
-<a name="line453">453: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line454">454: </a>  }
-
-<a name="line456">456: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;cnt,1,MPI_INT,0,comm);
-<a name="line457">457: </a>  <font color="#4169E1">if</font> (cnt) {
-<a name="line458">458: </a>    <font color="#4169E1">if</font> (rank) {
-<a name="line459">459: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((cnt+1)*<font color="#4169E1">sizeof</font>(char),&amp;vstring);
+<a name="line393">393: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(string,' ',&amp;token);
+<a name="line394">394: </a>        free(string);
+<a name="line395">395: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line396">396: </a>        <font color="#4169E1">if</font> (!first) {
+<a name="line397">397: </a>          <font color="#4169E1">goto</font> destroy;
+<a name="line398">398: </a>        } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (!first[0]) { <font color="#B22222">/* if first token is empty spaces, redo first token */</font>
+<a name="line399">399: </a>          <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line400">400: </a>        }
+<a name="line401">401: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;second);
+<a name="line402">402: </a>        <font color="#4169E1">if</font> (!first) {
+<a name="line403">403: </a>          <font color="#4169E1">goto</font> destroy;
+<a name="line404">404: </a>        } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (first[0] == '-') {
+<a name="line405">405: </a>          <font color="#B22222">/* warning: should be making sure we do not overfill vstring */</font>
+<a name="line406">406: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,first);
+<a name="line407">407: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">" "</font>);
+<a name="line408">408: </a>          <font color="#4169E1">if</font> (second) {
+<a name="line409">409: </a>            <font color="#B22222">/* protect second with quotes in case it contains strings */</font>
+<a name="line410">410: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">"\""</font>);
+<a name="line411">411: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,second);
+<a name="line412">412: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">"\""</font>);
+<a name="line413">413: </a>          }
+<a name="line414">414: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(vstring,<font color="#666666">" "</font>);
+<a name="line415">415: </a>        } <font color="#4169E1">else</font> {
+<a name="line416">416: </a>          <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> match;
+
+<a name="line418">418: </a>          <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(first,<font color="#666666">"alias"</font>,&amp;match);
+<a name="line419">419: </a>          <font color="#4169E1">if</font> (match) {
+<a name="line420">420: </a>            <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;third);
+<a name="line421">421: </a>            <font color="#4169E1">if</font> (!third) <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Error in options file:alias missing (%s)"</font>,second);
+<a name="line422">422: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,second);
+<a name="line423">423: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,<font color="#666666">" "</font>);
+<a name="line424">424: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,third);
+<a name="line425">425: </a>            <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(astring,<font color="#666666">" "</font>);
+<a name="line426">426: </a>          } <font color="#4169E1">else</font> {
+<a name="line427">427: </a>            <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Unknown statement in options file: (%s)"</font>,string);
+<a name="line428">428: </a>          }
+<a name="line429">429: </a>        }
+<a name="line430">430: </a><strong><font color="#FF0000">        destroy:</font></strong>
+<a name="line431">431: </a>        <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line432">432: </a>      }
+<a name="line433">433: </a>      err = fclose(fd);
+<a name="line434">434: </a>      <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fclose() failed on file"</font>);
+<a name="line435">435: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(astring,&amp;len);
+<a name="line436">436: </a>      acnt = PetscMPIIntCast(len);
+<a name="line437">437: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(vstring,&amp;len);
+<a name="line438">438: </a>      cnt  = PetscMPIIntCast(len);
+<a name="line439">439: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (require) {
+<a name="line440">440: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_USER,<font color="#666666">"Unable to open Options File %s"</font>,fname);
+<a name="line441">441: </a>    }
+<a name="line442">442: </a>  }
+
+<a name="line444">444: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;acnt,1,MPI_INT,0,comm);
+<a name="line445">445: </a>  <font color="#4169E1">if</font> (acnt) {
+<a name="line446">446: </a>    <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A> token;
+<a name="line447">447: </a>    char       *first,*second;
+
+<a name="line449">449: </a>    <font color="#4169E1">if</font> (rank) {
+<a name="line450">450: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((acnt+1)*<font color="#4169E1">sizeof</font>(char),&amp;astring);
+<a name="line451">451: </a>    }
+<a name="line452">452: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(astring,acnt,MPI_CHAR,0,comm);
+<a name="line453">453: </a>    astring[acnt] = 0;
+<a name="line454">454: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(astring,' ',&amp;token);
+<a name="line455">455: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
+<a name="line456">456: </a>    <font color="#4169E1">while</font> (first) {
+<a name="line457">457: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;second);
+<a name="line458">458: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsSetAlias.html#PetscOptionsSetAlias">PetscOptionsSetAlias</A>(first,second);
+<a name="line459">459: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;first);
 <a name="line460">460: </a>    }
-<a name="line461">461: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(vstring,cnt,MPI_CHAR,0,comm);
-<a name="line462">462: </a>    vstring[cnt] = 0;
-<a name="line463">463: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(vstring);
-<a name="line464">464: </a>  }
-<a name="line465">465: </a>  <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(astring);
-<a name="line466">466: </a>  <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(vstring);
-<a name="line467">467: </a>  <font color="#4169E1">return</font>(0);
-<a name="line468">468: </a>}
-
-<a name="line472">472: </a><font color="#B22222">/*@C</font>
-<a name="line473">473: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A> - Inserts into the options database from the command line,</font>
-<a name="line474">474: </a><font color="#B22222">                   the environmental variable and a file.</font>
-
-<a name="line476">476: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line477">477: </a><font color="#B22222">+  argc - count of number of command line arguments</font>
-<a name="line478">478: </a><font color="#B22222">.  args - the command line arguments</font>
-<a name="line479">479: </a><font color="#B22222">-  file - optional filename, defaults to ~username/.petscrc</font>
-
-<a name="line481">481: </a><font color="#B22222">   Note:</font>
-<a name="line482">482: </a><font color="#B22222">   Since <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>() is automatically called by <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>(),</font>
-<a name="line483">483: </a><font color="#B22222">   the user does not typically need to call this routine. <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
-<a name="line484">484: </a><font color="#B22222">   can be called several times, adding additional entries into the database.</font>
-
-<a name="line486">486: </a><font color="#B22222">   Options Database Keys:</font>
-<a name="line487">487: </a><font color="#B22222">+   -options_monitor &lt;optional filename&gt; - print options names and values as they are set</font>
-
-<a name="line489">489: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line491">491: </a><font color="#B22222">   Concepts: options database^adding</font>
-
-<a name="line493">493: </a><font color="#B22222">.seealso: PetscOptionsDestroy_Private(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(),</font>
-<a name="line494">494: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>()</font>
-<a name="line495">495: </a><font color="#B22222">@*/</font>
-<a name="line496">496: </a><strong><font color="#4169E1"><a name="PetscOptionsInsert"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(int *argc,char ***args,const char file[])</font></strong>
-<a name="line497">497: </a>{
-<a name="line499">499: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
-<a name="line500">500: </a>  char           pfile[PETSC_MAX_PATH_LEN];
-<a name="line501">501: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-
-<a name="line504">504: </a>  <font color="#4169E1">if</font> (options == <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>) {
-<a name="line505">505: </a>    fprintf(stderr, <font color="#666666">"Options have not been enabled.\nYou might have forgotten to call <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>().\n"</font>);
-<a name="line506">506: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Abort.html#MPI_Abort">MPI_Abort</A>(MPI_COMM_WORLD, PETSC_ERR_SUP);
-<a name="line507">507: </a>  }
-<a name="line508">508: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,&amp;rank);
-
-<a name="line510">510: </a>  options-&gt;argc     = (argc) ? *argc : 0;
-<a name="line511">511: </a>  options-&gt;args     = (args) ? *args : <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line461">461: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line462">462: </a>  }
 
-<a name="line513">513: </a>  <font color="#4169E1">if</font> (file) {
-<a name="line514">514: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,file,<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>);
+<a name="line464">464: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;cnt,1,MPI_INT,0,comm);
+<a name="line465">465: </a>  <font color="#4169E1">if</font> (cnt) {
+<a name="line466">466: </a>    <font color="#4169E1">if</font> (rank) {
+<a name="line467">467: </a>      <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((cnt+1)*<font color="#4169E1">sizeof</font>(char),&amp;vstring);
+<a name="line468">468: </a>    }
+<a name="line469">469: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(vstring,cnt,MPI_CHAR,0,comm);
+<a name="line470">470: </a>    vstring[cnt] = 0;
+<a name="line471">471: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(vstring);
+<a name="line472">472: </a>  }
+<a name="line473">473: </a>  <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(astring);
+<a name="line474">474: </a>  <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(vstring);
+<a name="line475">475: </a>  <font color="#4169E1">return</font>(0);
+<a name="line476">476: </a>}
+
+<a name="line480">480: </a><font color="#B22222">/*@C</font>
+<a name="line481">481: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A> - Inserts into the options database from the command line,</font>
+<a name="line482">482: </a><font color="#B22222">                   the environmental variable and a file.</font>
+
+<a name="line484">484: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line485">485: </a><font color="#B22222">+  argc - count of number of command line arguments</font>
+<a name="line486">486: </a><font color="#B22222">.  args - the command line arguments</font>
+<a name="line487">487: </a><font color="#B22222">-  file - optional filename, defaults to ~username/.petscrc</font>
+
+<a name="line489">489: </a><font color="#B22222">   Note:</font>
+<a name="line490">490: </a><font color="#B22222">   Since <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>() is automatically called by <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>(),</font>
+<a name="line491">491: </a><font color="#B22222">   the user does not typically need to call this routine. <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
+<a name="line492">492: </a><font color="#B22222">   can be called several times, adding additional entries into the database.</font>
+
+<a name="line494">494: </a><font color="#B22222">   Options Database Keys:</font>
+<a name="line495">495: </a><font color="#B22222">+   -options_monitor &lt;optional filename&gt; - print options names and values as they are set</font>
+
+<a name="line497">497: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line499">499: </a><font color="#B22222">   Concepts: options database^adding</font>
+
+<a name="line501">501: </a><font color="#B22222">.seealso: PetscOptionsDestroy_Private(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(),</font>
+<a name="line502">502: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>()</font>
+<a name="line503">503: </a><font color="#B22222">@*/</font>
+<a name="line504">504: </a><strong><font color="#4169E1"><a name="PetscOptionsInsert"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(int *argc,char ***args,const char file[])</font></strong>
+<a name="line505">505: </a>{
+<a name="line507">507: </a>  <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    rank;
+<a name="line508">508: </a>  char           pfile[PETSC_MAX_PATH_LEN];
+<a name="line509">509: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+
+<a name="line512">512: </a>  <font color="#4169E1">if</font> (options == <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>) {
+<a name="line513">513: </a>    fprintf(stderr, <font color="#666666">"Options have not been enabled.\nYou might have forgotten to call <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>().\n"</font>);
+<a name="line514">514: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Abort.html#MPI_Abort">MPI_Abort</A>(MPI_COMM_WORLD, PETSC_ERR_SUP);
 <a name="line515">515: </a>  }
-<a name="line516">516: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-skip_petscrc"</font>,&amp;flag,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line517">517: </a>  <font color="#4169E1">if</font> (!flag) {
-<a name="line518">518: </a>    <A href="../../../docs/manualpages/Sys/PetscGetHomeDirectory.html#PetscGetHomeDirectory">PetscGetHomeDirectory</A>(pfile,PETSC_MAX_PATH_LEN-16);
-<a name="line519">519: </a>    <font color="#B22222">/* warning: assumes all processes have a home directory or none, but nothing in between */</font>
-<a name="line520">520: </a>    <font color="#4169E1">if</font> (pfile[0]) {
-<a name="line521">521: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(pfile,<font color="#666666">"/.petscrc"</font>);
-<a name="line522">522: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,pfile,<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-<a name="line523">523: </a>    }
-<a name="line524">524: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">".petscrc"</font>,<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-<a name="line525">525: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"petscrc"</font>,<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-<a name="line526">526: </a>  }
-
-<a name="line528">528: </a>  <font color="#B22222">/* insert environmental options */</font>
-<a name="line529">529: </a>  {
-<a name="line530">530: </a>    char   *eoptions = 0;
-<a name="line531">531: </a>    size_t len = 0;
-<a name="line532">532: </a>    <font color="#4169E1">if</font> (!rank) {
-<a name="line533">533: </a>      eoptions = (char*)getenv(<font color="#666666">"PETSC_OPTIONS"</font>);
-<a name="line534">534: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(eoptions,&amp;len);
-<a name="line535">535: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;len,1,MPIU_SIZE_T,0,<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>);
-<a name="line536">536: </a>    } <font color="#4169E1">else</font> {
-<a name="line537">537: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;len,1,MPIU_SIZE_T,0,<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>);
-<a name="line538">538: </a>      <font color="#4169E1">if</font> (len) {
-<a name="line539">539: </a>        <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((len+1)*<font color="#4169E1">sizeof</font>(char*),&amp;eoptions);
-<a name="line540">540: </a>      }
-<a name="line541">541: </a>    }
-<a name="line542">542: </a>    <font color="#4169E1">if</font> (len) {
-<a name="line543">543: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(eoptions,len,MPI_CHAR,0,<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>);
-<a name="line544">544: </a>      <font color="#4169E1">if</font> (rank) eoptions[len] = 0;
-<a name="line545">545: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(eoptions);
-<a name="line546">546: </a>      <font color="#4169E1">if</font> (rank) {<A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(eoptions);}
-<a name="line547">547: </a>    }
-<a name="line548">548: </a>  }
-
-<a name="line550">550: </a>  <font color="#B22222">/* insert command line options */</font>
-<a name="line551">551: </a>  <font color="#4169E1">if</font> (argc &amp;&amp; args &amp;&amp; *argc) {
-<a name="line552">552: </a>    int        left    = *argc - 1;
-<a name="line553">553: </a>    char       **eargs = *args + 1;
-<a name="line554">554: </a>    <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> isoptions_file,isp4,tisp4,isp4yourname,isp4rmrank;
-
-<a name="line556">556: </a>    <font color="#4169E1">while</font> (left) {
-<a name="line557">557: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-options_file"</font>,&amp;isoptions_file);
-<a name="line558">558: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4pg"</font>,&amp;isp4);
-<a name="line559">559: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4yourname"</font>,&amp;isp4yourname);
-<a name="line560">560: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4rmrank"</font>,&amp;isp4rmrank);
-<a name="line561">561: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4wd"</font>,&amp;tisp4);
-<a name="line562">562: </a>      isp4 = (<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>) (isp4 || tisp4);
-<a name="line563">563: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-np"</font>,&amp;tisp4);
-<a name="line564">564: </a>      isp4 = (<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>) (isp4 || tisp4);
-<a name="line565">565: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4amslave"</font>,&amp;tisp4);
-
-<a name="line567">567: </a>      <font color="#4169E1">if</font> (eargs[0][0] != '-') {
-<a name="line568">568: </a>        eargs++; left--;
-<a name="line569">569: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isoptions_file) {
-<a name="line570">570: </a>        <font color="#4169E1">if</font> (left &lt;= 1) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_USER,<font color="#666666">"Missing filename for -options_file filename option"</font>);
-<a name="line571">571: </a>        <font color="#4169E1">if</font> (eargs[1][0] == '-') <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_USER,<font color="#666666">"Missing filename for -options_file filename option"</font>);
-<a name="line572">572: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,eargs[1],<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>);
-<a name="line573">573: </a>        eargs += 2; left -= 2;
-
-<a name="line575">575: </a>      <font color="#B22222">/*</font>
-<a name="line576">576: </a><font color="#B22222">         These are "bad" options that MPICH, etc put on the command line</font>
-<a name="line577">577: </a><font color="#B22222">         we strip them out here.</font>
-<a name="line578">578: </a><font color="#B22222">      */</font>
-<a name="line579">579: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (tisp4 || isp4rmrank) {
-<a name="line580">580: </a>        eargs += 1; left -= 1;
-<a name="line581">581: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isp4 || isp4yourname) {
-<a name="line582">582: </a>        eargs += 2; left -= 2;
-<a name="line583">583: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> ((left &lt; 2) || ((eargs[1][0] == '-') &amp;&amp;
-<a name="line584">584: </a>               ((eargs[1][1] &gt; '9') || (eargs[1][1] &lt; '0')))) {
-<a name="line585">585: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(eargs[0],<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line586">586: </a>        eargs++; left--;
-<a name="line587">587: </a>      } <font color="#4169E1">else</font> {
-<a name="line588">588: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(eargs[0],eargs[1]);
-<a name="line589">589: </a>        eargs += 2; left -= 2;
-<a name="line590">590: </a>      }
-<a name="line591">591: </a>    }
-<a name="line592">592: </a>  }
-<a name="line593">593: </a>  <font color="#4169E1">return</font>(0);
-<a name="line594">594: </a>}
-
-<a name="line598">598: </a><font color="#B22222">/*@C</font>
-<a name="line599">599: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A> - Prints the options that have been loaded. This is</font>
-<a name="line600">600: </a><font color="#B22222">   useful for debugging purposes.</font>
-
-<a name="line602">602: </a><font color="#B22222">   Collective on <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A></font>
-
-<a name="line604">604: </a><font color="#B22222">   Input Parameter:</font>
-<a name="line605">605: </a><font color="#B22222">.  FILE fd - location to print options (usually stdout or stderr)</font>
-
-<a name="line607">607: </a><font color="#B22222">   Options Database Key:</font>
-<a name="line608">608: </a><font color="#B22222">.  -optionstable - Activates <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>() within <A href="../../../docs/manualpages/Sys/PetscFinalize.html#PetscFinalize">PetscFinalize</A>()</font>
-
-<a name="line610">610: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line612">612: </a><font color="#B22222">   Concepts: options database^printing</font>
-
-<a name="line614">614: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>()</font>
-<a name="line615">615: </a><font color="#B22222">@*/</font>
-<a name="line616">616: </a><strong><font color="#4169E1"><a name="PetscOptionsPrint"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(FILE *fd)</font></strong>
-<a name="line617">617: </a>{
-<a name="line619">619: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
-
-<a name="line622">622: </a>  <font color="#4169E1">if</font> (!fd) fd = PETSC_STDOUT;
-<a name="line623">623: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
-<a name="line624">624: </a>  <font color="#4169E1">if</font> (options-&gt;N) {
-<a name="line625">625: </a>    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"#PETSc Option Table entries:\n"</font>);
-<a name="line626">626: </a>  } <font color="#4169E1">else</font> {
-<a name="line627">627: </a>    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"#No PETSc Option Table entries\n"</font>);
-<a name="line628">628: </a>  }
-<a name="line629">629: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
-<a name="line630">630: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) {
-<a name="line631">631: </a>      <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"-%s %s\n"</font>,options-&gt;names[i],options-&gt;values[i]);
-<a name="line632">632: </a>    } <font color="#4169E1">else</font> {
-<a name="line633">633: </a>      <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"-%s\n"</font>,options-&gt;names[i]);
-<a name="line634">634: </a>    }
-<a name="line635">635: </a>  }
-<a name="line636">636: </a>  <font color="#4169E1">if</font> (options-&gt;N) {
-<a name="line637">637: </a>    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"#End of PETSc Option Table entries\n"</font>);
-<a name="line638">638: </a>  }
-<a name="line639">639: </a>  <font color="#4169E1">return</font>(0);
-<a name="line640">640: </a>}
-
-<a name="line644">644: </a><font color="#B22222">/*@C</font>
-<a name="line645">645: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetAll.html#PetscOptionsGetAll">PetscOptionsGetAll</A> - Lists all the options the program was run with in a single string.</font>
-
-<a name="line647">647: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line649">649: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line650">650: </a><font color="#B22222">.  copts - pointer where string pointer is stored</font>
-
-<a name="line652">652: </a><font color="#B22222">   Notes: the array and each entry in the array should be freed with <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>()</font>
-
-<a name="line654">654: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line656">656: </a><font color="#B22222">   Concepts: options database^listing</font>
-
-<a name="line658">658: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>()</font>
-<a name="line659">659: </a><font color="#B22222">@*/</font>
-<a name="line660">660: </a><strong><font color="#4169E1"><a name="PetscOptionsGetAll"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetAll.html#PetscOptionsGetAll">PetscOptionsGetAll</A>(char *copts[])</font></strong>
-<a name="line661">661: </a>{
-<a name="line663">663: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
-<a name="line664">664: </a>  size_t         len = 1,lent;
-<a name="line665">665: </a>  char           *coptions;
-
-<a name="line668">668: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
-
-<a name="line670">670: </a>  <font color="#B22222">/* count the length of the required string */</font>
-<a name="line671">671: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
-<a name="line672">672: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(options-&gt;names[i],&amp;lent);
-<a name="line673">673: </a>    len += 2 + lent;
-<a name="line674">674: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) {
-<a name="line675">675: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(options-&gt;values[i],&amp;lent);
-<a name="line676">676: </a>      len += 1 + lent;
-<a name="line677">677: </a>    }
-<a name="line678">678: </a>  }
-<a name="line679">679: </a>  <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(len*<font color="#4169E1">sizeof</font>(char),&amp;coptions);
-<a name="line680">680: </a>  coptions[0] = 0;
-<a name="line681">681: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
-<a name="line682">682: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,<font color="#666666">"-"</font>);
-<a name="line683">683: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,options-&gt;names[i]);
-<a name="line684">684: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,<font color="#666666">" "</font>);
-<a name="line685">685: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) {
-<a name="line686">686: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,options-&gt;values[i]);
-<a name="line687">687: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,<font color="#666666">" "</font>);
-<a name="line688">688: </a>    }
-<a name="line689">689: </a>  }
-<a name="line690">690: </a>  *copts = coptions;
-<a name="line691">691: </a>  <font color="#4169E1">return</font>(0);
-<a name="line692">692: </a>}
-
-<a name="line696">696: </a><font color="#B22222">/*@C</font>
-<a name="line697">697: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsClear.html#PetscOptionsClear">PetscOptionsClear</A> - Removes all options form the database leaving it empty.</font>
-
-<a name="line699">699: </a><font color="#B22222">   Level: developer</font>
-
-<a name="line701">701: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
-<a name="line702">702: </a><font color="#B22222">@*/</font>
-<a name="line703">703: </a><strong><font color="#4169E1"><a name="PetscOptionsClear"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsClear.html#PetscOptionsClear">PetscOptionsClear</A>(void)</font></strong>
-<a name="line704">704: </a>{
-<a name="line705">705: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
-
-<a name="line708">708: </a>  <font color="#4169E1">if</font> (!options) <font color="#4169E1">return</font>(0);
-<a name="line709">709: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
-<a name="line710">710: </a>    <font color="#4169E1">if</font> (options-&gt;names[i])  free(options-&gt;names[i]);
-<a name="line711">711: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) free(options-&gt;values[i]);
-<a name="line712">712: </a>  }
-<a name="line713">713: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;Naliases; i++) {
-<a name="line714">714: </a>    free(options-&gt;aliases1[i]);
-<a name="line715">715: </a>    free(options-&gt;aliases2[i]);
-<a name="line716">716: </a>  }
-<a name="line717">717: </a>  options-&gt;N        = 0;
-<a name="line718">718: </a>  options-&gt;Naliases = 0;
-<a name="line719">719: </a>  <font color="#4169E1">return</font>(0);
-<a name="line720">720: </a>}
-
-<a name="line724">724: </a><font color="#B22222">/*@C</font>
-<a name="line725">725: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A> - Destroys the option database. </font>
-
-<a name="line727">727: </a><font color="#B22222">    Note:</font>
-<a name="line728">728: </a><font color="#B22222">    Since <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A>() is called by <A href="../../../docs/manualpages/Sys/PetscFinalize.html#PetscFinalize">PetscFinalize</A>(), the user </font>
-<a name="line729">729: </a><font color="#B22222">    typically does not need to call this routine.</font>
-
-<a name="line731">731: </a><font color="#B22222">   Level: developer</font>
-
-<a name="line733">733: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
-<a name="line734">734: </a><font color="#B22222">@*/</font>
-<a name="line735">735: </a><strong><font color="#4169E1"><a name="PetscOptionsDestroy"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A>(void)</font></strong>
-<a name="line736">736: </a>{
-
-<a name="line740">740: </a>  <font color="#4169E1">if</font> (!options) <font color="#4169E1">return</font>(0);
-<a name="line741">741: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsClear.html#PetscOptionsClear">PetscOptionsClear</A>();
-<a name="line742">742: </a>  free(options);
-<a name="line743">743: </a>  options = 0;
-<a name="line744">744: </a>  <font color="#4169E1">return</font>(0);
-<a name="line745">745: </a>}
-
-<a name="line749">749: </a><font color="#B22222">/*@C</font>
-<a name="line750">750: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A> - Sets an option name-value pair in the options </font>
-<a name="line751">751: </a><font color="#B22222">   database, overriding whatever is already present.</font>
-
-<a name="line753">753: </a><font color="#B22222">   Not collective, but setting values on certain processors could cause problems</font>
-<a name="line754">754: </a><font color="#B22222">   for parallel objects looking for options.</font>
-
-<a name="line756">756: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line757">757: </a><font color="#B22222">+  name - name of option, this SHOULD have the - prepended</font>
-<a name="line758">758: </a><font color="#B22222">-  value - the option value (not used for all options)</font>
-
-<a name="line760">760: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line762">762: </a><font color="#B22222">   Note:</font>
-<a name="line763">763: </a><font color="#B22222">   Only some options have values associated with them, such as</font>
-<a name="line764">764: </a><font color="#B22222">   -ksp_rtol tol.  Other options stand alone, such as -ksp_monitor.</font>
-
-<a name="line766">766: </a><font color="#B22222">  Concepts: options database^adding option</font>
-
-<a name="line768">768: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
-<a name="line769">769: </a><font color="#B22222">@*/</font>
-<a name="line770">770: </a><strong><font color="#4169E1"><a name="PetscOptionsSetValue"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(const char iname[],const char value[])</font></strong>
-<a name="line771">771: </a>{
-<a name="line772">772: </a>  size_t         len;
-<a name="line774">774: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       N,n,i;
-<a name="line775">775: </a>  char           **names;
-<a name="line776">776: </a>  const char     *name = (char*)iname;
-<a name="line777">777: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     gt,match;
-
-<a name="line780">780: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
-
-<a name="line782">782: </a>  <font color="#B22222">/* this is so that -h and -hel\p are equivalent (p4 does not like -help)*/</font>
-<a name="line783">783: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"-h"</font>,&amp;match);
-<a name="line784">784: </a>  <font color="#4169E1">if</font> (match) name = <font color="#666666">"-help"</font>;
-
-<a name="line786">786: </a>  name++;
-<a name="line787">787: </a>  <font color="#B22222">/* first check against aliases */</font>
-<a name="line788">788: </a>  N = options-&gt;Naliases;
-<a name="line789">789: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
-<a name="line790">790: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(options-&gt;aliases1[i],name,&amp;match);
-<a name="line791">791: </a>    <font color="#4169E1">if</font> (match) {
-<a name="line792">792: </a>      name = options-&gt;aliases2[i];
-<a name="line793">793: </a>      <font color="#4169E1">break</font>;
-<a name="line794">794: </a>    }
-<a name="line795">795: </a>  }
-
-<a name="line797">797: </a>  N     = options-&gt;N;
-<a name="line798">798: </a>  n     = N;
-<a name="line799">799: </a>  names = options-&gt;names;
-<a name="line800">800: </a>
-<a name="line801">801: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
-<a name="line802">802: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(names[i],name,&amp;match);
-<a name="line803">803: </a>    <A href="../../../docs/manualpages/Sys/PetscStrgrt.html#PetscStrgrt">PetscStrgrt</A>(names[i],name,&amp;gt);
-<a name="line804">804: </a>    <font color="#4169E1">if</font> (match) {
-<a name="line805">805: </a>      <font color="#4169E1">if</font> (options-&gt;values[i]) free(options-&gt;values[i]);
-<a name="line806">806: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value,&amp;len);
-<a name="line807">807: </a>      <font color="#4169E1">if</font> (len) {
-<a name="line808">808: </a>        options-&gt;values[i] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
-<a name="line809">809: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;values[i],value);
-<a name="line810">810: </a>      } <font color="#4169E1">else</font> { options-&gt;values[i] = 0;}
-<a name="line811">811: </a>      PetscOptionsMonitor(name,value);
-<a name="line812">812: </a>      <font color="#4169E1">return</font>(0);
-<a name="line813">813: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (gt) {
-<a name="line814">814: </a>      n = i;
-<a name="line815">815: </a>      <font color="#4169E1">break</font>;
-<a name="line816">816: </a>    }
-<a name="line817">817: </a>  }
-<a name="line818">818: </a>  <font color="#4169E1">if</font> (N &gt;= MAXOPTIONS) {
-<a name="line819">819: </a>    <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_PLIB,<font color="#666666">"No more room in option table, limit %d recompile \n src/sys/objects/options.c with larger value for MAXOPTIONS\n"</font>,MAXOPTIONS);
-<a name="line820">820: </a>  }
-<a name="line821">821: </a>  <font color="#B22222">/* shift remaining values down 1 */</font>
-<a name="line822">822: </a>  <font color="#4169E1">for</font> (i=N; i&gt;n; i--) {
-<a name="line823">823: </a>    options-&gt;names[i]  = options-&gt;names[i-1];
-<a name="line824">824: </a>    options-&gt;values[i] = options-&gt;values[i-1];
-<a name="line825">825: </a>    options-&gt;used[i]   = options-&gt;used[i-1];
-<a name="line826">826: </a>  }
-<a name="line827">827: </a>  <font color="#B22222">/* insert new name and value */</font>
-<a name="line828">828: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(name,&amp;len);
-<a name="line829">829: </a>  options-&gt;names[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
-<a name="line830">830: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;names[n],name);
-<a name="line831">831: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value,&amp;len);
-<a name="line832">832: </a>  <font color="#4169E1">if</font> (len) {
-<a name="line833">833: </a>    options-&gt;values[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
-<a name="line834">834: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;values[n],value);
-<a name="line835">835: </a>  } <font color="#4169E1">else</font> {options-&gt;values[n] = 0;}
-<a name="line836">836: </a>  options-&gt;used[n] = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line837">837: </a>  options-&gt;N++;
-<a name="line838">838: </a>  PetscOptionsMonitor(name,value);
-<a name="line839">839: </a>  <font color="#4169E1">return</font>(0);
-<a name="line840">840: </a>}
-
-<a name="line844">844: </a><font color="#B22222">/*@C</font>
-<a name="line845">845: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsClearValue.html#PetscOptionsClearValue">PetscOptionsClearValue</A> - Clears an option name-value pair in the options </font>
-<a name="line846">846: </a><font color="#B22222">   database, overriding whatever is already present.</font>
-
-<a name="line848">848: </a><font color="#B22222">   Not Collective, but setting values on certain processors could cause problems</font>
-<a name="line849">849: </a><font color="#B22222">   for parallel objects looking for options.</font>
-
-<a name="line851">851: </a><font color="#B22222">   Input Parameter:</font>
-<a name="line852">852: </a><font color="#B22222">.  name - name of option, this SHOULD have the - prepended</font>
-
-<a name="line854">854: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line856">856: </a><font color="#B22222">   Concepts: options database^removing option</font>
-<a name="line857">857: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
-<a name="line858">858: </a><font color="#B22222">@*/</font>
-<a name="line859">859: </a><strong><font color="#4169E1"><a name="PetscOptionsClearValue"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsClearValue.html#PetscOptionsClearValue">PetscOptionsClearValue</A>(const char iname[])</font></strong>
-<a name="line860">860: </a>{
-<a name="line862">862: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       N,n,i;
-<a name="line863">863: </a>  char           **names,*name=(char*)iname;
-<a name="line864">864: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     gt,match;
-
-<a name="line867">867: </a>  <font color="#4169E1">if</font> (name[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Name must begin with -: Instead %s"</font>,name);
-<a name="line868">868: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
-
-<a name="line870">870: </a>  name++;
-
-<a name="line872">872: </a>  N     = options-&gt;N; n = 0;
-<a name="line873">873: </a>  names = options-&gt;names;
-<a name="line874">874: </a>
-<a name="line875">875: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
-<a name="line876">876: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(names[i],name,&amp;match);
-<a name="line877">877: </a>    <A href="../../../docs/manualpages/Sys/PetscStrgrt.html#PetscStrgrt">PetscStrgrt</A>(names[i],name,&amp;gt);
-<a name="line878">878: </a>    <font color="#4169E1">if</font> (match) {
-<a name="line879">879: </a>      <font color="#4169E1">if</font> (options-&gt;names[i])  free(options-&gt;names[i]);
-<a name="line880">880: </a>      <font color="#4169E1">if</font> (options-&gt;values[i]) free(options-&gt;values[i]);
-<a name="line881">881: </a>      PetscOptionsMonitor(name,<font color="#666666">""</font>);
-<a name="line882">882: </a>      <font color="#4169E1">break</font>;
-<a name="line883">883: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (gt) {
-<a name="line884">884: </a>      <font color="#4169E1">return</font>(0); <font color="#B22222">/* it was not listed */</font>
-<a name="line885">885: </a>    }
-<a name="line886">886: </a>    n++;
-<a name="line887">887: </a>  }
-<a name="line888">888: </a>  <font color="#4169E1">if</font> (n == N) <font color="#4169E1">return</font>(0); <font color="#B22222">/* it was not listed */</font>
-
-<a name="line890">890: </a>  <font color="#B22222">/* shift remaining values down 1 */</font>
-<a name="line891">891: </a>  <font color="#4169E1">for</font> (i=n; i&lt;N-1; i++) {
-<a name="line892">892: </a>    options-&gt;names[i]  = options-&gt;names[i+1];
-<a name="line893">893: </a>    options-&gt;values[i] = options-&gt;values[i+1];
-<a name="line894">894: </a>    options-&gt;used[i]   = options-&gt;used[i+1];
+<a name="line516">516: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,&amp;rank);
+
+<a name="line518">518: </a>  options-&gt;argc     = (argc) ? *argc : 0;
+<a name="line519">519: </a>  options-&gt;args     = (args) ? *args : <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+
+<a name="line521">521: </a>  <font color="#4169E1">if</font> (file) {
+<a name="line522">522: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,file,<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>);
+<a name="line523">523: </a>  }
+<a name="line524">524: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-skip_petscrc"</font>,&amp;flag,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line525">525: </a>  <font color="#4169E1">if</font> (!flag) {
+<a name="line526">526: </a>    <A href="../../../docs/manualpages/Sys/PetscGetHomeDirectory.html#PetscGetHomeDirectory">PetscGetHomeDirectory</A>(pfile,PETSC_MAX_PATH_LEN-16);
+<a name="line527">527: </a>    <font color="#B22222">/* warning: assumes all processes have a home directory or none, but nothing in between */</font>
+<a name="line528">528: </a>    <font color="#4169E1">if</font> (pfile[0]) {
+<a name="line529">529: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(pfile,<font color="#666666">"/.petscrc"</font>);
+<a name="line530">530: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,pfile,<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
+<a name="line531">531: </a>    }
+<a name="line532">532: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">".petscrc"</font>,<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
+<a name="line533">533: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"petscrc"</font>,<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
+<a name="line534">534: </a>  }
+
+<a name="line536">536: </a>  <font color="#B22222">/* insert environmental options */</font>
+<a name="line537">537: </a>  {
+<a name="line538">538: </a>    char   *eoptions = 0;
+<a name="line539">539: </a>    size_t len = 0;
+<a name="line540">540: </a>    <font color="#4169E1">if</font> (!rank) {
+<a name="line541">541: </a>      eoptions = (char*)getenv(<font color="#666666">"PETSC_OPTIONS"</font>);
+<a name="line542">542: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(eoptions,&amp;len);
+<a name="line543">543: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;len,1,MPIU_SIZE_T,0,<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>);
+<a name="line544">544: </a>    } <font color="#4169E1">else</font> {
+<a name="line545">545: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(&amp;len,1,MPIU_SIZE_T,0,<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>);
+<a name="line546">546: </a>      <font color="#4169E1">if</font> (len) {
+<a name="line547">547: </a>        <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((len+1)*<font color="#4169E1">sizeof</font>(char*),&amp;eoptions);
+<a name="line548">548: </a>      }
+<a name="line549">549: </a>    }
+<a name="line550">550: </a>    <font color="#4169E1">if</font> (len) {
+<a name="line551">551: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Bcast.html#MPI_Bcast">MPI_Bcast</A>(eoptions,len,MPI_CHAR,0,<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>);
+<a name="line552">552: </a>      <font color="#4169E1">if</font> (rank) eoptions[len] = 0;
+<a name="line553">553: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsInsertString.html#PetscOptionsInsertString">PetscOptionsInsertString</A>(eoptions);
+<a name="line554">554: </a>      <font color="#4169E1">if</font> (rank) {<A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(eoptions);}
+<a name="line555">555: </a>    }
+<a name="line556">556: </a>  }
+
+<a name="line558">558: </a>  <font color="#B22222">/* insert command line options */</font>
+<a name="line559">559: </a>  <font color="#4169E1">if</font> (argc &amp;&amp; args &amp;&amp; *argc) {
+<a name="line560">560: </a>    int        left    = *argc - 1;
+<a name="line561">561: </a>    char       **eargs = *args + 1;
+<a name="line562">562: </a>    <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> isoptions_file,isp4,tisp4,isp4yourname,isp4rmrank;
+
+<a name="line564">564: </a>    <font color="#4169E1">while</font> (left) {
+<a name="line565">565: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-options_file"</font>,&amp;isoptions_file);
+<a name="line566">566: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4pg"</font>,&amp;isp4);
+<a name="line567">567: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4yourname"</font>,&amp;isp4yourname);
+<a name="line568">568: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4rmrank"</font>,&amp;isp4rmrank);
+<a name="line569">569: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4wd"</font>,&amp;tisp4);
+<a name="line570">570: </a>      isp4 = (<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>) (isp4 || tisp4);
+<a name="line571">571: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-np"</font>,&amp;tisp4);
+<a name="line572">572: </a>      isp4 = (<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>) (isp4 || tisp4);
+<a name="line573">573: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(eargs[0],<font color="#666666">"-p4amslave"</font>,&amp;tisp4);
+
+<a name="line575">575: </a>      <font color="#4169E1">if</font> (eargs[0][0] != '-') {
+<a name="line576">576: </a>        eargs++; left--;
+<a name="line577">577: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isoptions_file) {
+<a name="line578">578: </a>        <font color="#4169E1">if</font> (left &lt;= 1) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_USER,<font color="#666666">"Missing filename for -options_file filename option"</font>);
+<a name="line579">579: </a>        <font color="#4169E1">if</font> (eargs[1][0] == '-') <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_USER,<font color="#666666">"Missing filename for -options_file filename option"</font>);
+<a name="line580">580: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsInsertFile.html#PetscOptionsInsertFile">PetscOptionsInsertFile</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,eargs[1],<A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>);
+<a name="line581">581: </a>        eargs += 2; left -= 2;
+
+<a name="line583">583: </a>      <font color="#B22222">/*</font>
+<a name="line584">584: </a><font color="#B22222">         These are "bad" options that MPICH, etc put on the command line</font>
+<a name="line585">585: </a><font color="#B22222">         we strip them out here.</font>
+<a name="line586">586: </a><font color="#B22222">      */</font>
+<a name="line587">587: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (tisp4 || isp4rmrank) {
+<a name="line588">588: </a>        eargs += 1; left -= 1;
+<a name="line589">589: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isp4 || isp4yourname) {
+<a name="line590">590: </a>        eargs += 2; left -= 2;
+<a name="line591">591: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> ((left &lt; 2) || ((eargs[1][0] == '-') &amp;&amp;
+<a name="line592">592: </a>               ((eargs[1][1] &gt; '9') || (eargs[1][1] &lt; '0')))) {
+<a name="line593">593: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(eargs[0],<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line594">594: </a>        eargs++; left--;
+<a name="line595">595: </a>      } <font color="#4169E1">else</font> {
+<a name="line596">596: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(eargs[0],eargs[1]);
+<a name="line597">597: </a>        eargs += 2; left -= 2;
+<a name="line598">598: </a>      }
+<a name="line599">599: </a>    }
+<a name="line600">600: </a>  }
+<a name="line601">601: </a>  <font color="#4169E1">return</font>(0);
+<a name="line602">602: </a>}
+
+<a name="line606">606: </a><font color="#B22222">/*@C</font>
+<a name="line607">607: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A> - Prints the options that have been loaded. This is</font>
+<a name="line608">608: </a><font color="#B22222">   useful for debugging purposes.</font>
+
+<a name="line610">610: </a><font color="#B22222">   Collective on <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A></font>
+
+<a name="line612">612: </a><font color="#B22222">   Input Parameter:</font>
+<a name="line613">613: </a><font color="#B22222">.  FILE fd - location to print options (usually stdout or stderr)</font>
+
+<a name="line615">615: </a><font color="#B22222">   Options Database Key:</font>
+<a name="line616">616: </a><font color="#B22222">.  -optionstable - Activates <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>() within <A href="../../../docs/manualpages/Sys/PetscFinalize.html#PetscFinalize">PetscFinalize</A>()</font>
+
+<a name="line618">618: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line620">620: </a><font color="#B22222">   Concepts: options database^printing</font>
+
+<a name="line622">622: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>()</font>
+<a name="line623">623: </a><font color="#B22222">@*/</font>
+<a name="line624">624: </a><strong><font color="#4169E1"><a name="PetscOptionsPrint"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(FILE *fd)</font></strong>
+<a name="line625">625: </a>{
+<a name="line627">627: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
+
+<a name="line630">630: </a>  <font color="#4169E1">if</font> (!fd) fd = PETSC_STDOUT;
+<a name="line631">631: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
+<a name="line632">632: </a>  <font color="#4169E1">if</font> (options-&gt;N) {
+<a name="line633">633: </a>    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"#PETSc Option Table entries:\n"</font>);
+<a name="line634">634: </a>  } <font color="#4169E1">else</font> {
+<a name="line635">635: </a>    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"#No PETSc Option Table entries\n"</font>);
+<a name="line636">636: </a>  }
+<a name="line637">637: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
+<a name="line638">638: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) {
+<a name="line639">639: </a>      <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"-%s %s\n"</font>,options-&gt;names[i],options-&gt;values[i]);
+<a name="line640">640: </a>    } <font color="#4169E1">else</font> {
+<a name="line641">641: </a>      <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"-%s\n"</font>,options-&gt;names[i]);
+<a name="line642">642: </a>    }
+<a name="line643">643: </a>  }
+<a name="line644">644: </a>  <font color="#4169E1">if</font> (options-&gt;N) {
+<a name="line645">645: </a>    <A href="../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,fd,<font color="#666666">"#End of PETSc Option Table entries\n"</font>);
+<a name="line646">646: </a>  }
+<a name="line647">647: </a>  <font color="#4169E1">return</font>(0);
+<a name="line648">648: </a>}
+
+<a name="line652">652: </a><font color="#B22222">/*@C</font>
+<a name="line653">653: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetAll.html#PetscOptionsGetAll">PetscOptionsGetAll</A> - Lists all the options the program was run with in a single string.</font>
+
+<a name="line655">655: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line657">657: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line658">658: </a><font color="#B22222">.  copts - pointer where string pointer is stored</font>
+
+<a name="line660">660: </a><font color="#B22222">   Notes: the array and each entry in the array should be freed with <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>()</font>
+
+<a name="line662">662: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line664">664: </a><font color="#B22222">   Concepts: options database^listing</font>
+
+<a name="line666">666: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>()</font>
+<a name="line667">667: </a><font color="#B22222">@*/</font>
+<a name="line668">668: </a><strong><font color="#4169E1"><a name="PetscOptionsGetAll"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetAll.html#PetscOptionsGetAll">PetscOptionsGetAll</A>(char *copts[])</font></strong>
+<a name="line669">669: </a>{
+<a name="line671">671: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
+<a name="line672">672: </a>  size_t         len = 1,lent;
+<a name="line673">673: </a>  char           *coptions;
+
+<a name="line676">676: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
+
+<a name="line678">678: </a>  <font color="#B22222">/* count the length of the required string */</font>
+<a name="line679">679: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
+<a name="line680">680: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(options-&gt;names[i],&amp;lent);
+<a name="line681">681: </a>    len += 2 + lent;
+<a name="line682">682: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) {
+<a name="line683">683: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(options-&gt;values[i],&amp;lent);
+<a name="line684">684: </a>      len += 1 + lent;
+<a name="line685">685: </a>    }
+<a name="line686">686: </a>  }
+<a name="line687">687: </a>  <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(len*<font color="#4169E1">sizeof</font>(char),&amp;coptions);
+<a name="line688">688: </a>  coptions[0] = 0;
+<a name="line689">689: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
+<a name="line690">690: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,<font color="#666666">"-"</font>);
+<a name="line691">691: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,options-&gt;names[i]);
+<a name="line692">692: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,<font color="#666666">" "</font>);
+<a name="line693">693: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) {
+<a name="line694">694: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,options-&gt;values[i]);
+<a name="line695">695: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(coptions,<font color="#666666">" "</font>);
+<a name="line696">696: </a>    }
+<a name="line697">697: </a>  }
+<a name="line698">698: </a>  *copts = coptions;
+<a name="line699">699: </a>  <font color="#4169E1">return</font>(0);
+<a name="line700">700: </a>}
+
+<a name="line704">704: </a><font color="#B22222">/*@C</font>
+<a name="line705">705: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsClear.html#PetscOptionsClear">PetscOptionsClear</A> - Removes all options form the database leaving it empty.</font>
+
+<a name="line707">707: </a><font color="#B22222">   Level: developer</font>
+
+<a name="line709">709: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
+<a name="line710">710: </a><font color="#B22222">@*/</font>
+<a name="line711">711: </a><strong><font color="#4169E1"><a name="PetscOptionsClear"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsClear.html#PetscOptionsClear">PetscOptionsClear</A>(void)</font></strong>
+<a name="line712">712: </a>{
+<a name="line713">713: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
+
+<a name="line716">716: </a>  <font color="#4169E1">if</font> (!options) <font color="#4169E1">return</font>(0);
+<a name="line717">717: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
+<a name="line718">718: </a>    <font color="#4169E1">if</font> (options-&gt;names[i])  free(options-&gt;names[i]);
+<a name="line719">719: </a>    <font color="#4169E1">if</font> (options-&gt;values[i]) free(options-&gt;values[i]);
+<a name="line720">720: </a>  }
+<a name="line721">721: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;Naliases; i++) {
+<a name="line722">722: </a>    free(options-&gt;aliases1[i]);
+<a name="line723">723: </a>    free(options-&gt;aliases2[i]);
+<a name="line724">724: </a>  }
+<a name="line725">725: </a>  options-&gt;N        = 0;
+<a name="line726">726: </a>  options-&gt;Naliases = 0;
+<a name="line727">727: </a>  <font color="#4169E1">return</font>(0);
+<a name="line728">728: </a>}
+
+<a name="line732">732: </a><font color="#B22222">/*@C</font>
+<a name="line733">733: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A> - Destroys the option database. </font>
+
+<a name="line735">735: </a><font color="#B22222">    Note:</font>
+<a name="line736">736: </a><font color="#B22222">    Since <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A>() is called by <A href="../../../docs/manualpages/Sys/PetscFinalize.html#PetscFinalize">PetscFinalize</A>(), the user </font>
+<a name="line737">737: </a><font color="#B22222">    typically does not need to call this routine.</font>
+
+<a name="line739">739: </a><font color="#B22222">   Level: developer</font>
+
+<a name="line741">741: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
+<a name="line742">742: </a><font color="#B22222">@*/</font>
+<a name="line743">743: </a><strong><font color="#4169E1"><a name="PetscOptionsDestroy"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A>(void)</font></strong>
+<a name="line744">744: </a>{
+
+<a name="line748">748: </a>  <font color="#4169E1">if</font> (!options) <font color="#4169E1">return</font>(0);
+<a name="line749">749: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsClear.html#PetscOptionsClear">PetscOptionsClear</A>();
+<a name="line750">750: </a>  free(options);
+<a name="line751">751: </a>  options = 0;
+<a name="line752">752: </a>  <font color="#4169E1">return</font>(0);
+<a name="line753">753: </a>}
+
+<a name="line757">757: </a><font color="#B22222">/*@C</font>
+<a name="line758">758: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A> - Sets an option name-value pair in the options </font>
+<a name="line759">759: </a><font color="#B22222">   database, overriding whatever is already present.</font>
+
+<a name="line761">761: </a><font color="#B22222">   Not collective, but setting values on certain processors could cause problems</font>
+<a name="line762">762: </a><font color="#B22222">   for parallel objects looking for options.</font>
+
+<a name="line764">764: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line765">765: </a><font color="#B22222">+  name - name of option, this SHOULD have the - prepended</font>
+<a name="line766">766: </a><font color="#B22222">-  value - the option value (not used for all options)</font>
+
+<a name="line768">768: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line770">770: </a><font color="#B22222">   Note:</font>
+<a name="line771">771: </a><font color="#B22222">   Only some options have values associated with them, such as</font>
+<a name="line772">772: </a><font color="#B22222">   -ksp_rtol tol.  Other options stand alone, such as -ksp_monitor.</font>
+
+<a name="line774">774: </a><font color="#B22222">  Concepts: options database^adding option</font>
+
+<a name="line776">776: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
+<a name="line777">777: </a><font color="#B22222">@*/</font>
+<a name="line778">778: </a><strong><font color="#4169E1"><a name="PetscOptionsSetValue"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsSetValue.html#PetscOptionsSetValue">PetscOptionsSetValue</A>(const char iname[],const char value[])</font></strong>
+<a name="line779">779: </a>{
+<a name="line780">780: </a>  size_t         len;
+<a name="line782">782: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       N,n,i;
+<a name="line783">783: </a>  char           **names;
+<a name="line784">784: </a>  const char     *name = (char*)iname;
+<a name="line785">785: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     gt,match;
+
+<a name="line788">788: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
+
+<a name="line790">790: </a>  <font color="#B22222">/* this is so that -h and -hel\p are equivalent (p4 does not like -help)*/</font>
+<a name="line791">791: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(name,<font color="#666666">"-h"</font>,&amp;match);
+<a name="line792">792: </a>  <font color="#4169E1">if</font> (match) name = <font color="#666666">"-help"</font>;
+
+<a name="line794">794: </a>  name++;
+<a name="line795">795: </a>  <font color="#B22222">/* first check against aliases */</font>
+<a name="line796">796: </a>  N = options-&gt;Naliases;
+<a name="line797">797: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
+<a name="line798">798: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(options-&gt;aliases1[i],name,&amp;match);
+<a name="line799">799: </a>    <font color="#4169E1">if</font> (match) {
+<a name="line800">800: </a>      name = options-&gt;aliases2[i];
+<a name="line801">801: </a>      <font color="#4169E1">break</font>;
+<a name="line802">802: </a>    }
+<a name="line803">803: </a>  }
+
+<a name="line805">805: </a>  N     = options-&gt;N;
+<a name="line806">806: </a>  n     = N;
+<a name="line807">807: </a>  names = options-&gt;names;
+<a name="line808">808: </a>
+<a name="line809">809: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
+<a name="line810">810: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(names[i],name,&amp;match);
+<a name="line811">811: </a>    <A href="../../../docs/manualpages/Sys/PetscStrgrt.html#PetscStrgrt">PetscStrgrt</A>(names[i],name,&amp;gt);
+<a name="line812">812: </a>    <font color="#4169E1">if</font> (match) {
+<a name="line813">813: </a>      <font color="#4169E1">if</font> (options-&gt;values[i]) free(options-&gt;values[i]);
+<a name="line814">814: </a>      <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value,&amp;len);
+<a name="line815">815: </a>      <font color="#4169E1">if</font> (len) {
+<a name="line816">816: </a>        options-&gt;values[i] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
+<a name="line817">817: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;values[i],value);
+<a name="line818">818: </a>      } <font color="#4169E1">else</font> { options-&gt;values[i] = 0;}
+<a name="line819">819: </a>      PetscOptionsMonitor(name,value);
+<a name="line820">820: </a>      <font color="#4169E1">return</font>(0);
+<a name="line821">821: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (gt) {
+<a name="line822">822: </a>      n = i;
+<a name="line823">823: </a>      <font color="#4169E1">break</font>;
+<a name="line824">824: </a>    }
+<a name="line825">825: </a>  }
+<a name="line826">826: </a>  <font color="#4169E1">if</font> (N &gt;= MAXOPTIONS) {
+<a name="line827">827: </a>    <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_PLIB,<font color="#666666">"No more room in option table, limit %d recompile \n src/sys/objects/options.c with larger value for MAXOPTIONS\n"</font>,MAXOPTIONS);
+<a name="line828">828: </a>  }
+<a name="line829">829: </a>  <font color="#B22222">/* shift remaining values down 1 */</font>
+<a name="line830">830: </a>  <font color="#4169E1">for</font> (i=N; i&gt;n; i--) {
+<a name="line831">831: </a>    options-&gt;names[i]  = options-&gt;names[i-1];
+<a name="line832">832: </a>    options-&gt;values[i] = options-&gt;values[i-1];
+<a name="line833">833: </a>    options-&gt;used[i]   = options-&gt;used[i-1];
+<a name="line834">834: </a>  }
+<a name="line835">835: </a>  <font color="#B22222">/* insert new name and value */</font>
+<a name="line836">836: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(name,&amp;len);
+<a name="line837">837: </a>  options-&gt;names[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
+<a name="line838">838: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;names[n],name);
+<a name="line839">839: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value,&amp;len);
+<a name="line840">840: </a>  <font color="#4169E1">if</font> (len) {
+<a name="line841">841: </a>    options-&gt;values[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
+<a name="line842">842: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;values[n],value);
+<a name="line843">843: </a>  } <font color="#4169E1">else</font> {options-&gt;values[n] = 0;}
+<a name="line844">844: </a>  options-&gt;used[n] = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line845">845: </a>  options-&gt;N++;
+<a name="line846">846: </a>  PetscOptionsMonitor(name,value);
+<a name="line847">847: </a>  <font color="#4169E1">return</font>(0);
+<a name="line848">848: </a>}
+
+<a name="line852">852: </a><font color="#B22222">/*@C</font>
+<a name="line853">853: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsClearValue.html#PetscOptionsClearValue">PetscOptionsClearValue</A> - Clears an option name-value pair in the options </font>
+<a name="line854">854: </a><font color="#B22222">   database, overriding whatever is already present.</font>
+
+<a name="line856">856: </a><font color="#B22222">   Not Collective, but setting values on certain processors could cause problems</font>
+<a name="line857">857: </a><font color="#B22222">   for parallel objects looking for options.</font>
+
+<a name="line859">859: </a><font color="#B22222">   Input Parameter:</font>
+<a name="line860">860: </a><font color="#B22222">.  name - name of option, this SHOULD have the - prepended</font>
+
+<a name="line862">862: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line864">864: </a><font color="#B22222">   Concepts: options database^removing option</font>
+<a name="line865">865: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>()</font>
+<a name="line866">866: </a><font color="#B22222">@*/</font>
+<a name="line867">867: </a><strong><font color="#4169E1"><a name="PetscOptionsClearValue"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsClearValue.html#PetscOptionsClearValue">PetscOptionsClearValue</A>(const char iname[])</font></strong>
+<a name="line868">868: </a>{
+<a name="line870">870: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       N,n,i;
+<a name="line871">871: </a>  char           **names,*name=(char*)iname;
+<a name="line872">872: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     gt,match;
+
+<a name="line875">875: </a>  <font color="#4169E1">if</font> (name[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Name must begin with -: Instead %s"</font>,name);
+<a name="line876">876: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
+
+<a name="line878">878: </a>  name++;
+
+<a name="line880">880: </a>  N     = options-&gt;N; n = 0;
+<a name="line881">881: </a>  names = options-&gt;names;
+<a name="line882">882: </a>
+<a name="line883">883: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
+<a name="line884">884: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(names[i],name,&amp;match);
+<a name="line885">885: </a>    <A href="../../../docs/manualpages/Sys/PetscStrgrt.html#PetscStrgrt">PetscStrgrt</A>(names[i],name,&amp;gt);
+<a name="line886">886: </a>    <font color="#4169E1">if</font> (match) {
+<a name="line887">887: </a>      <font color="#4169E1">if</font> (options-&gt;names[i])  free(options-&gt;names[i]);
+<a name="line888">888: </a>      <font color="#4169E1">if</font> (options-&gt;values[i]) free(options-&gt;values[i]);
+<a name="line889">889: </a>      PetscOptionsMonitor(name,<font color="#666666">""</font>);
+<a name="line890">890: </a>      <font color="#4169E1">break</font>;
+<a name="line891">891: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (gt) {
+<a name="line892">892: </a>      <font color="#4169E1">return</font>(0); <font color="#B22222">/* it was not listed */</font>
+<a name="line893">893: </a>    }
+<a name="line894">894: </a>    n++;
 <a name="line895">895: </a>  }
-<a name="line896">896: </a>  options-&gt;N--;
-<a name="line897">897: </a>  <font color="#4169E1">return</font>(0);
-<a name="line898">898: </a>}
-
-<a name="line902">902: </a><font color="#B22222">/*@C</font>
-<a name="line903">903: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsSetAlias.html#PetscOptionsSetAlias">PetscOptionsSetAlias</A> - Makes a key and alias for another key</font>
-
-<a name="line905">905: </a><font color="#B22222">   Not Collective, but setting values on certain processors could cause problems</font>
-<a name="line906">906: </a><font color="#B22222">   for parallel objects looking for options.</font>
-
-<a name="line908">908: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line909">909: </a><font color="#B22222">+  inewname - the alias</font>
-<a name="line910">910: </a><font color="#B22222">-  ioldname - the name that alias will refer to </font>
-
-<a name="line912">912: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line914">914: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),OptionsHasName(),</font>
-<a name="line915">915: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line916">916: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line917">917: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line918">918: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line919">919: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line920">920: </a><font color="#B22222">@*/</font>
-<a name="line921">921: </a><strong><font color="#4169E1"><a name="PetscOptionsSetAlias"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsSetAlias.html#PetscOptionsSetAlias">PetscOptionsSetAlias</A>(const char inewname[],const char ioldname[])</font></strong>
-<a name="line922">922: </a>{
-<a name="line924">924: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = options-&gt;Naliases;
-<a name="line925">925: </a>  size_t         len;
-<a name="line926">926: </a>  char           *newname = (char *)inewname,*oldname = (char*)ioldname;
-
-<a name="line929">929: </a>  <font color="#4169E1">if</font> (newname[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"aliased must have -: Instead %s"</font>,newname);
-<a name="line930">930: </a>  <font color="#4169E1">if</font> (oldname[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"aliasee must have -: Instead %s"</font>,oldname);
-<a name="line931">931: </a>  <font color="#4169E1">if</font> (n &gt;= MAXALIASES) {
-<a name="line932">932: </a>    <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_MEM,<font color="#666666">"You have defined to many PETSc options aliases, limit %d recompile \n  src/sys/objects/options.c with larger value for MAXALIASES"</font>,MAXALIASES);
-<a name="line933">933: </a>  }
-
-<a name="line935">935: </a>  newname++; oldname++;
-<a name="line936">936: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(newname,&amp;len);
-<a name="line937">937: </a>  options-&gt;aliases1[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
-<a name="line938">938: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;aliases1[n],newname);
-<a name="line939">939: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(oldname,&amp;len);
-<a name="line940">940: </a>  options-&gt;aliases2[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
-<a name="line941">941: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;aliases2[n],oldname);
-<a name="line942">942: </a>  options-&gt;Naliases++;
-<a name="line943">943: </a>  <font color="#4169E1">return</font>(0);
-<a name="line944">944: </a>}
-
-<a name="line948">948: </a><strong><font color="#4169E1"><a name="PetscOptionsFindPair_Private"></a>static <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscOptionsFindPair_Private(const char pre[],const char name[],char *value[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line949">949: </a>{
-<a name="line951">951: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i,N;
-<a name="line952">952: </a>  size_t         len;
-<a name="line953">953: </a>  char           **names,tmp[256];
-<a name="line954">954: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     match;
-
-<a name="line957">957: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
-<a name="line958">958: </a>  N = options-&gt;N;
-<a name="line959">959: </a>  names = options-&gt;names;
-
-<a name="line961">961: </a>  <font color="#4169E1">if</font> (name[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Name must begin with -: Instead %s"</font>,name);
-
-<a name="line963">963: </a>  <font color="#B22222">/* append prefix to name */</font>
-<a name="line964">964: </a>  <font color="#4169E1">if</font> (pre) {
-<a name="line965">965: </a>    <font color="#4169E1">if</font> (pre[0] == '-') <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Prefix should not begin with a -"</font>);
-<a name="line966">966: </a>    <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(tmp,pre,256);
-<a name="line967">967: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(tmp,&amp;len);
-<a name="line968">968: </a>    <A href="../../../docs/manualpages/Sys/PetscStrncat.html#PetscStrncat">PetscStrncat</A>(tmp,name+1,256-len-1);
-<a name="line969">969: </a>  } <font color="#4169E1">else</font> {
-<a name="line970">970: </a>    <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(tmp,name+1,256);
-<a name="line971">971: </a>  }
-
-<a name="line973">973: </a>  <font color="#B22222">/* slow search */</font>
-<a name="line974">974: </a>  *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line975">975: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
-<a name="line976">976: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(names[i],tmp,&amp;match);
-<a name="line977">977: </a>    <font color="#4169E1">if</font> (match) {
-<a name="line978">978: </a>       *value           = options-&gt;values[i];
-<a name="line979">979: </a>       options-&gt;used[i] = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line980">980: </a>       *flg             = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line981">981: </a>       <font color="#4169E1">break</font>;
-<a name="line982">982: </a>     }
-<a name="line983">983: </a>  }
-<a name="line984">984: </a>  <font color="#4169E1">if</font> (!*flg) {
-<a name="line985">985: </a>    <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> j,cnt = 0,locs[16],loce[16];
-<a name="line986">986: </a>    size_t   n;
-<a name="line987">987: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(tmp,&amp;n);
-<a name="line988">988: </a>    <font color="#B22222">/* determine the location and number of all _%d_ in the key */</font>
-<a name="line989">989: </a>    <font color="#4169E1">for</font> (i=0; i&lt; (<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)n; i++) {
-<a name="line990">990: </a>      <font color="#4169E1">if</font> (tmp[i] == '_') {
-<a name="line991">991: </a>        <font color="#4169E1">for</font> (j=i+1; j&lt; (<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)n; j++) {
-<a name="line992">992: </a>          <font color="#4169E1">if</font> (tmp[j] &gt;= '0' &amp;&amp; tmp[j] &lt;= '9') <font color="#4169E1">continue</font>;
-<a name="line993">993: </a>          <font color="#4169E1">if</font> (tmp[j] == '_' &amp;&amp; j &gt; i+1) { <font color="#B22222">/* found a number */</font>
-<a name="line994">994: </a>            locs[cnt]   = i+1;
-<a name="line995">995: </a>            loce[cnt++] = j+1;
-<a name="line996">996: </a>          }
-<a name="line997">997: </a>          <font color="#4169E1">break</font>;
-<a name="line998">998: </a>        }
-<a name="line999">999: </a>      }
-<a name="line1000">1000: </a>    }
-<a name="line1001">1001: </a>    <font color="#4169E1">if</font> (cnt) {
-<a name="line1002">1002: </a>      char tmp2[256];
-<a name="line1003">1003: </a>      <font color="#4169E1">for</font> (i=0; i&lt;cnt; i++) {
-<a name="line1004">1004: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(tmp2,<font color="#666666">"-"</font>);
-<a name="line1005">1005: </a>        <A href="../../../docs/manualpages/Sys/PetscStrncat.html#PetscStrncat">PetscStrncat</A>(tmp2,tmp,locs[i]);
-<a name="line1006">1006: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(tmp2,tmp+loce[i]);
-<a name="line1007">1007: </a>        PetscOptionsFindPair_Private(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,tmp2,value,flg);
-<a name="line1008">1008: </a>        <font color="#4169E1">if</font> (*flg) <font color="#4169E1">break</font>;
-<a name="line1009">1009: </a>      }
-<a name="line1010">1010: </a>    }
-<a name="line1011">1011: </a>  }
-<a name="line1012">1012: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1013">1013: </a>}
-
-<a name="line1017">1017: </a><font color="#B22222">/*@C</font>
-<a name="line1018">1018: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsReject.html#PetscOptionsReject">PetscOptionsReject</A> - Generates an error if a certain option is given.</font>
-
-<a name="line1020">1020: </a><font color="#B22222">   Not Collective, but setting values on certain processors could cause problems</font>
-<a name="line1021">1021: </a><font color="#B22222">   for parallel objects looking for options.</font>
-
-<a name="line1023">1023: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1024">1024: </a><font color="#B22222">+  name - the option one is seeking </font>
-<a name="line1025">1025: </a><font color="#B22222">-  mess - error message (may be <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>)</font>
-
-<a name="line1027">1027: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line1029">1029: </a><font color="#B22222">   Concepts: options database^rejecting option</font>
-
-<a name="line1031">1031: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),OptionsHasName(),</font>
-<a name="line1032">1032: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1033">1033: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1034">1034: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1035">1035: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1036">1036: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1037">1037: </a><font color="#B22222">@*/</font>
-<a name="line1038">1038: </a><strong><font color="#4169E1"><a name="PetscOptionsReject"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsReject.html#PetscOptionsReject">PetscOptionsReject</A>(const char name[],const char mess[])</font></strong>
-<a name="line1039">1039: </a>{
-<a name="line1041">1041: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-
-<a name="line1044">1044: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,name,&amp;flag);
-<a name="line1045">1045: </a>  <font color="#4169E1">if</font> (flag) {
-<a name="line1046">1046: </a>    <font color="#4169E1">if</font> (mess) {
-<a name="line1047">1047: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Program has disabled option: %s with %s"</font>,name,mess);
-<a name="line1048">1048: </a>    } <font color="#4169E1">else</font> {
-<a name="line1049">1049: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Program has disabled option: %s"</font>,name);
-<a name="line1050">1050: </a>    }
-<a name="line1051">1051: </a>  }
-<a name="line1052">1052: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1053">1053: </a>}
-
-<a name="line1057">1057: </a><font color="#B22222">/*@C</font>
-<a name="line1058">1058: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A> - Determines whether a certain option is given in the database. This returns true whether the option is a number, string or boolean, even </font>
-<a name="line1059">1059: </a><font color="#B22222">                      its value is set to false.</font>
-
-<a name="line1061">1061: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1063">1063: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1064">1064: </a><font color="#B22222">+  name - the option one is seeking </font>
-<a name="line1065">1065: </a><font color="#B22222">-  pre - string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-
-<a name="line1067">1067: </a><font color="#B22222">   Output Parameters:</font>
-<a name="line1068">1068: </a><font color="#B22222">.  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>.</font>
-
-<a name="line1070">1070: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1072">1072: </a><font color="#B22222">   Concepts: options database^has option name</font>
-
-<a name="line1074">1074: </a><font color="#B22222">   Notes: Name cannot be simply -h</font>
-
-<a name="line1076">1076: </a><font color="#B22222">          In many cases you probably want to use <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>() instead of calling this, to allowing toggling values.</font>
-
-<a name="line1078">1078: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),</font>
-<a name="line1079">1079: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1080">1080: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1081">1081: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1082">1082: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1083">1083: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1084">1084: </a><font color="#B22222">@*/</font>
-<a name="line1085">1085: </a><strong><font color="#4169E1"><a name="PetscOptionsHasName"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1086">1086: </a>{
-<a name="line1087">1087: </a>  char           *value;
-<a name="line1089">1089: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-
-<a name="line1092">1092: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1093">1093: </a>  <font color="#4169E1">if</font> (flg) *flg = flag;
-<a name="line1094">1094: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1095">1095: </a>}
-
-<a name="line1099">1099: </a><font color="#B22222">/*@C</font>
-<a name="line1100">1100: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A> - Gets the integer value for a particular option in the database.</font>
-
-<a name="line1102">1102: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1104">1104: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1105">1105: </a><font color="#B22222">+  pre - the string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1106">1106: </a><font color="#B22222">-  name - the option one is seeking</font>
-
-<a name="line1108">1108: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1109">1109: </a><font color="#B22222">+  ivalue - the integer value to return</font>
-<a name="line1110">1110: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1112">1112: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1114">1114: </a><font color="#B22222">   Concepts: options database^has int</font>
-
-<a name="line1116">1116: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(),</font>
-<a name="line1117">1117: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>()</font>
-<a name="line1118">1118: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsString.html#PetscOptionsString">PetscOptionsString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsReal.html#PetscOptionsReal">PetscOptionsReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1119">1119: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1120">1120: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1121">1121: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1122">1122: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1123">1123: </a><font color="#B22222">@*/</font>
-<a name="line1124">1124: </a><strong><font color="#4169E1"><a name="PetscOptionsGetInt"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *ivalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1125">1125: </a>{
-<a name="line1126">1126: </a>  char           *value;
-<a name="line1128">1128: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-
-<a name="line1133">1133: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1134">1134: </a>  <font color="#4169E1">if</font> (flag) {
-<a name="line1135">1135: </a>    <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;}
-<a name="line1136">1136: </a>    <font color="#4169E1">else</font> {
-<a name="line1137">1137: </a>      <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1138">1138: </a>      PetscOptionsAtoi(value,ivalue);
-<a name="line1139">1139: </a>    }
-<a name="line1140">1140: </a>  } <font color="#4169E1">else</font> {
-<a name="line1141">1141: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1142">1142: </a>  }
-<a name="line1143">1143: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1144">1144: </a>}
-
-<a name="line1148">1148: </a><font color="#B22222">/*@C</font>
-<a name="line1149">1149: </a><font color="#B22222">     <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A> - Puts a list of option values that a single one may be selected from</font>
-
-<a name="line1151">1151: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1153">1153: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1154">1154: </a><font color="#B22222">+  pre - the string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1155">1155: </a><font color="#B22222">.  opt - option name</font>
-<a name="line1156">1156: </a><font color="#B22222">.  list - the possible choices</font>
-<a name="line1157">1157: </a><font color="#B22222">.  ntext - number of choices</font>
-
-<a name="line1159">1159: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1160">1160: </a><font color="#B22222">+  value - the index of the value to return</font>
-<a name="line1161">1161: </a><font color="#B22222">-  set - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-<a name="line1162">1162: </a><font color="#B22222">   </font>
-<a name="line1163">1163: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line1165">1165: </a><font color="#B22222">   See <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>() for when the choices are given in a <A href="../../../docs/manualpages/Sys/PetscFList.html#PetscFList">PetscFList</A>()</font>
-
-<a name="line1167">1167: </a><font color="#B22222">   Concepts: options database^list</font>
-
-<a name="line1169">1169: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),  </font>
-<a name="line1170">1170: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1171">1171: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1172">1172: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1173">1173: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1174">1174: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1175">1175: </a><font color="#B22222">@*/</font>
-<a name="line1176">1176: </a><strong><font color="#4169E1"><a name="PetscOptionsGetEList"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A>(const char pre[],const char opt[],const char *const*list,<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ntext,<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *value,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *set)</font></strong>
-<a name="line1177">1177: </a>{
-<a name="line1179">1179: </a>  size_t         alen,len = 0;
-<a name="line1180">1180: </a>  char           *svalue;
-<a name="line1181">1181: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     aset,flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1182">1182: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
-
-<a name="line1185">1185: </a>  <font color="#4169E1">for</font> ( i=0; i&lt;ntext; i++) {
-<a name="line1186">1186: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(list[i],&amp;alen);
-<a name="line1187">1187: </a>    <font color="#4169E1">if</font> (alen &gt; len) len = alen;
-<a name="line1188">1188: </a>  }
-<a name="line1189">1189: </a>  len += 5; <font color="#B22222">/* a little extra space for user mistypes */</font>
-<a name="line1190">1190: </a>  <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(len*<font color="#4169E1">sizeof</font>(char),&amp;svalue);
-<a name="line1191">1191: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(pre,opt,svalue,len,&amp;aset);
-<a name="line1192">1192: </a>  <font color="#4169E1">if</font> (aset) {
-<a name="line1193">1193: </a>    <font color="#4169E1">if</font> (set) *set = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1194">1194: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ntext; i++) {
-<a name="line1195">1195: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(svalue,list[i],&amp;flg);
-<a name="line1196">1196: </a>      <font color="#4169E1">if</font> (flg) {
-<a name="line1197">1197: </a>        *value = i;
-<a name="line1198">1198: </a>        <font color="#4169E1">break</font>;
-<a name="line1199">1199: </a>      }
-<a name="line1200">1200: </a>    }
-<a name="line1201">1201: </a>    <font color="#4169E1">if</font> (!flg) <A href="../../../docs/manualpages/Sys/SETERRQ3.html#SETERRQ3">SETERRQ3</A>(PETSC_ERR_USER,<font color="#666666">"Unknown option %s for -%s%s"</font>,svalue,pre?pre:<font color="#666666">""</font>,opt+1);
-<a name="line1202">1202: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (set) {
-<a name="line1203">1203: </a>    *set = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1204">1204: </a>  }
-<a name="line1205">1205: </a>  <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(svalue);
-<a name="line1206">1206: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1207">1207: </a>}
-
-<a name="line1211">1211: </a><font color="#B22222">/*@C</font>
-<a name="line1212">1212: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetEnum.html#PetscOptionsGetEnum">PetscOptionsGetEnum</A> - Gets the enum value for a particular option in the database.</font>
-
-<a name="line1214">1214: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1216">1216: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1217">1217: </a><font color="#B22222">+  pre - option prefix or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1218">1218: </a><font color="#B22222">.  opt - option name</font>
-<a name="line1219">1219: </a><font color="#B22222">.  list - array containing the list of choices, followed by the enum name, followed by the enum prefix, followed by a null</font>
-<a name="line1220">1220: </a><font color="#B22222">-  defaultv - the default (current) value</font>
-
-<a name="line1222">1222: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1223">1223: </a><font color="#B22222">+  value - the  value to return</font>
-<a name="line1224">1224: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1226">1226: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1228">1228: </a><font color="#B22222">   Concepts: options database</font>
-
-<a name="line1230">1230: </a><font color="#B22222">   Notes: Must be between a <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>() and a <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>()</font>
-
-<a name="line1232">1232: </a><font color="#B22222">          list is usually something like PCASMTypes or some other predefined list of enum names</font>
-
-<a name="line1234">1234: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(),</font>
-<a name="line1235">1235: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>()</font>
-<a name="line1236">1236: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsString.html#PetscOptionsString">PetscOptionsString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsReal.html#PetscOptionsReal">PetscOptionsReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1237">1237: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1238">1238: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1239">1239: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1240">1240: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnum.html#PetscOptionsEnum">PetscOptionsEnum</A>()</font>
-<a name="line1241">1241: </a><font color="#B22222">@*/</font>
-<a name="line1242">1242: </a><strong><font color="#4169E1"><a name="PetscOptionsGetEnum"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetEnum.html#PetscOptionsGetEnum">PetscOptionsGetEnum</A>(const char pre[],const char opt[],const char *const*list,<A href="../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</A> *value,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *set)</font></strong>
-<a name="line1243">1243: </a>{
-<a name="line1245">1245: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       ntext = 0,tval;
-<a name="line1246">1246: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     fset;
-
-<a name="line1249">1249: </a>  <font color="#4169E1">while</font> (list[ntext++]) {
-<a name="line1250">1250: </a>    <font color="#4169E1">if</font> (ntext &gt; 50) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"List argument appears to be wrong or have more than 50 entries"</font>);
-<a name="line1251">1251: </a>  }
-<a name="line1252">1252: </a>  <font color="#4169E1">if</font> (ntext &lt; 3) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"List argument must have at least two entries: typename and type prefix"</font>);
-<a name="line1253">1253: </a>  ntext -= 3;
-<a name="line1254">1254: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A>(pre,opt,list,ntext,&amp;tval,&amp;fset);
-<a name="line1255">1255: </a>  <font color="#B22222">/* with PETSC_USE_64BIT_INDICES sizeof(<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>) != sizeof(<A href="../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</A>) */</font>
-<a name="line1256">1256: </a>  <font color="#4169E1">if</font> (fset) *value = (<A href="../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</A>)tval;
-<a name="line1257">1257: </a>  <font color="#4169E1">if</font> (set) *set = fset;
-<a name="line1258">1258: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1259">1259: </a>}
-
-<a name="line1263">1263: </a><font color="#B22222">/*@C</font>
-<a name="line1264">1264: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A> - Gets the Logical (true or false) value for a particular </font>
-<a name="line1265">1265: </a><font color="#B22222">            option in the database.</font>
-
-<a name="line1267">1267: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1269">1269: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1270">1270: </a><font color="#B22222">+  pre - the string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1271">1271: </a><font color="#B22222">-  name - the option one is seeking</font>
-
-<a name="line1273">1273: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1274">1274: </a><font color="#B22222">+  ivalue - the logical value to return</font>
-<a name="line1275">1275: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>  if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1277">1277: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1279">1279: </a><font color="#B22222">   Notes:</font>
-<a name="line1280">1280: </a><font color="#B22222">       TRUE, true, YES, yes, nostring, and 1 all translate to <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A></font>
-<a name="line1281">1281: </a><font color="#B22222">       FALSE, false, NO, no, and 0 all translate to <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1283">1283: </a><font color="#B22222">       If the user does not supply the option (as either true or false) ivalue is NOT changed. Thus</font>
-<a name="line1284">1284: </a><font color="#B22222">     you NEED TO ALWAYS initialize the ivalue.</font>
-
-<a name="line1286">1286: </a><font color="#B22222">   Concepts: options database^has logical</font>
-
-<a name="line1288">1288: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(),</font>
-<a name="line1289">1289: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1290">1290: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1291">1291: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1292">1292: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1293">1293: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1294">1294: </a><font color="#B22222">@*/</font>
-<a name="line1295">1295: </a><strong><font color="#4169E1"><a name="PetscOptionsGetTruth"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *ivalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1296">1296: </a>{
-<a name="line1297">1297: </a>  char           *value;
-<a name="line1298">1298: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-
-<a name="line1304">1304: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1305">1305: </a>  <font color="#4169E1">if</font> (flag) {
-<a name="line1306">1306: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1307">1307: </a>    <font color="#4169E1">if</font> (!value) {
-<a name="line1308">1308: </a>      *ivalue = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1309">1309: </a>    } <font color="#4169E1">else</font> {
-<a name="line1310">1310: </a>      PetscOptionsAtol(value, ivalue);
-<a name="line1311">1311: </a>    }
-<a name="line1312">1312: </a>  } <font color="#4169E1">else</font> {
-<a name="line1313">1313: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1314">1314: </a>  }
-<a name="line1315">1315: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1316">1316: </a>}
-
-<a name="line1320">1320: </a><font color="#B22222">/*@C</font>
-<a name="line1321">1321: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruthArray.html#PetscOptionsGetTruthArray">PetscOptionsGetTruthArray</A> - Gets an array of Logical (true or false) values for a particular </font>
-<a name="line1322">1322: </a><font color="#B22222">   option in the database.  The values must be separated with commas with </font>
-<a name="line1323">1323: </a><font color="#B22222">   no intervening spaces. </font>
-
-<a name="line1325">1325: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1327">1327: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1328">1328: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1329">1329: </a><font color="#B22222">.  name - the option one is seeking</font>
-<a name="line1330">1330: </a><font color="#B22222">-  nmax - maximum number of values to retrieve</font>
-
-<a name="line1332">1332: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1333">1333: </a><font color="#B22222">+  dvalue - the integer values to return</font>
-<a name="line1334">1334: </a><font color="#B22222">.  nmax - actual number of values retreived</font>
-<a name="line1335">1335: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1337">1337: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1339">1339: </a><font color="#B22222">   Concepts: options database^array of ints</font>
-
-<a name="line1341">1341: </a><font color="#B22222">   Notes:</font>
-<a name="line1342">1342: </a><font color="#B22222">       TRUE, true, YES, yes, nostring, and 1 all translate to <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A></font>
-<a name="line1343">1343: </a><font color="#B22222">       FALSE, false, NO, no, and 0 all translate to <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1345">1345: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
-<a name="line1346">1346: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1347">1347: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1348">1348: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1349">1349: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1350">1350: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1351">1351: </a><font color="#B22222">@*/</font>
-<a name="line1352">1352: </a><strong><font color="#4169E1"><a name="PetscOptionsGetTruthArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruthArray.html#PetscOptionsGetTruthArray">PetscOptionsGetTruthArray</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> dvalue[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1353">1353: </a>{
-<a name="line1354">1354: </a>  char           *value;
-<a name="line1356">1356: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = 0;
-<a name="line1357">1357: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-<a name="line1358">1358: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
-
-<a name="line1363">1363: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1364">1364: </a>  <font color="#4169E1">if</font> (!flag)  {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
-<a name="line1365">1365: </a>  <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
-
-<a name="line1367">1367: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-
-<a name="line1369">1369: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
-<a name="line1370">1370: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1371">1371: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
-<a name="line1372">1372: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
-<a name="line1373">1373: </a>    PetscOptionsAtol(value,dvalue);
-<a name="line1374">1374: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1375">1375: </a>    dvalue++;
-<a name="line1376">1376: </a>    n++;
-<a name="line1377">1377: </a>  }
-<a name="line1378">1378: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line1379">1379: </a>  *nmax = n;
-<a name="line1380">1380: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1381">1381: </a>}
-
-<a name="line1385">1385: </a><font color="#B22222">/*@C</font>
-<a name="line1386">1386: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A> - Gets the double precision value for a particular </font>
-<a name="line1387">1387: </a><font color="#B22222">   option in the database.</font>
-
-<a name="line1389">1389: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1391">1391: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1392">1392: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1393">1393: </a><font color="#B22222">-  name - the option one is seeking</font>
-
-<a name="line1395">1395: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1396">1396: </a><font color="#B22222">+  dvalue - the double value to return</font>
-<a name="line1397">1397: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A> if not found</font>
-
-<a name="line1399">1399: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1401">1401: </a><font color="#B22222">   Concepts: options database^has double</font>
-
-<a name="line1403">1403: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
-<a name="line1404">1404: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1405">1405: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1406">1406: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1407">1407: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1408">1408: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1409">1409: </a><font color="#B22222">@*/</font>
-<a name="line1410">1410: </a><strong><font color="#4169E1"><a name="PetscOptionsGetReal"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *dvalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1411">1411: </a>{
-<a name="line1412">1412: </a>  char           *value;
-<a name="line1414">1414: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-
-<a name="line1419">1419: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1420">1420: </a>  <font color="#4169E1">if</font> (flag) {
-<a name="line1421">1421: </a>    <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;}
-<a name="line1422">1422: </a>    <font color="#4169E1">else</font>        {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; PetscOptionsAtod(value,dvalue);}
-<a name="line1423">1423: </a>  } <font color="#4169E1">else</font> {
-<a name="line1424">1424: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1425">1425: </a>  }
-<a name="line1426">1426: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1427">1427: </a>}
-
-<a name="line1431">1431: </a><font color="#B22222">/*@C</font>
-<a name="line1432">1432: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetScalar.html#PetscOptionsGetScalar">PetscOptionsGetScalar</A> - Gets the scalar value for a particular </font>
-<a name="line1433">1433: </a><font color="#B22222">   option in the database.</font>
-
-<a name="line1435">1435: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1437">1437: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1438">1438: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1439">1439: </a><font color="#B22222">-  name - the option one is seeking</font>
-
-<a name="line1441">1441: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1442">1442: </a><font color="#B22222">+  dvalue - the double value to return</font>
-<a name="line1443">1443: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1445">1445: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1447">1447: </a><font color="#B22222">   Usage:</font>
-<a name="line1448">1448: </a><font color="#B22222">   A complex number 2+3i can be specified as 2,3 at the command line.</font>
-<a name="line1449">1449: </a><font color="#B22222">   or a number 2.0e-10 - 3.3e-20 i  can be specified as 2.0e-10,3.3e-20</font>
-
-<a name="line1451">1451: </a><font color="#B22222">   Concepts: options database^has scalar</font>
-
-<a name="line1453">1453: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
-<a name="line1454">1454: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1455">1455: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1456">1456: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1457">1457: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1458">1458: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1459">1459: </a><font color="#B22222">@*/</font>
-<a name="line1460">1460: </a><strong><font color="#4169E1"><a name="PetscOptionsGetScalar"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetScalar.html#PetscOptionsGetScalar">PetscOptionsGetScalar</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *dvalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1461">1461: </a>{
-<a name="line1462">1462: </a>  char           *value;
-<a name="line1463">1463: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-
-<a name="line1469">1469: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1470">1470: </a>  <font color="#4169E1">if</font> (flag) {
-<a name="line1471">1471: </a>    <font color="#4169E1">if</font> (!value) {
-<a name="line1472">1472: </a>      <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1473">1473: </a>    } <font color="#4169E1">else</font> {
-<a name="line1474">1474: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1475">1475: </a>      PetscOptionsAtod(value,dvalue);
-<a name="line1476">1476: </a><font color="#A020F0">#else</font>
-<a name="line1477">1477: </a>      <A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>  re=0.0,im=0.0;
-<a name="line1478">1478: </a>      <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A> token;
-<a name="line1479">1479: </a>      char       *tvalue = 0;
-
-<a name="line1481">1481: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
-<a name="line1482">1482: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;tvalue);
-<a name="line1483">1483: </a>      <font color="#4169E1">if</font> (!tvalue) { <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"unknown string specified\n"</font>); }
-<a name="line1484">1484: </a>      PetscOptionsAtod(tvalue,&amp;re);
-<a name="line1485">1485: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;tvalue);
-<a name="line1486">1486: </a>      <font color="#4169E1">if</font> (!tvalue) { <font color="#B22222">/* Unknown separator used. using only real value */</font>
-<a name="line1487">1487: </a>        *dvalue = re;
-<a name="line1488">1488: </a>      } <font color="#4169E1">else</font> {
-<a name="line1489">1489: </a>        PetscOptionsAtod(tvalue,&amp;im);
-<a name="line1490">1490: </a>        *dvalue = re + PETSC_i*im;
-<a name="line1491">1491: </a>      }
-<a name="line1492">1492: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line1493">1493: </a><font color="#A020F0">#endif</font>
-<a name="line1494">1494: </a>      <font color="#4169E1">if</font> (flg) *flg    = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1495">1495: </a>    }
-<a name="line1496">1496: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* flag */</font>
-<a name="line1497">1497: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1498">1498: </a>  }
-<a name="line1499">1499: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1500">1500: </a>}
-
-<a name="line1504">1504: </a><font color="#B22222">/*@C</font>
-<a name="line1505">1505: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A> - Gets an array of double precision values for a </font>
-<a name="line1506">1506: </a><font color="#B22222">   particular option in the database.  The values must be separated with </font>
-<a name="line1507">1507: </a><font color="#B22222">   commas with no intervening spaces.</font>
-
-<a name="line1509">1509: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1511">1511: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1512">1512: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1513">1513: </a><font color="#B22222">.  name - the option one is seeking</font>
-<a name="line1514">1514: </a><font color="#B22222">-  nmax - maximum number of values to retrieve</font>
-
-<a name="line1516">1516: </a><font color="#B22222">   Output Parameters:</font>
-<a name="line1517">1517: </a><font color="#B22222">+  dvalue - the double value to return</font>
-<a name="line1518">1518: </a><font color="#B22222">.  nmax - actual number of values retreived</font>
-<a name="line1519">1519: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1521">1521: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1523">1523: </a><font color="#B22222">   Concepts: options database^array of doubles</font>
-
-<a name="line1525">1525: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
-<a name="line1526">1526: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1527">1527: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1528">1528: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1529">1529: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1530">1530: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1531">1531: </a><font color="#B22222">@*/</font>
-<a name="line1532">1532: </a><strong><font color="#4169E1"><a name="PetscOptionsGetRealArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> dvalue[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1533">1533: </a>{
-<a name="line1534">1534: </a>  char           *value;
-<a name="line1536">1536: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = 0;
-<a name="line1537">1537: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-<a name="line1538">1538: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
-
-<a name="line1543">1543: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1544">1544: </a>  <font color="#4169E1">if</font> (!flag)  {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
-<a name="line1545">1545: </a>  <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
-
-<a name="line1547">1547: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-
-<a name="line1549">1549: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
-<a name="line1550">1550: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1551">1551: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
-<a name="line1552">1552: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
-<a name="line1553">1553: </a>    PetscOptionsAtod(value,dvalue++);
-<a name="line1554">1554: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1555">1555: </a>    n++;
-<a name="line1556">1556: </a>  }
-<a name="line1557">1557: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line1558">1558: </a>  *nmax = n;
-<a name="line1559">1559: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1560">1560: </a>}
-
-<a name="line1564">1564: </a><font color="#B22222">/*@C</font>
-<a name="line1565">1565: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A> - Gets an array of integer values for a particular </font>
-<a name="line1566">1566: </a><font color="#B22222">   option in the database.  The values must be separated with commas with </font>
-<a name="line1567">1567: </a><font color="#B22222">   no intervening spaces. </font>
-
-<a name="line1569">1569: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1571">1571: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1572">1572: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1573">1573: </a><font color="#B22222">.  name - the option one is seeking</font>
-<a name="line1574">1574: </a><font color="#B22222">-  nmax - maximum number of values to retrieve, can include d-D to indicate d,d+1,..,D-1</font>
-
-<a name="line1576">1576: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1577">1577: </a><font color="#B22222">+  dvalue - the integer values to return</font>
-<a name="line1578">1578: </a><font color="#B22222">.  nmax - actual number of values retreived</font>
-<a name="line1579">1579: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1581">1581: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1583">1583: </a><font color="#B22222">   Concepts: options database^array of ints</font>
-
-<a name="line1585">1585: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
-<a name="line1586">1586: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1587">1587: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1588">1588: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1589">1589: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1590">1590: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1591">1591: </a><font color="#B22222">@*/</font>
-<a name="line1592">1592: </a><strong><font color="#4169E1"><a name="PetscOptionsGetIntArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> dvalue[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1593">1593: </a>{
-<a name="line1594">1594: </a>  char           *value;
-<a name="line1596">1596: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = 0,i,start,end;
-<a name="line1597">1597: </a>  size_t         len;
-<a name="line1598">1598: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag,foundrange;
-<a name="line1599">1599: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
-
-<a name="line1604">1604: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1605">1605: </a>  <font color="#4169E1">if</font> (!flag)  {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
-<a name="line1606">1606: </a>  <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
-
-<a name="line1608">1608: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-
-<a name="line1610">1610: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
-<a name="line1611">1611: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1612">1612: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
-<a name="line1613">1613: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
-<a name="line1614">1614: </a>
-<a name="line1615">1615: </a>    <font color="#B22222">/* look for form  d-D where d and D are integers */</font>
-<a name="line1616">1616: </a>    foundrange = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1617">1617: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value,&amp;len);
-<a name="line1618">1618: </a>    <font color="#4169E1">if</font> (value[0] == '-') i=2;
-<a name="line1619">1619: </a>    <font color="#4169E1">else</font> i=1;
-<a name="line1620">1620: </a>    <font color="#4169E1">for</font> (;i&lt;(int)len; i++) {
-<a name="line1621">1621: </a>      <font color="#4169E1">if</font> (value[i] == '-') {
-<a name="line1622">1622: </a>        <font color="#4169E1">if</font> (i == (int)len-1) <A href="../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_USER,<font color="#666666">"Error in %D-th array entry %s\n"</font>,n,value);
-<a name="line1623">1623: </a>        value[i] = 0;
-<a name="line1624">1624: </a>        PetscOptionsAtoi(value,&amp;start);
-<a name="line1625">1625: </a>        PetscOptionsAtoi(value+i+1,&amp;end);
-<a name="line1626">1626: </a>        <font color="#4169E1">if</font> (end &lt;= start) <A href="../../../docs/manualpages/Sys/SETERRQ3.html#SETERRQ3">SETERRQ3</A>(PETSC_ERR_USER,<font color="#666666">"Error in %D-th array entry, %s-%s cannot have decreasing list"</font>,n,value,value+i+1);
-<a name="line1627">1627: </a>        <font color="#4169E1">if</font> (n + end - start - 1 &gt;= *nmax) SETERRQ4(PETSC_ERR_USER,<font color="#666666">"Error in %D-th array entry, not enough space in left in array (%D) to contain entire range from %D to %D"</font>,n,*nmax-n,start,end);
-<a name="line1628">1628: </a>        <font color="#4169E1">for</font> (;start&lt;end; start++) {
-<a name="line1629">1629: </a>          *dvalue = start; dvalue++;n++;
-<a name="line1630">1630: </a>        }
-<a name="line1631">1631: </a>        foundrange = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1632">1632: </a>        <font color="#4169E1">break</font>;
-<a name="line1633">1633: </a>      }
-<a name="line1634">1634: </a>    }
-<a name="line1635">1635: </a>    <font color="#4169E1">if</font> (!foundrange) {
-<a name="line1636">1636: </a>      PetscOptionsAtoi(value,dvalue);
-<a name="line1637">1637: </a>      dvalue++;
-<a name="line1638">1638: </a>      n++;
-<a name="line1639">1639: </a>    }
-<a name="line1640">1640: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1641">1641: </a>  }
-<a name="line1642">1642: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line1643">1643: </a>  *nmax = n;
-<a name="line1644">1644: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1645">1645: </a>}
-
-<a name="line1649">1649: </a><font color="#B22222">/*@C</font>
-<a name="line1650">1650: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A> - Gets the string value for a particular option in</font>
-<a name="line1651">1651: </a><font color="#B22222">   the database.</font>
-
-<a name="line1653">1653: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1655">1655: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1656">1656: </a><font color="#B22222">+  pre - string to prepend to name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1657">1657: </a><font color="#B22222">.  name - the option one is seeking</font>
-<a name="line1658">1658: </a><font color="#B22222">-  len - maximum string length</font>
-
-<a name="line1660">1660: </a><font color="#B22222">   Output Parameters:</font>
-<a name="line1661">1661: </a><font color="#B22222">+  string - location to copy string</font>
-<a name="line1662">1662: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1664">1664: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1666">1666: </a><font color="#B22222">   Fortran Note:</font>
-<a name="line1667">1667: </a><font color="#B22222">   The Fortran interface is slightly different from the C/C++</font>
-<a name="line1668">1668: </a><font color="#B22222">   interface (len is not used).  Sample usage in Fortran follows</font>
-<a name="line1669">1669: </a><font color="#B22222">.vb</font>
-<a name="line1670">1670: </a><font color="#B22222">      character *20 string</font>
-<a name="line1671">1671: </a><font color="#B22222">      integer   flg, ierr</font>
-<a name="line1672">1672: </a><font color="#B22222">      call <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(PETSC_NULL_CHARACTER,'-s',string,flg,ierr)</font>
-<a name="line1673">1673: </a><font color="#B22222">.ve</font>
-
-<a name="line1675">1675: </a><font color="#B22222">   Concepts: options database^string</font>
-
-<a name="line1677">1677: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),  </font>
-<a name="line1678">1678: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1679">1679: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1680">1680: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1681">1681: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1682">1682: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1683">1683: </a><font color="#B22222">@*/</font>
-<a name="line1684">1684: </a><strong><font color="#4169E1"><a name="PetscOptionsGetString"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(const char pre[],const char name[],char string[],size_t len,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1685">1685: </a>{
-<a name="line1686">1686: </a>  char           *value;
-<a name="line1688">1688: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-
-<a name="line1693">1693: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1694">1694: </a>  <font color="#4169E1">if</font> (!flag) {
-<a name="line1695">1695: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1696">1696: </a>  } <font color="#4169E1">else</font> {
-<a name="line1697">1697: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1698">1698: </a>    <font color="#4169E1">if</font> (value) {
-<a name="line1699">1699: </a>      <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(string,value,len);
-<a name="line1700">1700: </a>    } <font color="#4169E1">else</font> {
-<a name="line1701">1701: </a>      <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(string,len);
-<a name="line1702">1702: </a>    }
-<a name="line1703">1703: </a>  }
-<a name="line1704">1704: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1705">1705: </a>}
-
-<a name="line1709">1709: </a><font color="#B22222">/*@C</font>
-<a name="line1710">1710: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetStringArray.html#PetscOptionsGetStringArray">PetscOptionsGetStringArray</A> - Gets an array of string values for a particular</font>
-<a name="line1711">1711: </a><font color="#B22222">   option in the database. The values must be separated with commas with </font>
-<a name="line1712">1712: </a><font color="#B22222">   no intervening spaces. </font>
-
-<a name="line1714">1714: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1716">1716: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1717">1717: </a><font color="#B22222">+  pre - string to prepend to name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
-<a name="line1718">1718: </a><font color="#B22222">.  name - the option one is seeking</font>
-<a name="line1719">1719: </a><font color="#B22222">-  nmax - maximum number of strings</font>
-
-<a name="line1721">1721: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1722">1722: </a><font color="#B22222">+  strings - location to copy strings</font>
-<a name="line1723">1723: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
-
-<a name="line1725">1725: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1727">1727: </a><font color="#B22222">   Notes: </font>
-<a name="line1728">1728: </a><font color="#B22222">   The user should pass in an array of pointers to char, to hold all the</font>
-<a name="line1729">1729: </a><font color="#B22222">   strings returned by this function.</font>
-
-<a name="line1731">1731: </a><font color="#B22222">   The user is responsible for deallocating the strings that are</font>
-<a name="line1732">1732: </a><font color="#B22222">   returned. The Fortran interface for this routine is not supported.</font>
-
-<a name="line1734">1734: </a><font color="#B22222">   Contributed by Matthew Knepley.</font>
-
-<a name="line1736">1736: </a><font color="#B22222">   Concepts: options database^array of strings</font>
-
-<a name="line1738">1738: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),  </font>
-<a name="line1739">1739: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
-<a name="line1740">1740: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
-<a name="line1741">1741: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
-<a name="line1742">1742: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
-<a name="line1743">1743: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
-<a name="line1744">1744: </a><font color="#B22222">@*/</font>
-<a name="line1745">1745: </a><strong><font color="#4169E1"><a name="PetscOptionsGetStringArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetStringArray.html#PetscOptionsGetStringArray">PetscOptionsGetStringArray</A>(const char pre[],const char name[],char *strings[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
-<a name="line1746">1746: </a>{
-<a name="line1747">1747: </a>  char           *value;
-<a name="line1749">1749: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n;
-<a name="line1750">1750: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
-<a name="line1751">1751: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
-<a name="line1752">1752: </a>
-<a name="line1756">1756: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
-<a name="line1757">1757: </a>  <font color="#4169E1">if</font> (!flag)  {*nmax = 0; <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
-<a name="line1758">1758: </a>  <font color="#4169E1">if</font> (!value) {*nmax = 0; <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;<font color="#4169E1">return</font>(0);}
-<a name="line1759">1759: </a>  <font color="#4169E1">if</font> (!*nmax) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;<font color="#4169E1">return</font>(0);}
-<a name="line1760">1760: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-
-<a name="line1762">1762: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
-<a name="line1763">1763: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1764">1764: </a>  n = 0;
-<a name="line1765">1765: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
-<a name="line1766">1766: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
-<a name="line1767">1767: </a>    <A href="../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</A>(value,&amp;strings[n]);
-<a name="line1768">1768: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
-<a name="line1769">1769: </a>    n++;
-<a name="line1770">1770: </a>  }
-<a name="line1771">1771: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
-<a name="line1772">1772: </a>  *nmax = n;
-<a name="line1773">1773: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1774">1774: </a>}
-
-<a name="line1778">1778: </a><font color="#B22222">/*@C</font>
-<a name="line1779">1779: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A> - Returns a count of the number of options in the </font>
-<a name="line1780">1780: </a><font color="#B22222">   database that have never been selected.</font>
-
-<a name="line1782">1782: </a><font color="#B22222">   Not Collective</font>
-
-<a name="line1784">1784: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1785">1785: </a><font color="#B22222">.   N - count of options not used</font>
-
-<a name="line1787">1787: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line1789">1789: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>()</font>
-<a name="line1790">1790: </a><font color="#B22222">@*/</font>
-<a name="line1791">1791: </a><strong><font color="#4169E1"><a name="PetscOptionsAllUsed"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>(int *N)</font></strong>
-<a name="line1792">1792: </a>{
-<a name="line1793">1793: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,n = 0;
-
-<a name="line1796">1796: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
-<a name="line1797">1797: </a>    <font color="#4169E1">if</font> (!options-&gt;used[i]) { n++; }
-<a name="line1798">1798: </a>  }
-<a name="line1799">1799: </a>  *N = n;
-<a name="line1800">1800: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1801">1801: </a>}
-
-<a name="line1805">1805: </a><font color="#B22222">/*@</font>
-<a name="line1806">1806: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A> - Prints to screen any options that were set and never used.</font>
-
-<a name="line1808">1808: </a><font color="#B22222">  Not collective</font>
-
-<a name="line1810">1810: </a><font color="#B22222">   Options Database Key:</font>
-<a name="line1811">1811: </a><font color="#B22222">.  -options_left - Activates OptionsAllUsed() within <A href="../../../docs/manualpages/Sys/PetscFinalize.html#PetscFinalize">PetscFinalize</A>()</font>
-
-<a name="line1813">1813: </a><font color="#B22222">  Level: advanced</font>
-
-<a name="line1815">1815: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>()</font>
-<a name="line1816">1816: </a><font color="#B22222">@*/</font>
-<a name="line1817">1817: </a><strong><font color="#4169E1"><a name="PetscOptionsLeft"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A>(void)</font></strong>
-<a name="line1818">1818: </a>{
-<a name="line1820">1820: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
-
-<a name="line1823">1823: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
-<a name="line1824">1824: </a>    <font color="#4169E1">if</font> (!options-&gt;used[i]) {
-<a name="line1825">1825: </a>      <font color="#4169E1">if</font> (options-&gt;values[i]) {
-<a name="line1826">1826: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"Option left: name:-%s value: %s\n"</font>,options-&gt;names[i],options-&gt;values[i]);
-<a name="line1827">1827: </a>      } <font color="#4169E1">else</font> {
-<a name="line1828">1828: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"Option left: name:-%s no value \n"</font>,options-&gt;names[i]);
-<a name="line1829">1829: </a>      }
-<a name="line1830">1830: </a>    }
-<a name="line1831">1831: </a>  }
-<a name="line1832">1832: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1833">1833: </a>}
-
-
-<a name="line1838">1838: </a><font color="#B22222">/*</font>
-<a name="line1839">1839: </a><font color="#B22222">    PetscOptionsCreate - Creates the empty options database.</font>
-
-<a name="line1841">1841: </a><font color="#B22222">*/</font>
-<a name="line1842">1842: </a><strong><font color="#4169E1"><a name="PetscOptionsCreate"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsCreate(void)</font></strong>
-<a name="line1843">1843: </a>{
-
-<a name="line1847">1847: </a>  options = (PetscOptionsTable*)malloc(<font color="#4169E1">sizeof</font>(PetscOptionsTable));
-<a name="line1848">1848: </a>  <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(options-&gt;used,MAXOPTIONS*<font color="#4169E1">sizeof</font>(<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>));
-<a name="line1849">1849: </a>  options-&gt;namegiven                 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1850">1850: </a>  options-&gt;N                         = 0;
-<a name="line1851">1851: </a>  options-&gt;Naliases                  = 0;
-<a name="line1852">1852: </a>  options-&gt;numbermonitors         = 0;
-
-<a name="line1854">1854: </a>  PetscOptionsObject.prefix = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line1855">1855: </a>  PetscOptionsObject.title  = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line1856">1856: </a>
-<a name="line1857">1857: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1858">1858: </a>}
-
-<a name="line1862">1862: </a><font color="#B22222">/*@</font>
-<a name="line1863">1863: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsSetFromOptions.html#PetscOptionsSetFromOptions">PetscOptionsSetFromOptions</A> - Sets various <A href="../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> and <A href="../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A> parameters from user options.</font>
-
-<a name="line1865">1865: </a><font color="#B22222">   Collective on <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A></font>
-
-<a name="line1867">1867: </a><font color="#B22222">   Options Database Keys:</font>
-<a name="line1868">1868: </a><font color="#B22222">+  -options_monitor &lt;optional filename&gt; - prints the names and values of all runtime options as they are set. The monitor functionality is not </font>
-<a name="line1869">1869: </a><font color="#B22222">                available for options set through a file, environment variable, or on </font>
-<a name="line1870">1870: </a><font color="#B22222">                the command line. Only options set after <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A> completes will </font>
-<a name="line1871">1871: </a><font color="#B22222">                be monitored.</font>
-<a name="line1872">1872: </a><font color="#B22222">.  -options_monitor_cancel - cancel all options database monitors    </font>
-
-<a name="line1874">1874: </a><font color="#B22222">   Notes:</font>
-<a name="line1875">1875: </a><font color="#B22222">   To see all options, run your program with the -help option or consult</font>
-<a name="line1876">1876: </a><font color="#B22222">   the users manual. </font>
-
-<a name="line1878">1878: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line1880">1880: </a><font color="#B22222">.keywords: set, options, database</font>
-<a name="line1881">1881: </a><font color="#B22222">@*/</font>
-<a name="line1882">1882: </a><strong><font color="#4169E1"><a name="PetscOptionsSetFromOptions"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsSetFromOptions.html#PetscOptionsSetFromOptions">PetscOptionsSetFromOptions</A>(void)</font></strong>
-<a name="line1883">1883: </a>{
-<a name="line1884">1884: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>          flgc,flgm;
-<a name="line1885">1885: </a>  <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>      ierr;
-<a name="line1886">1886: </a>  char                monfilename[PETSC_MAX_PATH_LEN];
-<a name="line1887">1887: </a>  <A href="../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>         monviewer;
-
-<a name="line1890">1890: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">""</font>,<font color="#666666">"Options database options"</font>,<font color="#666666">"PetscOptions"</font>);
-<a name="line1891">1891: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsString.html#PetscOptionsString">PetscOptionsString</A>(<font color="#666666">"-options_monitor"</font>,<font color="#666666">"Monitor options database"</font>,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>"</font>,<font color="#666666">"stdout"</font>,monfilename,PETSC_MAX_PATH_LEN,&amp;flgm);
-<a name="line1892">1892: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(<font color="#666666">"-options_monitor_cancel"</font>,<font color="#666666">"Cancel all options database monitors"</font>,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>"</font>,&amp;flgc);
-<a name="line1893">1893: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>();
-<a name="line1894">1894: </a>  <font color="#4169E1">if</font> (flgm) {
-<a name="line1895">1895: </a>    <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,monfilename,&amp;monviewer);
-<a name="line1896">1896: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(<A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>,monviewer,(<A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*)(void*))<A href="../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>);
-<a name="line1897">1897: </a>  }
-<a name="line1898">1898: </a>  <font color="#4169E1">if</font> (flgc) { <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>(); }
-<a name="line1899">1899: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1900">1900: </a>}
-
-
-<a name="line1905">1905: </a><font color="#B22222">/*@C</font>
-<a name="line1906">1906: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A> - Print all options set value events.</font>
-
-<a name="line1908">1908: </a><font color="#B22222">   Collective on <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A></font>
-
-<a name="line1910">1910: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1911">1911: </a><font color="#B22222">+  name  - option name string</font>
-<a name="line1912">1912: </a><font color="#B22222">.  value - option value string</font>
-<a name="line1913">1913: </a><font color="#B22222">-  dummy - unused monitor context </font>
-
-<a name="line1915">1915: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line1917">1917: </a><font color="#B22222">.keywords: PetscOptions, default, monitor</font>
-
-<a name="line1919">1919: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>()</font>
-<a name="line1920">1920: </a><font color="#B22222">@*/</font>
-<a name="line1921">1921: </a><strong><font color="#4169E1"><a name="PetscOptionsMonitorDefault"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>(const char name[], const char value[], void *dummy)</font></strong>
-<a name="line1922">1922: </a>{
-<a name="line1924">1924: </a>  <A href="../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>    viewer = (<A href="../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>) dummy;
-
-<a name="line1927">1927: </a>  <font color="#4169E1">if</font> (!viewer) {
-<a name="line1928">1928: </a>    <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIGetStdout.html#PetscViewerASCIIGetStdout">PetscViewerASCIIGetStdout</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,&amp;viewer);
-<a name="line1929">1929: </a>  }
-<a name="line1930">1930: </a>  <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"Setting option: %s = %s\n"</font>,name,value);
-<a name="line1931">1931: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1932">1932: </a>}
-
-<a name="line1936">1936: </a><font color="#B22222">/*@C</font>
-<a name="line1937">1937: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A> - Sets an ADDITIONAL function to be called at every method that</font>
-<a name="line1938">1938: </a><font color="#B22222">   modified the PETSc options database.</font>
-<a name="line1939">1939: </a><font color="#B22222">      </font>
-<a name="line1940">1940: </a><font color="#B22222">   Not collective</font>
-
-<a name="line1942">1942: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1943">1943: </a><font color="#B22222">+  monitor - pointer to function (if this is <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>, it turns off monitoring</font>
-<a name="line1944">1944: </a><font color="#B22222">.  mctx    - [optional] context for private data for the</font>
-<a name="line1945">1945: </a><font color="#B22222">             monitor routine (use <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A> if no context is desired)</font>
-<a name="line1946">1946: </a><font color="#B22222">-  monitordestroy - [optional] routine that frees monitor context</font>
-<a name="line1947">1947: </a><font color="#B22222">          (may be <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>)</font>
-
-<a name="line1949">1949: </a><font color="#B22222">   Calling Sequence of monitor:</font>
-<a name="line1950">1950: </a><font color="#B22222">$     monitor (const char name[], const char value[], void *mctx)</font>
-
-<a name="line1952">1952: </a><font color="#B22222">+  name - option name string</font>
-<a name="line1953">1953: </a><font color="#B22222">.  value - option value string</font>
-<a name="line1954">1954: </a><font color="#B22222">-  mctx  - optional monitoring context, as set by <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>()</font>
-
-<a name="line1956">1956: </a><font color="#B22222">   Options Database Keys:</font>
-<a name="line1957">1957: </a><font color="#B22222">+    -options_monitor    - sets <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>()</font>
-<a name="line1958">1958: </a><font color="#B22222">-    -options_monitor_cancel - cancels all monitors that have</font>
-<a name="line1959">1959: </a><font color="#B22222">                          been hardwired into a code by </font>
-<a name="line1960">1960: </a><font color="#B22222">                          calls to <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(), but</font>
-<a name="line1961">1961: </a><font color="#B22222">                          does not cancel those set via</font>
-<a name="line1962">1962: </a><font color="#B22222">                          the options database.</font>
-
-<a name="line1964">1964: </a><font color="#B22222">   Notes:  </font>
-<a name="line1965">1965: </a><font color="#B22222">   The default is to do nothing.  To print the name and value of options </font>
-<a name="line1966">1966: </a><font color="#B22222">   being inserted into the database, use <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>() as the monitoring routine, </font>
-<a name="line1967">1967: </a><font color="#B22222">   with a null monitoring context. </font>
-
-<a name="line1969">1969: </a><font color="#B22222">   Several different monitoring routines may be set by calling</font>
-<a name="line1970">1970: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>() multiple times; all will be called in the </font>
-<a name="line1971">1971: </a><font color="#B22222">   order in which they were set.</font>
-
-<a name="line1973">1973: </a><font color="#B22222">   Level: beginner</font>
-
-<a name="line1975">1975: </a><font color="#B22222">.keywords: PetscOptions, set, monitor</font>
-
-<a name="line1977">1977: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>()</font>
-<a name="line1978">1978: </a><font color="#B22222">@*/</font>
-<a name="line1979">1979: </a><strong><font color="#4169E1"><a name="PetscOptionsMonitorSet"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(<A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitor)(const char name[], const char value[], void*),void *mctx,<A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitordestroy)(void*))</font></strong>
-<a name="line1980">1980: </a>{
-<a name="line1982">1982: </a>  <font color="#4169E1">if</font> (options-&gt;numbermonitors &gt;= MAXOPTIONSMONITORS) {
-<a name="line1983">1983: </a>    <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Too many PetscOptions monitors set"</font>);
-<a name="line1984">1984: </a>  }
-<a name="line1985">1985: </a>  options-&gt;monitor[options-&gt;numbermonitors]           = monitor;
-<a name="line1986">1986: </a>  options-&gt;monitordestroy[options-&gt;numbermonitors]    = monitordestroy;
-<a name="line1987">1987: </a>  options-&gt;monitorcontext[options-&gt;numbermonitors++]  = (void*)mctx;
-<a name="line1988">1988: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1989">1989: </a>}
-
-<a name="line1993">1993: </a><font color="#B22222">/*@</font>
-<a name="line1994">1994: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A> - Clears all monitors for a PetscOptions object.</font>
-
-<a name="line1996">1996: </a><font color="#B22222">   Not collective </font>
-
-<a name="line1998">1998: </a><font color="#B22222">   Options Database Key:</font>
-<a name="line1999">1999: </a><font color="#B22222">.  -options_monitor_cancel - Cancels all monitors that have</font>
-<a name="line2000">2000: </a><font color="#B22222">    been hardwired into a code by calls to <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(), </font>
-<a name="line2001">2001: </a><font color="#B22222">    but does not cancel those set via the options database.</font>
-
-<a name="line2003">2003: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line2005">2005: </a><font color="#B22222">.keywords: PetscOptions, set, monitor</font>
-
-<a name="line2007">2007: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>()</font>
-<a name="line2008">2008: </a><font color="#B22222">@*/</font>
-<a name="line2009">2009: </a><strong><font color="#4169E1"><a name="PetscOptionsMonitorCancel"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>(void)</font></strong>
-<a name="line2010">2010: </a>{
-<a name="line2012">2012: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
-
-<a name="line2015">2015: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;numbermonitors; i++) {
-<a name="line2016">2016: </a>    <font color="#4169E1">if</font> (options-&gt;monitordestroy[i]) {
-<a name="line2017">2017: </a>      (*options-&gt;monitordestroy[i])(options-&gt;monitorcontext[i]);
-<a name="line2018">2018: </a>    }
-<a name="line2019">2019: </a>  }
-<a name="line2020">2020: </a>  options-&gt;numbermonitors = 0;
-<a name="line2021">2021: </a>  <font color="#4169E1">return</font>(0);
-<a name="line2022">2022: </a>}
+<a name="line896">896: </a>  <font color="#4169E1">if</font> (n == N) <font color="#4169E1">return</font>(0); <font color="#B22222">/* it was not listed */</font>
+
+<a name="line898">898: </a>  <font color="#B22222">/* shift remaining values down 1 */</font>
+<a name="line899">899: </a>  <font color="#4169E1">for</font> (i=n; i&lt;N-1; i++) {
+<a name="line900">900: </a>    options-&gt;names[i]  = options-&gt;names[i+1];
+<a name="line901">901: </a>    options-&gt;values[i] = options-&gt;values[i+1];
+<a name="line902">902: </a>    options-&gt;used[i]   = options-&gt;used[i+1];
+<a name="line903">903: </a>  }
+<a name="line904">904: </a>  options-&gt;N--;
+<a name="line905">905: </a>  <font color="#4169E1">return</font>(0);
+<a name="line906">906: </a>}
+
+<a name="line910">910: </a><font color="#B22222">/*@C</font>
+<a name="line911">911: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsSetAlias.html#PetscOptionsSetAlias">PetscOptionsSetAlias</A> - Makes a key and alias for another key</font>
+
+<a name="line913">913: </a><font color="#B22222">   Not Collective, but setting values on certain processors could cause problems</font>
+<a name="line914">914: </a><font color="#B22222">   for parallel objects looking for options.</font>
+
+<a name="line916">916: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line917">917: </a><font color="#B22222">+  inewname - the alias</font>
+<a name="line918">918: </a><font color="#B22222">-  ioldname - the name that alias will refer to </font>
+
+<a name="line920">920: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line922">922: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),OptionsHasName(),</font>
+<a name="line923">923: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line924">924: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line925">925: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line926">926: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line927">927: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line928">928: </a><font color="#B22222">@*/</font>
+<a name="line929">929: </a><strong><font color="#4169E1"><a name="PetscOptionsSetAlias"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsSetAlias.html#PetscOptionsSetAlias">PetscOptionsSetAlias</A>(const char inewname[],const char ioldname[])</font></strong>
+<a name="line930">930: </a>{
+<a name="line932">932: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = options-&gt;Naliases;
+<a name="line933">933: </a>  size_t         len;
+<a name="line934">934: </a>  char           *newname = (char *)inewname,*oldname = (char*)ioldname;
+
+<a name="line937">937: </a>  <font color="#4169E1">if</font> (newname[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"aliased must have -: Instead %s"</font>,newname);
+<a name="line938">938: </a>  <font color="#4169E1">if</font> (oldname[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"aliasee must have -: Instead %s"</font>,oldname);
+<a name="line939">939: </a>  <font color="#4169E1">if</font> (n &gt;= MAXALIASES) {
+<a name="line940">940: </a>    <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_MEM,<font color="#666666">"You have defined to many PETSc options aliases, limit %d recompile \n  src/sys/objects/options.c with larger value for MAXALIASES"</font>,MAXALIASES);
+<a name="line941">941: </a>  }
+
+<a name="line943">943: </a>  newname++; oldname++;
+<a name="line944">944: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(newname,&amp;len);
+<a name="line945">945: </a>  options-&gt;aliases1[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
+<a name="line946">946: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;aliases1[n],newname);
+<a name="line947">947: </a>  <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(oldname,&amp;len);
+<a name="line948">948: </a>  options-&gt;aliases2[n] = (char*)malloc((len+1)*<font color="#4169E1">sizeof</font>(char));
+<a name="line949">949: </a>  <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(options-&gt;aliases2[n],oldname);
+<a name="line950">950: </a>  options-&gt;Naliases++;
+<a name="line951">951: </a>  <font color="#4169E1">return</font>(0);
+<a name="line952">952: </a>}
+
+<a name="line956">956: </a><strong><font color="#4169E1"><a name="PetscOptionsFindPair_Private"></a>static <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscOptionsFindPair_Private(const char pre[],const char name[],char *value[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line957">957: </a>{
+<a name="line959">959: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i,N;
+<a name="line960">960: </a>  size_t         len;
+<a name="line961">961: </a>  char           **names,tmp[256];
+<a name="line962">962: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     match;
+
+<a name="line965">965: </a>  <font color="#4169E1">if</font> (!options) {<A href="../../../docs/manualpages/Sys/PetscOptionsInsert.html#PetscOptionsInsert">PetscOptionsInsert</A>(0,0,0);}
+<a name="line966">966: </a>  N = options-&gt;N;
+<a name="line967">967: </a>  names = options-&gt;names;
+
+<a name="line969">969: </a>  <font color="#4169E1">if</font> (name[0] != '-') <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Name must begin with -: Instead %s"</font>,name);
+
+<a name="line971">971: </a>  <font color="#B22222">/* append prefix to name */</font>
+<a name="line972">972: </a>  <font color="#4169E1">if</font> (pre) {
+<a name="line973">973: </a>    <font color="#4169E1">if</font> (pre[0] == '-') <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Prefix should not begin with a -"</font>);
+<a name="line974">974: </a>    <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(tmp,pre,256);
+<a name="line975">975: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(tmp,&amp;len);
+<a name="line976">976: </a>    <A href="../../../docs/manualpages/Sys/PetscStrncat.html#PetscStrncat">PetscStrncat</A>(tmp,name+1,256-len-1);
+<a name="line977">977: </a>  } <font color="#4169E1">else</font> {
+<a name="line978">978: </a>    <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(tmp,name+1,256);
+<a name="line979">979: </a>  }
+
+<a name="line981">981: </a>  <font color="#B22222">/* slow search */</font>
+<a name="line982">982: </a>  *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line983">983: </a>  <font color="#4169E1">for</font> (i=0; i&lt;N; i++) {
+<a name="line984">984: </a>    <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(names[i],tmp,&amp;match);
+<a name="line985">985: </a>    <font color="#4169E1">if</font> (match) {
+<a name="line986">986: </a>       *value           = options-&gt;values[i];
+<a name="line987">987: </a>       options-&gt;used[i] = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line988">988: </a>       *flg             = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line989">989: </a>       <font color="#4169E1">break</font>;
+<a name="line990">990: </a>     }
+<a name="line991">991: </a>  }
+<a name="line992">992: </a>  <font color="#4169E1">if</font> (!*flg) {
+<a name="line993">993: </a>    <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> j,cnt = 0,locs[16],loce[16];
+<a name="line994">994: </a>    size_t   n;
+<a name="line995">995: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(tmp,&amp;n);
+<a name="line996">996: </a>    <font color="#B22222">/* determine the location and number of all _%d_ in the key */</font>
+<a name="line997">997: </a>    <font color="#4169E1">for</font> (i=0; i&lt; (<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)n; i++) {
+<a name="line998">998: </a>      <font color="#4169E1">if</font> (tmp[i] == '_') {
+<a name="line999">999: </a>        <font color="#4169E1">for</font> (j=i+1; j&lt; (<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>)n; j++) {
+<a name="line1000">1000: </a>          <font color="#4169E1">if</font> (tmp[j] &gt;= '0' &amp;&amp; tmp[j] &lt;= '9') <font color="#4169E1">continue</font>;
+<a name="line1001">1001: </a>          <font color="#4169E1">if</font> (tmp[j] == '_' &amp;&amp; j &gt; i+1) { <font color="#B22222">/* found a number */</font>
+<a name="line1002">1002: </a>            locs[cnt]   = i+1;
+<a name="line1003">1003: </a>            loce[cnt++] = j+1;
+<a name="line1004">1004: </a>          }
+<a name="line1005">1005: </a>          <font color="#4169E1">break</font>;
+<a name="line1006">1006: </a>        }
+<a name="line1007">1007: </a>      }
+<a name="line1008">1008: </a>    }
+<a name="line1009">1009: </a>    <font color="#4169E1">if</font> (cnt) {
+<a name="line1010">1010: </a>      char tmp2[256];
+<a name="line1011">1011: </a>      <font color="#4169E1">for</font> (i=0; i&lt;cnt; i++) {
+<a name="line1012">1012: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcpy.html#PetscStrcpy">PetscStrcpy</A>(tmp2,<font color="#666666">"-"</font>);
+<a name="line1013">1013: </a>        <A href="../../../docs/manualpages/Sys/PetscStrncat.html#PetscStrncat">PetscStrncat</A>(tmp2,tmp,locs[i]);
+<a name="line1014">1014: </a>        <A href="../../../docs/manualpages/Sys/PetscStrcat.html#PetscStrcat">PetscStrcat</A>(tmp2,tmp+loce[i]);
+<a name="line1015">1015: </a>        PetscOptionsFindPair_Private(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,tmp2,value,flg);
+<a name="line1016">1016: </a>        <font color="#4169E1">if</font> (*flg) <font color="#4169E1">break</font>;
+<a name="line1017">1017: </a>      }
+<a name="line1018">1018: </a>    }
+<a name="line1019">1019: </a>  }
+<a name="line1020">1020: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1021">1021: </a>}
+
+<a name="line1025">1025: </a><font color="#B22222">/*@C</font>
+<a name="line1026">1026: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsReject.html#PetscOptionsReject">PetscOptionsReject</A> - Generates an error if a certain option is given.</font>
+
+<a name="line1028">1028: </a><font color="#B22222">   Not Collective, but setting values on certain processors could cause problems</font>
+<a name="line1029">1029: </a><font color="#B22222">   for parallel objects looking for options.</font>
+
+<a name="line1031">1031: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1032">1032: </a><font color="#B22222">+  name - the option one is seeking </font>
+<a name="line1033">1033: </a><font color="#B22222">-  mess - error message (may be <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>)</font>
+
+<a name="line1035">1035: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line1037">1037: </a><font color="#B22222">   Concepts: options database^rejecting option</font>
+
+<a name="line1039">1039: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),OptionsHasName(),</font>
+<a name="line1040">1040: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1041">1041: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1042">1042: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1043">1043: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1044">1044: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1045">1045: </a><font color="#B22222">@*/</font>
+<a name="line1046">1046: </a><strong><font color="#4169E1"><a name="PetscOptionsReject"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsReject.html#PetscOptionsReject">PetscOptionsReject</A>(const char name[],const char mess[])</font></strong>
+<a name="line1047">1047: </a>{
+<a name="line1049">1049: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+
+<a name="line1052">1052: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,name,&amp;flag);
+<a name="line1053">1053: </a>  <font color="#4169E1">if</font> (flag) {
+<a name="line1054">1054: </a>    <font color="#4169E1">if</font> (mess) {
+<a name="line1055">1055: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Program has disabled option: %s with %s"</font>,name,mess);
+<a name="line1056">1056: </a>    } <font color="#4169E1">else</font> {
+<a name="line1057">1057: </a>      <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Program has disabled option: %s"</font>,name);
+<a name="line1058">1058: </a>    }
+<a name="line1059">1059: </a>  }
+<a name="line1060">1060: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1061">1061: </a>}
+
+<a name="line1065">1065: </a><font color="#B22222">/*@C</font>
+<a name="line1066">1066: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A> - Determines whether a certain option is given in the database. This returns true whether the option is a number, string or boolean, even </font>
+<a name="line1067">1067: </a><font color="#B22222">                      its value is set to false.</font>
+
+<a name="line1069">1069: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1071">1071: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1072">1072: </a><font color="#B22222">+  name - the option one is seeking </font>
+<a name="line1073">1073: </a><font color="#B22222">-  pre - string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+
+<a name="line1075">1075: </a><font color="#B22222">   Output Parameters:</font>
+<a name="line1076">1076: </a><font color="#B22222">.  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>.</font>
+
+<a name="line1078">1078: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1080">1080: </a><font color="#B22222">   Concepts: options database^has option name</font>
+
+<a name="line1082">1082: </a><font color="#B22222">   Notes: Name cannot be simply -h</font>
+
+<a name="line1084">1084: </a><font color="#B22222">          In many cases you probably want to use <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>() instead of calling this, to allowing toggling values.</font>
+
+<a name="line1086">1086: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),</font>
+<a name="line1087">1087: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1088">1088: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1089">1089: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1090">1090: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1091">1091: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1092">1092: </a><font color="#B22222">@*/</font>
+<a name="line1093">1093: </a><strong><font color="#4169E1"><a name="PetscOptionsHasName"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1094">1094: </a>{
+<a name="line1095">1095: </a>  char           *value;
+<a name="line1097">1097: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+
+<a name="line1100">1100: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1101">1101: </a>  <font color="#4169E1">if</font> (flg) *flg = flag;
+<a name="line1102">1102: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1103">1103: </a>}
+
+<a name="line1107">1107: </a><font color="#B22222">/*@C</font>
+<a name="line1108">1108: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A> - Gets the integer value for a particular option in the database.</font>
+
+<a name="line1110">1110: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1112">1112: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1113">1113: </a><font color="#B22222">+  pre - the string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1114">1114: </a><font color="#B22222">-  name - the option one is seeking</font>
+
+<a name="line1116">1116: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1117">1117: </a><font color="#B22222">+  ivalue - the integer value to return</font>
+<a name="line1118">1118: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1120">1120: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1122">1122: </a><font color="#B22222">   Concepts: options database^has int</font>
+
+<a name="line1124">1124: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(),</font>
+<a name="line1125">1125: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>()</font>
+<a name="line1126">1126: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsString.html#PetscOptionsString">PetscOptionsString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsReal.html#PetscOptionsReal">PetscOptionsReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1127">1127: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1128">1128: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1129">1129: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1130">1130: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1131">1131: </a><font color="#B22222">@*/</font>
+<a name="line1132">1132: </a><strong><font color="#4169E1"><a name="PetscOptionsGetInt"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *ivalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1133">1133: </a>{
+<a name="line1134">1134: </a>  char           *value;
+<a name="line1136">1136: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+
+<a name="line1141">1141: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1142">1142: </a>  <font color="#4169E1">if</font> (flag) {
+<a name="line1143">1143: </a>    <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;}
+<a name="line1144">1144: </a>    <font color="#4169E1">else</font> {
+<a name="line1145">1145: </a>      <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1146">1146: </a>      PetscOptionsAtoi(value,ivalue);
+<a name="line1147">1147: </a>    }
+<a name="line1148">1148: </a>  } <font color="#4169E1">else</font> {
+<a name="line1149">1149: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1150">1150: </a>  }
+<a name="line1151">1151: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1152">1152: </a>}
+
+<a name="line1156">1156: </a><font color="#B22222">/*@C</font>
+<a name="line1157">1157: </a><font color="#B22222">     <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A> - Puts a list of option values that a single one may be selected from</font>
+
+<a name="line1159">1159: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1161">1161: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1162">1162: </a><font color="#B22222">+  pre - the string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1163">1163: </a><font color="#B22222">.  opt - option name</font>
+<a name="line1164">1164: </a><font color="#B22222">.  list - the possible choices</font>
+<a name="line1165">1165: </a><font color="#B22222">.  ntext - number of choices</font>
+
+<a name="line1167">1167: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1168">1168: </a><font color="#B22222">+  value - the index of the value to return</font>
+<a name="line1169">1169: </a><font color="#B22222">-  set - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+<a name="line1170">1170: </a><font color="#B22222">   </font>
+<a name="line1171">1171: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line1173">1173: </a><font color="#B22222">   See <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>() for when the choices are given in a <A href="../../../docs/manualpages/Sys/PetscFList.html#PetscFList">PetscFList</A>()</font>
+
+<a name="line1175">1175: </a><font color="#B22222">   Concepts: options database^list</font>
+
+<a name="line1177">1177: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),  </font>
+<a name="line1178">1178: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1179">1179: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1180">1180: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1181">1181: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1182">1182: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1183">1183: </a><font color="#B22222">@*/</font>
+<a name="line1184">1184: </a><strong><font color="#4169E1"><a name="PetscOptionsGetEList"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A>(const char pre[],const char opt[],const char *const*list,<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ntext,<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *value,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *set)</font></strong>
+<a name="line1185">1185: </a>{
+<a name="line1187">1187: </a>  size_t         alen,len = 0;
+<a name="line1188">1188: </a>  char           *svalue;
+<a name="line1189">1189: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     aset,flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1190">1190: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
+
+<a name="line1193">1193: </a>  <font color="#4169E1">for</font> ( i=0; i&lt;ntext; i++) {
+<a name="line1194">1194: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(list[i],&amp;alen);
+<a name="line1195">1195: </a>    <font color="#4169E1">if</font> (alen &gt; len) len = alen;
+<a name="line1196">1196: </a>  }
+<a name="line1197">1197: </a>  len += 5; <font color="#B22222">/* a little extra space for user mistypes */</font>
+<a name="line1198">1198: </a>  <A href="../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(len*<font color="#4169E1">sizeof</font>(char),&amp;svalue);
+<a name="line1199">1199: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(pre,opt,svalue,len,&amp;aset);
+<a name="line1200">1200: </a>  <font color="#4169E1">if</font> (aset) {
+<a name="line1201">1201: </a>    <font color="#4169E1">if</font> (set) *set = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1202">1202: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ntext; i++) {
+<a name="line1203">1203: </a>      <A href="../../../docs/manualpages/Sys/PetscStrcasecmp.html#PetscStrcasecmp">PetscStrcasecmp</A>(svalue,list[i],&amp;flg);
+<a name="line1204">1204: </a>      <font color="#4169E1">if</font> (flg) {
+<a name="line1205">1205: </a>        *value = i;
+<a name="line1206">1206: </a>        <font color="#4169E1">break</font>;
+<a name="line1207">1207: </a>      }
+<a name="line1208">1208: </a>    }
+<a name="line1209">1209: </a>    <font color="#4169E1">if</font> (!flg) <A href="../../../docs/manualpages/Sys/SETERRQ3.html#SETERRQ3">SETERRQ3</A>(PETSC_ERR_USER,<font color="#666666">"Unknown option %s for -%s%s"</font>,svalue,pre?pre:<font color="#666666">""</font>,opt+1);
+<a name="line1210">1210: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (set) {
+<a name="line1211">1211: </a>    *set = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1212">1212: </a>  }
+<a name="line1213">1213: </a>  <A href="../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(svalue);
+<a name="line1214">1214: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1215">1215: </a>}
+
+<a name="line1219">1219: </a><font color="#B22222">/*@C</font>
+<a name="line1220">1220: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetEnum.html#PetscOptionsGetEnum">PetscOptionsGetEnum</A> - Gets the enum value for a particular option in the database.</font>
+
+<a name="line1222">1222: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1224">1224: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1225">1225: </a><font color="#B22222">+  pre - option prefix or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1226">1226: </a><font color="#B22222">.  opt - option name</font>
+<a name="line1227">1227: </a><font color="#B22222">.  list - array containing the list of choices, followed by the enum name, followed by the enum prefix, followed by a null</font>
+<a name="line1228">1228: </a><font color="#B22222">-  defaultv - the default (current) value</font>
+
+<a name="line1230">1230: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1231">1231: </a><font color="#B22222">+  value - the  value to return</font>
+<a name="line1232">1232: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1234">1234: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1236">1236: </a><font color="#B22222">   Concepts: options database</font>
+
+<a name="line1238">1238: </a><font color="#B22222">   Notes: Must be between a <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>() and a <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>()</font>
+
+<a name="line1240">1240: </a><font color="#B22222">          list is usually something like PCASMTypes or some other predefined list of enum names</font>
+
+<a name="line1242">1242: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(),</font>
+<a name="line1243">1243: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>()</font>
+<a name="line1244">1244: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsInt.html#PetscOptionsInt">PetscOptionsInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsString.html#PetscOptionsString">PetscOptionsString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsReal.html#PetscOptionsReal">PetscOptionsReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1245">1245: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1246">1246: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1247">1247: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1248">1248: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnum.html#PetscOptionsEnum">PetscOptionsEnum</A>()</font>
+<a name="line1249">1249: </a><font color="#B22222">@*/</font>
+<a name="line1250">1250: </a><strong><font color="#4169E1"><a name="PetscOptionsGetEnum"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetEnum.html#PetscOptionsGetEnum">PetscOptionsGetEnum</A>(const char pre[],const char opt[],const char *const*list,<A href="../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</A> *value,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *set)</font></strong>
+<a name="line1251">1251: </a>{
+<a name="line1253">1253: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       ntext = 0,tval;
+<a name="line1254">1254: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     fset;
+
+<a name="line1257">1257: </a>  <font color="#4169E1">while</font> (list[ntext++]) {
+<a name="line1258">1258: </a>    <font color="#4169E1">if</font> (ntext &gt; 50) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"List argument appears to be wrong or have more than 50 entries"</font>);
+<a name="line1259">1259: </a>  }
+<a name="line1260">1260: </a>  <font color="#4169E1">if</font> (ntext &lt; 3) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"List argument must have at least two entries: typename and type prefix"</font>);
+<a name="line1261">1261: </a>  ntext -= 3;
+<a name="line1262">1262: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetEList.html#PetscOptionsGetEList">PetscOptionsGetEList</A>(pre,opt,list,ntext,&amp;tval,&amp;fset);
+<a name="line1263">1263: </a>  <font color="#B22222">/* with PETSC_USE_64BIT_INDICES sizeof(<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>) != sizeof(<A href="../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</A>) */</font>
+<a name="line1264">1264: </a>  <font color="#4169E1">if</font> (fset) *value = (<A href="../../../docs/manualpages/Sys/PetscEnum.html#PetscEnum">PetscEnum</A>)tval;
+<a name="line1265">1265: </a>  <font color="#4169E1">if</font> (set) *set = fset;
+<a name="line1266">1266: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1267">1267: </a>}
+
+<a name="line1271">1271: </a><font color="#B22222">/*@C</font>
+<a name="line1272">1272: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A> - Gets the Logical (true or false) value for a particular </font>
+<a name="line1273">1273: </a><font color="#B22222">            option in the database.</font>
+
+<a name="line1275">1275: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1277">1277: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1278">1278: </a><font color="#B22222">+  pre - the string to prepend to the name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1279">1279: </a><font color="#B22222">-  name - the option one is seeking</font>
+
+<a name="line1281">1281: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1282">1282: </a><font color="#B22222">+  ivalue - the logical value to return</font>
+<a name="line1283">1283: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>  if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1285">1285: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1287">1287: </a><font color="#B22222">   Notes:</font>
+<a name="line1288">1288: </a><font color="#B22222">       TRUE, true, YES, yes, nostring, and 1 all translate to <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A></font>
+<a name="line1289">1289: </a><font color="#B22222">       FALSE, false, NO, no, and 0 all translate to <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1291">1291: </a><font color="#B22222">       If the user does not supply the option (as either true or false) ivalue is NOT changed. Thus</font>
+<a name="line1292">1292: </a><font color="#B22222">     you NEED TO ALWAYS initialize the ivalue.</font>
+
+<a name="line1294">1294: </a><font color="#B22222">   Concepts: options database^has logical</font>
+
+<a name="line1296">1296: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(),</font>
+<a name="line1297">1297: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1298">1298: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1299">1299: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1300">1300: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1301">1301: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1302">1302: </a><font color="#B22222">@*/</font>
+<a name="line1303">1303: </a><strong><font color="#4169E1"><a name="PetscOptionsGetTruth"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *ivalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1304">1304: </a>{
+<a name="line1305">1305: </a>  char           *value;
+<a name="line1306">1306: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+
+<a name="line1312">1312: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1313">1313: </a>  <font color="#4169E1">if</font> (flag) {
+<a name="line1314">1314: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1315">1315: </a>    <font color="#4169E1">if</font> (!value) {
+<a name="line1316">1316: </a>      *ivalue = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1317">1317: </a>    } <font color="#4169E1">else</font> {
+<a name="line1318">1318: </a>      PetscOptionsAtol(value, ivalue);
+<a name="line1319">1319: </a>    }
+<a name="line1320">1320: </a>  } <font color="#4169E1">else</font> {
+<a name="line1321">1321: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1322">1322: </a>  }
+<a name="line1323">1323: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1324">1324: </a>}
+
+<a name="line1328">1328: </a><font color="#B22222">/*@C</font>
+<a name="line1329">1329: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruthArray.html#PetscOptionsGetTruthArray">PetscOptionsGetTruthArray</A> - Gets an array of Logical (true or false) values for a particular </font>
+<a name="line1330">1330: </a><font color="#B22222">   option in the database.  The values must be separated with commas with </font>
+<a name="line1331">1331: </a><font color="#B22222">   no intervening spaces. </font>
+
+<a name="line1333">1333: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1335">1335: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1336">1336: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1337">1337: </a><font color="#B22222">.  name - the option one is seeking</font>
+<a name="line1338">1338: </a><font color="#B22222">-  nmax - maximum number of values to retrieve</font>
+
+<a name="line1340">1340: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1341">1341: </a><font color="#B22222">+  dvalue - the integer values to return</font>
+<a name="line1342">1342: </a><font color="#B22222">.  nmax - actual number of values retreived</font>
+<a name="line1343">1343: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1345">1345: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1347">1347: </a><font color="#B22222">   Concepts: options database^array of ints</font>
+
+<a name="line1349">1349: </a><font color="#B22222">   Notes:</font>
+<a name="line1350">1350: </a><font color="#B22222">       TRUE, true, YES, yes, nostring, and 1 all translate to <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A></font>
+<a name="line1351">1351: </a><font color="#B22222">       FALSE, false, NO, no, and 0 all translate to <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1353">1353: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
+<a name="line1354">1354: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1355">1355: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1356">1356: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1357">1357: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1358">1358: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1359">1359: </a><font color="#B22222">@*/</font>
+<a name="line1360">1360: </a><strong><font color="#4169E1"><a name="PetscOptionsGetTruthArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruthArray.html#PetscOptionsGetTruthArray">PetscOptionsGetTruthArray</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> dvalue[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1361">1361: </a>{
+<a name="line1362">1362: </a>  char           *value;
+<a name="line1364">1364: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = 0;
+<a name="line1365">1365: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+<a name="line1366">1366: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
+
+<a name="line1371">1371: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1372">1372: </a>  <font color="#4169E1">if</font> (!flag)  {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
+<a name="line1373">1373: </a>  <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
+
+<a name="line1375">1375: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+
+<a name="line1377">1377: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
+<a name="line1378">1378: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1379">1379: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
+<a name="line1380">1380: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
+<a name="line1381">1381: </a>    PetscOptionsAtol(value,dvalue);
+<a name="line1382">1382: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1383">1383: </a>    dvalue++;
+<a name="line1384">1384: </a>    n++;
+<a name="line1385">1385: </a>  }
+<a name="line1386">1386: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line1387">1387: </a>  *nmax = n;
+<a name="line1388">1388: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1389">1389: </a>}
+
+<a name="line1393">1393: </a><font color="#B22222">/*@C</font>
+<a name="line1394">1394: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A> - Gets the double precision value for a particular </font>
+<a name="line1395">1395: </a><font color="#B22222">   option in the database.</font>
+
+<a name="line1397">1397: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1399">1399: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1400">1400: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1401">1401: </a><font color="#B22222">-  name - the option one is seeking</font>
+
+<a name="line1403">1403: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1404">1404: </a><font color="#B22222">+  dvalue - the double value to return</font>
+<a name="line1405">1405: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A> if not found</font>
+
+<a name="line1407">1407: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1409">1409: </a><font color="#B22222">   Concepts: options database^has double</font>
+
+<a name="line1411">1411: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
+<a name="line1412">1412: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1413">1413: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1414">1414: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1415">1415: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1416">1416: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1417">1417: </a><font color="#B22222">@*/</font>
+<a name="line1418">1418: </a><strong><font color="#4169E1"><a name="PetscOptionsGetReal"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *dvalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1419">1419: </a>{
+<a name="line1420">1420: </a>  char           *value;
+<a name="line1422">1422: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+
+<a name="line1427">1427: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1428">1428: </a>  <font color="#4169E1">if</font> (flag) {
+<a name="line1429">1429: </a>    <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;}
+<a name="line1430">1430: </a>    <font color="#4169E1">else</font>        {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; PetscOptionsAtod(value,dvalue);}
+<a name="line1431">1431: </a>  } <font color="#4169E1">else</font> {
+<a name="line1432">1432: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1433">1433: </a>  }
+<a name="line1434">1434: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1435">1435: </a>}
+
+<a name="line1439">1439: </a><font color="#B22222">/*@C</font>
+<a name="line1440">1440: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetScalar.html#PetscOptionsGetScalar">PetscOptionsGetScalar</A> - Gets the scalar value for a particular </font>
+<a name="line1441">1441: </a><font color="#B22222">   option in the database.</font>
+
+<a name="line1443">1443: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1445">1445: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1446">1446: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1447">1447: </a><font color="#B22222">-  name - the option one is seeking</font>
+
+<a name="line1449">1449: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1450">1450: </a><font color="#B22222">+  dvalue - the double value to return</font>
+<a name="line1451">1451: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1453">1453: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1455">1455: </a><font color="#B22222">   Usage:</font>
+<a name="line1456">1456: </a><font color="#B22222">   A complex number 2+3i can be specified as 2,3 at the command line.</font>
+<a name="line1457">1457: </a><font color="#B22222">   or a number 2.0e-10 - 3.3e-20 i  can be specified as 2.0e-10,3.3e-20</font>
+
+<a name="line1459">1459: </a><font color="#B22222">   Concepts: options database^has scalar</font>
+
+<a name="line1461">1461: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
+<a name="line1462">1462: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1463">1463: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1464">1464: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1465">1465: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1466">1466: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1467">1467: </a><font color="#B22222">@*/</font>
+<a name="line1468">1468: </a><strong><font color="#4169E1"><a name="PetscOptionsGetScalar"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetScalar.html#PetscOptionsGetScalar">PetscOptionsGetScalar</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *dvalue,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1469">1469: </a>{
+<a name="line1470">1470: </a>  char           *value;
+<a name="line1471">1471: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+
+<a name="line1477">1477: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1478">1478: </a>  <font color="#4169E1">if</font> (flag) {
+<a name="line1479">1479: </a>    <font color="#4169E1">if</font> (!value) {
+<a name="line1480">1480: </a>      <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1481">1481: </a>    } <font color="#4169E1">else</font> {
+<a name="line1482">1482: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1483">1483: </a>      PetscOptionsAtod(value,dvalue);
+<a name="line1484">1484: </a><font color="#A020F0">#else</font>
+<a name="line1485">1485: </a>      <A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>  re=0.0,im=0.0;
+<a name="line1486">1486: </a>      <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A> token;
+<a name="line1487">1487: </a>      char       *tvalue = 0;
+
+<a name="line1489">1489: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
+<a name="line1490">1490: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;tvalue);
+<a name="line1491">1491: </a>      <font color="#4169E1">if</font> (!tvalue) { <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"unknown string specified\n"</font>); }
+<a name="line1492">1492: </a>      PetscOptionsAtod(tvalue,&amp;re);
+<a name="line1493">1493: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;tvalue);
+<a name="line1494">1494: </a>      <font color="#4169E1">if</font> (!tvalue) { <font color="#B22222">/* Unknown separator used. using only real value */</font>
+<a name="line1495">1495: </a>        *dvalue = re;
+<a name="line1496">1496: </a>      } <font color="#4169E1">else</font> {
+<a name="line1497">1497: </a>        PetscOptionsAtod(tvalue,&amp;im);
+<a name="line1498">1498: </a>        *dvalue = re + PETSC_i*im;
+<a name="line1499">1499: </a>      }
+<a name="line1500">1500: </a>      <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line1501">1501: </a><font color="#A020F0">#endif</font>
+<a name="line1502">1502: </a>      <font color="#4169E1">if</font> (flg) *flg    = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1503">1503: </a>    }
+<a name="line1504">1504: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* flag */</font>
+<a name="line1505">1505: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1506">1506: </a>  }
+<a name="line1507">1507: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1508">1508: </a>}
+
+<a name="line1512">1512: </a><font color="#B22222">/*@C</font>
+<a name="line1513">1513: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A> - Gets an array of double precision values for a </font>
+<a name="line1514">1514: </a><font color="#B22222">   particular option in the database.  The values must be separated with </font>
+<a name="line1515">1515: </a><font color="#B22222">   commas with no intervening spaces.</font>
+
+<a name="line1517">1517: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1519">1519: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1520">1520: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1521">1521: </a><font color="#B22222">.  name - the option one is seeking</font>
+<a name="line1522">1522: </a><font color="#B22222">-  nmax - maximum number of values to retrieve</font>
+
+<a name="line1524">1524: </a><font color="#B22222">   Output Parameters:</font>
+<a name="line1525">1525: </a><font color="#B22222">+  dvalue - the double value to return</font>
+<a name="line1526">1526: </a><font color="#B22222">.  nmax - actual number of values retreived</font>
+<a name="line1527">1527: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1529">1529: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1531">1531: </a><font color="#B22222">   Concepts: options database^array of doubles</font>
+
+<a name="line1533">1533: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
+<a name="line1534">1534: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1535">1535: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1536">1536: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1537">1537: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1538">1538: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1539">1539: </a><font color="#B22222">@*/</font>
+<a name="line1540">1540: </a><strong><font color="#4169E1"><a name="PetscOptionsGetRealArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> dvalue[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1541">1541: </a>{
+<a name="line1542">1542: </a>  char           *value;
+<a name="line1544">1544: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = 0;
+<a name="line1545">1545: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+<a name="line1546">1546: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
+
+<a name="line1551">1551: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1552">1552: </a>  <font color="#4169E1">if</font> (!flag)  {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
+<a name="line1553">1553: </a>  <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
+
+<a name="line1555">1555: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+
+<a name="line1557">1557: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
+<a name="line1558">1558: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1559">1559: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
+<a name="line1560">1560: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
+<a name="line1561">1561: </a>    PetscOptionsAtod(value,dvalue++);
+<a name="line1562">1562: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1563">1563: </a>    n++;
+<a name="line1564">1564: </a>  }
+<a name="line1565">1565: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line1566">1566: </a>  *nmax = n;
+<a name="line1567">1567: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1568">1568: </a>}
+
+<a name="line1572">1572: </a><font color="#B22222">/*@C</font>
+<a name="line1573">1573: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A> - Gets an array of integer values for a particular </font>
+<a name="line1574">1574: </a><font color="#B22222">   option in the database.  The values must be separated with commas with </font>
+<a name="line1575">1575: </a><font color="#B22222">   no intervening spaces. </font>
+
+<a name="line1577">1577: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1579">1579: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1580">1580: </a><font color="#B22222">+  pre - string to prepend to each name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1581">1581: </a><font color="#B22222">.  name - the option one is seeking</font>
+<a name="line1582">1582: </a><font color="#B22222">-  nmax - maximum number of values to retrieve, can include d-D to indicate d,d+1,..,D-1</font>
+
+<a name="line1584">1584: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1585">1585: </a><font color="#B22222">+  dvalue - the integer values to return</font>
+<a name="line1586">1586: </a><font color="#B22222">.  nmax - actual number of values retreived</font>
+<a name="line1587">1587: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1589">1589: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1591">1591: </a><font color="#B22222">   Concepts: options database^array of ints</font>
+
+<a name="line1593">1593: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), </font>
+<a name="line1594">1594: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1595">1595: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1596">1596: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1597">1597: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1598">1598: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1599">1599: </a><font color="#B22222">@*/</font>
+<a name="line1600">1600: </a><strong><font color="#4169E1"><a name="PetscOptionsGetIntArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(const char pre[],const char name[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> dvalue[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1601">1601: </a>{
+<a name="line1602">1602: </a>  char           *value;
+<a name="line1604">1604: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = 0,i,start,end;
+<a name="line1605">1605: </a>  size_t         len;
+<a name="line1606">1606: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag,foundrange;
+<a name="line1607">1607: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
+
+<a name="line1612">1612: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1613">1613: </a>  <font color="#4169E1">if</font> (!flag)  {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
+<a name="line1614">1614: </a>  <font color="#4169E1">if</font> (!value) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>; *nmax = 0; <font color="#4169E1">return</font>(0);}
+
+<a name="line1616">1616: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+
+<a name="line1618">1618: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
+<a name="line1619">1619: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1620">1620: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
+<a name="line1621">1621: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
+<a name="line1622">1622: </a>
+<a name="line1623">1623: </a>    <font color="#B22222">/* look for form  d-D where d and D are integers */</font>
+<a name="line1624">1624: </a>    foundrange = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1625">1625: </a>    <A href="../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(value,&amp;len);
+<a name="line1626">1626: </a>    <font color="#4169E1">if</font> (value[0] == '-') i=2;
+<a name="line1627">1627: </a>    <font color="#4169E1">else</font> i=1;
+<a name="line1628">1628: </a>    <font color="#4169E1">for</font> (;i&lt;(int)len; i++) {
+<a name="line1629">1629: </a>      <font color="#4169E1">if</font> (value[i] == '-') {
+<a name="line1630">1630: </a>        <font color="#4169E1">if</font> (i == (int)len-1) <A href="../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_USER,<font color="#666666">"Error in %D-th array entry %s\n"</font>,n,value);
+<a name="line1631">1631: </a>        value[i] = 0;
+<a name="line1632">1632: </a>        PetscOptionsAtoi(value,&amp;start);
+<a name="line1633">1633: </a>        PetscOptionsAtoi(value+i+1,&amp;end);
+<a name="line1634">1634: </a>        <font color="#4169E1">if</font> (end &lt;= start) <A href="../../../docs/manualpages/Sys/SETERRQ3.html#SETERRQ3">SETERRQ3</A>(PETSC_ERR_USER,<font color="#666666">"Error in %D-th array entry, %s-%s cannot have decreasing list"</font>,n,value,value+i+1);
+<a name="line1635">1635: </a>        <font color="#4169E1">if</font> (n + end - start - 1 &gt;= *nmax) SETERRQ4(PETSC_ERR_USER,<font color="#666666">"Error in %D-th array entry, not enough space in left in array (%D) to contain entire range from %D to %D"</font>,n,*nmax-n,start,end);
+<a name="line1636">1636: </a>        <font color="#4169E1">for</font> (;start&lt;end; start++) {
+<a name="line1637">1637: </a>          *dvalue = start; dvalue++;n++;
+<a name="line1638">1638: </a>        }
+<a name="line1639">1639: </a>        foundrange = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1640">1640: </a>        <font color="#4169E1">break</font>;
+<a name="line1641">1641: </a>      }
+<a name="line1642">1642: </a>    }
+<a name="line1643">1643: </a>    <font color="#4169E1">if</font> (!foundrange) {
+<a name="line1644">1644: </a>      PetscOptionsAtoi(value,dvalue);
+<a name="line1645">1645: </a>      dvalue++;
+<a name="line1646">1646: </a>      n++;
+<a name="line1647">1647: </a>    }
+<a name="line1648">1648: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1649">1649: </a>  }
+<a name="line1650">1650: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line1651">1651: </a>  *nmax = n;
+<a name="line1652">1652: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1653">1653: </a>}
+
+<a name="line1657">1657: </a><font color="#B22222">/*@C</font>
+<a name="line1658">1658: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A> - Gets the string value for a particular option in</font>
+<a name="line1659">1659: </a><font color="#B22222">   the database.</font>
+
+<a name="line1661">1661: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1663">1663: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1664">1664: </a><font color="#B22222">+  pre - string to prepend to name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1665">1665: </a><font color="#B22222">.  name - the option one is seeking</font>
+<a name="line1666">1666: </a><font color="#B22222">-  len - maximum string length</font>
+
+<a name="line1668">1668: </a><font color="#B22222">   Output Parameters:</font>
+<a name="line1669">1669: </a><font color="#B22222">+  string - location to copy string</font>
+<a name="line1670">1670: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1672">1672: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1674">1674: </a><font color="#B22222">   Fortran Note:</font>
+<a name="line1675">1675: </a><font color="#B22222">   The Fortran interface is slightly different from the C/C++</font>
+<a name="line1676">1676: </a><font color="#B22222">   interface (len is not used).  Sample usage in Fortran follows</font>
+<a name="line1677">1677: </a><font color="#B22222">.vb</font>
+<a name="line1678">1678: </a><font color="#B22222">      character *20 string</font>
+<a name="line1679">1679: </a><font color="#B22222">      integer   flg, ierr</font>
+<a name="line1680">1680: </a><font color="#B22222">      call <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(PETSC_NULL_CHARACTER,'-s',string,flg,ierr)</font>
+<a name="line1681">1681: </a><font color="#B22222">.ve</font>
+
+<a name="line1683">1683: </a><font color="#B22222">   Concepts: options database^string</font>
+
+<a name="line1685">1685: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),  </font>
+<a name="line1686">1686: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1687">1687: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1688">1688: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1689">1689: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1690">1690: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1691">1691: </a><font color="#B22222">@*/</font>
+<a name="line1692">1692: </a><strong><font color="#4169E1"><a name="PetscOptionsGetString"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(const char pre[],const char name[],char string[],size_t len,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1693">1693: </a>{
+<a name="line1694">1694: </a>  char           *value;
+<a name="line1696">1696: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+
+<a name="line1701">1701: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1702">1702: </a>  <font color="#4169E1">if</font> (!flag) {
+<a name="line1703">1703: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1704">1704: </a>  } <font color="#4169E1">else</font> {
+<a name="line1705">1705: </a>    <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1706">1706: </a>    <font color="#4169E1">if</font> (value) {
+<a name="line1707">1707: </a>      <A href="../../../docs/manualpages/Sys/PetscStrncpy.html#PetscStrncpy">PetscStrncpy</A>(string,value,len);
+<a name="line1708">1708: </a>    } <font color="#4169E1">else</font> {
+<a name="line1709">1709: </a>      <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(string,len);
+<a name="line1710">1710: </a>    }
+<a name="line1711">1711: </a>  }
+<a name="line1712">1712: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1713">1713: </a>}
+
+<a name="line1717">1717: </a><font color="#B22222">/*@C</font>
+<a name="line1718">1718: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsGetStringArray.html#PetscOptionsGetStringArray">PetscOptionsGetStringArray</A> - Gets an array of string values for a particular</font>
+<a name="line1719">1719: </a><font color="#B22222">   option in the database. The values must be separated with commas with </font>
+<a name="line1720">1720: </a><font color="#B22222">   no intervening spaces. </font>
+
+<a name="line1722">1722: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1724">1724: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1725">1725: </a><font color="#B22222">+  pre - string to prepend to name or <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A></font>
+<a name="line1726">1726: </a><font color="#B22222">.  name - the option one is seeking</font>
+<a name="line1727">1727: </a><font color="#B22222">-  nmax - maximum number of strings</font>
+
+<a name="line1729">1729: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1730">1730: </a><font color="#B22222">+  strings - location to copy strings</font>
+<a name="line1731">1731: </a><font color="#B22222">-  flg - <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A> if found, else <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A></font>
+
+<a name="line1733">1733: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1735">1735: </a><font color="#B22222">   Notes: </font>
+<a name="line1736">1736: </a><font color="#B22222">   The user should pass in an array of pointers to char, to hold all the</font>
+<a name="line1737">1737: </a><font color="#B22222">   strings returned by this function.</font>
+
+<a name="line1739">1739: </a><font color="#B22222">   The user is responsible for deallocating the strings that are</font>
+<a name="line1740">1740: </a><font color="#B22222">   returned. The Fortran interface for this routine is not supported.</font>
+
+<a name="line1742">1742: </a><font color="#B22222">   Contributed by Matthew Knepley.</font>
+
+<a name="line1744">1744: </a><font color="#B22222">   Concepts: options database^array of strings</font>
+
+<a name="line1746">1746: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsGetInt.html#PetscOptionsGetInt">PetscOptionsGetInt</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetReal.html#PetscOptionsGetReal">PetscOptionsGetReal</A>(),  </font>
+<a name="line1747">1747: </a><font color="#B22222">           <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetIntArray.html#PetscOptionsGetIntArray">PetscOptionsGetIntArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsGetRealArray.html#PetscOptionsGetRealArray">PetscOptionsGetRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruth.html#PetscOptionsTruth">PetscOptionsTruth</A>(),</font>
+<a name="line1748">1748: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsHead.html#PetscOptionsHead">PetscOptionsHead</A>(),</font>
+<a name="line1749">1749: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsStringArray.html#PetscOptionsStringArray">PetscOptionsStringArray</A>(),<A href="../../../docs/manualpages/Sys/PetscOptionsRealArray.html#PetscOptionsRealArray">PetscOptionsRealArray</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsScalar.html#PetscOptionsScalar">PetscOptionsScalar</A>(),</font>
+<a name="line1750">1750: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupBegin.html#PetscOptionsTruthGroupBegin">PetscOptionsTruthGroupBegin</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroup.html#PetscOptionsTruthGroup">PetscOptionsTruthGroup</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsTruthGroupEnd.html#PetscOptionsTruthGroupEnd">PetscOptionsTruthGroupEnd</A>(),</font>
+<a name="line1751">1751: </a><font color="#B22222">          <A href="../../../docs/manualpages/Sys/PetscOptionsList.html#PetscOptionsList">PetscOptionsList</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsEList.html#PetscOptionsEList">PetscOptionsEList</A>()</font>
+<a name="line1752">1752: </a><font color="#B22222">@*/</font>
+<a name="line1753">1753: </a><strong><font color="#4169E1"><a name="PetscOptionsGetStringArray"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetStringArray.html#PetscOptionsGetStringArray">PetscOptionsGetStringArray</A>(const char pre[],const char name[],char *strings[],<A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *nmax,<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> *flg)</font></strong>
+<a name="line1754">1754: </a>{
+<a name="line1755">1755: </a>  char           *value;
+<a name="line1757">1757: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n;
+<a name="line1758">1758: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     flag;
+<a name="line1759">1759: </a>  <A href="../../../docs/manualpages/Sys/PetscToken.html#PetscToken">PetscToken</A>     token;
+<a name="line1760">1760: </a>
+<a name="line1764">1764: </a>  PetscOptionsFindPair_Private(pre,name,&amp;value,&amp;flag);
+<a name="line1765">1765: </a>  <font color="#4169E1">if</font> (!flag)  {*nmax = 0; <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#4169E1">return</font>(0);}
+<a name="line1766">1766: </a>  <font color="#4169E1">if</font> (!value) {*nmax = 0; <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;<font color="#4169E1">return</font>(0);}
+<a name="line1767">1767: </a>  <font color="#4169E1">if</font> (!*nmax) {<font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;<font color="#4169E1">return</font>(0);}
+<a name="line1768">1768: </a>  <font color="#4169E1">if</font> (flg) *flg = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+
+<a name="line1770">1770: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenCreate.html#PetscTokenCreate">PetscTokenCreate</A>(value,',',&amp;token);
+<a name="line1771">1771: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1772">1772: </a>  n = 0;
+<a name="line1773">1773: </a>  <font color="#4169E1">while</font> (n &lt; *nmax) {
+<a name="line1774">1774: </a>    <font color="#4169E1">if</font> (!value) <font color="#4169E1">break</font>;
+<a name="line1775">1775: </a>    <A href="../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</A>(value,&amp;strings[n]);
+<a name="line1776">1776: </a>    <A href="../../../docs/manualpages/Sys/PetscTokenFind.html#PetscTokenFind">PetscTokenFind</A>(token,&amp;value);
+<a name="line1777">1777: </a>    n++;
+<a name="line1778">1778: </a>  }
+<a name="line1779">1779: </a>  <A href="../../../docs/manualpages/Sys/PetscTokenDestroy.html#PetscTokenDestroy">PetscTokenDestroy</A>(token);
+<a name="line1780">1780: </a>  *nmax = n;
+<a name="line1781">1781: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1782">1782: </a>}
+
+<a name="line1786">1786: </a><font color="#B22222">/*@C</font>
+<a name="line1787">1787: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A> - Returns a count of the number of options in the </font>
+<a name="line1788">1788: </a><font color="#B22222">   database that have never been selected.</font>
+
+<a name="line1790">1790: </a><font color="#B22222">   Not Collective</font>
+
+<a name="line1792">1792: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1793">1793: </a><font color="#B22222">.   N - count of options not used</font>
+
+<a name="line1795">1795: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line1797">1797: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>()</font>
+<a name="line1798">1798: </a><font color="#B22222">@*/</font>
+<a name="line1799">1799: </a><strong><font color="#4169E1"><a name="PetscOptionsAllUsed"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>(int *N)</font></strong>
+<a name="line1800">1800: </a>{
+<a name="line1801">1801: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,n = 0;
+
+<a name="line1804">1804: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
+<a name="line1805">1805: </a>    <font color="#4169E1">if</font> (!options-&gt;used[i]) { n++; }
+<a name="line1806">1806: </a>  }
+<a name="line1807">1807: </a>  *N = n;
+<a name="line1808">1808: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1809">1809: </a>}
+
+<a name="line1813">1813: </a><font color="#B22222">/*@</font>
+<a name="line1814">1814: </a><font color="#B22222">    <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A> - Prints to screen any options that were set and never used.</font>
+
+<a name="line1816">1816: </a><font color="#B22222">  Not collective</font>
+
+<a name="line1818">1818: </a><font color="#B22222">   Options Database Key:</font>
+<a name="line1819">1819: </a><font color="#B22222">.  -options_left - Activates OptionsAllUsed() within <A href="../../../docs/manualpages/Sys/PetscFinalize.html#PetscFinalize">PetscFinalize</A>()</font>
+
+<a name="line1821">1821: </a><font color="#B22222">  Level: advanced</font>
+
+<a name="line1823">1823: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>()</font>
+<a name="line1824">1824: </a><font color="#B22222">@*/</font>
+<a name="line1825">1825: </a><strong><font color="#4169E1"><a name="PetscOptionsLeft"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A>(void)</font></strong>
+<a name="line1826">1826: </a>{
+<a name="line1828">1828: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
+
+<a name="line1831">1831: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;N; i++) {
+<a name="line1832">1832: </a>    <font color="#4169E1">if</font> (!options-&gt;used[i]) {
+<a name="line1833">1833: </a>      <font color="#4169E1">if</font> (options-&gt;values[i]) {
+<a name="line1834">1834: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"Option left: name:-%s value: %s\n"</font>,options-&gt;names[i],options-&gt;values[i]);
+<a name="line1835">1835: </a>      } <font color="#4169E1">else</font> {
+<a name="line1836">1836: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"Option left: name:-%s no value \n"</font>,options-&gt;names[i]);
+<a name="line1837">1837: </a>      }
+<a name="line1838">1838: </a>    }
+<a name="line1839">1839: </a>  }
+<a name="line1840">1840: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1841">1841: </a>}
+
+
+<a name="line1846">1846: </a><font color="#B22222">/*</font>
+<a name="line1847">1847: </a><font color="#B22222">    PetscOptionsCreate - Creates the empty options database.</font>
+
+<a name="line1849">1849: </a><font color="#B22222">*/</font>
+<a name="line1850">1850: </a><strong><font color="#4169E1"><a name="PetscOptionsCreate"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscOptionsCreate(void)</font></strong>
+<a name="line1851">1851: </a>{
+
+<a name="line1855">1855: </a>  options = (PetscOptionsTable*)malloc(<font color="#4169E1">sizeof</font>(PetscOptionsTable));
+<a name="line1856">1856: </a>  <A href="../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(options-&gt;used,MAXOPTIONS*<font color="#4169E1">sizeof</font>(<A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>));
+<a name="line1857">1857: </a>  options-&gt;namegiven                 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1858">1858: </a>  options-&gt;N                         = 0;
+<a name="line1859">1859: </a>  options-&gt;Naliases                  = 0;
+<a name="line1860">1860: </a>  options-&gt;numbermonitors         = 0;
+
+<a name="line1862">1862: </a>  PetscOptionsObject.prefix = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line1863">1863: </a>  PetscOptionsObject.title  = <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line1864">1864: </a>
+<a name="line1865">1865: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1866">1866: </a>}
+
+<a name="line1870">1870: </a><font color="#B22222">/*@</font>
+<a name="line1871">1871: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsSetFromOptions.html#PetscOptionsSetFromOptions">PetscOptionsSetFromOptions</A> - Sets various <A href="../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> and <A href="../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A> parameters from user options.</font>
+
+<a name="line1873">1873: </a><font color="#B22222">   Collective on <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A></font>
+
+<a name="line1875">1875: </a><font color="#B22222">   Options Database Keys:</font>
+<a name="line1876">1876: </a><font color="#B22222">+  -options_monitor &lt;optional filename&gt; - prints the names and values of all runtime options as they are set. The monitor functionality is not </font>
+<a name="line1877">1877: </a><font color="#B22222">                available for options set through a file, environment variable, or on </font>
+<a name="line1878">1878: </a><font color="#B22222">                the command line. Only options set after <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A> completes will </font>
+<a name="line1879">1879: </a><font color="#B22222">                be monitored.</font>
+<a name="line1880">1880: </a><font color="#B22222">.  -options_monitor_cancel - cancel all options database monitors    </font>
+
+<a name="line1882">1882: </a><font color="#B22222">   Notes:</font>
+<a name="line1883">1883: </a><font color="#B22222">   To see all options, run your program with the -help option or consult</font>
+<a name="line1884">1884: </a><font color="#B22222">   the users manual. </font>
+
+<a name="line1886">1886: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line1888">1888: </a><font color="#B22222">.keywords: set, options, database</font>
+<a name="line1889">1889: </a><font color="#B22222">@*/</font>
+<a name="line1890">1890: </a><strong><font color="#4169E1"><a name="PetscOptionsSetFromOptions"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsSetFromOptions.html#PetscOptionsSetFromOptions">PetscOptionsSetFromOptions</A>(void)</font></strong>
+<a name="line1891">1891: </a>{
+<a name="line1892">1892: </a>  <A href="../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>          flgc,flgm;
+<a name="line1893">1893: </a>  <A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>      ierr;
+<a name="line1894">1894: </a>  char                monfilename[PETSC_MAX_PATH_LEN];
+<a name="line1895">1895: </a>  <A href="../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>         monviewer;
+
+<a name="line1898">1898: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsBegin.html#PetscOptionsBegin">PetscOptionsBegin</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">""</font>,<font color="#666666">"Options database options"</font>,<font color="#666666">"PetscOptions"</font>);
+<a name="line1899">1899: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsString.html#PetscOptionsString">PetscOptionsString</A>(<font color="#666666">"-options_monitor"</font>,<font color="#666666">"Monitor options database"</font>,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>"</font>,<font color="#666666">"stdout"</font>,monfilename,PETSC_MAX_PATH_LEN,&amp;flgm);
+<a name="line1900">1900: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsName.html#PetscOptionsName">PetscOptionsName</A>(<font color="#666666">"-options_monitor_cancel"</font>,<font color="#666666">"Cancel all options database monitors"</font>,<font color="#666666">"<A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>"</font>,&amp;flgc);
+<a name="line1901">1901: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsEnd.html#PetscOptionsEnd">PetscOptionsEnd</A>();
+<a name="line1902">1902: </a>  <font color="#4169E1">if</font> (flgm) {
+<a name="line1903">1903: </a>    <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,monfilename,&amp;monviewer);
+<a name="line1904">1904: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(<A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>,monviewer,(<A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*)(void*))<A href="../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>);
+<a name="line1905">1905: </a>  }
+<a name="line1906">1906: </a>  <font color="#4169E1">if</font> (flgc) { <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>(); }
+<a name="line1907">1907: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1908">1908: </a>}
+
+
+<a name="line1913">1913: </a><font color="#B22222">/*@C</font>
+<a name="line1914">1914: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A> - Print all options set value events.</font>
+
+<a name="line1916">1916: </a><font color="#B22222">   Collective on <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A></font>
+
+<a name="line1918">1918: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1919">1919: </a><font color="#B22222">+  name  - option name string</font>
+<a name="line1920">1920: </a><font color="#B22222">.  value - option value string</font>
+<a name="line1921">1921: </a><font color="#B22222">-  dummy - unused monitor context </font>
+
+<a name="line1923">1923: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line1925">1925: </a><font color="#B22222">.keywords: PetscOptions, default, monitor</font>
+
+<a name="line1927">1927: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>()</font>
+<a name="line1928">1928: </a><font color="#B22222">@*/</font>
+<a name="line1929">1929: </a><strong><font color="#4169E1"><a name="PetscOptionsMonitorDefault"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>(const char name[], const char value[], void *dummy)</font></strong>
+<a name="line1930">1930: </a>{
+<a name="line1932">1932: </a>  <A href="../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>    viewer = (<A href="../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>) dummy;
+
+<a name="line1935">1935: </a>  <font color="#4169E1">if</font> (!viewer) {
+<a name="line1936">1936: </a>    <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIGetStdout.html#PetscViewerASCIIGetStdout">PetscViewerASCIIGetStdout</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,&amp;viewer);
+<a name="line1937">1937: </a>  }
+<a name="line1938">1938: </a>  <A href="../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"Setting option: %s = %s\n"</font>,name,value);
+<a name="line1939">1939: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1940">1940: </a>}
+
+<a name="line1944">1944: </a><font color="#B22222">/*@C</font>
+<a name="line1945">1945: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A> - Sets an ADDITIONAL function to be called at every method that</font>
+<a name="line1946">1946: </a><font color="#B22222">   modified the PETSc options database.</font>
+<a name="line1947">1947: </a><font color="#B22222">      </font>
+<a name="line1948">1948: </a><font color="#B22222">   Not collective</font>
+
+<a name="line1950">1950: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1951">1951: </a><font color="#B22222">+  monitor - pointer to function (if this is <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>, it turns off monitoring</font>
+<a name="line1952">1952: </a><font color="#B22222">.  mctx    - [optional] context for private data for the</font>
+<a name="line1953">1953: </a><font color="#B22222">             monitor routine (use <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A> if no context is desired)</font>
+<a name="line1954">1954: </a><font color="#B22222">-  monitordestroy - [optional] routine that frees monitor context</font>
+<a name="line1955">1955: </a><font color="#B22222">          (may be <A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>)</font>
+
+<a name="line1957">1957: </a><font color="#B22222">   Calling Sequence of monitor:</font>
+<a name="line1958">1958: </a><font color="#B22222">$     monitor (const char name[], const char value[], void *mctx)</font>
+
+<a name="line1960">1960: </a><font color="#B22222">+  name - option name string</font>
+<a name="line1961">1961: </a><font color="#B22222">.  value - option value string</font>
+<a name="line1962">1962: </a><font color="#B22222">-  mctx  - optional monitoring context, as set by <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>()</font>
+
+<a name="line1964">1964: </a><font color="#B22222">   Options Database Keys:</font>
+<a name="line1965">1965: </a><font color="#B22222">+    -options_monitor    - sets <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>()</font>
+<a name="line1966">1966: </a><font color="#B22222">-    -options_monitor_cancel - cancels all monitors that have</font>
+<a name="line1967">1967: </a><font color="#B22222">                          been hardwired into a code by </font>
+<a name="line1968">1968: </a><font color="#B22222">                          calls to <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(), but</font>
+<a name="line1969">1969: </a><font color="#B22222">                          does not cancel those set via</font>
+<a name="line1970">1970: </a><font color="#B22222">                          the options database.</font>
+
+<a name="line1972">1972: </a><font color="#B22222">   Notes:  </font>
+<a name="line1973">1973: </a><font color="#B22222">   The default is to do nothing.  To print the name and value of options </font>
+<a name="line1974">1974: </a><font color="#B22222">   being inserted into the database, use <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>() as the monitoring routine, </font>
+<a name="line1975">1975: </a><font color="#B22222">   with a null monitoring context. </font>
+
+<a name="line1977">1977: </a><font color="#B22222">   Several different monitoring routines may be set by calling</font>
+<a name="line1978">1978: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>() multiple times; all will be called in the </font>
+<a name="line1979">1979: </a><font color="#B22222">   order in which they were set.</font>
+
+<a name="line1981">1981: </a><font color="#B22222">   Level: beginner</font>
+
+<a name="line1983">1983: </a><font color="#B22222">.keywords: PetscOptions, set, monitor</font>
+
+<a name="line1985">1985: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>()</font>
+<a name="line1986">1986: </a><font color="#B22222">@*/</font>
+<a name="line1987">1987: </a><strong><font color="#4169E1"><a name="PetscOptionsMonitorSet"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(<A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitor)(const char name[], const char value[], void*),void *mctx,<A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> (*monitordestroy)(void*))</font></strong>
+<a name="line1988">1988: </a>{
+<a name="line1990">1990: </a>  <font color="#4169E1">if</font> (options-&gt;numbermonitors &gt;= MAXOPTIONSMONITORS) {
+<a name="line1991">1991: </a>    <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Too many PetscOptions monitors set"</font>);
+<a name="line1992">1992: </a>  }
+<a name="line1993">1993: </a>  options-&gt;monitor[options-&gt;numbermonitors]           = monitor;
+<a name="line1994">1994: </a>  options-&gt;monitordestroy[options-&gt;numbermonitors]    = monitordestroy;
+<a name="line1995">1995: </a>  options-&gt;monitorcontext[options-&gt;numbermonitors++]  = (void*)mctx;
+<a name="line1996">1996: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1997">1997: </a>}
+
+<a name="line2001">2001: </a><font color="#B22222">/*@</font>
+<a name="line2002">2002: </a><font color="#B22222">   <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A> - Clears all monitors for a PetscOptions object.</font>
+
+<a name="line2004">2004: </a><font color="#B22222">   Not collective </font>
+
+<a name="line2006">2006: </a><font color="#B22222">   Options Database Key:</font>
+<a name="line2007">2007: </a><font color="#B22222">.  -options_monitor_cancel - Cancels all monitors that have</font>
+<a name="line2008">2008: </a><font color="#B22222">    been hardwired into a code by calls to <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>(), </font>
+<a name="line2009">2009: </a><font color="#B22222">    but does not cancel those set via the options database.</font>
+
+<a name="line2011">2011: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line2013">2013: </a><font color="#B22222">.keywords: PetscOptions, set, monitor</font>
+
+<a name="line2015">2015: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorDefault.html#PetscOptionsMonitorDefault">PetscOptionsMonitorDefault</A>(), <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorSet.html#PetscOptionsMonitorSet">PetscOptionsMonitorSet</A>()</font>
+<a name="line2016">2016: </a><font color="#B22222">@*/</font>
+<a name="line2017">2017: </a><strong><font color="#4169E1"><a name="PetscOptionsMonitorCancel"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscOptionsMonitorCancel.html#PetscOptionsMonitorCancel">PetscOptionsMonitorCancel</A>(void)</font></strong>
+<a name="line2018">2018: </a>{
+<a name="line2020">2020: </a>  <A href="../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i;
+
+<a name="line2023">2023: </a>  <font color="#4169E1">for</font> (i=0; i&lt;options-&gt;numbermonitors; i++) {
+<a name="line2024">2024: </a>    <font color="#4169E1">if</font> (options-&gt;monitordestroy[i]) {
+<a name="line2025">2025: </a>      (*options-&gt;monitordestroy[i])(options-&gt;monitorcontext[i]);
+<a name="line2026">2026: </a>    }
+<a name="line2027">2027: </a>  }
+<a name="line2028">2028: </a>  options-&gt;numbermonitors = 0;
+<a name="line2029">2029: </a>  <font color="#4169E1">return</font>(0);
+<a name="line2030">2030: </a>}
 </pre>
 </body>
 
Index: petsc/src/sys/objects/pinit.c
===================================================================
--- petsc.orig/src/sys/objects/pinit.c
+++ petsc/src/sys/objects/pinit.c
@@ -844,7 +844,8 @@
   }
   flg1 = PETSC_FALSE;
   flg2 = PETSC_FALSE;
-  ierr = PetscOptionsGetTruth(PETSC_NULL,"-malloc_dump",&flg1,PETSC_NULL);CHKERRQ(ierr);
+  /* preemptive call to avoid listing this option in options table as unused */
+  ierr = PetscOptionsHasName(PETSC_NULL,"-malloc_dump",&flg1);CHKERRQ(ierr);
   ierr = PetscOptionsGetTruth(PETSC_NULL,"-options_table",&flg2,PETSC_NULL);CHKERRQ(ierr);
   if (flg2) {
     if (!rank) {ierr = PetscOptionsPrint(stdout);CHKERRQ(ierr);}
@@ -883,20 +884,14 @@
     }
   }
 
-  flg1 = PETSC_FALSE;
-  ierr = PetscOptionsGetTruth(PETSC_NULL,"-log_history",&flg1,PETSC_NULL);CHKERRQ(ierr);
-  if (flg1) {
+  if (petsc_history) {
     ierr = PetscLogCloseHistoryFile(&petsc_history);CHKERRQ(ierr);
     petsc_history = 0;
   }
 
   ierr = PetscInfoAllow(PETSC_FALSE,PETSC_NULL);CHKERRQ(ierr);
 
-  flg1 = PETSC_FALSE;
-  flg3 = PETSC_FALSE;
-  ierr = PetscOptionsGetTruth(PETSC_NULL,"-malloc_dump",&flg1,PETSC_NULL);CHKERRQ(ierr);
-  ierr = PetscOptionsGetTruth(PETSC_NULL,"-malloc_log",&flg3,PETSC_NULL);CHKERRQ(ierr);
-  if (flg1) {
+  {
     char fname[PETSC_MAX_PATH_LEN];
     FILE *fd;
     int  err;
@@ -911,7 +906,7 @@
       ierr = PetscMallocDump(fd);CHKERRQ(ierr);
       err = fclose(fd);
       if (err) SETERRQ(PETSC_ERR_SYS,"fclose() failed on file");    
-    } else {
+    } else if (flg1) {
       MPI_Comm local_comm;
 
       ierr = MPI_Comm_dup(MPI_COMM_WORLD,&local_comm);CHKERRQ(ierr);
@@ -921,7 +916,7 @@
       ierr = MPI_Comm_free(&local_comm);CHKERRQ(ierr);
     }
   }
-  if (flg3) {
+  {
     char fname[PETSC_MAX_PATH_LEN];
     FILE *fd;
     
@@ -936,7 +931,7 @@
       ierr = PetscMallocDumpLog(fd);CHKERRQ(ierr); 
       err = fclose(fd);
       if (err) SETERRQ(PETSC_ERR_SYS,"fclose() failed on file");    
-    } else {
+    } else if (flg1) {
       ierr = PetscMallocDumpLog(stdout);CHKERRQ(ierr); 
     }
   }
Index: petsc/src/sys/objects/pinit.c.html
===================================================================
--- petsc.orig/src/sys/objects/pinit.c.html
+++ petsc/src/sys/objects/pinit.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T01:29:24+00:00">
+<meta name="date" content="2011-03-17T18:43:07+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -772,234 +772,229 @@
 <a name="line844">844: </a>  }
 <a name="line845">845: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
 <a name="line846">846: </a>  flg2 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line847">847: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_dump"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line848">848: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-options_table"</font>,&amp;flg2,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line849">849: </a>  <font color="#4169E1">if</font> (flg2) {
-<a name="line850">850: </a>    <font color="#4169E1">if</font> (!rank) {<A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(stdout);}
-<a name="line851">851: </a>  }
-
-<a name="line853">853: </a>  <font color="#B22222">/* to prevent PETSc -options_left from warning */</font>
-<a name="line854">854: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-nox"</font>,&amp;flg1);<A href="../../../docs/manualpages/Sys/CHKERRQ.html#CHKERRQ">CHKERRQ</A>(ierr)
-<a name="line855">855: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-nox_warning"</font>,&amp;flg1);<A href="../../../docs/manualpages/Sys/CHKERRQ.html#CHKERRQ">CHKERRQ</A>(ierr)
-
-<a name="line857">857: </a>  <font color="#4169E1">if</font> (!PetscOpenMPWorker) { <font color="#B22222">/* worker processes skip this because they do not usually process options */</font>
-<a name="line858">858: </a>    flg3 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#B22222">/* default value is required */</font>
-<a name="line859">859: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-options_left"</font>,&amp;flg3,&amp;flg1);
-<a name="line860">860: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>(&amp;nopt);
-<a name="line861">861: </a>    <font color="#4169E1">if</font> (flg3) {
-<a name="line862">862: </a>      <font color="#4169E1">if</font> (!flg2) { <font color="#B22222">/* have not yet printed the options */</font>
-<a name="line863">863: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(stdout);
-<a name="line864">864: </a>      }
-<a name="line865">865: </a>      <font color="#4169E1">if</font> (!nopt) {
-<a name="line866">866: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"There are no unused options.\n"</font>);
-<a name="line867">867: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (nopt == 1) {
-<a name="line868">868: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"There is one unused database option. It is:\n"</font>);
-<a name="line869">869: </a>      } <font color="#4169E1">else</font> {
-<a name="line870">870: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"There are %d unused database options. They are:\n"</font>,nopt);
-<a name="line871">871: </a>      }
-<a name="line872">872: </a>    }
-<a name="line873">873: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line874">874: </a>    <font color="#4169E1">if</font> (nopt &amp;&amp; !flg3 &amp;&amp; !flg1) {
-<a name="line875">875: </a>      <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"WARNING! There are options you set that were not used!\n"</font>);
-<a name="line876">876: </a>      <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"WARNING! could be spelling mistake, etc!\n"</font>);
-<a name="line877">877: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A>();
-<a name="line878">878: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (nopt &amp;&amp; flg3) {
-<a name="line879">879: </a><font color="#A020F0">#else </font>
-<a name="line880">880: </a>    <font color="#4169E1">if</font> (nopt &amp;&amp; flg3) {
-<a name="line881">881: </a><font color="#A020F0">#endif</font>
-<a name="line882">882: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A>();
-<a name="line883">883: </a>    }
-<a name="line884">884: </a>  }
-
-<a name="line886">886: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line887">887: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-log_history"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line888">888: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line889">889: </a>    PetscLogCloseHistoryFile(&amp;petsc_history);
-<a name="line890">890: </a>    petsc_history = 0;
-<a name="line891">891: </a>  }
-
-<a name="line893">893: </a>  <A href="../../../docs/manualpages/Profiling/PetscInfoAllow.html#PetscInfoAllow">PetscInfoAllow</A>(<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-
-<a name="line895">895: </a>  flg1 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line896">896: </a>  flg3 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line897">897: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_dump"</font>,&amp;flg1,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line898">898: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_log"</font>,&amp;flg3,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line899">899: </a>  <font color="#4169E1">if</font> (flg1) {
-<a name="line900">900: </a>    char fname[PETSC_MAX_PATH_LEN];
-<a name="line901">901: </a>    FILE *fd;
-<a name="line902">902: </a>    int  err;
-
-<a name="line904">904: </a>    fname[0] = 0;
-<a name="line905">905: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_dump"</font>,fname,250,&amp;flg1);
-<a name="line906">906: </a>    <font color="#4169E1">if</font> (flg1 &amp;&amp; fname[0]) {
-<a name="line907">907: </a>      char sname[PETSC_MAX_PATH_LEN];
-
-<a name="line909">909: </a>      sprintf(sname,<font color="#666666">"%s_%d"</font>,fname,rank);
-<a name="line910">910: </a>      fd   = fopen(sname,<font color="#666666">"w"</font>); <font color="#4169E1">if</font> (!fd) <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Cannot open log file: %s"</font>,sname);
-<a name="line911">911: </a>      <A href="../../../docs/manualpages/Sys/PetscMallocDump.html#PetscMallocDump">PetscMallocDump</A>(fd);
-<a name="line912">912: </a>      err = fclose(fd);
-<a name="line913">913: </a>      <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fclose() failed on file"</font>);
-<a name="line914">914: </a>    } <font color="#4169E1">else</font> {
-<a name="line915">915: </a>      <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> local_comm;
-
-<a name="line917">917: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_dup.html#MPI_Comm_dup">MPI_Comm_dup</A>(MPI_COMM_WORLD,&amp;local_comm);
-<a name="line918">918: </a>      PetscSequentialPhaseBegin_Private(local_comm,1);
-<a name="line919">919: </a>        <A href="../../../docs/manualpages/Sys/PetscMallocDump.html#PetscMallocDump">PetscMallocDump</A>(stdout);
-<a name="line920">920: </a>      PetscSequentialPhaseEnd_Private(local_comm,1);
-<a name="line921">921: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_free.html#MPI_Comm_free">MPI_Comm_free</A>(&amp;local_comm);
-<a name="line922">922: </a>    }
-<a name="line923">923: </a>  }
-<a name="line924">924: </a>  <font color="#4169E1">if</font> (flg3) {
-<a name="line925">925: </a>    char fname[PETSC_MAX_PATH_LEN];
-<a name="line926">926: </a>    FILE *fd;
-<a name="line927">927: </a>
-<a name="line928">928: </a>    fname[0] = 0;
-<a name="line929">929: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_log"</font>,fname,250,&amp;flg1);
-<a name="line930">930: </a>    <font color="#4169E1">if</font> (flg1 &amp;&amp; fname[0]) {
-<a name="line931">931: </a>      char sname[PETSC_MAX_PATH_LEN];
-<a name="line932">932: </a>      int  err;
-
-<a name="line934">934: </a>      sprintf(sname,<font color="#666666">"%s_%d"</font>,fname,rank);
-<a name="line935">935: </a>      fd   = fopen(sname,<font color="#666666">"w"</font>); <font color="#4169E1">if</font> (!fd) <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Cannot open log file: %s"</font>,sname);
-<a name="line936">936: </a>      <A href="../../../docs/manualpages/Sys/PetscMallocDumpLog.html#PetscMallocDumpLog">PetscMallocDumpLog</A>(fd);
-<a name="line937">937: </a>      err = fclose(fd);
-<a name="line938">938: </a>      <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fclose() failed on file"</font>);
-<a name="line939">939: </a>    } <font color="#4169E1">else</font> {
-<a name="line940">940: </a>      <A href="../../../docs/manualpages/Sys/PetscMallocDumpLog.html#PetscMallocDumpLog">PetscMallocDumpLog</A>(stdout);
-<a name="line941">941: </a>    }
-<a name="line942">942: </a>  }
-<a name="line943">943: </a>  <font color="#B22222">/* Can be destroyed only after all the options are used */</font>
-<a name="line944">944: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A>();
-
-<a name="line946">946: </a>  PetscGlobalArgc = 0;
-<a name="line947">947: </a>  PetscGlobalArgs = 0;
-
-<a name="line949">949: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
-<a name="line950">950: </a><font color="#A020F0">#if !defined(PETSC_HAVE_MPI_C_DOUBLE_COMPLEX)</font>
-<a name="line951">951: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;MPIU_SUM);
-<a name="line952">952: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPI_C_DOUBLE_COMPLEX);
-<a name="line953">953: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPI_C_COMPLEX);
-<a name="line954">954: </a><font color="#A020F0">#endif</font>
-<a name="line955">955: </a><font color="#A020F0">#endif</font>
-<a name="line956">956: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPIU_2SCALAR);
-<a name="line957">957: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPIU_2INT);
-<a name="line958">958: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;PetscMaxSum_Op);
-<a name="line959">959: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;PetscADMax_Op);
-<a name="line960">960: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;PetscADMin_Op);
-
-<a name="line962">962: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Keyval_free.html#MPI_Keyval_free">MPI_Keyval_free</A>(&amp;Petsc_Counter_keyval);
-<a name="line963">963: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Keyval_free.html#MPI_Keyval_free">MPI_Keyval_free</A>(&amp;Petsc_InnerComm_keyval);
-<a name="line964">964: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Keyval_free.html#MPI_Keyval_free">MPI_Keyval_free</A>(&amp;Petsc_OuterComm_keyval);
-
-<a name="line966">966: </a>  <A href="../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(0,<font color="#666666">"PETSc successfully ended!\n"</font>);
-<a name="line967">967: </a>  <font color="#4169E1">if</font> (PetscBeganMPI) {
-<a name="line968">968: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_FINALIZED)</font>
-<a name="line969">969: </a>    <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> flag;
-<a name="line970">970: </a>    MPI_Finalized(&amp;flag);
-<a name="line971">971: </a>    <font color="#4169E1">if</font> (flag) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_LIB,<font color="#666666">"<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Finalize.html#MPI_Finalize">MPI_Finalize</A>() has already been called, even though <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Init.html#MPI_Init">MPI_Init</A>() was called by <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>()"</font>);
-<a name="line972">972: </a><font color="#A020F0">#endif</font>
-<a name="line973">973: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Finalize.html#MPI_Finalize">MPI_Finalize</A>();
-<a name="line974">974: </a>  }
-
-<a name="line976">976: </a>  <font color="#4169E1">if</font>(PETSC_ZOPEFD != NULL){
-<a name="line977">977: </a>    <font color="#4169E1">if</font> (PETSC_ZOPEFD != PETSC_STDOUT) fprintf(PETSC_ZOPEFD, <font color="#666666">"&lt;&lt;&lt;end&gt;&gt;&gt;"</font>);
-<a name="line978">978: </a>    <font color="#4169E1">else</font> fprintf(PETSC_STDOUT, <font color="#666666">"&lt;&lt;&lt;end&gt;&gt;&gt;"</font>);}
-
-<a name="line980">980: </a><font color="#B22222">/*</font>
-
-<a name="line982">982: </a><font color="#B22222">     Note: In certain cases <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A> is never <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_free.html#MPI_Comm_free">MPI_Comm_free</A>()ed because </font>
-<a name="line983">983: </a><font color="#B22222">   the communicator has some outstanding requests on it. Specifically if the </font>
-<a name="line984">984: </a><font color="#B22222">   flag PETSC_HAVE_BROKEN_REQUEST_FREE is set (for IBM MPI implementation). See </font>
-<a name="line985">985: </a><font color="#B22222">   src/vec/utils/vpscat.c. Due to this the memory allocated in <A href="../../../docs/manualpages/Sys/PetscCommDuplicate.html#PetscCommDuplicate">PetscCommDuplicate</A>()</font>
-<a name="line986">986: </a><font color="#B22222">   is never freed as it should be. Thus one may obtain messages of the form</font>
-<a name="line987">987: </a><font color="#B22222">   [ 1] 8 bytes <A href="../../../docs/manualpages/Sys/PetscCommDuplicate.html#PetscCommDuplicate">PetscCommDuplicate</A>() line 645 in src/sys/mpiu.c indicating the</font>
-<a name="line988">988: </a><font color="#B22222">   memory was not freed.</font>
-
-<a name="line990">990: </a><font color="#B22222">*/</font>
-<a name="line991">991: </a>  <A href="../../../docs/manualpages/Sys/PetscMallocClear.html#PetscMallocClear">PetscMallocClear</A>();
-<a name="line992">992: </a>  PetscInitializeCalled = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line993">993: </a>  PetscFinalizeCalled   = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line994">994: </a>  <A href="../../../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>(ierr);
-<a name="line995">995: </a>}
-
-<a name="line997">997: </a><font color="#B22222">/*</font>
-<a name="line998">998: </a><font color="#B22222">     These may be used in code that ADIC is to be used on</font>
-<a name="line999">999: </a><font color="#B22222">*/</font>
-
-<a name="line1003">1003: </a><font color="#B22222">/*@</font>
-<a name="line1004">1004: </a><font color="#B22222">      <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A> - Computes the maximum value over several processors</font>
-
-<a name="line1006">1006: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line1008">1008: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1009">1009: </a><font color="#B22222">+   local - the local value</font>
-<a name="line1010">1010: </a><font color="#B22222">-   comm - the processors that find the maximum</font>
-
-<a name="line1012">1012: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1013">1013: </a><font color="#B22222">.   result - the maximum value</font>
-<a name="line1014">1014: </a><font color="#B22222">  </font>
-<a name="line1015">1015: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line1017">1017: </a><font color="#B22222">   Notes:</font>
-<a name="line1018">1018: </a><font color="#B22222">     These functions are to be used inside user functions that are to be processed with </font>
-<a name="line1019">1019: </a><font color="#B22222">   ADIC. PETSc will automatically provide differentiated versions of these functions</font>
-
-<a name="line1021">1021: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A>(), <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A>()</font>
-<a name="line1022">1022: </a><font color="#B22222">@*/</font>
-<a name="line1023">1023: </a><strong><font color="#4169E1"><a name="PetscGlobalMax"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A>(<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* local,<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* result,<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
-<a name="line1024">1024: </a>{
-<a name="line1025">1025: </a>  <font color="#4169E1">return</font> <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(local,result,1,MPIU_REAL,MPI_MAX,comm);
-<a name="line1026">1026: </a>}
-
-<a name="line1030">1030: </a><font color="#B22222">/*@</font>
-<a name="line1031">1031: </a><font color="#B22222">      <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A> - Computes the minimum value over several processors</font>
-
-<a name="line1033">1033: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line1035">1035: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1036">1036: </a><font color="#B22222">+   local - the local value</font>
-<a name="line1037">1037: </a><font color="#B22222">-   comm - the processors that find the minimum</font>
-
-<a name="line1039">1039: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1040">1040: </a><font color="#B22222">.   result - the minimum value</font>
-<a name="line1041">1041: </a><font color="#B22222">  </font>
-<a name="line1042">1042: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line1044">1044: </a><font color="#B22222">   Notes:</font>
-<a name="line1045">1045: </a><font color="#B22222">     These functions are to be used inside user functions that are to be processed with </font>
-<a name="line1046">1046: </a><font color="#B22222">   ADIC. PETSc will automatically provide differentiated versions of these functions</font>
-
-<a name="line1048">1048: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A>(), <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A>()</font>
-<a name="line1049">1049: </a><font color="#B22222">@*/</font>
-<a name="line1050">1050: </a><strong><font color="#4169E1"><a name="PetscGlobalMin"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A>(<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* local,<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* result,<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
-<a name="line1051">1051: </a>{
-<a name="line1052">1052: </a>  <font color="#4169E1">return</font> <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(local,result,1,MPIU_REAL,MPI_MIN,comm);
-<a name="line1053">1053: </a>}
-
-<a name="line1057">1057: </a><font color="#B22222">/*@</font>
-<a name="line1058">1058: </a><font color="#B22222">      <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A> - Computes the sum over sever processors</font>
-
-<a name="line1060">1060: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line1062">1062: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1063">1063: </a><font color="#B22222">+   local - the local value</font>
-<a name="line1064">1064: </a><font color="#B22222">-   comm - the processors that find the sum</font>
-
-<a name="line1066">1066: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line1067">1067: </a><font color="#B22222">.   result - the sum</font>
-<a name="line1068">1068: </a><font color="#B22222">  </font>
-<a name="line1069">1069: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line1071">1071: </a><font color="#B22222">   Notes:</font>
-<a name="line1072">1072: </a><font color="#B22222">     These functions are to be used inside user functions that are to be processed with </font>
-<a name="line1073">1073: </a><font color="#B22222">   ADIC. PETSc will automatically provide differentiated versions of these functions</font>
-
-<a name="line1075">1075: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A>(), <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A>()</font>
-<a name="line1076">1076: </a><font color="#B22222">@*/</font>
-<a name="line1077">1077: </a><strong><font color="#4169E1"><a name="PetscGlobalSum"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A>(<A href="../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>* local,<A href="../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>* result,<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
-<a name="line1078">1078: </a>{
-<a name="line1079">1079: </a>  <font color="#4169E1">return</font> <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(local,result,1,<A href="../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,MPIU_SUM,comm);
-<a name="line1080">1080: </a>}
+<a name="line847">847: </a>  <font color="#B22222">/* preemptive call to avoid listing this option in options table as unused */</font>
+<a name="line848">848: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_dump"</font>,&amp;flg1);
+<a name="line849">849: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-options_table"</font>,&amp;flg2,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line850">850: </a>  <font color="#4169E1">if</font> (flg2) {
+<a name="line851">851: </a>    <font color="#4169E1">if</font> (!rank) {<A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(stdout);}
+<a name="line852">852: </a>  }
+
+<a name="line854">854: </a>  <font color="#B22222">/* to prevent PETSc -options_left from warning */</font>
+<a name="line855">855: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-nox"</font>,&amp;flg1);<A href="../../../docs/manualpages/Sys/CHKERRQ.html#CHKERRQ">CHKERRQ</A>(ierr)
+<a name="line856">856: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsHasName.html#PetscOptionsHasName">PetscOptionsHasName</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-nox_warning"</font>,&amp;flg1);<A href="../../../docs/manualpages/Sys/CHKERRQ.html#CHKERRQ">CHKERRQ</A>(ierr)
+
+<a name="line858">858: </a>  <font color="#4169E1">if</font> (!PetscOpenMPWorker) { <font color="#B22222">/* worker processes skip this because they do not usually process options */</font>
+<a name="line859">859: </a>    flg3 = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>; <font color="#B22222">/* default value is required */</font>
+<a name="line860">860: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-options_left"</font>,&amp;flg3,&amp;flg1);
+<a name="line861">861: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsAllUsed.html#PetscOptionsAllUsed">PetscOptionsAllUsed</A>(&amp;nopt);
+<a name="line862">862: </a>    <font color="#4169E1">if</font> (flg3) {
+<a name="line863">863: </a>      <font color="#4169E1">if</font> (!flg2) { <font color="#B22222">/* have not yet printed the options */</font>
+<a name="line864">864: </a>        <A href="../../../docs/manualpages/Sys/PetscOptionsPrint.html#PetscOptionsPrint">PetscOptionsPrint</A>(stdout);
+<a name="line865">865: </a>      }
+<a name="line866">866: </a>      <font color="#4169E1">if</font> (!nopt) {
+<a name="line867">867: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"There are no unused options.\n"</font>);
+<a name="line868">868: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (nopt == 1) {
+<a name="line869">869: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"There is one unused database option. It is:\n"</font>);
+<a name="line870">870: </a>      } <font color="#4169E1">else</font> {
+<a name="line871">871: </a>        <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"There are %d unused database options. They are:\n"</font>,nopt);
+<a name="line872">872: </a>      }
+<a name="line873">873: </a>    }
+<a name="line874">874: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line875">875: </a>    <font color="#4169E1">if</font> (nopt &amp;&amp; !flg3 &amp;&amp; !flg1) {
+<a name="line876">876: </a>      <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"WARNING! There are options you set that were not used!\n"</font>);
+<a name="line877">877: </a>      <A href="../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"WARNING! could be spelling mistake, etc!\n"</font>);
+<a name="line878">878: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A>();
+<a name="line879">879: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (nopt &amp;&amp; flg3) {
+<a name="line880">880: </a><font color="#A020F0">#else </font>
+<a name="line881">881: </a>    <font color="#4169E1">if</font> (nopt &amp;&amp; flg3) {
+<a name="line882">882: </a><font color="#A020F0">#endif</font>
+<a name="line883">883: </a>      <A href="../../../docs/manualpages/Sys/PetscOptionsLeft.html#PetscOptionsLeft">PetscOptionsLeft</A>();
+<a name="line884">884: </a>    }
+<a name="line885">885: </a>  }
+
+<a name="line887">887: </a>  <font color="#4169E1">if</font> (petsc_history) {
+<a name="line888">888: </a>    PetscLogCloseHistoryFile(&amp;petsc_history);
+<a name="line889">889: </a>    petsc_history = 0;
+<a name="line890">890: </a>  }
+
+<a name="line892">892: </a>  <A href="../../../docs/manualpages/Profiling/PetscInfoAllow.html#PetscInfoAllow">PetscInfoAllow</A>(<A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>,<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+
+<a name="line894">894: </a>  {
+<a name="line895">895: </a>    char fname[PETSC_MAX_PATH_LEN];
+<a name="line896">896: </a>    FILE *fd;
+<a name="line897">897: </a>    int  err;
+
+<a name="line899">899: </a>    fname[0] = 0;
+<a name="line900">900: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_dump"</font>,fname,250,&amp;flg1);
+<a name="line901">901: </a>    <font color="#4169E1">if</font> (flg1 &amp;&amp; fname[0]) {
+<a name="line902">902: </a>      char sname[PETSC_MAX_PATH_LEN];
+
+<a name="line904">904: </a>      sprintf(sname,<font color="#666666">"%s_%d"</font>,fname,rank);
+<a name="line905">905: </a>      fd   = fopen(sname,<font color="#666666">"w"</font>); <font color="#4169E1">if</font> (!fd) <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Cannot open log file: %s"</font>,sname);
+<a name="line906">906: </a>      <A href="../../../docs/manualpages/Sys/PetscMallocDump.html#PetscMallocDump">PetscMallocDump</A>(fd);
+<a name="line907">907: </a>      err = fclose(fd);
+<a name="line908">908: </a>      <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fclose() failed on file"</font>);
+<a name="line909">909: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg1) {
+<a name="line910">910: </a>      <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> local_comm;
+
+<a name="line912">912: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_dup.html#MPI_Comm_dup">MPI_Comm_dup</A>(MPI_COMM_WORLD,&amp;local_comm);
+<a name="line913">913: </a>      PetscSequentialPhaseBegin_Private(local_comm,1);
+<a name="line914">914: </a>        <A href="../../../docs/manualpages/Sys/PetscMallocDump.html#PetscMallocDump">PetscMallocDump</A>(stdout);
+<a name="line915">915: </a>      PetscSequentialPhaseEnd_Private(local_comm,1);
+<a name="line916">916: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_free.html#MPI_Comm_free">MPI_Comm_free</A>(&amp;local_comm);
+<a name="line917">917: </a>    }
+<a name="line918">918: </a>  }
+<a name="line919">919: </a>  {
+<a name="line920">920: </a>    char fname[PETSC_MAX_PATH_LEN];
+<a name="line921">921: </a>    FILE *fd;
+<a name="line922">922: </a>
+<a name="line923">923: </a>    fname[0] = 0;
+<a name="line924">924: </a>    <A href="../../../docs/manualpages/Sys/PetscOptionsGetString.html#PetscOptionsGetString">PetscOptionsGetString</A>(<A href="../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-malloc_log"</font>,fname,250,&amp;flg1);
+<a name="line925">925: </a>    <font color="#4169E1">if</font> (flg1 &amp;&amp; fname[0]) {
+<a name="line926">926: </a>      char sname[PETSC_MAX_PATH_LEN];
+<a name="line927">927: </a>      int  err;
+
+<a name="line929">929: </a>      sprintf(sname,<font color="#666666">"%s_%d"</font>,fname,rank);
+<a name="line930">930: </a>      fd   = fopen(sname,<font color="#666666">"w"</font>); <font color="#4169E1">if</font> (!fd) <A href="../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Cannot open log file: %s"</font>,sname);
+<a name="line931">931: </a>      <A href="../../../docs/manualpages/Sys/PetscMallocDumpLog.html#PetscMallocDumpLog">PetscMallocDumpLog</A>(fd);
+<a name="line932">932: </a>      err = fclose(fd);
+<a name="line933">933: </a>      <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fclose() failed on file"</font>);
+<a name="line934">934: </a>    } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (flg1) {
+<a name="line935">935: </a>      <A href="../../../docs/manualpages/Sys/PetscMallocDumpLog.html#PetscMallocDumpLog">PetscMallocDumpLog</A>(stdout);
+<a name="line936">936: </a>    }
+<a name="line937">937: </a>  }
+<a name="line938">938: </a>  <font color="#B22222">/* Can be destroyed only after all the options are used */</font>
+<a name="line939">939: </a>  <A href="../../../docs/manualpages/Sys/PetscOptionsDestroy.html#PetscOptionsDestroy">PetscOptionsDestroy</A>();
+
+<a name="line941">941: </a>  PetscGlobalArgc = 0;
+<a name="line942">942: </a>  PetscGlobalArgs = 0;
+
+<a name="line944">944: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
+<a name="line945">945: </a><font color="#A020F0">#if !defined(PETSC_HAVE_MPI_C_DOUBLE_COMPLEX)</font>
+<a name="line946">946: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;MPIU_SUM);
+<a name="line947">947: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPI_C_DOUBLE_COMPLEX);
+<a name="line948">948: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPI_C_COMPLEX);
+<a name="line949">949: </a><font color="#A020F0">#endif</font>
+<a name="line950">950: </a><font color="#A020F0">#endif</font>
+<a name="line951">951: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPIU_2SCALAR);
+<a name="line952">952: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;MPIU_2INT);
+<a name="line953">953: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;PetscMaxSum_Op);
+<a name="line954">954: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;PetscADMax_Op);
+<a name="line955">955: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Op_free.html#MPI_Op_free">MPI_Op_free</A>(&amp;PetscADMin_Op);
+
+<a name="line957">957: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Keyval_free.html#MPI_Keyval_free">MPI_Keyval_free</A>(&amp;Petsc_Counter_keyval);
+<a name="line958">958: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Keyval_free.html#MPI_Keyval_free">MPI_Keyval_free</A>(&amp;Petsc_InnerComm_keyval);
+<a name="line959">959: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Keyval_free.html#MPI_Keyval_free">MPI_Keyval_free</A>(&amp;Petsc_OuterComm_keyval);
+
+<a name="line961">961: </a>  <A href="../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(0,<font color="#666666">"PETSc successfully ended!\n"</font>);
+<a name="line962">962: </a>  <font color="#4169E1">if</font> (PetscBeganMPI) {
+<a name="line963">963: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_FINALIZED)</font>
+<a name="line964">964: </a>    <A href="../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> flag;
+<a name="line965">965: </a>    MPI_Finalized(&amp;flag);
+<a name="line966">966: </a>    <font color="#4169E1">if</font> (flag) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_LIB,<font color="#666666">"<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Finalize.html#MPI_Finalize">MPI_Finalize</A>() has already been called, even though <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Init.html#MPI_Init">MPI_Init</A>() was called by <A href="../../../docs/manualpages/Sys/PetscInitialize.html#PetscInitialize">PetscInitialize</A>()"</font>);
+<a name="line967">967: </a><font color="#A020F0">#endif</font>
+<a name="line968">968: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Finalize.html#MPI_Finalize">MPI_Finalize</A>();
+<a name="line969">969: </a>  }
+
+<a name="line971">971: </a>  <font color="#4169E1">if</font>(PETSC_ZOPEFD != NULL){
+<a name="line972">972: </a>    <font color="#4169E1">if</font> (PETSC_ZOPEFD != PETSC_STDOUT) fprintf(PETSC_ZOPEFD, <font color="#666666">"&lt;&lt;&lt;end&gt;&gt;&gt;"</font>);
+<a name="line973">973: </a>    <font color="#4169E1">else</font> fprintf(PETSC_STDOUT, <font color="#666666">"&lt;&lt;&lt;end&gt;&gt;&gt;"</font>);}
+
+<a name="line975">975: </a><font color="#B22222">/*</font>
+
+<a name="line977">977: </a><font color="#B22222">     Note: In certain cases <A href="../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A> is never <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_free.html#MPI_Comm_free">MPI_Comm_free</A>()ed because </font>
+<a name="line978">978: </a><font color="#B22222">   the communicator has some outstanding requests on it. Specifically if the </font>
+<a name="line979">979: </a><font color="#B22222">   flag PETSC_HAVE_BROKEN_REQUEST_FREE is set (for IBM MPI implementation). See </font>
+<a name="line980">980: </a><font color="#B22222">   src/vec/utils/vpscat.c. Due to this the memory allocated in <A href="../../../docs/manualpages/Sys/PetscCommDuplicate.html#PetscCommDuplicate">PetscCommDuplicate</A>()</font>
+<a name="line981">981: </a><font color="#B22222">   is never freed as it should be. Thus one may obtain messages of the form</font>
+<a name="line982">982: </a><font color="#B22222">   [ 1] 8 bytes <A href="../../../docs/manualpages/Sys/PetscCommDuplicate.html#PetscCommDuplicate">PetscCommDuplicate</A>() line 645 in src/sys/mpiu.c indicating the</font>
+<a name="line983">983: </a><font color="#B22222">   memory was not freed.</font>
+
+<a name="line985">985: </a><font color="#B22222">*/</font>
+<a name="line986">986: </a>  <A href="../../../docs/manualpages/Sys/PetscMallocClear.html#PetscMallocClear">PetscMallocClear</A>();
+<a name="line987">987: </a>  PetscInitializeCalled = <A href="../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line988">988: </a>  PetscFinalizeCalled   = <A href="../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line989">989: </a>  <A href="../../../docs/manualpages/Sys/PetscFunctionReturn.html#PetscFunctionReturn">PetscFunctionReturn</A>(ierr);
+<a name="line990">990: </a>}
+
+<a name="line992">992: </a><font color="#B22222">/*</font>
+<a name="line993">993: </a><font color="#B22222">     These may be used in code that ADIC is to be used on</font>
+<a name="line994">994: </a><font color="#B22222">*/</font>
+
+<a name="line998">998: </a><font color="#B22222">/*@</font>
+<a name="line999">999: </a><font color="#B22222">      <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A> - Computes the maximum value over several processors</font>
+
+<a name="line1001">1001: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line1003">1003: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1004">1004: </a><font color="#B22222">+   local - the local value</font>
+<a name="line1005">1005: </a><font color="#B22222">-   comm - the processors that find the maximum</font>
+
+<a name="line1007">1007: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1008">1008: </a><font color="#B22222">.   result - the maximum value</font>
+<a name="line1009">1009: </a><font color="#B22222">  </font>
+<a name="line1010">1010: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line1012">1012: </a><font color="#B22222">   Notes:</font>
+<a name="line1013">1013: </a><font color="#B22222">     These functions are to be used inside user functions that are to be processed with </font>
+<a name="line1014">1014: </a><font color="#B22222">   ADIC. PETSc will automatically provide differentiated versions of these functions</font>
+
+<a name="line1016">1016: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A>(), <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A>()</font>
+<a name="line1017">1017: </a><font color="#B22222">@*/</font>
+<a name="line1018">1018: </a><strong><font color="#4169E1"><a name="PetscGlobalMax"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A>(<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* local,<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* result,<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
+<a name="line1019">1019: </a>{
+<a name="line1020">1020: </a>  <font color="#4169E1">return</font> <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(local,result,1,MPIU_REAL,MPI_MAX,comm);
+<a name="line1021">1021: </a>}
+
+<a name="line1025">1025: </a><font color="#B22222">/*@</font>
+<a name="line1026">1026: </a><font color="#B22222">      <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A> - Computes the minimum value over several processors</font>
+
+<a name="line1028">1028: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line1030">1030: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1031">1031: </a><font color="#B22222">+   local - the local value</font>
+<a name="line1032">1032: </a><font color="#B22222">-   comm - the processors that find the minimum</font>
+
+<a name="line1034">1034: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1035">1035: </a><font color="#B22222">.   result - the minimum value</font>
+<a name="line1036">1036: </a><font color="#B22222">  </font>
+<a name="line1037">1037: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line1039">1039: </a><font color="#B22222">   Notes:</font>
+<a name="line1040">1040: </a><font color="#B22222">     These functions are to be used inside user functions that are to be processed with </font>
+<a name="line1041">1041: </a><font color="#B22222">   ADIC. PETSc will automatically provide differentiated versions of these functions</font>
+
+<a name="line1043">1043: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A>(), <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A>()</font>
+<a name="line1044">1044: </a><font color="#B22222">@*/</font>
+<a name="line1045">1045: </a><strong><font color="#4169E1"><a name="PetscGlobalMin"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A>(<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* local,<A href="../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* result,<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
+<a name="line1046">1046: </a>{
+<a name="line1047">1047: </a>  <font color="#4169E1">return</font> <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(local,result,1,MPIU_REAL,MPI_MIN,comm);
+<a name="line1048">1048: </a>}
+
+<a name="line1052">1052: </a><font color="#B22222">/*@</font>
+<a name="line1053">1053: </a><font color="#B22222">      <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A> - Computes the sum over sever processors</font>
+
+<a name="line1055">1055: </a><font color="#B22222">     Collective on <A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line1057">1057: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1058">1058: </a><font color="#B22222">+   local - the local value</font>
+<a name="line1059">1059: </a><font color="#B22222">-   comm - the processors that find the sum</font>
+
+<a name="line1061">1061: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line1062">1062: </a><font color="#B22222">.   result - the sum</font>
+<a name="line1063">1063: </a><font color="#B22222">  </font>
+<a name="line1064">1064: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line1066">1066: </a><font color="#B22222">   Notes:</font>
+<a name="line1067">1067: </a><font color="#B22222">     These functions are to be used inside user functions that are to be processed with </font>
+<a name="line1068">1068: </a><font color="#B22222">   ADIC. PETSc will automatically provide differentiated versions of these functions</font>
+
+<a name="line1070">1070: </a><font color="#B22222">.seealso: <A href="../../../docs/manualpages/Sys/PetscGlobalMin.html#PetscGlobalMin">PetscGlobalMin</A>(), <A href="../../../docs/manualpages/Sys/PetscGlobalMax.html#PetscGlobalMax">PetscGlobalMax</A>()</font>
+<a name="line1071">1071: </a><font color="#B22222">@*/</font>
+<a name="line1072">1072: </a><strong><font color="#4169E1"><a name="PetscGlobalSum"></a><A href="../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../docs/manualpages/Sys/PetscGlobalSum.html#PetscGlobalSum">PetscGlobalSum</A>(<A href="../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>* local,<A href="../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>* result,<A href="../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm)</font></strong>
+<a name="line1073">1073: </a>{
+<a name="line1074">1074: </a>  <font color="#4169E1">return</font> <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(local,result,1,<A href="../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,MPIU_SUM,comm);
+<a name="line1075">1075: </a>}
 
 
 </pre>
Index: petsc/src/sys/verbose/verboseinfo.c
===================================================================
--- petsc.orig/src/sys/verbose/verboseinfo.c
+++ petsc/src/sys/verbose/verboseinfo.c
@@ -208,6 +208,7 @@
   err = fflush(PetscInfoFile);
   if (err) SETERRQ(PETSC_ERR_SYS,"fflush() failed on file");        
   if (petsc_history) {
+    va_start(Argp, message);
     (*PetscVFPrintf)(petsc_history, message, Argp);CHKERRQ(ierr);
   }
   va_end(Argp);
Index: petsc/src/sys/verbose/verboseinfo.c.html
===================================================================
--- petsc.orig/src/sys/verbose/verboseinfo.c.html
+++ petsc/src/sys/verbose/verboseinfo.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T01:31:17+00:00">
+<meta name="date" content="2011-03-17T18:44:54+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -201,11 +201,12 @@
 <a name="line208">208: </a>  err = fflush(PetscInfoFile);
 <a name="line209">209: </a>  <font color="#4169E1">if</font> (err) <A href="../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
 <a name="line210">210: </a>  <font color="#4169E1">if</font> (petsc_history) {
-<a name="line211">211: </a>    (*PetscVFPrintf)(petsc_history, message, Argp);
-<a name="line212">212: </a>  }
-<a name="line213">213: </a>  va_end(Argp);
-<a name="line214">214: </a>  <font color="#4169E1">return</font>(0);
-<a name="line215">215: </a>}
+<a name="line211">211: </a>    va_start(Argp, message);
+<a name="line212">212: </a>    (*PetscVFPrintf)(petsc_history, message, Argp);
+<a name="line213">213: </a>  }
+<a name="line214">214: </a>  va_end(Argp);
+<a name="line215">215: </a>  <font color="#4169E1">return</font>(0);
+<a name="line216">216: </a>}
 </pre>
 </body>
 
Index: petsc/src/sys/viewer/impls/ascii/filev.c
===================================================================
--- petsc.orig/src/sys/viewer/impls/ascii/filev.c
+++ petsc/src/sys/viewer/impls/ascii/filev.c
@@ -428,6 +428,7 @@
     err = fflush(fd);
     if (err) SETERRQ(PETSC_ERR_SYS,"fflush() failed on file");        
     if (petsc_history) {
+      va_start(Argp,format);
       tab = ascii->tab;
       while (tab--) {ierr = PetscFPrintf(PETSC_COMM_SELF,fd,"  ");CHKERRQ(ierr);}
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
@@ -841,6 +842,7 @@
     if (err) SETERRQ(PETSC_ERR_SYS,"fflush() failed on file");        
     queuefile = fp;
     if (petsc_history) {
+      va_start(Argp,format);
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
       err = fflush(petsc_history);
       if (err) SETERRQ(PETSC_ERR_SYS,"fflush() failed on file");        
@@ -988,6 +990,7 @@
     err = fflush(fd);
     if (err) SETERRQ(PETSC_ERR_SYS,"fflush() failed on file");        
     if (petsc_history) {
+      va_start(Argp,format);
       tab = ascii->tab + ctx->tabs;
       while (tab--) {ierr = PetscFPrintf(PETSC_COMM_SELF,fd,"  ");CHKERRQ(ierr);}
       ierr = (*PetscVFPrintf)(petsc_history,format,Argp);CHKERRQ(ierr);
Index: petsc/src/sys/viewer/impls/ascii/filev.c.html
===================================================================
--- petsc.orig/src/sys/viewer/impls/ascii/filev.c.html
+++ petsc/src/sys/viewer/impls/ascii/filev.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:19:33+00:00">
+<meta name="date" content="2011-03-17T18:40:58+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -388,541 +388,544 @@
 <a name="line428">428: </a>    err = fflush(fd);
 <a name="line429">429: </a>    <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
 <a name="line430">430: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line431">431: </a>      tab = ascii-&gt;tab;
-<a name="line432">432: </a>      <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fd,<font color="#666666">"  "</font>);}
-<a name="line433">433: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line434">434: </a>      err = fflush(petsc_history);
-<a name="line435">435: </a>      <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
-<a name="line436">436: </a>    }
-<a name="line437">437: </a>    va_end(Argp);
-<a name="line438">438: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ascii-&gt;bviewer) { <font color="#B22222">/* this is a singleton <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> that is not on process 0 */</font>
-<a name="line439">439: </a>    va_list     Argp;
-<a name="line440">440: </a>    int         fullLength;
-<a name="line441">441: </a>    char        *string;
-
-<a name="line443">443: </a>    PrintfQueue next;
-<a name="line444">444: </a>    <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
-<a name="line445">445: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next;}
-<a name="line446">446: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
-<a name="line447">447: </a>    queuelength++;
-<a name="line448">448: </a>    next-&gt;size = QUEUESTRINGSIZE;
-<a name="line449">449: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size*<font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
-<a name="line450">450: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
-<a name="line451">451: </a>    string = next-&gt;string;
-<a name="line452">452: </a>    tab = 2*ascii-&gt;tab;
-<a name="line453">453: </a>    <font color="#4169E1">while</font> (tab--) {*string++ = ' ';}
-<a name="line454">454: </a>    va_start(Argp,format);
-<a name="line455">455: </a>    PetscVSNPrintf(string,next-&gt;size-2*ascii-&gt;tab,format,&amp;fullLength,Argp);
-<a name="line456">456: </a>    va_end(Argp);
-<a name="line457">457: </a>  }
-<a name="line458">458: </a>  <font color="#4169E1">return</font>(0);
-<a name="line459">459: </a>}
-
-<a name="line463">463: </a><font color="#B22222">/*@C</font>
-<a name="line464">464: </a><font color="#B22222">     <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A> - Sets the name of the file the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> uses.</font>
-
-<a name="line466">466: </a><font color="#B22222">    Collective on <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A></font>
-
-<a name="line468">468: </a><font color="#B22222">  Input Parameters:</font>
-<a name="line469">469: </a><font color="#B22222">+  viewer - the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>; either ASCII or binary</font>
-<a name="line470">470: </a><font color="#B22222">-  name - the name of the file it should use</font>
-
-<a name="line472">472: </a><font color="#B22222">    Level: advanced</font>
-
-<a name="line474">474: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryOpen.html#PetscViewerBinaryOpen">PetscViewerBinaryOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(),</font>
-<a name="line475">475: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIGetPointer.html#PetscViewerASCIIGetPointer">PetscViewerASCIIGetPointer</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>()</font>
-
-<a name="line477">477: </a><font color="#B22222">@*/</font>
-<a name="line478">478: </a><strong><font color="#4169E1"><a name="PetscViewerFileSetName"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,const char name[])</font></strong>
-<a name="line479">479: </a>{
-<a name="line480">480: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> ierr,(*f)(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>,const char[]);
-
-<a name="line485">485: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectQueryFunction.html#PetscObjectQueryFunction">PetscObjectQueryFunction</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileSetName_C"</font>,(void (**)(void))&amp;f);
-<a name="line486">486: </a>  <font color="#4169E1">if</font> (f) {
-<a name="line487">487: </a>    (*f)(viewer,name);
-<a name="line488">488: </a>  }
-<a name="line489">489: </a>  <font color="#4169E1">return</font>(0);
-<a name="line490">490: </a>}
-
-<a name="line494">494: </a><font color="#B22222">/*@C</font>
-<a name="line495">495: </a><font color="#B22222">     <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileGetName.html#PetscViewerFileGetName">PetscViewerFileGetName</A> - Gets the name of the file the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> uses.</font>
-
-<a name="line497">497: </a><font color="#B22222">    Not Collective</font>
-
-<a name="line499">499: </a><font color="#B22222">  Input Parameter:</font>
-<a name="line500">500: </a><font color="#B22222">.  viewer - the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>; either ASCII or binary</font>
-
-<a name="line502">502: </a><font color="#B22222">  Output Parameter:</font>
-<a name="line503">503: </a><font color="#B22222">.  name - the name of the file it is using</font>
-
-<a name="line505">505: </a><font color="#B22222">    Level: advanced</font>
-
-<a name="line507">507: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryOpen.html#PetscViewerBinaryOpen">PetscViewerBinaryOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A>()</font>
-
-<a name="line509">509: </a><font color="#B22222">@*/</font>
-<a name="line510">510: </a><strong><font color="#4169E1"><a name="PetscViewerFileGetName"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileGetName.html#PetscViewerFileGetName">PetscViewerFileGetName</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,char **name)</font></strong>
-<a name="line511">511: </a>{
-<a name="line512">512: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> ierr,(*f)(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>,char **);
-
-<a name="line516">516: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectQueryFunction.html#PetscObjectQueryFunction">PetscObjectQueryFunction</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileGetName_C"</font>,(void (**)(void))&amp;f);
-<a name="line517">517: </a>  <font color="#4169E1">if</font> (f) {
-<a name="line518">518: </a>    (*f)(viewer,name);
-<a name="line519">519: </a>  }
-<a name="line520">520: </a>  <font color="#4169E1">return</font>(0);
-<a name="line521">521: </a>}
-
-<a name="line526">526: </a><strong><font color="#4169E1"><a name="PetscViewerFileGetName_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscViewerFileGetName_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,char **name)</font></strong>
-<a name="line527">527: </a>{
-<a name="line528">528: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII*)viewer-&gt;data;
-
-<a name="line531">531: </a>  *name = vascii-&gt;filename;
-<a name="line532">532: </a>  <font color="#4169E1">return</font>(0);
-<a name="line533">533: </a>}
-
-
-<a name="line540">540: </a><strong><font color="#4169E1"><a name="PetscViewerFileSetName_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscViewerFileSetName_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,const char name[])</font></strong>
-<a name="line541">541: </a>{
-<a name="line542">542: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line543">543: </a>  size_t            len;
-<a name="line544">544: </a>  char              fname[PETSC_MAX_PATH_LEN],*gz;
-<a name="line545">545: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII*)viewer-&gt;data;
-<a name="line546">546: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        isstderr,isstdout;
-<a name="line547">547: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
-
-<a name="line550">550: </a>  <font color="#4169E1">if</font> (!name) <font color="#4169E1">return</font>(0);
-<a name="line551">551: </a>  <A href="../../../../../docs/manualpages/Sys/PetscStrfree.html#PetscStrfree">PetscStrfree</A>(vascii-&gt;filename);
-<a name="line552">552: </a>  <A href="../../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</A>(name,&amp;vascii-&gt;filename);
-
-<a name="line554">554: </a>  <font color="#B22222">/* Is this file to be compressed */</font>
-<a name="line555">555: </a>  vascii-&gt;storecompressed = <A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line556">556: </a>  <A href="../../../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(vascii-&gt;filename,<font color="#666666">".gz"</font>,&amp;gz);
-<a name="line557">557: </a>  <font color="#4169E1">if</font> (gz) {
-<a name="line558">558: </a>    <A href="../../../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(gz,&amp;len);
-<a name="line559">559: </a>    <font color="#4169E1">if</font> (len == 3) {
-<a name="line560">560: </a>      *gz = 0;
-<a name="line561">561: </a>      vascii-&gt;storecompressed = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line562">562: </a>    }
-<a name="line563">563: </a>  }
-<a name="line564">564: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
-<a name="line565">565: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line566">566: </a>    <A href="../../../../../docs/manualpages/Sys/PetscStrcmp.html#PetscStrcmp">PetscStrcmp</A>(name,<font color="#666666">"stderr"</font>,&amp;isstderr);
-<a name="line567">567: </a>    <A href="../../../../../docs/manualpages/Sys/PetscStrcmp.html#PetscStrcmp">PetscStrcmp</A>(name,<font color="#666666">"stdout"</font>,&amp;isstdout);
-<a name="line568">568: </a>    <font color="#B22222">/* empty filename means stdout */</font>
-<a name="line569">569: </a>    <font color="#4169E1">if</font> (name[0] == 0)  isstdout = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line570">570: </a>    <font color="#4169E1">if</font> (isstderr)      vascii-&gt;fd = PETSC_STDERR;
-<a name="line571">571: </a>    <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isstdout) vascii-&gt;fd = PETSC_STDOUT;
-<a name="line572">572: </a>    <font color="#4169E1">else</font> {
-
-
-<a name="line575">575: </a>      <A href="../../../../../docs/manualpages/Sys/PetscFixFilename.html#PetscFixFilename">PetscFixFilename</A>(name,fname);
-<a name="line576">576: </a>      <font color="#4169E1">switch</font>(vascii-&gt;mode) {
-<a name="line577">577: </a>      <font color="#4169E1">case</font> FILE_MODE_READ:
-<a name="line578">578: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"r"</font>);
-<a name="line579">579: </a>        <font color="#4169E1">break</font>;
-<a name="line580">580: </a>      <font color="#4169E1">case</font> FILE_MODE_WRITE:
-<a name="line581">581: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"w"</font>);
-<a name="line582">582: </a>        <font color="#4169E1">break</font>;
-<a name="line583">583: </a>      <font color="#4169E1">case</font> FILE_MODE_APPEND:
-<a name="line584">584: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"a"</font>);
-<a name="line585">585: </a>        <font color="#4169E1">break</font>;
-<a name="line586">586: </a>      <font color="#4169E1">case</font> FILE_MODE_UPDATE:
-<a name="line587">587: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"r+"</font>);
-<a name="line588">588: </a>        <font color="#4169E1">if</font> (!vascii-&gt;fd) {
-<a name="line589">589: </a>          vascii-&gt;fd = fopen(fname,<font color="#666666">"w+"</font>);
-<a name="line590">590: </a>        }
-<a name="line591">591: </a>        <font color="#4169E1">break</font>;
-<a name="line592">592: </a>      <font color="#4169E1">case</font> FILE_MODE_APPEND_UPDATE:
-<a name="line593">593: </a>        <font color="#B22222">/* I really want a file which is opened at the end for updating,</font>
-<a name="line594">594: </a><font color="#B22222">           not a+, which opens at the beginning, but makes writes at the end.</font>
-<a name="line595">595: </a><font color="#B22222">        */</font>
-<a name="line596">596: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"r+"</font>);
-<a name="line597">597: </a>        <font color="#4169E1">if</font> (!vascii-&gt;fd) {
-<a name="line598">598: </a>          vascii-&gt;fd = fopen(fname,<font color="#666666">"w+"</font>);
-<a name="line599">599: </a>        } <font color="#4169E1">else</font> {
-<a name="line600">600: </a>          fseek(vascii-&gt;fd, 0, SEEK_END);
-<a name="line601">601: </a>        }
-<a name="line602">602: </a>        <font color="#4169E1">break</font>;
-<a name="line603">603: </a><strong><font color="#FF0000">      default:</font></strong>
-<a name="line604">604: </a>        <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG, <font color="#666666">"Invalid file mode %d"</font>, vascii-&gt;mode);
-<a name="line605">605: </a>      }
-<a name="line606">606: </a>      <font color="#4169E1">if</font> (!vascii-&gt;fd) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Cannot open <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> file: %s"</font>,fname);
-<a name="line607">607: </a>    }
-<a name="line608">608: </a>  }
-<a name="line609">609: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
-<a name="line610">610: </a>  PetscLogObjectState((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"File: %s"</font>,name);
-<a name="line611">611: </a><font color="#A020F0">#endif</font>
-<a name="line612">612: </a>  <font color="#4169E1">return</font>(0);
-<a name="line613">613: </a>}
-
-<a name="line618">618: </a><strong><font color="#4169E1"><a name="PetscViewerGetSingleton_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerGetSingleton_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
-<a name="line619">619: </a>{
-<a name="line620">620: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
-<a name="line621">621: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line622">622: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)viewer-&gt;data,*ovascii;
-<a name="line623">623: </a>  const char        *name;
-
-<a name="line626">626: </a>  <font color="#4169E1">if</font> (vascii-&gt;sviewer) {
-<a name="line627">627: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Singleton already obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> and not restored"</font>);
-<a name="line628">628: </a>  }
-<a name="line629">629: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,outviewer);
-<a name="line630">630: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(*outviewer,PETSC_VIEWER_ASCII);
-<a name="line631">631: </a>  ovascii      = (PetscViewer_ASCII*)(*outviewer)-&gt;data;
-<a name="line632">632: </a>  ovascii-&gt;fd  = vascii-&gt;fd;
-<a name="line633">633: </a>  ovascii-&gt;tab = vascii-&gt;tab;
-
-<a name="line635">635: </a>  vascii-&gt;sviewer = *outviewer;
-
-<a name="line637">637: </a>  (*outviewer)-&gt;format     = viewer-&gt;format;
-<a name="line638">638: </a>  (*outviewer)-&gt;iformat    = viewer-&gt;iformat;
-
-<a name="line640">640: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,&amp;name);
-<a name="line641">641: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectSetName.html#PetscObjectSetName">PetscObjectSetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*outviewer),name);
-
-<a name="line643">643: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
-<a name="line644">644: </a>  ((PetscViewer_ASCII*)((*outviewer)-&gt;data))-&gt;bviewer = viewer;
-<a name="line645">645: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII_Singleton;
-<a name="line646">646: </a>  <font color="#4169E1">if</font> (rank) {
-<a name="line647">647: </a>    (*outviewer)-&gt;ops-&gt;flush = 0;
-<a name="line648">648: </a>  } <font color="#4169E1">else</font> {
-<a name="line649">649: </a>    (*outviewer)-&gt;ops-&gt;flush = PetscViewerFlush_ASCII_Singleton_0;
-<a name="line650">650: </a>  }
-<a name="line651">651: </a>  <font color="#4169E1">return</font>(0);
-<a name="line652">652: </a>}
-
-<a name="line656">656: </a><strong><font color="#4169E1"><a name="PetscViewerRestoreSingleton_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerRestoreSingleton_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
-<a name="line657">657: </a>{
-<a name="line658">658: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line659">659: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)(*outviewer)-&gt;data;
-<a name="line660">660: </a>  PetscViewer_ASCII *ascii  = (PetscViewer_ASCII *)viewer-&gt;data;
-
-<a name="line663">663: </a>  <font color="#4169E1">if</font> (!ascii-&gt;sviewer) {
-<a name="line664">664: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Singleton never obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
-<a name="line665">665: </a>  }
-<a name="line666">666: </a>  <font color="#4169E1">if</font> (ascii-&gt;sviewer != *outviewer) {
-<a name="line667">667: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"This <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> did not generate singleton"</font>);
-<a name="line668">668: </a>  }
-
-<a name="line670">670: </a>  ascii-&gt;sviewer             = 0;
-<a name="line671">671: </a>  vascii-&gt;fd                 = PETSC_STDOUT;
-<a name="line672">672: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII;
-<a name="line673">673: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(*outviewer);
-<a name="line674">674: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(viewer);
-<a name="line675">675: </a>  <font color="#4169E1">return</font>(0);
-<a name="line676">676: </a>}
-
-<a name="line680">680: </a><strong><font color="#4169E1"><a name="PetscViewerGetSubcomm_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerGetSubcomm_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> subcomm,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
-<a name="line681">681: </a>{
-<a name="line682">682: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
-<a name="line683">683: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line684">684: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)viewer-&gt;data,*ovascii;
-<a name="line685">685: </a>  const char        *name;
-
-<a name="line688">688: </a>  <font color="#4169E1">if</font> (vascii-&gt;sviewer) {
-<a name="line689">689: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Subcomm already obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> and not restored"</font>);
-<a name="line690">690: </a>  }
-<a name="line691">691: </a>  <font color="#B22222">/* <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,outviewer); */</font>
-<a name="line692">692: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(subcomm,outviewer);
-<a name="line693">693: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(*outviewer,PETSC_VIEWER_ASCII);
-<a name="line694">694: </a>  ovascii      = (PetscViewer_ASCII*)(*outviewer)-&gt;data;
-<a name="line695">695: </a>  ovascii-&gt;fd  = vascii-&gt;fd;
-<a name="line696">696: </a>  ovascii-&gt;tab = vascii-&gt;tab;
-
-<a name="line698">698: </a>  vascii-&gt;sviewer = *outviewer;
-
-<a name="line700">700: </a>  (*outviewer)-&gt;format     = viewer-&gt;format;
-<a name="line701">701: </a>  (*outviewer)-&gt;iformat    = viewer-&gt;iformat;
-
-<a name="line703">703: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,&amp;name);
-<a name="line704">704: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectSetName.html#PetscObjectSetName">PetscObjectSetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*outviewer),name);
-
-<a name="line706">706: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
-<a name="line707">707: </a>  ((PetscViewer_ASCII*)((*outviewer)-&gt;data))-&gt;bviewer = viewer;
-<a name="line708">708: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII_Singleton;
-<a name="line709">709: </a>  <font color="#B22222">/* following might not be correct??? */</font>
-<a name="line710">710: </a>  <font color="#4169E1">if</font> (rank) {
-<a name="line711">711: </a>    (*outviewer)-&gt;ops-&gt;flush = 0;
-<a name="line712">712: </a>  } <font color="#4169E1">else</font> {
-<a name="line713">713: </a>    (*outviewer)-&gt;ops-&gt;flush = PetscViewerFlush_ASCII_Singleton_0;
-<a name="line714">714: </a>  }
-<a name="line715">715: </a>  <font color="#4169E1">return</font>(0);
-<a name="line716">716: </a>}
-
-<a name="line720">720: </a><strong><font color="#4169E1"><a name="PetscViewerRestoreSubcomm_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerRestoreSubcomm_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> subcomm,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
-<a name="line721">721: </a>{
-<a name="line722">722: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line723">723: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)(*outviewer)-&gt;data;
-<a name="line724">724: </a>  PetscViewer_ASCII *ascii  = (PetscViewer_ASCII *)viewer-&gt;data;
-
-<a name="line727">727: </a>  <font color="#4169E1">if</font> (!ascii-&gt;sviewer) {
-<a name="line728">728: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Subcomm never obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
-<a name="line729">729: </a>  }
-<a name="line730">730: </a>  <font color="#4169E1">if</font> (ascii-&gt;sviewer != *outviewer) {
-<a name="line731">731: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"This <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> did not generate subcomm"</font>);
-<a name="line732">732: </a>  }
-
-<a name="line734">734: </a>  ascii-&gt;sviewer             = 0;
-<a name="line735">735: </a>  vascii-&gt;fd                 = PETSC_STDOUT;
-<a name="line736">736: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII;
-<a name="line737">737: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(*outviewer);
-<a name="line738">738: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(viewer);
-<a name="line739">739: </a>  <font color="#4169E1">return</font>(0);
-<a name="line740">740: </a>}
-
-<a name="line745">745: </a><strong><font color="#4169E1"><a name="PetscViewerCreate_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscViewerCreate_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line746">746: </a>{
-<a name="line747">747: </a>  PetscViewer_ASCII *vascii;
-<a name="line748">748: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-
-<a name="line751">751: </a>  PetscNewLog(viewer,PetscViewer_ASCII,&amp;vascii);
-<a name="line752">752: </a>  viewer-&gt;data = (void*)vascii;
-
-<a name="line754">754: </a>  viewer-&gt;ops-&gt;destroy          = PetscViewerDestroy_ASCII;
-<a name="line755">755: </a>  viewer-&gt;ops-&gt;flush            = PetscViewerFlush_ASCII;
-<a name="line756">756: </a>  viewer-&gt;ops-&gt;getsingleton     = PetscViewerGetSingleton_ASCII;
-<a name="line757">757: </a>  viewer-&gt;ops-&gt;restoresingleton = PetscViewerRestoreSingleton_ASCII;
-<a name="line758">758: </a>  viewer-&gt;ops-&gt;getsubcomm       = PetscViewerGetSubcomm_ASCII;
-<a name="line759">759: </a>  viewer-&gt;ops-&gt;restoresubcomm   = PetscViewerRestoreSubcomm_ASCII;
-
-<a name="line761">761: </a>  <font color="#B22222">/* defaults to stdout unless set with <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A>() */</font>
-<a name="line762">762: </a>  vascii-&gt;fd             = PETSC_STDOUT;
-<a name="line763">763: </a>  vascii-&gt;mode           = FILE_MODE_WRITE;
-<a name="line764">764: </a>  vascii-&gt;bviewer        = 0;
-<a name="line765">765: </a>  vascii-&gt;sviewer        = 0;
-<a name="line766">766: </a>  viewer-&gt;format         = PETSC_VIEWER_DEFAULT;
-<a name="line767">767: </a>  viewer-&gt;iformat        = 0;
-<a name="line768">768: </a>  vascii-&gt;tab            = 0;
-<a name="line769">769: </a>  vascii-&gt;tab_store      = 0;
-<a name="line770">770: </a>  vascii-&gt;filename       = 0;
-
-<a name="line772">772: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileSetName_C"</font>,<font color="#666666">"PetscViewerFileSetName_ASCII"</font>,
-<a name="line773">773: </a>                                     PetscViewerFileSetName_ASCII);
-<a name="line774">774: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileGetName_C"</font>,<font color="#666666">"PetscViewerFileGetName_ASCII"</font>,
-<a name="line775">775: </a>                                     PetscViewerFileGetName_ASCII);
-<a name="line776">776: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileGetMode_C"</font>,<font color="#666666">"PetscViewerFileGetMode_ASCII"</font>,
-<a name="line777">777: </a>                                     PetscViewerFileGetMode_ASCII);
-<a name="line778">778: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileSetMode_C"</font>,<font color="#666666">"PetscViewerFileSetMode_ASCII"</font>,
-<a name="line779">779: </a>                                     PetscViewerFileSetMode_ASCII);
-
-<a name="line781">781: </a>  <font color="#4169E1">return</font>(0);
-<a name="line782">782: </a>}
-
-
-<a name="line788">788: </a><font color="#B22222">/*@C</font>
-<a name="line789">789: </a><font color="#B22222">    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A> - Prints synchronized output to the specified file from</font>
-<a name="line790">790: </a><font color="#B22222">    several processors.  Output of the first processor is followed by that of the </font>
-<a name="line791">791: </a><font color="#B22222">    second, etc.</font>
-
-<a name="line793">793: </a><font color="#B22222">    Not Collective, must call collective <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>() to get the results out</font>
-
-<a name="line795">795: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line796">796: </a><font color="#B22222">+   viewer - the ASCII <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A></font>
-<a name="line797">797: </a><font color="#B22222">-   format - the usual printf() format string </font>
-
-<a name="line799">799: </a><font color="#B22222">    Level: intermediate</font>
-
-<a name="line801">801: </a><font color="#B22222">    Fortran Note:</font>
-<a name="line802">802: </a><font color="#B22222">      Can only print a single character* string</font>
-
-<a name="line804">804: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(), <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(),</font>
-<a name="line805">805: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Sys/PetscFOpen.html#PetscFOpen">PetscFOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIGetPointer.html#PetscViewerASCIIGetPointer">PetscViewerASCIIGetPointer</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(),</font>
-<a name="line806">806: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
-
-<a name="line808">808: </a><font color="#B22222">@*/</font>
-<a name="line809">809: </a><strong><font color="#4169E1"><a name="PetscViewerASCIISynchronizedPrintf"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,const char format[],...)</font></strong>
-<a name="line810">810: </a>{
-<a name="line811">811: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)viewer-&gt;data;
-<a name="line812">812: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line813">813: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
-<a name="line814">814: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          tab = vascii-&gt;tab;
-<a name="line815">815: </a>  <A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>          comm;
-<a name="line816">816: </a>  FILE              *fp;
-<a name="line817">817: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
-<a name="line818">818: </a>  int               err;
-
-<a name="line823">823: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
-<a name="line824">824: </a>  <font color="#4169E1">if</font> (!iascii) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Not ASCII <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
-
-<a name="line826">826: </a>  comm = ((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm;
-<a name="line827">827: </a>  fp   = vascii-&gt;fd;
-<a name="line828">828: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line829">829: </a>  <font color="#4169E1">if</font> (vascii-&gt;bviewer) {<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vascii-&gt;bviewer)-&gt;comm,&amp;rank);}
-<a name="line830">830: </a>
-
-<a name="line832">832: </a>  <font color="#B22222">/* First processor prints immediately to fp */</font>
-<a name="line833">833: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line834">834: </a>    va_list Argp;
-
-<a name="line836">836: </a>    <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fp,<font color="#666666">"  "</font>);}
-
-<a name="line838">838: </a>    va_start(Argp,format);
-<a name="line839">839: </a>    (*PetscVFPrintf)(fp,format,Argp);
-<a name="line840">840: </a>    err = fflush(fp);
-<a name="line841">841: </a>    <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
-<a name="line842">842: </a>    queuefile = fp;
-<a name="line843">843: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line844">844: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line845">845: </a>      err = fflush(petsc_history);
-<a name="line846">846: </a>      <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
-<a name="line847">847: </a>    }
-<a name="line848">848: </a>    va_end(Argp);
-<a name="line849">849: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors add to local queue */</font>
-<a name="line850">850: </a>    char        *string;
-<a name="line851">851: </a>    va_list     Argp;
-<a name="line852">852: </a>    int         fullLength;
-<a name="line853">853: </a>    PrintfQueue next;
-
-<a name="line855">855: </a>    <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
-<a name="line856">856: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next;}
-<a name="line857">857: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
-<a name="line858">858: </a>    queuelength++;
-<a name="line859">859: </a>    next-&gt;size = QUEUESTRINGSIZE;
-<a name="line860">860: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size*<font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
-<a name="line861">861: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
-<a name="line862">862: </a>    string = next-&gt;string;
-<a name="line863">863: </a>    tab *= 2;
-<a name="line864">864: </a>    <font color="#4169E1">while</font> (tab--) {*string++ = ' ';}
-<a name="line865">865: </a>    va_start(Argp,format);
-<a name="line866">866: </a>    PetscVSNPrintf(string,next-&gt;size-2*vascii-&gt;tab,format,&amp;fullLength,Argp);
-<a name="line867">867: </a>    va_end(Argp);
-<a name="line868">868: </a>  }
-<a name="line869">869: </a>  <font color="#4169E1">return</font>(0);
-<a name="line870">870: </a>}
-
-
-<a name="line875">875: </a><font color="#B22222">/*@C</font>
-<a name="line876">876: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A> - Opens an ASCII file as a monitor object, suitable for the default <A href="../../../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A>, <A href="../../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> and <A href="../../../../../docs/manualpages/TS/TS.html#TS">TS</A> monitors</font>
-
-<a name="line878">878: </a><font color="#B22222">   Collective on <A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line880">880: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line881">881: </a><font color="#B22222">+  comm - the communicator</font>
-<a name="line882">882: </a><font color="#B22222">.  name - the file name</font>
-<a name="line883">883: </a><font color="#B22222">-  tabs - how far in the text should be tabbed</font>
-
-<a name="line885">885: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line886">886: </a><font color="#B22222">.  lab - the context to be used with <A href="../../../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A>/<A href="../../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A>/<A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>()</font>
-
-<a name="line888">888: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line890">890: </a><font color="#B22222">   Notes:</font>
-<a name="line891">891: </a><font color="#B22222">   This can be destroyed with PetscViewerASCIIMonitorDestroy().</font>
-
-<a name="line893">893: </a><font color="#B22222">   See <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>()</font>
-
-<a name="line895">895: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/KSP/KSPMonitorSet.html#KSPMonitorSet">KSPMonitorSet</A>(), <A href="../../../../../docs/manualpages/SNES/SNESMonitorSet.html#SNESMonitorSet">SNESMonitorSet</A>(), <A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>(), <A href="../../../../../docs/manualpages/KSP/KSPMonitorDefault.html#KSPMonitorDefault">KSPMonitorDefault</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>, PetscViewerASCIIMonitorDestroy()</font>
-
-<a name="line897">897: </a><font color="#B22222">@*/</font>
-<a name="line898">898: </a><strong><font color="#4169E1"><a name="PetscViewerASCIIMonitorCreate"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>(<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char *filename,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> tabs,<A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>* ctx)</font></strong>
-<a name="line899">899: </a>{
-
-<a name="line903">903: </a>  <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _p_PetscViewerASCIIMonitor</font>,ctx);
-<a name="line904">904: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(comm,filename,&amp;(*ctx)-&gt;viewer);
-<a name="line905">905: </a>  (*ctx)-&gt;tabs = tabs;
-<a name="line906">906: </a>  <font color="#4169E1">return</font>(0);
-<a name="line907">907: </a>}
-
-<a name="line911">911: </a><font color="#B22222">/*@C</font>
-<a name="line912">912: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorDestroys.html#PetscViewerASCIIMonitorDestroys">PetscViewerASCIIMonitorDestroys</A> - removes a monitor context.</font>
-
-<a name="line914">914: </a><font color="#B22222">   Collective on <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A></font>
-
-<a name="line916">916: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line917">917: </a><font color="#B22222">.   ctx - the monitor context created with <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>()</font>
-
-<a name="line919">919: </a><font color="#B22222">   Level: advanced</font>
-
-<a name="line921">921: </a><font color="#B22222">   Notes:</font>
-<a name="line922">922: </a><font color="#B22222">     This is rarely called by users, it is usually called when the <A href="../../../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A>, <A href="../../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> or <A href="../../../../../docs/manualpages/TS/TS.html#TS">TS</A> object is destroyed</font>
-
-<a name="line924">924: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/KSP/KSPMonitorSet.html#KSPMonitorSet">KSPMonitorSet</A>(), <A href="../../../../../docs/manualpages/SNES/SNESMonitorSet.html#SNESMonitorSet">SNESMonitorSet</A>(), <A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>(), <A href="../../../../../docs/manualpages/KSP/KSPMonitorDefault.html#KSPMonitorDefault">KSPMonitorDefault</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>, <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>()</font>
-
-<a name="line926">926: </a><font color="#B22222">@*/</font>
-<a name="line927">927: </a><strong><font color="#4169E1"><a name="PetscViewerASCIIMonitorDestroy"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerASCIIMonitorDestroy(<A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A> ctx)</font></strong>
-<a name="line928">928: </a>{
-
-<a name="line932">932: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(ctx-&gt;viewer);
-<a name="line933">933: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(ctx);
-<a name="line934">934: </a>  <font color="#4169E1">return</font>(0);
-<a name="line935">935: </a>}
-
-<a name="line939">939: </a><font color="#B22222">/*@C</font>
-<a name="line940">940: </a><font color="#B22222">    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorPrintf.html#PetscViewerASCIIMonitorPrintf">PetscViewerASCIIMonitorPrintf</A> - Prints to the viewer associated with this monitor context</font>
-
-<a name="line942">942: </a><font color="#B22222">    Not Collective, but only first processor in set has any effect</font>
-
-<a name="line944">944: </a><font color="#B22222">    Input Parameters:</font>
-<a name="line945">945: </a><font color="#B22222">+    ctx - the context obtained with <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>()</font>
-<a name="line946">946: </a><font color="#B22222">-    format - the usual printf() format string </font>
-
-<a name="line948">948: </a><font color="#B22222">    Level: developer</font>
-
-<a name="line950">950: </a><font color="#B22222">    Developer Notes: This code is virtually identical to <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(), however the code</font>
-<a name="line951">951: </a><font color="#B22222">      could not simply be called from here due to the var args.</font>
-
-<a name="line953">953: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/KSP/KSPMonitorSet.html#KSPMonitorSet">KSPMonitorSet</A>(), <A href="../../../../../docs/manualpages/SNES/SNESMonitorSet.html#SNESMonitorSet">SNESMonitorSet</A>(), <A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>(), <A href="../../../../../docs/manualpages/KSP/KSPMonitorDefault.html#KSPMonitorDefault">KSPMonitorDefault</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>, <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>(),</font>
-<a name="line954">954: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(), <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
-
-
-<a name="line957">957: </a><font color="#B22222">@*/</font>
-<a name="line958">958: </a><strong><font color="#4169E1"><a name="PetscViewerASCIIMonitorPrintf"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorPrintf.html#PetscViewerASCIIMonitorPrintf">PetscViewerASCIIMonitorPrintf</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A> ctx,const char format[],...)</font></strong>
-<a name="line959">959: </a>{
-<a name="line960">960: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>       viewer = ctx-&gt;viewer;
-<a name="line961">961: </a>  PetscViewer_ASCII *ascii = (PetscViewer_ASCII*)viewer-&gt;data;
-<a name="line962">962: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
-<a name="line963">963: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          tab;
-<a name="line964">964: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line965">965: </a>  FILE              *fd = ascii-&gt;fd;
-<a name="line966">966: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
-<a name="line967">967: </a>  int               err;
-
-<a name="line972">972: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
-<a name="line973">973: </a>  <font color="#4169E1">if</font> (!iascii) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Not ASCII <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
-
-<a name="line975">975: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
-<a name="line976">976: </a>  <font color="#4169E1">if</font> (ascii-&gt;bviewer) {<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ascii-&gt;bviewer)-&gt;comm,&amp;rank);}
-<a name="line977">977: </a>  <font color="#4169E1">if</font> (!rank) {
-<a name="line978">978: </a>    va_list Argp;
-<a name="line979">979: </a>    <font color="#4169E1">if</font> (ascii-&gt;bviewer) {
-<a name="line980">980: </a>      queuefile = fd;
-<a name="line981">981: </a>    }
-
-<a name="line983">983: </a>    tab = ascii-&gt;tab + ctx-&gt;tabs;
-<a name="line984">984: </a>    <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fd,<font color="#666666">"  "</font>);}
-
-<a name="line986">986: </a>    va_start(Argp,format);
-<a name="line987">987: </a>    (*PetscVFPrintf)(fd,format,Argp);
-<a name="line988">988: </a>    err = fflush(fd);
-<a name="line989">989: </a>    <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
-<a name="line990">990: </a>    <font color="#4169E1">if</font> (petsc_history) {
-<a name="line991">991: </a>      tab = ascii-&gt;tab + ctx-&gt;tabs;
-<a name="line992">992: </a>      <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fd,<font color="#666666">"  "</font>);}
-<a name="line993">993: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
-<a name="line994">994: </a>      err = fflush(petsc_history);
-<a name="line995">995: </a>      <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
-<a name="line996">996: </a>    }
-<a name="line997">997: </a>    va_end(Argp);
-<a name="line998">998: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ascii-&gt;bviewer) { <font color="#B22222">/* this is a singleton <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> that is not on process 0 */</font>
-<a name="line999">999: </a>    va_list     Argp;
-<a name="line1000">1000: </a>    int         fullLength;
-<a name="line1001">1001: </a>    char        *string;
-<a name="line1002">1002: </a>    PrintfQueue next;
-
-<a name="line1004">1004: </a>    <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
-<a name="line1005">1005: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next;}
-<a name="line1006">1006: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
-<a name="line1007">1007: </a>    queuelength++;
-<a name="line1008">1008: </a>    next-&gt;size = QUEUESTRINGSIZE;
-<a name="line1009">1009: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size*<font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
-<a name="line1010">1010: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
-<a name="line1011">1011: </a>    string = next-&gt;string;
-<a name="line1012">1012: </a>    tab = 2*(ascii-&gt;tab + ctx-&gt;tabs);
-<a name="line1013">1013: </a>    <font color="#4169E1">while</font> (tab--) {*string++ = ' ';}
-<a name="line1014">1014: </a>    va_start(Argp,format);
-<a name="line1015">1015: </a>    PetscVSNPrintf(string,next-&gt;size-2*ascii-&gt;tab,format,&amp;fullLength,Argp);
-<a name="line1016">1016: </a>    va_end(Argp);
-<a name="line1017">1017: </a>  }
-<a name="line1018">1018: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1019">1019: </a>}
+<a name="line431">431: </a>      va_start(Argp,format);
+<a name="line432">432: </a>      tab = ascii-&gt;tab;
+<a name="line433">433: </a>      <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fd,<font color="#666666">"  "</font>);}
+<a name="line434">434: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line435">435: </a>      err = fflush(petsc_history);
+<a name="line436">436: </a>      <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
+<a name="line437">437: </a>    }
+<a name="line438">438: </a>    va_end(Argp);
+<a name="line439">439: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ascii-&gt;bviewer) { <font color="#B22222">/* this is a singleton <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> that is not on process 0 */</font>
+<a name="line440">440: </a>    va_list     Argp;
+<a name="line441">441: </a>    int         fullLength;
+<a name="line442">442: </a>    char        *string;
+
+<a name="line444">444: </a>    PrintfQueue next;
+<a name="line445">445: </a>    <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
+<a name="line446">446: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next;}
+<a name="line447">447: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
+<a name="line448">448: </a>    queuelength++;
+<a name="line449">449: </a>    next-&gt;size = QUEUESTRINGSIZE;
+<a name="line450">450: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size*<font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
+<a name="line451">451: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
+<a name="line452">452: </a>    string = next-&gt;string;
+<a name="line453">453: </a>    tab = 2*ascii-&gt;tab;
+<a name="line454">454: </a>    <font color="#4169E1">while</font> (tab--) {*string++ = ' ';}
+<a name="line455">455: </a>    va_start(Argp,format);
+<a name="line456">456: </a>    PetscVSNPrintf(string,next-&gt;size-2*ascii-&gt;tab,format,&amp;fullLength,Argp);
+<a name="line457">457: </a>    va_end(Argp);
+<a name="line458">458: </a>  }
+<a name="line459">459: </a>  <font color="#4169E1">return</font>(0);
+<a name="line460">460: </a>}
+
+<a name="line464">464: </a><font color="#B22222">/*@C</font>
+<a name="line465">465: </a><font color="#B22222">     <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A> - Sets the name of the file the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> uses.</font>
+
+<a name="line467">467: </a><font color="#B22222">    Collective on <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A></font>
+
+<a name="line469">469: </a><font color="#B22222">  Input Parameters:</font>
+<a name="line470">470: </a><font color="#B22222">+  viewer - the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>; either ASCII or binary</font>
+<a name="line471">471: </a><font color="#B22222">-  name - the name of the file it should use</font>
+
+<a name="line473">473: </a><font color="#B22222">    Level: advanced</font>
+
+<a name="line475">475: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryOpen.html#PetscViewerBinaryOpen">PetscViewerBinaryOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(),</font>
+<a name="line476">476: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIGetPointer.html#PetscViewerASCIIGetPointer">PetscViewerASCIIGetPointer</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>()</font>
+
+<a name="line478">478: </a><font color="#B22222">@*/</font>
+<a name="line479">479: </a><strong><font color="#4169E1"><a name="PetscViewerFileSetName"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,const char name[])</font></strong>
+<a name="line480">480: </a>{
+<a name="line481">481: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> ierr,(*f)(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>,const char[]);
+
+<a name="line486">486: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectQueryFunction.html#PetscObjectQueryFunction">PetscObjectQueryFunction</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileSetName_C"</font>,(void (**)(void))&amp;f);
+<a name="line487">487: </a>  <font color="#4169E1">if</font> (f) {
+<a name="line488">488: </a>    (*f)(viewer,name);
+<a name="line489">489: </a>  }
+<a name="line490">490: </a>  <font color="#4169E1">return</font>(0);
+<a name="line491">491: </a>}
+
+<a name="line495">495: </a><font color="#B22222">/*@C</font>
+<a name="line496">496: </a><font color="#B22222">     <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileGetName.html#PetscViewerFileGetName">PetscViewerFileGetName</A> - Gets the name of the file the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> uses.</font>
+
+<a name="line498">498: </a><font color="#B22222">    Not Collective</font>
+
+<a name="line500">500: </a><font color="#B22222">  Input Parameter:</font>
+<a name="line501">501: </a><font color="#B22222">.  viewer - the <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>; either ASCII or binary</font>
+
+<a name="line503">503: </a><font color="#B22222">  Output Parameter:</font>
+<a name="line504">504: </a><font color="#B22222">.  name - the name of the file it is using</font>
+
+<a name="line506">506: </a><font color="#B22222">    Level: advanced</font>
+
+<a name="line508">508: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryOpen.html#PetscViewerBinaryOpen">PetscViewerBinaryOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A>()</font>
+
+<a name="line510">510: </a><font color="#B22222">@*/</font>
+<a name="line511">511: </a><strong><font color="#4169E1"><a name="PetscViewerFileGetName"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileGetName.html#PetscViewerFileGetName">PetscViewerFileGetName</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,char **name)</font></strong>
+<a name="line512">512: </a>{
+<a name="line513">513: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> ierr,(*f)(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>,char **);
+
+<a name="line517">517: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectQueryFunction.html#PetscObjectQueryFunction">PetscObjectQueryFunction</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileGetName_C"</font>,(void (**)(void))&amp;f);
+<a name="line518">518: </a>  <font color="#4169E1">if</font> (f) {
+<a name="line519">519: </a>    (*f)(viewer,name);
+<a name="line520">520: </a>  }
+<a name="line521">521: </a>  <font color="#4169E1">return</font>(0);
+<a name="line522">522: </a>}
+
+<a name="line527">527: </a><strong><font color="#4169E1"><a name="PetscViewerFileGetName_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscViewerFileGetName_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,char **name)</font></strong>
+<a name="line528">528: </a>{
+<a name="line529">529: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII*)viewer-&gt;data;
+
+<a name="line532">532: </a>  *name = vascii-&gt;filename;
+<a name="line533">533: </a>  <font color="#4169E1">return</font>(0);
+<a name="line534">534: </a>}
+
+
+<a name="line541">541: </a><strong><font color="#4169E1"><a name="PetscViewerFileSetName_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscViewerFileSetName_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,const char name[])</font></strong>
+<a name="line542">542: </a>{
+<a name="line543">543: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line544">544: </a>  size_t            len;
+<a name="line545">545: </a>  char              fname[PETSC_MAX_PATH_LEN],*gz;
+<a name="line546">546: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII*)viewer-&gt;data;
+<a name="line547">547: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        isstderr,isstdout;
+<a name="line548">548: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
+
+<a name="line551">551: </a>  <font color="#4169E1">if</font> (!name) <font color="#4169E1">return</font>(0);
+<a name="line552">552: </a>  <A href="../../../../../docs/manualpages/Sys/PetscStrfree.html#PetscStrfree">PetscStrfree</A>(vascii-&gt;filename);
+<a name="line553">553: </a>  <A href="../../../../../docs/manualpages/Sys/PetscStrallocpy.html#PetscStrallocpy">PetscStrallocpy</A>(name,&amp;vascii-&gt;filename);
+
+<a name="line555">555: </a>  <font color="#B22222">/* Is this file to be compressed */</font>
+<a name="line556">556: </a>  vascii-&gt;storecompressed = <A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line557">557: </a>  <A href="../../../../../docs/manualpages/Sys/PetscStrstr.html#PetscStrstr">PetscStrstr</A>(vascii-&gt;filename,<font color="#666666">".gz"</font>,&amp;gz);
+<a name="line558">558: </a>  <font color="#4169E1">if</font> (gz) {
+<a name="line559">559: </a>    <A href="../../../../../docs/manualpages/Sys/PetscStrlen.html#PetscStrlen">PetscStrlen</A>(gz,&amp;len);
+<a name="line560">560: </a>    <font color="#4169E1">if</font> (len == 3) {
+<a name="line561">561: </a>      *gz = 0;
+<a name="line562">562: </a>      vascii-&gt;storecompressed = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line563">563: </a>    }
+<a name="line564">564: </a>  }
+<a name="line565">565: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
+<a name="line566">566: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line567">567: </a>    <A href="../../../../../docs/manualpages/Sys/PetscStrcmp.html#PetscStrcmp">PetscStrcmp</A>(name,<font color="#666666">"stderr"</font>,&amp;isstderr);
+<a name="line568">568: </a>    <A href="../../../../../docs/manualpages/Sys/PetscStrcmp.html#PetscStrcmp">PetscStrcmp</A>(name,<font color="#666666">"stdout"</font>,&amp;isstdout);
+<a name="line569">569: </a>    <font color="#B22222">/* empty filename means stdout */</font>
+<a name="line570">570: </a>    <font color="#4169E1">if</font> (name[0] == 0)  isstdout = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line571">571: </a>    <font color="#4169E1">if</font> (isstderr)      vascii-&gt;fd = PETSC_STDERR;
+<a name="line572">572: </a>    <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isstdout) vascii-&gt;fd = PETSC_STDOUT;
+<a name="line573">573: </a>    <font color="#4169E1">else</font> {
+
+
+<a name="line576">576: </a>      <A href="../../../../../docs/manualpages/Sys/PetscFixFilename.html#PetscFixFilename">PetscFixFilename</A>(name,fname);
+<a name="line577">577: </a>      <font color="#4169E1">switch</font>(vascii-&gt;mode) {
+<a name="line578">578: </a>      <font color="#4169E1">case</font> FILE_MODE_READ:
+<a name="line579">579: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"r"</font>);
+<a name="line580">580: </a>        <font color="#4169E1">break</font>;
+<a name="line581">581: </a>      <font color="#4169E1">case</font> FILE_MODE_WRITE:
+<a name="line582">582: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"w"</font>);
+<a name="line583">583: </a>        <font color="#4169E1">break</font>;
+<a name="line584">584: </a>      <font color="#4169E1">case</font> FILE_MODE_APPEND:
+<a name="line585">585: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"a"</font>);
+<a name="line586">586: </a>        <font color="#4169E1">break</font>;
+<a name="line587">587: </a>      <font color="#4169E1">case</font> FILE_MODE_UPDATE:
+<a name="line588">588: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"r+"</font>);
+<a name="line589">589: </a>        <font color="#4169E1">if</font> (!vascii-&gt;fd) {
+<a name="line590">590: </a>          vascii-&gt;fd = fopen(fname,<font color="#666666">"w+"</font>);
+<a name="line591">591: </a>        }
+<a name="line592">592: </a>        <font color="#4169E1">break</font>;
+<a name="line593">593: </a>      <font color="#4169E1">case</font> FILE_MODE_APPEND_UPDATE:
+<a name="line594">594: </a>        <font color="#B22222">/* I really want a file which is opened at the end for updating,</font>
+<a name="line595">595: </a><font color="#B22222">           not a+, which opens at the beginning, but makes writes at the end.</font>
+<a name="line596">596: </a><font color="#B22222">        */</font>
+<a name="line597">597: </a>        vascii-&gt;fd = fopen(fname,<font color="#666666">"r+"</font>);
+<a name="line598">598: </a>        <font color="#4169E1">if</font> (!vascii-&gt;fd) {
+<a name="line599">599: </a>          vascii-&gt;fd = fopen(fname,<font color="#666666">"w+"</font>);
+<a name="line600">600: </a>        } <font color="#4169E1">else</font> {
+<a name="line601">601: </a>          fseek(vascii-&gt;fd, 0, SEEK_END);
+<a name="line602">602: </a>        }
+<a name="line603">603: </a>        <font color="#4169E1">break</font>;
+<a name="line604">604: </a><strong><font color="#FF0000">      default:</font></strong>
+<a name="line605">605: </a>        <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONG, <font color="#666666">"Invalid file mode %d"</font>, vascii-&gt;mode);
+<a name="line606">606: </a>      }
+<a name="line607">607: </a>      <font color="#4169E1">if</font> (!vascii-&gt;fd) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_FILE_OPEN,<font color="#666666">"Cannot open <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> file: %s"</font>,fname);
+<a name="line608">608: </a>    }
+<a name="line609">609: </a>  }
+<a name="line610">610: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
+<a name="line611">611: </a>  PetscLogObjectState((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"File: %s"</font>,name);
+<a name="line612">612: </a><font color="#A020F0">#endif</font>
+<a name="line613">613: </a>  <font color="#4169E1">return</font>(0);
+<a name="line614">614: </a>}
+
+<a name="line619">619: </a><strong><font color="#4169E1"><a name="PetscViewerGetSingleton_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerGetSingleton_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
+<a name="line620">620: </a>{
+<a name="line621">621: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
+<a name="line622">622: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line623">623: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)viewer-&gt;data,*ovascii;
+<a name="line624">624: </a>  const char        *name;
+
+<a name="line627">627: </a>  <font color="#4169E1">if</font> (vascii-&gt;sviewer) {
+<a name="line628">628: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Singleton already obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> and not restored"</font>);
+<a name="line629">629: </a>  }
+<a name="line630">630: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,outviewer);
+<a name="line631">631: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(*outviewer,PETSC_VIEWER_ASCII);
+<a name="line632">632: </a>  ovascii      = (PetscViewer_ASCII*)(*outviewer)-&gt;data;
+<a name="line633">633: </a>  ovascii-&gt;fd  = vascii-&gt;fd;
+<a name="line634">634: </a>  ovascii-&gt;tab = vascii-&gt;tab;
+
+<a name="line636">636: </a>  vascii-&gt;sviewer = *outviewer;
+
+<a name="line638">638: </a>  (*outviewer)-&gt;format     = viewer-&gt;format;
+<a name="line639">639: </a>  (*outviewer)-&gt;iformat    = viewer-&gt;iformat;
+
+<a name="line641">641: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,&amp;name);
+<a name="line642">642: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectSetName.html#PetscObjectSetName">PetscObjectSetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*outviewer),name);
+
+<a name="line644">644: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
+<a name="line645">645: </a>  ((PetscViewer_ASCII*)((*outviewer)-&gt;data))-&gt;bviewer = viewer;
+<a name="line646">646: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII_Singleton;
+<a name="line647">647: </a>  <font color="#4169E1">if</font> (rank) {
+<a name="line648">648: </a>    (*outviewer)-&gt;ops-&gt;flush = 0;
+<a name="line649">649: </a>  } <font color="#4169E1">else</font> {
+<a name="line650">650: </a>    (*outviewer)-&gt;ops-&gt;flush = PetscViewerFlush_ASCII_Singleton_0;
+<a name="line651">651: </a>  }
+<a name="line652">652: </a>  <font color="#4169E1">return</font>(0);
+<a name="line653">653: </a>}
+
+<a name="line657">657: </a><strong><font color="#4169E1"><a name="PetscViewerRestoreSingleton_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerRestoreSingleton_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
+<a name="line658">658: </a>{
+<a name="line659">659: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line660">660: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)(*outviewer)-&gt;data;
+<a name="line661">661: </a>  PetscViewer_ASCII *ascii  = (PetscViewer_ASCII *)viewer-&gt;data;
+
+<a name="line664">664: </a>  <font color="#4169E1">if</font> (!ascii-&gt;sviewer) {
+<a name="line665">665: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Singleton never obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
+<a name="line666">666: </a>  }
+<a name="line667">667: </a>  <font color="#4169E1">if</font> (ascii-&gt;sviewer != *outviewer) {
+<a name="line668">668: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"This <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> did not generate singleton"</font>);
+<a name="line669">669: </a>  }
+
+<a name="line671">671: </a>  ascii-&gt;sviewer             = 0;
+<a name="line672">672: </a>  vascii-&gt;fd                 = PETSC_STDOUT;
+<a name="line673">673: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII;
+<a name="line674">674: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(*outviewer);
+<a name="line675">675: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(viewer);
+<a name="line676">676: </a>  <font color="#4169E1">return</font>(0);
+<a name="line677">677: </a>}
+
+<a name="line681">681: </a><strong><font color="#4169E1"><a name="PetscViewerGetSubcomm_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerGetSubcomm_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> subcomm,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
+<a name="line682">682: </a>{
+<a name="line683">683: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
+<a name="line684">684: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line685">685: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)viewer-&gt;data,*ovascii;
+<a name="line686">686: </a>  const char        *name;
+
+<a name="line689">689: </a>  <font color="#4169E1">if</font> (vascii-&gt;sviewer) {
+<a name="line690">690: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Subcomm already obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> and not restored"</font>);
+<a name="line691">691: </a>  }
+<a name="line692">692: </a>  <font color="#B22222">/* <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,outviewer); */</font>
+<a name="line693">693: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerCreate.html#PetscViewerCreate">PetscViewerCreate</A>(subcomm,outviewer);
+<a name="line694">694: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerSetType.html#PetscViewerSetType">PetscViewerSetType</A>(*outviewer,PETSC_VIEWER_ASCII);
+<a name="line695">695: </a>  ovascii      = (PetscViewer_ASCII*)(*outviewer)-&gt;data;
+<a name="line696">696: </a>  ovascii-&gt;fd  = vascii-&gt;fd;
+<a name="line697">697: </a>  ovascii-&gt;tab = vascii-&gt;tab;
+
+<a name="line699">699: </a>  vascii-&gt;sviewer = *outviewer;
+
+<a name="line701">701: </a>  (*outviewer)-&gt;format     = viewer-&gt;format;
+<a name="line702">702: </a>  (*outviewer)-&gt;iformat    = viewer-&gt;iformat;
+
+<a name="line704">704: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,&amp;name);
+<a name="line705">705: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectSetName.html#PetscObjectSetName">PetscObjectSetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*outviewer),name);
+
+<a name="line707">707: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
+<a name="line708">708: </a>  ((PetscViewer_ASCII*)((*outviewer)-&gt;data))-&gt;bviewer = viewer;
+<a name="line709">709: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII_Singleton;
+<a name="line710">710: </a>  <font color="#B22222">/* following might not be correct??? */</font>
+<a name="line711">711: </a>  <font color="#4169E1">if</font> (rank) {
+<a name="line712">712: </a>    (*outviewer)-&gt;ops-&gt;flush = 0;
+<a name="line713">713: </a>  } <font color="#4169E1">else</font> {
+<a name="line714">714: </a>    (*outviewer)-&gt;ops-&gt;flush = PetscViewerFlush_ASCII_Singleton_0;
+<a name="line715">715: </a>  }
+<a name="line716">716: </a>  <font color="#4169E1">return</font>(0);
+<a name="line717">717: </a>}
+
+<a name="line721">721: </a><strong><font color="#4169E1"><a name="PetscViewerRestoreSubcomm_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerRestoreSubcomm_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> subcomm,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> *outviewer)</font></strong>
+<a name="line722">722: </a>{
+<a name="line723">723: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line724">724: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)(*outviewer)-&gt;data;
+<a name="line725">725: </a>  PetscViewer_ASCII *ascii  = (PetscViewer_ASCII *)viewer-&gt;data;
+
+<a name="line728">728: </a>  <font color="#4169E1">if</font> (!ascii-&gt;sviewer) {
+<a name="line729">729: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"Subcomm never obtained from <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
+<a name="line730">730: </a>  }
+<a name="line731">731: </a>  <font color="#4169E1">if</font> (ascii-&gt;sviewer != *outviewer) {
+<a name="line732">732: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"This <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> did not generate subcomm"</font>);
+<a name="line733">733: </a>  }
+
+<a name="line735">735: </a>  ascii-&gt;sviewer             = 0;
+<a name="line736">736: </a>  vascii-&gt;fd                 = PETSC_STDOUT;
+<a name="line737">737: </a>  (*outviewer)-&gt;ops-&gt;destroy = PetscViewerDestroy_ASCII;
+<a name="line738">738: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(*outviewer);
+<a name="line739">739: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(viewer);
+<a name="line740">740: </a>  <font color="#4169E1">return</font>(0);
+<a name="line741">741: </a>}
+
+<a name="line746">746: </a><strong><font color="#4169E1"><a name="PetscViewerCreate_ASCII"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  PetscViewerCreate_ASCII(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line747">747: </a>{
+<a name="line748">748: </a>  PetscViewer_ASCII *vascii;
+<a name="line749">749: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+
+<a name="line752">752: </a>  PetscNewLog(viewer,PetscViewer_ASCII,&amp;vascii);
+<a name="line753">753: </a>  viewer-&gt;data = (void*)vascii;
+
+<a name="line755">755: </a>  viewer-&gt;ops-&gt;destroy          = PetscViewerDestroy_ASCII;
+<a name="line756">756: </a>  viewer-&gt;ops-&gt;flush            = PetscViewerFlush_ASCII;
+<a name="line757">757: </a>  viewer-&gt;ops-&gt;getsingleton     = PetscViewerGetSingleton_ASCII;
+<a name="line758">758: </a>  viewer-&gt;ops-&gt;restoresingleton = PetscViewerRestoreSingleton_ASCII;
+<a name="line759">759: </a>  viewer-&gt;ops-&gt;getsubcomm       = PetscViewerGetSubcomm_ASCII;
+<a name="line760">760: </a>  viewer-&gt;ops-&gt;restoresubcomm   = PetscViewerRestoreSubcomm_ASCII;
+
+<a name="line762">762: </a>  <font color="#B22222">/* defaults to stdout unless set with <A href="../../../../../docs/manualpages/Viewer/PetscViewerFileSetName.html#PetscViewerFileSetName">PetscViewerFileSetName</A>() */</font>
+<a name="line763">763: </a>  vascii-&gt;fd             = PETSC_STDOUT;
+<a name="line764">764: </a>  vascii-&gt;mode           = FILE_MODE_WRITE;
+<a name="line765">765: </a>  vascii-&gt;bviewer        = 0;
+<a name="line766">766: </a>  vascii-&gt;sviewer        = 0;
+<a name="line767">767: </a>  viewer-&gt;format         = PETSC_VIEWER_DEFAULT;
+<a name="line768">768: </a>  viewer-&gt;iformat        = 0;
+<a name="line769">769: </a>  vascii-&gt;tab            = 0;
+<a name="line770">770: </a>  vascii-&gt;tab_store      = 0;
+<a name="line771">771: </a>  vascii-&gt;filename       = 0;
+
+<a name="line773">773: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileSetName_C"</font>,<font color="#666666">"PetscViewerFileSetName_ASCII"</font>,
+<a name="line774">774: </a>                                     PetscViewerFileSetName_ASCII);
+<a name="line775">775: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileGetName_C"</font>,<font color="#666666">"PetscViewerFileGetName_ASCII"</font>,
+<a name="line776">776: </a>                                     PetscViewerFileGetName_ASCII);
+<a name="line777">777: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileGetMode_C"</font>,<font color="#666666">"PetscViewerFileGetMode_ASCII"</font>,
+<a name="line778">778: </a>                                     PetscViewerFileGetMode_ASCII);
+<a name="line779">779: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<font color="#666666">"PetscViewerFileSetMode_C"</font>,<font color="#666666">"PetscViewerFileSetMode_ASCII"</font>,
+<a name="line780">780: </a>                                     PetscViewerFileSetMode_ASCII);
+
+<a name="line782">782: </a>  <font color="#4169E1">return</font>(0);
+<a name="line783">783: </a>}
+
+
+<a name="line789">789: </a><font color="#B22222">/*@C</font>
+<a name="line790">790: </a><font color="#B22222">    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A> - Prints synchronized output to the specified file from</font>
+<a name="line791">791: </a><font color="#B22222">    several processors.  Output of the first processor is followed by that of the </font>
+<a name="line792">792: </a><font color="#B22222">    second, etc.</font>
+
+<a name="line794">794: </a><font color="#B22222">    Not Collective, must call collective <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>() to get the results out</font>
+
+<a name="line796">796: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line797">797: </a><font color="#B22222">+   viewer - the ASCII <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A></font>
+<a name="line798">798: </a><font color="#B22222">-   format - the usual printf() format string </font>
+
+<a name="line800">800: </a><font color="#B22222">    Level: intermediate</font>
+
+<a name="line802">802: </a><font color="#B22222">    Fortran Note:</font>
+<a name="line803">803: </a><font color="#B22222">      Can only print a single character* string</font>
+
+<a name="line805">805: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Sys/PetscSynchronizedPrintf.html#PetscSynchronizedPrintf">PetscSynchronizedPrintf</A>(), <A href="../../../../../docs/manualpages/Sys/PetscSynchronizedFlush.html#PetscSynchronizedFlush">PetscSynchronizedFlush</A>(), <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(),</font>
+<a name="line806">806: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Sys/PetscFOpen.html#PetscFOpen">PetscFOpen</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIGetPointer.html#PetscViewerASCIIGetPointer">PetscViewerASCIIGetPointer</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(),</font>
+<a name="line807">807: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
+
+<a name="line809">809: </a><font color="#B22222">@*/</font>
+<a name="line810">810: </a><strong><font color="#4169E1"><a name="PetscViewerASCIISynchronizedPrintf"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIISynchronizedPrintf.html#PetscViewerASCIISynchronizedPrintf">PetscViewerASCIISynchronizedPrintf</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer,const char format[],...)</font></strong>
+<a name="line811">811: </a>{
+<a name="line812">812: </a>  PetscViewer_ASCII *vascii = (PetscViewer_ASCII *)viewer-&gt;data;
+<a name="line813">813: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line814">814: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
+<a name="line815">815: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          tab = vascii-&gt;tab;
+<a name="line816">816: </a>  <A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>          comm;
+<a name="line817">817: </a>  FILE              *fp;
+<a name="line818">818: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
+<a name="line819">819: </a>  int               err;
+
+<a name="line824">824: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
+<a name="line825">825: </a>  <font color="#4169E1">if</font> (!iascii) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Not ASCII <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
+
+<a name="line827">827: </a>  comm = ((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm;
+<a name="line828">828: </a>  fp   = vascii-&gt;fd;
+<a name="line829">829: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line830">830: </a>  <font color="#4169E1">if</font> (vascii-&gt;bviewer) {<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vascii-&gt;bviewer)-&gt;comm,&amp;rank);}
+<a name="line831">831: </a>
+
+<a name="line833">833: </a>  <font color="#B22222">/* First processor prints immediately to fp */</font>
+<a name="line834">834: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line835">835: </a>    va_list Argp;
+
+<a name="line837">837: </a>    <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fp,<font color="#666666">"  "</font>);}
+
+<a name="line839">839: </a>    va_start(Argp,format);
+<a name="line840">840: </a>    (*PetscVFPrintf)(fp,format,Argp);
+<a name="line841">841: </a>    err = fflush(fp);
+<a name="line842">842: </a>    <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
+<a name="line843">843: </a>    queuefile = fp;
+<a name="line844">844: </a>    <font color="#4169E1">if</font> (petsc_history) {
+<a name="line845">845: </a>      va_start(Argp,format);
+<a name="line846">846: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line847">847: </a>      err = fflush(petsc_history);
+<a name="line848">848: </a>      <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
+<a name="line849">849: </a>    }
+<a name="line850">850: </a>    va_end(Argp);
+<a name="line851">851: </a>  } <font color="#4169E1">else</font> { <font color="#B22222">/* other processors add to local queue */</font>
+<a name="line852">852: </a>    char        *string;
+<a name="line853">853: </a>    va_list     Argp;
+<a name="line854">854: </a>    int         fullLength;
+<a name="line855">855: </a>    PrintfQueue next;
+
+<a name="line857">857: </a>    <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
+<a name="line858">858: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next;}
+<a name="line859">859: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
+<a name="line860">860: </a>    queuelength++;
+<a name="line861">861: </a>    next-&gt;size = QUEUESTRINGSIZE;
+<a name="line862">862: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size*<font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
+<a name="line863">863: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
+<a name="line864">864: </a>    string = next-&gt;string;
+<a name="line865">865: </a>    tab *= 2;
+<a name="line866">866: </a>    <font color="#4169E1">while</font> (tab--) {*string++ = ' ';}
+<a name="line867">867: </a>    va_start(Argp,format);
+<a name="line868">868: </a>    PetscVSNPrintf(string,next-&gt;size-2*vascii-&gt;tab,format,&amp;fullLength,Argp);
+<a name="line869">869: </a>    va_end(Argp);
+<a name="line870">870: </a>  }
+<a name="line871">871: </a>  <font color="#4169E1">return</font>(0);
+<a name="line872">872: </a>}
+
+
+<a name="line877">877: </a><font color="#B22222">/*@C</font>
+<a name="line878">878: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A> - Opens an ASCII file as a monitor object, suitable for the default <A href="../../../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A>, <A href="../../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> and <A href="../../../../../docs/manualpages/TS/TS.html#TS">TS</A> monitors</font>
+
+<a name="line880">880: </a><font color="#B22222">   Collective on <A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line882">882: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line883">883: </a><font color="#B22222">+  comm - the communicator</font>
+<a name="line884">884: </a><font color="#B22222">.  name - the file name</font>
+<a name="line885">885: </a><font color="#B22222">-  tabs - how far in the text should be tabbed</font>
+
+<a name="line887">887: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line888">888: </a><font color="#B22222">.  lab - the context to be used with <A href="../../../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A>/<A href="../../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A>/<A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>()</font>
+
+<a name="line890">890: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line892">892: </a><font color="#B22222">   Notes:</font>
+<a name="line893">893: </a><font color="#B22222">   This can be destroyed with PetscViewerASCIIMonitorDestroy().</font>
+
+<a name="line895">895: </a><font color="#B22222">   See <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>()</font>
+
+<a name="line897">897: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/KSP/KSPMonitorSet.html#KSPMonitorSet">KSPMonitorSet</A>(), <A href="../../../../../docs/manualpages/SNES/SNESMonitorSet.html#SNESMonitorSet">SNESMonitorSet</A>(), <A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>(), <A href="../../../../../docs/manualpages/KSP/KSPMonitorDefault.html#KSPMonitorDefault">KSPMonitorDefault</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>, PetscViewerASCIIMonitorDestroy()</font>
+
+<a name="line899">899: </a><font color="#B22222">@*/</font>
+<a name="line900">900: </a><strong><font color="#4169E1"><a name="PetscViewerASCIIMonitorCreate"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>(<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,const char *filename,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> tabs,<A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>* ctx)</font></strong>
+<a name="line901">901: </a>{
+
+<a name="line905">905: </a>  <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _p_PetscViewerASCIIMonitor</font>,ctx);
+<a name="line906">906: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIOpen.html#PetscViewerASCIIOpen">PetscViewerASCIIOpen</A>(comm,filename,&amp;(*ctx)-&gt;viewer);
+<a name="line907">907: </a>  (*ctx)-&gt;tabs = tabs;
+<a name="line908">908: </a>  <font color="#4169E1">return</font>(0);
+<a name="line909">909: </a>}
+
+<a name="line913">913: </a><font color="#B22222">/*@C</font>
+<a name="line914">914: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorDestroys.html#PetscViewerASCIIMonitorDestroys">PetscViewerASCIIMonitorDestroys</A> - removes a monitor context.</font>
+
+<a name="line916">916: </a><font color="#B22222">   Collective on <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A></font>
+
+<a name="line918">918: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line919">919: </a><font color="#B22222">.   ctx - the monitor context created with <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>()</font>
+
+<a name="line921">921: </a><font color="#B22222">   Level: advanced</font>
+
+<a name="line923">923: </a><font color="#B22222">   Notes:</font>
+<a name="line924">924: </a><font color="#B22222">     This is rarely called by users, it is usually called when the <A href="../../../../../docs/manualpages/KSP/KSP.html#KSP">KSP</A>, <A href="../../../../../docs/manualpages/SNES/SNES.html#SNES">SNES</A> or <A href="../../../../../docs/manualpages/TS/TS.html#TS">TS</A> object is destroyed</font>
+
+<a name="line926">926: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/KSP/KSPMonitorSet.html#KSPMonitorSet">KSPMonitorSet</A>(), <A href="../../../../../docs/manualpages/SNES/SNESMonitorSet.html#SNESMonitorSet">SNESMonitorSet</A>(), <A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>(), <A href="../../../../../docs/manualpages/KSP/KSPMonitorDefault.html#KSPMonitorDefault">KSPMonitorDefault</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>, <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>()</font>
+
+<a name="line928">928: </a><font color="#B22222">@*/</font>
+<a name="line929">929: </a><strong><font color="#4169E1"><a name="PetscViewerASCIIMonitorDestroy"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> PetscViewerASCIIMonitorDestroy(<A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A> ctx)</font></strong>
+<a name="line930">930: </a>{
+
+<a name="line934">934: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDestroy.html#PetscViewerDestroy">PetscViewerDestroy</A>(ctx-&gt;viewer);
+<a name="line935">935: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(ctx);
+<a name="line936">936: </a>  <font color="#4169E1">return</font>(0);
+<a name="line937">937: </a>}
+
+<a name="line941">941: </a><font color="#B22222">/*@C</font>
+<a name="line942">942: </a><font color="#B22222">    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorPrintf.html#PetscViewerASCIIMonitorPrintf">PetscViewerASCIIMonitorPrintf</A> - Prints to the viewer associated with this monitor context</font>
+
+<a name="line944">944: </a><font color="#B22222">    Not Collective, but only first processor in set has any effect</font>
+
+<a name="line946">946: </a><font color="#B22222">    Input Parameters:</font>
+<a name="line947">947: </a><font color="#B22222">+    ctx - the context obtained with <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>()</font>
+<a name="line948">948: </a><font color="#B22222">-    format - the usual printf() format string </font>
+
+<a name="line950">950: </a><font color="#B22222">    Level: developer</font>
+
+<a name="line952">952: </a><font color="#B22222">    Developer Notes: This code is virtually identical to <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(), however the code</font>
+<a name="line953">953: </a><font color="#B22222">      could not simply be called from here due to the var args.</font>
+
+<a name="line955">955: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/KSP/KSPMonitorSet.html#KSPMonitorSet">KSPMonitorSet</A>(), <A href="../../../../../docs/manualpages/SNES/SNESMonitorSet.html#SNESMonitorSet">SNESMonitorSet</A>(), <A href="../../../../../docs/manualpages/TS/TSMonitorSet.html#TSMonitorSet">TSMonitorSet</A>(), <A href="../../../../../docs/manualpages/KSP/KSPMonitorDefault.html#KSPMonitorDefault">KSPMonitorDefault</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A>, <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorCreate.html#PetscViewerASCIIMonitorCreate">PetscViewerASCIIMonitorCreate</A>(),</font>
+<a name="line956">956: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(), <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(), <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>()</font>
+
+
+<a name="line959">959: </a><font color="#B22222">@*/</font>
+<a name="line960">960: </a><strong><font color="#4169E1"><a name="PetscViewerASCIIMonitorPrintf"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitorPrintf.html#PetscViewerASCIIMonitorPrintf">PetscViewerASCIIMonitorPrintf</A>(<A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIMonitor.html#PetscViewerASCIIMonitor">PetscViewerASCIIMonitor</A> ctx,const char format[],...)</font></strong>
+<a name="line961">961: </a>{
+<a name="line962">962: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>       viewer = ctx-&gt;viewer;
+<a name="line963">963: </a>  PetscViewer_ASCII *ascii = (PetscViewer_ASCII*)viewer-&gt;data;
+<a name="line964">964: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>       rank;
+<a name="line965">965: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          tab;
+<a name="line966">966: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line967">967: </a>  FILE              *fd = ascii-&gt;fd;
+<a name="line968">968: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        iascii;
+<a name="line969">969: </a>  int               err;
+
+<a name="line974">974: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
+<a name="line975">975: </a>  <font color="#4169E1">if</font> (!iascii) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Not ASCII <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>"</font>);
+
+<a name="line977">977: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;comm,&amp;rank);
+<a name="line978">978: </a>  <font color="#4169E1">if</font> (ascii-&gt;bviewer) {<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ascii-&gt;bviewer)-&gt;comm,&amp;rank);}
+<a name="line979">979: </a>  <font color="#4169E1">if</font> (!rank) {
+<a name="line980">980: </a>    va_list Argp;
+<a name="line981">981: </a>    <font color="#4169E1">if</font> (ascii-&gt;bviewer) {
+<a name="line982">982: </a>      queuefile = fd;
+<a name="line983">983: </a>    }
+
+<a name="line985">985: </a>    tab = ascii-&gt;tab + ctx-&gt;tabs;
+<a name="line986">986: </a>    <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fd,<font color="#666666">"  "</font>);}
+
+<a name="line988">988: </a>    va_start(Argp,format);
+<a name="line989">989: </a>    (*PetscVFPrintf)(fd,format,Argp);
+<a name="line990">990: </a>    err = fflush(fd);
+<a name="line991">991: </a>    <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
+<a name="line992">992: </a>    <font color="#4169E1">if</font> (petsc_history) {
+<a name="line993">993: </a>      va_start(Argp,format);
+<a name="line994">994: </a>      tab = ascii-&gt;tab + ctx-&gt;tabs;
+<a name="line995">995: </a>      <font color="#4169E1">while</font> (tab--) {<A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,fd,<font color="#666666">"  "</font>);}
+<a name="line996">996: </a>      (*PetscVFPrintf)(petsc_history,format,Argp);
+<a name="line997">997: </a>      err = fflush(petsc_history);
+<a name="line998">998: </a>      <font color="#4169E1">if</font> (err) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SYS,<font color="#666666">"fflush() failed on file"</font>);
+<a name="line999">999: </a>    }
+<a name="line1000">1000: </a>    va_end(Argp);
+<a name="line1001">1001: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ascii-&gt;bviewer) { <font color="#B22222">/* this is a singleton <A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> that is not on process 0 */</font>
+<a name="line1002">1002: </a>    va_list     Argp;
+<a name="line1003">1003: </a>    int         fullLength;
+<a name="line1004">1004: </a>    char        *string;
+<a name="line1005">1005: </a>    PrintfQueue next;
+
+<a name="line1007">1007: </a>    <A href="../../../../../docs/manualpages/Sys/PetscNew.html#PetscNew">PetscNew</A>(<font color="#4169E1">struct _PrintfQueue</font>,&amp;next);
+<a name="line1008">1008: </a>    <font color="#4169E1">if</font> (queue) {queue-&gt;next = next; queue = next;}
+<a name="line1009">1009: </a>    <font color="#4169E1">else</font>       {queuebase   = queue = next;}
+<a name="line1010">1010: </a>    queuelength++;
+<a name="line1011">1011: </a>    next-&gt;size = QUEUESTRINGSIZE;
+<a name="line1012">1012: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(next-&gt;size*<font color="#4169E1">sizeof</font>(char), &amp;next-&gt;string);
+<a name="line1013">1013: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(next-&gt;string,next-&gt;size);
+<a name="line1014">1014: </a>    string = next-&gt;string;
+<a name="line1015">1015: </a>    tab = 2*(ascii-&gt;tab + ctx-&gt;tabs);
+<a name="line1016">1016: </a>    <font color="#4169E1">while</font> (tab--) {*string++ = ' ';}
+<a name="line1017">1017: </a>    va_start(Argp,format);
+<a name="line1018">1018: </a>    PetscVSNPrintf(string,next-&gt;size-2*ascii-&gt;tab,format,&amp;fullLength,Argp);
+<a name="line1019">1019: </a>    va_end(Argp);
+<a name="line1020">1020: </a>  }
+<a name="line1021">1021: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1022">1022: </a>}
 </pre>
 </body>
 
Index: petsc/src/vec/vec/impls/seq/bvec2.c
===================================================================
--- petsc.orig/src/vec/vec/impls/seq/bvec2.c
+++ petsc/src/vec/vec/impls/seq/bvec2.c
@@ -12,6 +12,10 @@
 EXTERN_C_END
 #endif
 
+#if defined(PETSC_HAVE_HDF5)
+extern PetscErrorCode VecView_MPI_HDF5(Vec,PetscViewer);
+#endif
+
 #include "../src/vec/vec/impls/seq/ftn-kernels/fnorm.h"
 #undef __FUNCT__  
 #define __FUNCT__ "VecNorm_Seq"
@@ -478,6 +482,9 @@
 #if defined(PETSC_HAVE_MATLAB_ENGINE)
   PetscTruth     ismatlab;
 #endif
+#if defined(PETSC_HAVE_HDF5)
+  PetscTruth     ishdf5;
+#endif
 
   PetscFunctionBegin;
   ierr = PetscTypeCompare((PetscObject)viewer,PETSC_VIEWER_DRAW,&isdraw);CHKERRQ(ierr);
@@ -487,6 +494,9 @@
 #if defined(PETSC_HAVE_MATHEMATICA)
   ierr = PetscTypeCompare((PetscObject)viewer,PETSC_VIEWER_MATHEMATICA,&ismathematica);CHKERRQ(ierr);
 #endif
+#if defined(PETSC_HAVE_HDF5)
+  ierr = PetscTypeCompare((PetscObject)viewer,PETSC_VIEWER_HDF5,&ishdf5);CHKERRQ(ierr);
+#endif
 #if defined(PETSC_HAVE_PNETCDF)
   ierr = PetscTypeCompare((PetscObject)viewer,PETSC_VIEWER_NETCDF,&isnetcdf);CHKERRQ(ierr);
 #endif
@@ -504,6 +514,10 @@
   } else if (ismathematica) {
     ierr = PetscViewerMathematicaPutVector(viewer,xin);CHKERRQ(ierr);
 #endif
+#if defined(PETSC_HAVE_HDF5)
+  } else if (ishdf5) {
+    ierr = VecView_MPI_HDF5(xin,viewer);CHKERRQ(ierr); /* Reusing VecView_MPI_HDF5 ... don't want code duplication*/
+#endif
 #if defined(PETSC_HAVE_PNETCDF)
   } else if (isnetcdf) {
     ierr = VecView_Seq_Netcdf(xin,viewer);CHKERRQ(ierr);
Index: petsc/src/vec/vec/impls/seq/bvec2.c.html
===================================================================
--- petsc.orig/src/vec/vec/impls/seq/bvec2.c.html
+++ petsc/src/vec/vec/impls/seq/bvec2.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T01:32:20+00:00">
+<meta name="date" content="2011-03-17T18:45:59+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -20,777 +20,790 @@
 <a name="line11"> 11: </a><font color="#A020F0">#include </font><font color="#666666">"pnetcdf.h"</font><font color="#A020F0"></font>
 <a name="line13"> 13: </a><font color="#A020F0">#endif</font>
 
-<a name="line15"> 15: </a><font color="#A020F0">#include </font><font color="#666666">"../src/vec/vec/impls/seq/ftn-kernels/fnorm.h"</font><font color="#A020F0"></font>
-<a name="line18"> 18: </a><strong><font color="#4169E1"><a name="VecNorm_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecNorm_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Vec/NormType.html#NormType">NormType</A> type,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* z)</font></strong>
-<a name="line19"> 19: </a>{
-<a name="line20"> 20: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *xx;
-<a name="line22"> 22: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = xin-&gt;map-&gt;n;
-<a name="line23"> 23: </a>  <A href="../../../../../docs/manualpages/Sys/PetscBLASInt.html#PetscBLASInt">PetscBLASInt</A>   one = 1, bn = PetscBLASIntCast(n);
-
-<a name="line26"> 26: </a>  <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A> || type == <A href="../../../../../docs/manualpages/Vec/NORM_FROBENIUS.html#NORM_FROBENIUS">NORM_FROBENIUS</A>) {
-<a name="line27"> 27: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xx);
-<a name="line28"> 28: </a>    <font color="#B22222">/*</font>
-<a name="line29"> 29: </a><font color="#B22222">      This is because the Fortran BLAS 1 Norm is very slow! </font>
-<a name="line30"> 30: </a><font color="#B22222">    */</font>
-<a name="line31"> 31: </a><font color="#A020F0">#if defined(PETSC_HAVE_SLOW_BLAS_NORM2)</font>
-<a name="line32"> 32: </a><font color="#A020F0">#if defined(PETSC_USE_FORTRAN_KERNEL_NORM)</font>
-<a name="line33"> 33: </a>    fortrannormsqr_(xx,&amp;n,z);
-<a name="line34"> 34: </a>    *z = sqrt(*z);
-<a name="line35"> 35: </a><font color="#A020F0">#elif defined(PETSC_USE_UNROLLED_NORM)</font>
-<a name="line36"> 36: </a>    {
-<a name="line37"> 37: </a>    <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> work = 0.0;
-<a name="line38"> 38: </a>    <font color="#4169E1">switch</font> (n &amp; 0x3) {
-<a name="line39"> 39: </a>      <font color="#4169E1">case</font> 3: work += PetscRealPart(xx[0]*PetscConj(xx[0])); xx++;
-<a name="line40"> 40: </a>      <font color="#4169E1">case</font> 2: work += PetscRealPart(xx[0]*PetscConj(xx[0])); xx++;
-<a name="line41"> 41: </a>      <font color="#4169E1">case</font> 1: work += PetscRealPart(xx[0]*PetscConj(xx[0])); xx++; n -= 4;
-<a name="line42"> 42: </a>    }
-<a name="line43"> 43: </a>    <font color="#4169E1">while</font> (n&gt;0) {
-<a name="line44"> 44: </a>      work += PetscRealPart(xx[0]*PetscConj(xx[0])+xx[1]*PetscConj(xx[1])+
-<a name="line45"> 45: </a>                        xx[2]*PetscConj(xx[2])+xx[3]*PetscConj(xx[3]));
-<a name="line46"> 46: </a>      xx += 4; n -= 4;
-<a name="line47"> 47: </a>    }
-<a name="line48"> 48: </a>    *z = sqrt(work);}
-<a name="line49"> 49: </a><font color="#A020F0">#else</font>
-<a name="line50"> 50: </a>    {
-<a name="line51"> 51: </a>      <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>         i;
-<a name="line52"> 52: </a>      <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> sum=0.0;
-<a name="line53"> 53: </a>      <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line54"> 54: </a>        sum += (xx[i])*(PetscConj(xx[i]));
-<a name="line55"> 55: </a>      }
-<a name="line56"> 56: </a>      *z = sqrt(PetscRealPart(sum));
-<a name="line57"> 57: </a>    }
-<a name="line58"> 58: </a><font color="#A020F0">#endif</font>
-<a name="line59"> 59: </a><font color="#A020F0">#else</font>
-<a name="line60"> 60: </a>    *z = BLASnrm2_(&amp;bn,xx,&amp;one);
-<a name="line61"> 61: </a><font color="#A020F0">#endif</font>
-<a name="line62"> 62: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xin,&amp;xx);
-<a name="line63"> 63: </a>    <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(PetscMax(2.0*n-1,0.0));
-<a name="line64"> 64: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>) {
-<a name="line65"> 65: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          i;
-<a name="line66"> 66: </a>    <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>    max = 0.0,tmp;
-
-<a name="line68"> 68: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xx);
-<a name="line69"> 69: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line70"> 70: </a>      <font color="#4169E1">if</font> ((tmp = PetscAbsScalar(*xx)) &gt; max) max = tmp;
-<a name="line71"> 71: </a>      <font color="#B22222">/* check special case of tmp == NaN */</font>
-<a name="line72"> 72: </a>      <font color="#4169E1">if</font> (tmp != tmp) {max = tmp; <font color="#4169E1">break</font>;}
-<a name="line73"> 73: </a>      xx++;
-<a name="line74"> 74: </a>    }
-<a name="line75"> 75: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xin,&amp;xx);
-<a name="line76"> 76: </a>    *z   = max;
-<a name="line77"> 77: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_1.html#NORM_1">NORM_1</A>) {
-<a name="line78"> 78: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xx);
-<a name="line79"> 79: </a>    *z = BLASasum_(&amp;bn,xx,&amp;one);
-<a name="line80"> 80: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xin,&amp;xx);
-<a name="line81"> 81: </a>    <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(PetscMax(n-1.0,0.0));
-<a name="line82"> 82: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_1_AND_2.html#NORM_1_AND_2">NORM_1_AND_2</A>) {
-<a name="line83"> 83: </a>    VecNorm_Seq(xin,<A href="../../../../../docs/manualpages/Vec/NORM_1.html#NORM_1">NORM_1</A>,z);
-<a name="line84"> 84: </a>    VecNorm_Seq(xin,<A href="../../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>,z+1);
-<a name="line85"> 85: </a>  }
-<a name="line86"> 86: </a>  <font color="#4169E1">return</font>(0);
-<a name="line87"> 87: </a>}
-
-<a name="line91"> 91: </a><strong><font color="#4169E1"><a name="VecView_Seq_File"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_File(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line92"> 92: </a>{
-<a name="line93"> 93: </a>  Vec_Seq           *x = (Vec_Seq *)xin-&gt;data;
-<a name="line94"> 94: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line95"> 95: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          i,n = xin-&gt;map-&gt;n;
-<a name="line96"> 96: </a>  const char        *name;
-<a name="line97"> 97: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
-
-<a name="line100">100: </a>  PetscViewerGetFormat(viewer,&amp;format);
-<a name="line101">101: </a>  <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_MATLAB) {
-<a name="line102">102: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin,&amp;name);
-<a name="line103">103: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%s = [\n"</font>,name);
-<a name="line104">104: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line105">105: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
-<a name="line106">106: </a>      <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &gt; 0.0) {
-<a name="line107">107: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e + %18.16ei\n"</font>,PetscRealPart(x-&gt;array[i]),PetscImaginaryPart(x-&gt;array[i]));
-<a name="line108">108: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &lt; 0.0) {
-<a name="line109">109: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e - %18.16ei\n"</font>,PetscRealPart(x-&gt;array[i]),-PetscImaginaryPart(x-&gt;array[i]));
-<a name="line110">110: </a>      } <font color="#4169E1">else</font> {
-<a name="line111">111: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e\n"</font>,PetscRealPart(x-&gt;array[i]));
-<a name="line112">112: </a>      }
-<a name="line113">113: </a><font color="#A020F0">#else</font>
-<a name="line114">114: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e\n"</font>,x-&gt;array[i]);
-<a name="line115">115: </a><font color="#A020F0">#endif</font>
-<a name="line116">116: </a>    }
-<a name="line117">117: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"];\n"</font>);
-<a name="line118">118: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_SYMMODU) {
-<a name="line119">119: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line120">120: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
-<a name="line121">121: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e %18.16e\n"</font>,PetscRealPart(x-&gt;array[i]),PetscImaginaryPart(x-&gt;array[i]));
-<a name="line122">122: </a><font color="#A020F0">#else</font>
-<a name="line123">123: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e\n"</font>,x-&gt;array[i]);
-<a name="line124">124: </a><font color="#A020F0">#endif</font>
-<a name="line125">125: </a>    }
-<a name="line126">126: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_VTK || format == PETSC_VIEWER_ASCII_VTK_CELL) {
-<a name="line127">127: </a>    <font color="#B22222">/* </font>
-<a name="line128">128: </a><font color="#B22222">       state 0: No header has been output</font>
-<a name="line129">129: </a><font color="#B22222">       state 1: Only POINT_DATA has been output</font>
-<a name="line130">130: </a><font color="#B22222">       state 2: Only CELL_DATA has been output</font>
-<a name="line131">131: </a><font color="#B22222">       state 3: Output both, POINT_DATA last</font>
-<a name="line132">132: </a><font color="#B22222">       state 4: Output both, CELL_DATA last </font>
-<a name="line133">133: </a><font color="#B22222">    */</font>
-<a name="line134">134: </a>    static <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> stateId = -1;
-<a name="line135">135: </a>    int outputState = 0;
-<a name="line136">136: </a>    <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> hasState;
-<a name="line137">137: </a>    int doOutput = 0;
-<a name="line138">138: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
-
-<a name="line140">140: </a>    <font color="#4169E1">if</font> (stateId &lt; 0) {
-<a name="line141">141: </a>      <A href="../../../../../docs/manualpages/Sys/PetscObjectComposedDataRegister.html#PetscObjectComposedDataRegister">PetscObjectComposedDataRegister</A>(&amp;stateId);
-<a name="line142">142: </a>    }
-<a name="line143">143: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectComposedDataGetInt.html#PetscObjectComposedDataGetInt">PetscObjectComposedDataGetInt</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) viewer, stateId, outputState, hasState);
-<a name="line144">144: </a>    <font color="#4169E1">if</font> (!hasState) {
-<a name="line145">145: </a>      outputState = 0;
+<a name="line15"> 15: </a><font color="#A020F0">#if defined(PETSC_HAVE_HDF5)</font>
+<a name="line17"> 17: </a><font color="#A020F0">#endif</font>
+
+<a name="line19"> 19: </a><font color="#A020F0">#include </font><font color="#666666">"../src/vec/vec/impls/seq/ftn-kernels/fnorm.h"</font><font color="#A020F0"></font>
+<a name="line22"> 22: </a><strong><font color="#4169E1"><a name="VecNorm_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecNorm_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Vec/NormType.html#NormType">NormType</A> type,<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>* z)</font></strong>
+<a name="line23"> 23: </a>{
+<a name="line24"> 24: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *xx;
+<a name="line26"> 26: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = xin-&gt;map-&gt;n;
+<a name="line27"> 27: </a>  <A href="../../../../../docs/manualpages/Sys/PetscBLASInt.html#PetscBLASInt">PetscBLASInt</A>   one = 1, bn = PetscBLASIntCast(n);
+
+<a name="line30"> 30: </a>  <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A> || type == <A href="../../../../../docs/manualpages/Vec/NORM_FROBENIUS.html#NORM_FROBENIUS">NORM_FROBENIUS</A>) {
+<a name="line31"> 31: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xx);
+<a name="line32"> 32: </a>    <font color="#B22222">/*</font>
+<a name="line33"> 33: </a><font color="#B22222">      This is because the Fortran BLAS 1 Norm is very slow! </font>
+<a name="line34"> 34: </a><font color="#B22222">    */</font>
+<a name="line35"> 35: </a><font color="#A020F0">#if defined(PETSC_HAVE_SLOW_BLAS_NORM2)</font>
+<a name="line36"> 36: </a><font color="#A020F0">#if defined(PETSC_USE_FORTRAN_KERNEL_NORM)</font>
+<a name="line37"> 37: </a>    fortrannormsqr_(xx,&amp;n,z);
+<a name="line38"> 38: </a>    *z = sqrt(*z);
+<a name="line39"> 39: </a><font color="#A020F0">#elif defined(PETSC_USE_UNROLLED_NORM)</font>
+<a name="line40"> 40: </a>    {
+<a name="line41"> 41: </a>    <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> work = 0.0;
+<a name="line42"> 42: </a>    <font color="#4169E1">switch</font> (n &amp; 0x3) {
+<a name="line43"> 43: </a>      <font color="#4169E1">case</font> 3: work += PetscRealPart(xx[0]*PetscConj(xx[0])); xx++;
+<a name="line44"> 44: </a>      <font color="#4169E1">case</font> 2: work += PetscRealPart(xx[0]*PetscConj(xx[0])); xx++;
+<a name="line45"> 45: </a>      <font color="#4169E1">case</font> 1: work += PetscRealPart(xx[0]*PetscConj(xx[0])); xx++; n -= 4;
+<a name="line46"> 46: </a>    }
+<a name="line47"> 47: </a>    <font color="#4169E1">while</font> (n&gt;0) {
+<a name="line48"> 48: </a>      work += PetscRealPart(xx[0]*PetscConj(xx[0])+xx[1]*PetscConj(xx[1])+
+<a name="line49"> 49: </a>                        xx[2]*PetscConj(xx[2])+xx[3]*PetscConj(xx[3]));
+<a name="line50"> 50: </a>      xx += 4; n -= 4;
+<a name="line51"> 51: </a>    }
+<a name="line52"> 52: </a>    *z = sqrt(work);}
+<a name="line53"> 53: </a><font color="#A020F0">#else</font>
+<a name="line54"> 54: </a>    {
+<a name="line55"> 55: </a>      <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>         i;
+<a name="line56"> 56: </a>      <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> sum=0.0;
+<a name="line57"> 57: </a>      <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line58"> 58: </a>        sum += (xx[i])*(PetscConj(xx[i]));
+<a name="line59"> 59: </a>      }
+<a name="line60"> 60: </a>      *z = sqrt(PetscRealPart(sum));
+<a name="line61"> 61: </a>    }
+<a name="line62"> 62: </a><font color="#A020F0">#endif</font>
+<a name="line63"> 63: </a><font color="#A020F0">#else</font>
+<a name="line64"> 64: </a>    *z = BLASnrm2_(&amp;bn,xx,&amp;one);
+<a name="line65"> 65: </a><font color="#A020F0">#endif</font>
+<a name="line66"> 66: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xin,&amp;xx);
+<a name="line67"> 67: </a>    <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(PetscMax(2.0*n-1,0.0));
+<a name="line68"> 68: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_INFINITY.html#NORM_INFINITY">NORM_INFINITY</A>) {
+<a name="line69"> 69: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          i;
+<a name="line70"> 70: </a>    <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>    max = 0.0,tmp;
+
+<a name="line72"> 72: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xx);
+<a name="line73"> 73: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line74"> 74: </a>      <font color="#4169E1">if</font> ((tmp = PetscAbsScalar(*xx)) &gt; max) max = tmp;
+<a name="line75"> 75: </a>      <font color="#B22222">/* check special case of tmp == NaN */</font>
+<a name="line76"> 76: </a>      <font color="#4169E1">if</font> (tmp != tmp) {max = tmp; <font color="#4169E1">break</font>;}
+<a name="line77"> 77: </a>      xx++;
+<a name="line78"> 78: </a>    }
+<a name="line79"> 79: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xin,&amp;xx);
+<a name="line80"> 80: </a>    *z   = max;
+<a name="line81"> 81: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_1.html#NORM_1">NORM_1</A>) {
+<a name="line82"> 82: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xx);
+<a name="line83"> 83: </a>    *z = BLASasum_(&amp;bn,xx,&amp;one);
+<a name="line84"> 84: </a>    <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(xin,&amp;xx);
+<a name="line85"> 85: </a>    <A href="../../../../../docs/manualpages/Profiling/PetscLogFlops.html#PetscLogFlops">PetscLogFlops</A>(PetscMax(n-1.0,0.0));
+<a name="line86"> 86: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (type == <A href="../../../../../docs/manualpages/Vec/NORM_1_AND_2.html#NORM_1_AND_2">NORM_1_AND_2</A>) {
+<a name="line87"> 87: </a>    VecNorm_Seq(xin,<A href="../../../../../docs/manualpages/Vec/NORM_1.html#NORM_1">NORM_1</A>,z);
+<a name="line88"> 88: </a>    VecNorm_Seq(xin,<A href="../../../../../docs/manualpages/Vec/NORM_2.html#NORM_2">NORM_2</A>,z+1);
+<a name="line89"> 89: </a>  }
+<a name="line90"> 90: </a>  <font color="#4169E1">return</font>(0);
+<a name="line91"> 91: </a>}
+
+<a name="line95"> 95: </a><strong><font color="#4169E1"><a name="VecView_Seq_File"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_File(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line96"> 96: </a>{
+<a name="line97"> 97: </a>  Vec_Seq           *x = (Vec_Seq *)xin-&gt;data;
+<a name="line98"> 98: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line99"> 99: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>          i,n = xin-&gt;map-&gt;n;
+<a name="line100">100: </a>  const char        *name;
+<a name="line101">101: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
+
+<a name="line104">104: </a>  PetscViewerGetFormat(viewer,&amp;format);
+<a name="line105">105: </a>  <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_MATLAB) {
+<a name="line106">106: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin,&amp;name);
+<a name="line107">107: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%s = [\n"</font>,name);
+<a name="line108">108: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line109">109: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
+<a name="line110">110: </a>      <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &gt; 0.0) {
+<a name="line111">111: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e + %18.16ei\n"</font>,PetscRealPart(x-&gt;array[i]),PetscImaginaryPart(x-&gt;array[i]));
+<a name="line112">112: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &lt; 0.0) {
+<a name="line113">113: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e - %18.16ei\n"</font>,PetscRealPart(x-&gt;array[i]),-PetscImaginaryPart(x-&gt;array[i]));
+<a name="line114">114: </a>      } <font color="#4169E1">else</font> {
+<a name="line115">115: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e\n"</font>,PetscRealPart(x-&gt;array[i]));
+<a name="line116">116: </a>      }
+<a name="line117">117: </a><font color="#A020F0">#else</font>
+<a name="line118">118: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e\n"</font>,x-&gt;array[i]);
+<a name="line119">119: </a><font color="#A020F0">#endif</font>
+<a name="line120">120: </a>    }
+<a name="line121">121: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"];\n"</font>);
+<a name="line122">122: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_SYMMODU) {
+<a name="line123">123: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line124">124: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
+<a name="line125">125: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e %18.16e\n"</font>,PetscRealPart(x-&gt;array[i]),PetscImaginaryPart(x-&gt;array[i]));
+<a name="line126">126: </a><font color="#A020F0">#else</font>
+<a name="line127">127: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%18.16e\n"</font>,x-&gt;array[i]);
+<a name="line128">128: </a><font color="#A020F0">#endif</font>
+<a name="line129">129: </a>    }
+<a name="line130">130: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_VTK || format == PETSC_VIEWER_ASCII_VTK_CELL) {
+<a name="line131">131: </a>    <font color="#B22222">/* </font>
+<a name="line132">132: </a><font color="#B22222">       state 0: No header has been output</font>
+<a name="line133">133: </a><font color="#B22222">       state 1: Only POINT_DATA has been output</font>
+<a name="line134">134: </a><font color="#B22222">       state 2: Only CELL_DATA has been output</font>
+<a name="line135">135: </a><font color="#B22222">       state 3: Output both, POINT_DATA last</font>
+<a name="line136">136: </a><font color="#B22222">       state 4: Output both, CELL_DATA last </font>
+<a name="line137">137: </a><font color="#B22222">    */</font>
+<a name="line138">138: </a>    static <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> stateId = -1;
+<a name="line139">139: </a>    int outputState = 0;
+<a name="line140">140: </a>    <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> hasState;
+<a name="line141">141: </a>    int doOutput = 0;
+<a name="line142">142: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
+
+<a name="line144">144: </a>    <font color="#4169E1">if</font> (stateId &lt; 0) {
+<a name="line145">145: </a>      <A href="../../../../../docs/manualpages/Sys/PetscObjectComposedDataRegister.html#PetscObjectComposedDataRegister">PetscObjectComposedDataRegister</A>(&amp;stateId);
 <a name="line146">146: </a>    }
-<a name="line147">147: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) xin, &amp;name);
-<a name="line148">148: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
-<a name="line149">149: </a>    <font color="#4169E1">if</font> ((bs &lt; 1) || (bs &gt; 3)) {
-<a name="line150">150: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"VTK can only handle 3D objects, but vector dimension is %d"</font>, bs);
-<a name="line151">151: </a>    }
-<a name="line152">152: </a>    <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_VTK) {
-<a name="line153">153: </a>      <font color="#4169E1">if</font> (outputState == 0) {
-<a name="line154">154: </a>        outputState = 1;
-<a name="line155">155: </a>        doOutput = 1;
-<a name="line156">156: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 1) {
-<a name="line157">157: </a>        doOutput = 0;
-<a name="line158">158: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 2) {
-<a name="line159">159: </a>        outputState = 3;
-<a name="line160">160: </a>        doOutput = 1;
-<a name="line161">161: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 3) {
-<a name="line162">162: </a>        doOutput = 0;
-<a name="line163">163: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 4) {
-<a name="line164">164: </a>        <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"Tried to output POINT_DATA again after intervening CELL_DATA"</font>);
-<a name="line165">165: </a>      }
-<a name="line166">166: </a>      <font color="#4169E1">if</font> (doOutput) {
-<a name="line167">167: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"POINT_DATA %d\n"</font>, n);
-<a name="line168">168: </a>      }
-<a name="line169">169: </a>    } <font color="#4169E1">else</font> {
-<a name="line170">170: </a>      <font color="#4169E1">if</font> (outputState == 0) {
-<a name="line171">171: </a>        outputState = 2;
-<a name="line172">172: </a>        doOutput = 1;
-<a name="line173">173: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 1) {
-<a name="line174">174: </a>        outputState = 4;
-<a name="line175">175: </a>        doOutput = 1;
-<a name="line176">176: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 2) {
-<a name="line177">177: </a>        doOutput = 0;
-<a name="line178">178: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 3) {
-<a name="line179">179: </a>        <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"Tried to output CELL_DATA again after intervening POINT_DATA"</font>);
-<a name="line180">180: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 4) {
+<a name="line147">147: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectComposedDataGetInt.html#PetscObjectComposedDataGetInt">PetscObjectComposedDataGetInt</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) viewer, stateId, outputState, hasState);
+<a name="line148">148: </a>    <font color="#4169E1">if</font> (!hasState) {
+<a name="line149">149: </a>      outputState = 0;
+<a name="line150">150: </a>    }
+<a name="line151">151: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectGetName.html#PetscObjectGetName">PetscObjectGetName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) xin, &amp;name);
+<a name="line152">152: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
+<a name="line153">153: </a>    <font color="#4169E1">if</font> ((bs &lt; 1) || (bs &gt; 3)) {
+<a name="line154">154: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"VTK can only handle 3D objects, but vector dimension is %d"</font>, bs);
+<a name="line155">155: </a>    }
+<a name="line156">156: </a>    <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_VTK) {
+<a name="line157">157: </a>      <font color="#4169E1">if</font> (outputState == 0) {
+<a name="line158">158: </a>        outputState = 1;
+<a name="line159">159: </a>        doOutput = 1;
+<a name="line160">160: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 1) {
+<a name="line161">161: </a>        doOutput = 0;
+<a name="line162">162: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 2) {
+<a name="line163">163: </a>        outputState = 3;
+<a name="line164">164: </a>        doOutput = 1;
+<a name="line165">165: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 3) {
+<a name="line166">166: </a>        doOutput = 0;
+<a name="line167">167: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 4) {
+<a name="line168">168: </a>        <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"Tried to output POINT_DATA again after intervening CELL_DATA"</font>);
+<a name="line169">169: </a>      }
+<a name="line170">170: </a>      <font color="#4169E1">if</font> (doOutput) {
+<a name="line171">171: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"POINT_DATA %d\n"</font>, n);
+<a name="line172">172: </a>      }
+<a name="line173">173: </a>    } <font color="#4169E1">else</font> {
+<a name="line174">174: </a>      <font color="#4169E1">if</font> (outputState == 0) {
+<a name="line175">175: </a>        outputState = 2;
+<a name="line176">176: </a>        doOutput = 1;
+<a name="line177">177: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 1) {
+<a name="line178">178: </a>        outputState = 4;
+<a name="line179">179: </a>        doOutput = 1;
+<a name="line180">180: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 2) {
 <a name="line181">181: </a>        doOutput = 0;
-<a name="line182">182: </a>      }
-<a name="line183">183: </a>      <font color="#4169E1">if</font> (doOutput) {
-<a name="line184">184: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"CELL_DATA %d\n"</font>, n);
-<a name="line185">185: </a>      }
-<a name="line186">186: </a>    }
-<a name="line187">187: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectComposedDataSetInt.html#PetscObjectComposedDataSetInt">PetscObjectComposedDataSetInt</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) viewer, stateId, outputState);
-<a name="line188">188: </a>    <font color="#4169E1">if</font> (name) {
-<a name="line189">189: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"SCALARS %s double %d\n"</font>, name, bs);
-<a name="line190">190: </a>    } <font color="#4169E1">else</font> {
-<a name="line191">191: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"SCALARS scalars double %d\n"</font>, bs);
-<a name="line192">192: </a>    }
-<a name="line193">193: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"LOOKUP_TABLE default\n"</font>);
-<a name="line194">194: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
-<a name="line195">195: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
-<a name="line196">196: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
-<a name="line197">197: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
-<a name="line198">198: </a>        }
-<a name="line199">199: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line200">200: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G"</font>,x-&gt;array[i*bs+b]);
-<a name="line201">201: </a><font color="#A020F0">#endif</font>
-<a name="line202">202: </a>      }
-<a name="line203">203: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
-<a name="line204">204: </a>    }
-<a name="line205">205: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_VTK_COORDS) {
-<a name="line206">206: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
-
-<a name="line208">208: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
-<a name="line209">209: </a>    <font color="#4169E1">if</font> ((bs &lt; 1) || (bs &gt; 3)) {
-<a name="line210">210: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"VTK can only handle 3D objects, but vector dimension is %d"</font>, bs);
-<a name="line211">211: </a>    }
-<a name="line212">212: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
-<a name="line213">213: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
-<a name="line214">214: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
-<a name="line215">215: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
-<a name="line216">216: </a>        }
-<a name="line217">217: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line218">218: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G"</font>,x-&gt;array[i*bs+b]);
-<a name="line219">219: </a><font color="#A020F0">#endif</font>
-<a name="line220">220: </a>      }
-<a name="line221">221: </a>      <font color="#4169E1">for</font> (b=bs; b&lt;3; b++) {
-<a name="line222">222: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" 0.0"</font>);
-<a name="line223">223: </a>      }
-<a name="line224">224: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
-<a name="line225">225: </a>    }
-<a name="line226">226: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_PCICE) {
-<a name="line227">227: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
-
-<a name="line229">229: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
-<a name="line230">230: </a>    <font color="#4169E1">if</font> ((bs &lt; 1) || (bs &gt; 3)) {
-<a name="line231">231: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"PCICE can only handle up to 3D objects, but vector dimension is %d"</font>, bs);
-<a name="line232">232: </a>    }
-<a name="line233">233: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%D\n"</font>, xin-&gt;map-&gt;N/bs);
-<a name="line234">234: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
-<a name="line235">235: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%7D   "</font>, i+1);
-<a name="line236">236: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
-<a name="line237">237: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
-<a name="line238">238: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
-<a name="line239">239: </a>        }
-<a name="line240">240: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line241">241: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"% 12.5E"</font>,x-&gt;array[i*bs+b]);
-<a name="line242">242: </a><font color="#A020F0">#endif</font>
-<a name="line243">243: </a>      }
-<a name="line244">244: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
-<a name="line245">245: </a>    }
-<a name="line246">246: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_PYLITH) {
-<a name="line247">247: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
-
-<a name="line249">249: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
-<a name="line250">250: </a>    <font color="#4169E1">if</font> (bs != 3) {
-<a name="line251">251: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"PyLith can only handle 3D objects, but vector dimension is %d"</font>, bs);
-<a name="line252">252: </a>    }
-<a name="line253">253: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"#\n"</font>);
-<a name="line254">254: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"#  Node      X-coord           Y-coord           Z-coord\n"</font>);
-<a name="line255">255: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"#\n"</font>);
-<a name="line256">256: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
-<a name="line257">257: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%7D "</font>, i+1);
-<a name="line258">258: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
-<a name="line259">259: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
-<a name="line260">260: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
-<a name="line261">261: </a>        }
-<a name="line262">262: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line263">263: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"% 16.8E"</font>,x-&gt;array[i*bs+b]);
-<a name="line264">264: </a><font color="#A020F0">#endif</font>
-<a name="line265">265: </a>      }
-<a name="line266">266: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
-<a name="line267">267: </a>    }
-<a name="line268">268: </a>  } <font color="#4169E1">else</font> {
-<a name="line269">269: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line270">270: </a>      <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_INDEX) {
-<a name="line271">271: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%D: "</font>,i);
-<a name="line272">272: </a>      }
-<a name="line273">273: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
-<a name="line274">274: </a>      <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &gt; 0.0) {
-<a name="line275">275: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G + %G i\n"</font>,PetscRealPart(x-&gt;array[i]),PetscImaginaryPart(x-&gt;array[i]));
-<a name="line276">276: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &lt; 0.0) {
-<a name="line277">277: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G - %G i\n"</font>,PetscRealPart(x-&gt;array[i]),-PetscImaginaryPart(x-&gt;array[i]));
-<a name="line278">278: </a>      } <font color="#4169E1">else</font> {
-<a name="line279">279: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G\n"</font>,PetscRealPart(x-&gt;array[i]));
-<a name="line280">280: </a>      }
-<a name="line281">281: </a><font color="#A020F0">#else</font>
-<a name="line282">282: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G\n"</font>,x-&gt;array[i]);
-<a name="line283">283: </a><font color="#A020F0">#endif</font>
-<a name="line284">284: </a>    }
-<a name="line285">285: </a>  }
-<a name="line286">286: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(viewer);
-<a name="line287">287: </a>  <font color="#4169E1">return</font>(0);
-<a name="line288">288: </a>}
-
-<a name="line292">292: </a><strong><font color="#4169E1"><a name="VecView_Seq_Draw_LG"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Draw_LG(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> v)</font></strong>
-<a name="line293">293: </a>{
-<a name="line294">294: </a>  Vec_Seq        *x = (Vec_Seq *)xin-&gt;data;
-<a name="line296">296: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i,n = xin-&gt;map-&gt;n;
-<a name="line297">297: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDraw.html#PetscDraw">PetscDraw</A>      win;
-<a name="line298">298: </a>  <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      *xx;
-<a name="line299">299: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLG.html#PetscDrawLG">PetscDrawLG</A>    lg;
-
-<a name="line302">302: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDrawGetDrawLG.html#PetscViewerDrawGetDrawLG">PetscViewerDrawGetDrawLG</A>(v,0,&amp;lg);
-<a name="line303">303: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGGetDraw.html#PetscDrawLGGetDraw">PetscDrawLGGetDraw</A>(lg,&amp;win);
-<a name="line304">304: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawCheckResizedWindow.html#PetscDrawCheckResizedWindow">PetscDrawCheckResizedWindow</A>(win);
-<a name="line305">305: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGReset.html#PetscDrawLGReset">PetscDrawLGReset</A>(lg);
-<a name="line306">306: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>),&amp;xx);
-<a name="line307">307: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line308">308: </a>    xx[i] = (<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>) i;
-<a name="line309">309: </a>  }
-<a name="line310">310: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line311">311: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGAddPoints.html#PetscDrawLGAddPoints">PetscDrawLGAddPoints</A>(lg,n,&amp;xx,&amp;x-&gt;array);
-<a name="line312">312: </a><font color="#A020F0">#else </font>
-<a name="line313">313: </a>  {
-<a name="line314">314: </a>    <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *yy;
-<a name="line315">315: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>),&amp;yy);
-<a name="line316">316: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line317">317: </a>      yy[i] = PetscRealPart(x-&gt;array[i]);
-<a name="line318">318: </a>    }
-<a name="line319">319: </a>    <A href="../../../../../docs/manualpages/Draw/PetscDrawLGAddPoints.html#PetscDrawLGAddPoints">PetscDrawLGAddPoints</A>(lg,n,&amp;xx,&amp;yy);
-<a name="line320">320: </a>    <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(yy);
-<a name="line321">321: </a>  }
-<a name="line322">322: </a><font color="#A020F0">#endif</font>
-<a name="line323">323: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(xx);
-<a name="line324">324: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGDraw.html#PetscDrawLGDraw">PetscDrawLGDraw</A>(lg);
-<a name="line325">325: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawSynchronizedFlush.html#PetscDrawSynchronizedFlush">PetscDrawSynchronizedFlush</A>(win);
-<a name="line326">326: </a>  <font color="#4169E1">return</font>(0);
-<a name="line327">327: </a>}
-
-<a name="line331">331: </a><strong><font color="#4169E1"><a name="VecView_Seq_Draw"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Draw(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> v)</font></strong>
-<a name="line332">332: </a>{
-<a name="line333">333: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
-<a name="line334">334: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDraw.html#PetscDraw">PetscDraw</A>         draw;
-<a name="line335">335: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        isnull;
-<a name="line336">336: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
-
-<a name="line339">339: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDrawGetDraw.html#PetscViewerDrawGetDraw">PetscViewerDrawGetDraw</A>(v,0,&amp;draw);
-<a name="line340">340: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawIsNull.html#PetscDrawIsNull">PetscDrawIsNull</A>(draw,&amp;isnull); <font color="#4169E1">if</font> (isnull) <font color="#4169E1">return</font>(0);
-<a name="line341">341: </a>
-<a name="line342">342: </a>  PetscViewerGetFormat(v,&amp;format);
-<a name="line343">343: </a>  <font color="#B22222">/*</font>
-<a name="line344">344: </a><font color="#B22222">     Currently it only supports drawing to a line graph */</font>
-<a name="line345">345: </a>  <font color="#4169E1">if</font> (format != PETSC_VIEWER_DRAW_LG) {
-<a name="line346">346: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerPushFormat.html#PetscViewerPushFormat">PetscViewerPushFormat</A>(v,PETSC_VIEWER_DRAW_LG);
-<a name="line347">347: </a>  }
-<a name="line348">348: </a>  VecView_Seq_Draw_LG(xin,v);
+<a name="line182">182: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 3) {
+<a name="line183">183: </a>        <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"Tried to output CELL_DATA again after intervening POINT_DATA"</font>);
+<a name="line184">184: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (outputState == 4) {
+<a name="line185">185: </a>        doOutput = 0;
+<a name="line186">186: </a>      }
+<a name="line187">187: </a>      <font color="#4169E1">if</font> (doOutput) {
+<a name="line188">188: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"CELL_DATA %d\n"</font>, n);
+<a name="line189">189: </a>      }
+<a name="line190">190: </a>    }
+<a name="line191">191: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectComposedDataSetInt.html#PetscObjectComposedDataSetInt">PetscObjectComposedDataSetInt</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) viewer, stateId, outputState);
+<a name="line192">192: </a>    <font color="#4169E1">if</font> (name) {
+<a name="line193">193: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"SCALARS %s double %d\n"</font>, name, bs);
+<a name="line194">194: </a>    } <font color="#4169E1">else</font> {
+<a name="line195">195: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"SCALARS scalars double %d\n"</font>, bs);
+<a name="line196">196: </a>    }
+<a name="line197">197: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer, <font color="#666666">"LOOKUP_TABLE default\n"</font>);
+<a name="line198">198: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
+<a name="line199">199: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
+<a name="line200">200: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
+<a name="line201">201: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
+<a name="line202">202: </a>        }
+<a name="line203">203: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line204">204: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G"</font>,x-&gt;array[i*bs+b]);
+<a name="line205">205: </a><font color="#A020F0">#endif</font>
+<a name="line206">206: </a>      }
+<a name="line207">207: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
+<a name="line208">208: </a>    }
+<a name="line209">209: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_VTK_COORDS) {
+<a name="line210">210: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
+
+<a name="line212">212: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
+<a name="line213">213: </a>    <font color="#4169E1">if</font> ((bs &lt; 1) || (bs &gt; 3)) {
+<a name="line214">214: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"VTK can only handle 3D objects, but vector dimension is %d"</font>, bs);
+<a name="line215">215: </a>    }
+<a name="line216">216: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
+<a name="line217">217: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
+<a name="line218">218: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
+<a name="line219">219: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
+<a name="line220">220: </a>        }
+<a name="line221">221: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line222">222: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G"</font>,x-&gt;array[i*bs+b]);
+<a name="line223">223: </a><font color="#A020F0">#endif</font>
+<a name="line224">224: </a>      }
+<a name="line225">225: </a>      <font color="#4169E1">for</font> (b=bs; b&lt;3; b++) {
+<a name="line226">226: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" 0.0"</font>);
+<a name="line227">227: </a>      }
+<a name="line228">228: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
+<a name="line229">229: </a>    }
+<a name="line230">230: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_PCICE) {
+<a name="line231">231: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
+
+<a name="line233">233: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
+<a name="line234">234: </a>    <font color="#4169E1">if</font> ((bs &lt; 1) || (bs &gt; 3)) {
+<a name="line235">235: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"PCICE can only handle up to 3D objects, but vector dimension is %d"</font>, bs);
+<a name="line236">236: </a>    }
+<a name="line237">237: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%D\n"</font>, xin-&gt;map-&gt;N/bs);
+<a name="line238">238: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
+<a name="line239">239: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%7D   "</font>, i+1);
+<a name="line240">240: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
+<a name="line241">241: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
+<a name="line242">242: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
+<a name="line243">243: </a>        }
+<a name="line244">244: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line245">245: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"% 12.5E"</font>,x-&gt;array[i*bs+b]);
+<a name="line246">246: </a><font color="#A020F0">#endif</font>
+<a name="line247">247: </a>      }
+<a name="line248">248: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
+<a name="line249">249: </a>    }
+<a name="line250">250: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_PYLITH) {
+<a name="line251">251: </a>    <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs, b;
+
+<a name="line253">253: </a>    <A href="../../../../../docs/manualpages/Vec/VecGetBlockSize.html#VecGetBlockSize">VecGetBlockSize</A>(xin, &amp;bs);
+<a name="line254">254: </a>    <font color="#4169E1">if</font> (bs != 3) {
+<a name="line255">255: </a>      <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_WRONGSTATE, <font color="#666666">"PyLith can only handle 3D objects, but vector dimension is %d"</font>, bs);
+<a name="line256">256: </a>    }
+<a name="line257">257: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"#\n"</font>);
+<a name="line258">258: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"#  Node      X-coord           Y-coord           Z-coord\n"</font>);
+<a name="line259">259: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"#\n"</font>);
+<a name="line260">260: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n/bs; i++) {
+<a name="line261">261: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%7D "</font>, i+1);
+<a name="line262">262: </a>      <font color="#4169E1">for</font> (b=0; b&lt;bs; b++) {
+<a name="line263">263: </a>        <font color="#4169E1">if</font> (b &gt; 0) {
+<a name="line264">264: </a>          <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">" "</font>);
+<a name="line265">265: </a>        }
+<a name="line266">266: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line267">267: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"% 16.8E"</font>,x-&gt;array[i*bs+b]);
+<a name="line268">268: </a><font color="#A020F0">#endif</font>
+<a name="line269">269: </a>      }
+<a name="line270">270: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"\n"</font>);
+<a name="line271">271: </a>    }
+<a name="line272">272: </a>  } <font color="#4169E1">else</font> {
+<a name="line273">273: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line274">274: </a>      <font color="#4169E1">if</font> (format == PETSC_VIEWER_ASCII_INDEX) {
+<a name="line275">275: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%D: "</font>,i);
+<a name="line276">276: </a>      }
+<a name="line277">277: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
+<a name="line278">278: </a>      <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &gt; 0.0) {
+<a name="line279">279: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G + %G i\n"</font>,PetscRealPart(x-&gt;array[i]),PetscImaginaryPart(x-&gt;array[i]));
+<a name="line280">280: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (PetscImaginaryPart(x-&gt;array[i]) &lt; 0.0) {
+<a name="line281">281: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G - %G i\n"</font>,PetscRealPart(x-&gt;array[i]),-PetscImaginaryPart(x-&gt;array[i]));
+<a name="line282">282: </a>      } <font color="#4169E1">else</font> {
+<a name="line283">283: </a>        <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G\n"</font>,PetscRealPart(x-&gt;array[i]));
+<a name="line284">284: </a>      }
+<a name="line285">285: </a><font color="#A020F0">#else</font>
+<a name="line286">286: </a>      <A href="../../../../../docs/manualpages/Viewer/PetscViewerASCIIPrintf.html#PetscViewerASCIIPrintf">PetscViewerASCIIPrintf</A>(viewer,<font color="#666666">"%G\n"</font>,x-&gt;array[i]);
+<a name="line287">287: </a><font color="#A020F0">#endif</font>
+<a name="line288">288: </a>    }
+<a name="line289">289: </a>  }
+<a name="line290">290: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFlush.html#PetscViewerFlush">PetscViewerFlush</A>(viewer);
+<a name="line291">291: </a>  <font color="#4169E1">return</font>(0);
+<a name="line292">292: </a>}
+
+<a name="line296">296: </a><strong><font color="#4169E1"><a name="VecView_Seq_Draw_LG"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Draw_LG(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> v)</font></strong>
+<a name="line297">297: </a>{
+<a name="line298">298: </a>  Vec_Seq        *x = (Vec_Seq *)xin-&gt;data;
+<a name="line300">300: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i,n = xin-&gt;map-&gt;n;
+<a name="line301">301: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDraw.html#PetscDraw">PetscDraw</A>      win;
+<a name="line302">302: </a>  <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>      *xx;
+<a name="line303">303: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLG.html#PetscDrawLG">PetscDrawLG</A>    lg;
+
+<a name="line306">306: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDrawGetDrawLG.html#PetscViewerDrawGetDrawLG">PetscViewerDrawGetDrawLG</A>(v,0,&amp;lg);
+<a name="line307">307: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGGetDraw.html#PetscDrawLGGetDraw">PetscDrawLGGetDraw</A>(lg,&amp;win);
+<a name="line308">308: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawCheckResizedWindow.html#PetscDrawCheckResizedWindow">PetscDrawCheckResizedWindow</A>(win);
+<a name="line309">309: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGReset.html#PetscDrawLGReset">PetscDrawLGReset</A>(lg);
+<a name="line310">310: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>),&amp;xx);
+<a name="line311">311: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line312">312: </a>    xx[i] = (<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>) i;
+<a name="line313">313: </a>  }
+<a name="line314">314: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line315">315: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGAddPoints.html#PetscDrawLGAddPoints">PetscDrawLGAddPoints</A>(lg,n,&amp;xx,&amp;x-&gt;array);
+<a name="line316">316: </a><font color="#A020F0">#else </font>
+<a name="line317">317: </a>  {
+<a name="line318">318: </a>    <A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A> *yy;
+<a name="line319">319: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>((n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscReal.html#PetscReal">PetscReal</A>),&amp;yy);
+<a name="line320">320: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line321">321: </a>      yy[i] = PetscRealPart(x-&gt;array[i]);
+<a name="line322">322: </a>    }
+<a name="line323">323: </a>    <A href="../../../../../docs/manualpages/Draw/PetscDrawLGAddPoints.html#PetscDrawLGAddPoints">PetscDrawLGAddPoints</A>(lg,n,&amp;xx,&amp;yy);
+<a name="line324">324: </a>    <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(yy);
+<a name="line325">325: </a>  }
+<a name="line326">326: </a><font color="#A020F0">#endif</font>
+<a name="line327">327: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(xx);
+<a name="line328">328: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawLGDraw.html#PetscDrawLGDraw">PetscDrawLGDraw</A>(lg);
+<a name="line329">329: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawSynchronizedFlush.html#PetscDrawSynchronizedFlush">PetscDrawSynchronizedFlush</A>(win);
+<a name="line330">330: </a>  <font color="#4169E1">return</font>(0);
+<a name="line331">331: </a>}
+
+<a name="line335">335: </a><strong><font color="#4169E1"><a name="VecView_Seq_Draw"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Draw(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> v)</font></strong>
+<a name="line336">336: </a>{
+<a name="line337">337: </a>  <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>    ierr;
+<a name="line338">338: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDraw.html#PetscDraw">PetscDraw</A>         draw;
+<a name="line339">339: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>        isnull;
+<a name="line340">340: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerFormat.html#PetscViewerFormat">PetscViewerFormat</A> format;
+
+<a name="line343">343: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerDrawGetDraw.html#PetscViewerDrawGetDraw">PetscViewerDrawGetDraw</A>(v,0,&amp;draw);
+<a name="line344">344: </a>  <A href="../../../../../docs/manualpages/Draw/PetscDrawIsNull.html#PetscDrawIsNull">PetscDrawIsNull</A>(draw,&amp;isnull); <font color="#4169E1">if</font> (isnull) <font color="#4169E1">return</font>(0);
+<a name="line345">345: </a>
+<a name="line346">346: </a>  PetscViewerGetFormat(v,&amp;format);
+<a name="line347">347: </a>  <font color="#B22222">/*</font>
+<a name="line348">348: </a><font color="#B22222">     Currently it only supports drawing to a line graph */</font>
 <a name="line349">349: </a>  <font color="#4169E1">if</font> (format != PETSC_VIEWER_DRAW_LG) {
-<a name="line350">350: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerPopFormat.html#PetscViewerPopFormat">PetscViewerPopFormat</A>(v);
+<a name="line350">350: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerPushFormat.html#PetscViewerPushFormat">PetscViewerPushFormat</A>(v,PETSC_VIEWER_DRAW_LG);
 <a name="line351">351: </a>  }
-
-<a name="line353">353: </a>  <font color="#4169E1">return</font>(0);
-<a name="line354">354: </a>}
-
-<a name="line358">358: </a><strong><font color="#4169E1"><a name="VecView_Seq_Binary"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Binary(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line359">359: </a>{
-<a name="line360">360: </a>  Vec_Seq        *x = (Vec_Seq *)xin-&gt;data;
-<a name="line362">362: </a>  int            fdes;
-<a name="line363">363: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = xin-&gt;map-&gt;n,cookie=VEC_FILE_COOKIE;
-<a name="line364">364: </a>  FILE           *file;
-<a name="line365">365: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPIIO)</font>
-<a name="line366">366: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isMPIIO;
-<a name="line367">367: </a><font color="#A020F0">#endif</font>
-
-
-<a name="line371">371: </a>  <font color="#B22222">/* Write vector header */</font>
-<a name="line372">372: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryWrite.html#PetscViewerBinaryWrite">PetscViewerBinaryWrite</A>(viewer,&amp;cookie,1,PETSC_INT,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-<a name="line373">373: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryWrite.html#PetscViewerBinaryWrite">PetscViewerBinaryWrite</A>(viewer,&amp;n,1,PETSC_INT,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-
-<a name="line375">375: </a>  <font color="#B22222">/* Write vector contents */</font>
-<a name="line376">376: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPIIO)</font>
-<a name="line377">377: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetMPIIO.html#PetscViewerBinaryGetMPIIO">PetscViewerBinaryGetMPIIO</A>(viewer,&amp;isMPIIO);
-<a name="line378">378: </a>  <font color="#4169E1">if</font> (!isMPIIO) {
-<a name="line379">379: </a><font color="#A020F0">#endif</font>
-<a name="line380">380: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetDescriptor.html#PetscViewerBinaryGetDescriptor">PetscViewerBinaryGetDescriptor</A>(viewer,&amp;fdes);
-<a name="line381">381: </a>    <A href="../../../../../docs/manualpages/Sys/PetscBinaryWrite.html#PetscBinaryWrite">PetscBinaryWrite</A>(fdes,x-&gt;array,n,PETSC_SCALAR,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
-<a name="line382">382: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPIIO)</font>
-<a name="line383">383: </a>  } <font color="#4169E1">else</font> {
-<a name="line384">384: </a>    MPI_Offset   off;
-<a name="line385">385: </a>    MPI_File     mfdes;
-<a name="line386">386: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>  gsizes[1],lsizes[1],lstarts[1];
-<a name="line387">387: </a>    MPI_Datatype view;
-
-<a name="line389">389: </a>    gsizes[0]  = PetscMPIIntCast(n);
-<a name="line390">390: </a>    lsizes[0]  = PetscMPIIntCast(n);
-<a name="line391">391: </a>    lstarts[0] = 0;
-<a name="line392">392: </a>    MPI_Type_create_subarray(1,gsizes,lsizes,lstarts,MPI_ORDER_FORTRAN,<A href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,&amp;view);
-<a name="line393">393: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_commit.html#MPI_Type_commit">MPI_Type_commit</A>(&amp;view);
-
-<a name="line395">395: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetMPIIODescriptor.html#PetscViewerBinaryGetMPIIODescriptor">PetscViewerBinaryGetMPIIODescriptor</A>(viewer,&amp;mfdes);
-<a name="line396">396: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetMPIIOOffset.html#PetscViewerBinaryGetMPIIOOffset">PetscViewerBinaryGetMPIIOOffset</A>(viewer,&amp;off);
-<a name="line397">397: </a>    MPIU_File_write_all(mfdes,x-&gt;array,lsizes[0],<A href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,MPI_STATUS_IGNORE);
-<a name="line398">398: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryAddMPIIOOffset.html#PetscViewerBinaryAddMPIIOOffset">PetscViewerBinaryAddMPIIOOffset</A>(viewer,n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-<a name="line399">399: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;view);
-<a name="line400">400: </a>  }
-<a name="line401">401: </a><font color="#A020F0">#endif</font>
-
-<a name="line403">403: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetInfoPointer.html#PetscViewerBinaryGetInfoPointer">PetscViewerBinaryGetInfoPointer</A>(viewer,&amp;file);
-<a name="line404">404: </a>  <font color="#4169E1">if</font> (file &amp;&amp; xin-&gt;map-&gt;bs &gt; 1) {
-<a name="line405">405: </a>    <font color="#4169E1">if</font> (((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin)-&gt;prefix) {
-<a name="line406">406: </a>      <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,file,<font color="#666666">"-%s_vecload_block_size %D\n"</font>,((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin)-&gt;prefix,xin-&gt;map-&gt;bs);
-<a name="line407">407: </a>    } <font color="#4169E1">else</font> {
-<a name="line408">408: </a>      <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,file,<font color="#666666">"-vecload_block_size %D\n"</font>,xin-&gt;map-&gt;bs);
-<a name="line409">409: </a>    }
-<a name="line410">410: </a>  }
-<a name="line411">411: </a>  <font color="#4169E1">return</font>(0);
-<a name="line412">412: </a>}
-
-<a name="line414">414: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
-<a name="line417">417: </a><strong><font color="#4169E1"><a name="VecView_Seq_Netcdf"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Netcdf(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> v)</font></strong>
-<a name="line418">418: </a>{
-<a name="line420">420: </a>  int            n = xin-&gt;map-&gt;n,ncid,xdim,xdim_num=1,xin_id,xstart=0;
-<a name="line421">421: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *xarray;
-
-<a name="line424">424: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line425">425: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xarray);
-<a name="line426">426: </a>  PetscViewerNetcdfGetID(v,&amp;ncid);
-<a name="line427">427: </a>  <font color="#4169E1">if</font> (ncid &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"First call PetscViewerNetcdfOpen to create NetCDF dataset"</font>);
-<a name="line428">428: </a>  <font color="#B22222">/* define dimensions */</font>
-<a name="line429">429: </a>  ncmpi_def_dim(ncid,<font color="#666666">"PETSc_Vector_Global_Size"</font>,n,&amp;xdim);
-<a name="line430">430: </a>  <font color="#B22222">/* define variables */</font>
-<a name="line431">431: </a>  ncmpi_def_var(ncid,<font color="#666666">"PETSc_Vector_Seq"</font>,NC_DOUBLE,xdim_num,&amp;xdim,&amp;xin_id);
-<a name="line432">432: </a>  <font color="#B22222">/* leave define mode */</font>
-<a name="line433">433: </a>  ncmpi_enddef(ncid);
-<a name="line434">434: </a>  <font color="#B22222">/* store the vector */</font>
-<a name="line435">435: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetOwnershipRange.html#VecGetOwnershipRange">VecGetOwnershipRange</A>(xin,&amp;xstart,<A href="../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line436">436: </a>  ncmpi_put_vara_double_all(ncid,xin_id,(const MPI_Offset*)&amp;xstart,(const MPI_Offset*)&amp;n,xarray);
-<a name="line437">437: </a><font color="#A020F0">#else </font>
-<a name="line438">438: </a>    <A href="../../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"NetCDF viewer not supported for complex numbers\n"</font>);
-<a name="line439">439: </a><font color="#A020F0">#endif</font>
-<a name="line440">440: </a>  <font color="#4169E1">return</font>(0);
-<a name="line441">441: </a>}
-<a name="line442">442: </a><font color="#A020F0">#endif</font>
-
-<a name="line444">444: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
-<a name="line445">445: </a><font color="#A020F0">#include </font><font color="#666666">"mat.h"</font><font color="#A020F0">   </font><font color="#B22222">/* Matlab include file */</font><font color="#A020F0"></font>
-<a name="line449">449: </a><strong><font color="#4169E1"><a name="VecView_Seq_Matlab"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Matlab(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> vec,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line450">450: </a>{
-<a name="line452">452: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n;
-<a name="line453">453: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *array;
-<a name="line454">454: </a>
-<a name="line456">456: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetLocalSize.html#VecGetLocalSize">VecGetLocalSize</A>(vec,&amp;n);
-<a name="line457">457: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectName.html#PetscObjectName">PetscObjectName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vec);
-<a name="line458">458: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(vec,&amp;array);
-<a name="line459">459: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerMatlabPutArray.html#PetscViewerMatlabPutArray">PetscViewerMatlabPutArray</A>(viewer,n,1,array,((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vec)-&gt;name);
-<a name="line460">460: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(vec,&amp;array);
-<a name="line461">461: </a>  <font color="#4169E1">return</font>(0);
-<a name="line462">462: </a>}
-<a name="line464">464: </a><font color="#A020F0">#endif</font>
-
-<a name="line468">468: </a><strong><font color="#4169E1"><a name="VecView_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
-<a name="line469">469: </a>{
-<a name="line471">471: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isdraw,iascii,issocket,isbinary;
-<a name="line472">472: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATHEMATICA)</font>
-<a name="line473">473: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     ismathematica;
-<a name="line474">474: </a><font color="#A020F0">#endif</font>
-<a name="line475">475: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
-<a name="line476">476: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isnetcdf;
-<a name="line477">477: </a><font color="#A020F0">#endif</font>
-<a name="line478">478: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
-<a name="line479">479: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     ismatlab;
-<a name="line480">480: </a><font color="#A020F0">#endif</font>
-
-<a name="line483">483: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_DRAW,&amp;isdraw);
-<a name="line484">484: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
-<a name="line485">485: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_SOCKET,&amp;issocket);
-<a name="line486">486: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_BINARY,&amp;isbinary);
-<a name="line487">487: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATHEMATICA)</font>
-<a name="line488">488: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_MATHEMATICA,&amp;ismathematica);
-<a name="line489">489: </a><font color="#A020F0">#endif</font>
-<a name="line490">490: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
-<a name="line491">491: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_NETCDF,&amp;isnetcdf);
-<a name="line492">492: </a><font color="#A020F0">#endif</font>
-<a name="line493">493: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
-<a name="line494">494: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<A href="../../../../../docs/manualpages/Viewer/PETSC_VIEWER_MATLAB.html#PETSC_VIEWER_MATLAB">PETSC_VIEWER_MATLAB</A>,&amp;ismatlab);
-<a name="line495">495: </a><font color="#A020F0">#endif</font>
-
-<a name="line497">497: </a>  <font color="#4169E1">if</font> (isdraw){
-<a name="line498">498: </a>    VecView_Seq_Draw(xin,viewer);
-<a name="line499">499: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (iascii){
-<a name="line500">500: </a>    VecView_Seq_File(xin,viewer);
-<a name="line501">501: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isbinary) {
-<a name="line502">502: </a>    VecView_Seq_Binary(xin,viewer);
-<a name="line503">503: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATHEMATICA)</font>
-<a name="line504">504: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ismathematica) {
-<a name="line505">505: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerMathematicaPutVector.html#PetscViewerMathematicaPutVector">PetscViewerMathematicaPutVector</A>(viewer,xin);
-<a name="line506">506: </a><font color="#A020F0">#endif</font>
-<a name="line507">507: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
-<a name="line508">508: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isnetcdf) {
-<a name="line509">509: </a>    VecView_Seq_Netcdf(xin,viewer);
-<a name="line510">510: </a><font color="#A020F0">#endif</font>
-<a name="line511">511: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
-<a name="line512">512: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ismatlab) {
-<a name="line513">513: </a>    VecView_Seq_Matlab(xin,viewer);
-<a name="line514">514: </a><font color="#A020F0">#endif</font>
-<a name="line515">515: </a>  } <font color="#4169E1">else</font> {
-<a name="line516">516: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"Viewer type %s not supported by this vector object"</font>,((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;type_name);
-<a name="line517">517: </a>  }
-<a name="line518">518: </a>  <font color="#4169E1">return</font>(0);
-<a name="line519">519: </a>}
-
-<a name="line523">523: </a><strong><font color="#4169E1"><a name="VecGetValues_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecGetValues_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ni,const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ix[],<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> y[])</font></strong>
-<a name="line524">524: </a>{
-<a name="line525">525: </a>  Vec_Seq     *x = (Vec_Seq *)xin-&gt;data;
-<a name="line526">526: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *xx = x-&gt;array;
-<a name="line527">527: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i;
-
-<a name="line530">530: </a>  <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
-<a name="line531">531: </a>    <font color="#4169E1">if</font> (xin-&gt;stash.ignorenegidx &amp;&amp; ix[i] &lt; 0) <font color="#4169E1">continue</font>;
-<a name="line532">532: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line533">533: </a>    <font color="#4169E1">if</font> (ix[i] &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D cannot be negative"</font>,ix[i]);
-<a name="line534">534: </a>    <font color="#4169E1">if</font> (ix[i] &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D to large maximum allowed %D"</font>,ix[i],xin-&gt;map-&gt;n);
-<a name="line535">535: </a><font color="#A020F0">#endif</font>
-<a name="line536">536: </a>    y[i] = xx[ix[i]];
-<a name="line537">537: </a>  }
-<a name="line538">538: </a>  <font color="#4169E1">return</font>(0);
-<a name="line539">539: </a>}
-
-<a name="line543">543: </a><strong><font color="#4169E1"><a name="VecSetValues_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecSetValues_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ni,const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ix[],const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> y[],<A href="../../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> m)</font></strong>
-<a name="line544">544: </a>{
-<a name="line545">545: </a>  Vec_Seq     *x = (Vec_Seq *)xin-&gt;data;
-<a name="line546">546: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *xx = x-&gt;array;
-<a name="line547">547: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i;
-
-<a name="line550">550: </a>  <font color="#4169E1">if</font> (m == <A href="../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>) {
-<a name="line551">551: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
-<a name="line552">552: </a>      <font color="#4169E1">if</font> (xin-&gt;stash.ignorenegidx &amp;&amp; ix[i] &lt; 0) <font color="#4169E1">continue</font>;
-<a name="line553">553: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line554">554: </a>      <font color="#4169E1">if</font> (ix[i] &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D cannot be negative"</font>,ix[i]);
-<a name="line555">555: </a>      <font color="#4169E1">if</font> (ix[i] &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,ix[i],xin-&gt;map-&gt;n);
-<a name="line556">556: </a><font color="#A020F0">#endif</font>
-<a name="line557">557: </a>      xx[ix[i]] = y[i];
-<a name="line558">558: </a>    }
-<a name="line559">559: </a>  } <font color="#4169E1">else</font> {
-<a name="line560">560: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
-<a name="line561">561: </a>      <font color="#4169E1">if</font> (xin-&gt;stash.ignorenegidx &amp;&amp; ix[i] &lt; 0) <font color="#4169E1">continue</font>;
-<a name="line562">562: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line563">563: </a>      <font color="#4169E1">if</font> (ix[i] &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D cannot be negative"</font>,ix[i]);
-<a name="line564">564: </a>      <font color="#4169E1">if</font> (ix[i] &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,ix[i],xin-&gt;map-&gt;n);
-<a name="line565">565: </a><font color="#A020F0">#endif</font>
-<a name="line566">566: </a>      xx[ix[i]] += y[i];
-<a name="line567">567: </a>    }
-<a name="line568">568: </a>  }
-<a name="line569">569: </a>  <font color="#4169E1">return</font>(0);
-<a name="line570">570: </a>}
-
-<a name="line574">574: </a><strong><font color="#4169E1"><a name="VecSetValuesBlocked_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecSetValuesBlocked_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ni,const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ix[],const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> yin[],<A href="../../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> m)</font></strong>
-<a name="line575">575: </a>{
-<a name="line576">576: </a>  Vec_Seq     *x = (Vec_Seq *)xin-&gt;data;
-<a name="line577">577: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *xx = x-&gt;array,*y = (<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>*)yin;
-<a name="line578">578: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i,bs = xin-&gt;map-&gt;bs,start,j;
-
-<a name="line580">580: </a>  <font color="#B22222">/*</font>
-<a name="line581">581: </a><font color="#B22222">       For optimization could treat bs = 2, 3, 4, 5 as special cases with loop unrolling</font>
-<a name="line582">582: </a><font color="#B22222">  */</font>
-<a name="line584">584: </a>  <font color="#4169E1">if</font> (m == <A href="../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>) {
-<a name="line585">585: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
-<a name="line586">586: </a>      start = bs*ix[i];
-<a name="line587">587: </a>      <font color="#4169E1">if</font> (start &lt; 0) <font color="#4169E1">continue</font>;
-<a name="line588">588: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line589">589: </a>      <font color="#4169E1">if</font> (start &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,start,xin-&gt;map-&gt;n);
-<a name="line590">590: </a><font color="#A020F0">#endif</font>
-<a name="line591">591: </a>      <font color="#4169E1">for</font> (j=0; j&lt;bs; j++) {
-<a name="line592">592: </a>        xx[start+j] = y[j];
-<a name="line593">593: </a>      }
-<a name="line594">594: </a>      y += bs;
-<a name="line595">595: </a>    }
-<a name="line596">596: </a>  } <font color="#4169E1">else</font> {
-<a name="line597">597: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
-<a name="line598">598: </a>      start = bs*ix[i];
-<a name="line599">599: </a>      <font color="#4169E1">if</font> (start &lt; 0) <font color="#4169E1">continue</font>;
-<a name="line600">600: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line601">601: </a>      <font color="#4169E1">if</font> (start &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,start,xin-&gt;map-&gt;n);
-<a name="line602">602: </a><font color="#A020F0">#endif</font>
-<a name="line603">603: </a>      <font color="#4169E1">for</font> (j=0; j&lt;bs; j++) {
-<a name="line604">604: </a>        xx[start+j] += y[j];
-<a name="line605">605: </a>      }
-<a name="line606">606: </a>      y += bs;
-<a name="line607">607: </a>    }
-<a name="line608">608: </a>  }
-<a name="line609">609: </a>  <font color="#4169E1">return</font>(0);
-<a name="line610">610: </a>}
-
-
-<a name="line615">615: </a><strong><font color="#4169E1"><a name="VecDestroy_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecDestroy_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v)</font></strong>
-<a name="line616">616: </a>{
-<a name="line617">617: </a>  Vec_Seq        *vs = (Vec_Seq*)v-&gt;data;
-
-
-<a name="line622">622: </a>  <font color="#B22222">/* if memory was published with AMS then destroy it */</font>
-<a name="line623">623: </a>  PetscObjectDepublish(v);
-
-<a name="line625">625: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
-<a name="line626">626: </a>  PetscLogObjectState((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<font color="#666666">"Length=%D"</font>,v-&gt;map-&gt;n);
-<a name="line627">627: </a><font color="#A020F0">#endif</font>
-<a name="line628">628: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(vs-&gt;array_allocated);
-<a name="line629">629: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(vs);
-
-<a name="line631">631: </a>  <font color="#4169E1">return</font>(0);
-<a name="line632">632: </a>}
-
-<a name="line634">634: </a><font color="#A020F0">#if 0</font>
-<a name="line637">637: </a><strong><font color="#4169E1"><a name="VecPublish_Seq"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecPublish_Seq(<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A> obj)</font></strong>
-<a name="line638">638: </a>{
-<a name="line640">640: </a>  <font color="#4169E1">return</font>(0);
-<a name="line641">641: </a>}
-<a name="line642">642: </a><font color="#A020F0">#endif</font>
-
-<a name="line644">644: </a><strong><font color="#4169E1">EXTERN <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecLoad_Binary(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>, const <A href="../../../../../docs/manualpages/Vec/VecType.html#VecType">VecType</A>, <A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>*)</font></strong>;
-
-<a name="line646">646: </a>static <font color="#4169E1">struct _VecOps</font> DvOps = {VecDuplicate_Seq, <font color="#B22222">/* 1 */</font>
-<a name="line647">647: </a>            VecDuplicateVecs_Default,
-<a name="line648">648: </a>            VecDestroyVecs_Default,
-<a name="line649">649: </a>            VecDot_Seq,
-<a name="line650">650: </a>            VecMDot_Seq,
-<a name="line651">651: </a>            VecNorm_Seq,
-<a name="line652">652: </a>            VecTDot_Seq,
-<a name="line653">653: </a>            VecMTDot_Seq,
-<a name="line654">654: </a>            VecScale_Seq,
-<a name="line655">655: </a>            VecCopy_Seq, <font color="#B22222">/* 10 */</font>
-<a name="line656">656: </a>            VecSet_Seq,
-<a name="line657">657: </a>            VecSwap_Seq,
-<a name="line658">658: </a>            VecAXPY_Seq,
-<a name="line659">659: </a>            VecAXPBY_Seq,
-<a name="line660">660: </a>            VecMAXPY_Seq,
-<a name="line661">661: </a>            VecAYPX_Seq,
-<a name="line662">662: </a>            VecWAXPY_Seq,
-<a name="line663">663: </a>            VecAXPBYPCZ_Seq,
-<a name="line664">664: </a>            VecPointwiseMult_Seq,
-<a name="line665">665: </a>            VecPointwiseDivide_Seq,
-<a name="line666">666: </a>            VecSetValues_Seq, <font color="#B22222">/* 20 */</font>
-<a name="line667">667: </a>            0,0,
-<a name="line668">668: </a>            VecGetArray_Seq,
-<a name="line669">669: </a>            VecGetSize_Seq,
-<a name="line670">670: </a>            VecGetSize_Seq,
-<a name="line671">671: </a>            VecRestoreArray_Seq,
-<a name="line672">672: </a>            VecMax_Seq,
-<a name="line673">673: </a>            VecMin_Seq,
-<a name="line674">674: </a>            VecSetRandom_Seq,
-<a name="line675">675: </a>            VecSetOption_Seq, <font color="#B22222">/* 30 */</font>
-<a name="line676">676: </a>            VecSetValuesBlocked_Seq,
-<a name="line677">677: </a>            VecDestroy_Seq,
-<a name="line678">678: </a>            VecView_Seq,
-<a name="line679">679: </a>            VecPlaceArray_Seq,
-<a name="line680">680: </a>            VecReplaceArray_Seq,
-<a name="line681">681: </a>            VecDot_Seq,
-<a name="line682">682: </a>            VecTDot_Seq,
-<a name="line683">683: </a>            VecNorm_Seq,
-<a name="line684">684: </a>            VecMDot_Seq,
-<a name="line685">685: </a>            VecMTDot_Seq, <font color="#B22222">/* 40 */</font>
-<a name="line686">686: </a>            VecLoadIntoVector_Default,
-<a name="line687">687: </a>            0, <font color="#B22222">/* VecLoadIntoVectorNative */</font>
-<a name="line688">688: </a>            VecReciprocal_Default,
-<a name="line689">689: </a>            0, <font color="#B22222">/* VecViewNative */</font>
-<a name="line690">690: </a>            VecConjugate_Seq,
-<a name="line691">691: </a>            0,
-<a name="line692">692: </a>            0,
-<a name="line693">693: </a>            VecResetArray_Seq,
-<a name="line694">694: </a>            0,
-<a name="line695">695: </a>            VecMaxPointwiseDivide_Seq,
-<a name="line696">696: </a>            VecLoad_Binary, <font color="#B22222">/* 50 */</font>
-<a name="line697">697: </a>            VecPointwiseMax_Seq,
-<a name="line698">698: </a>            VecPointwiseMaxAbs_Seq,
-<a name="line699">699: </a>            VecPointwiseMin_Seq,
-<a name="line700">700: </a>            VecGetValues_Seq
-<a name="line701">701: </a>          };
-
-
-<a name="line704">704: </a><font color="#B22222">/*</font>
-<a name="line705">705: </a><font color="#B22222">      This is called by VecCreate_Seq() (i.e. <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>()) and <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>()</font>
-<a name="line706">706: </a><font color="#B22222">*/</font>
-<a name="line709">709: </a><strong><font color="#4169E1"><a name="VecCreate_Seq_Private"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecCreate_Seq_Private(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v,const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> array[])</font></strong>
-<a name="line710">710: </a>{
-<a name="line711">711: </a>  Vec_Seq        *s;
-
-<a name="line715">715: </a>  PetscNewLog(v,Vec_Seq,&amp;s);
-<a name="line716">716: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(v-&gt;ops,&amp;DvOps,<font color="#4169E1">sizeof</font>(DvOps));
-<a name="line717">717: </a>  v-&gt;data            = (void*)s;
-<a name="line718">718: </a>  v-&gt;petscnative     = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line719">719: </a>  s-&gt;array           = (<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *)array;
-<a name="line720">720: </a>  s-&gt;array_allocated = 0;
-
-<a name="line722">722: </a>  <font color="#4169E1">if</font> (v-&gt;map-&gt;bs == -1) v-&gt;map-&gt;bs = 1;
-<a name="line723">723: </a>  <A href="../../../../../docs/manualpages/Vec/PetscLayoutSetUp.html#PetscLayoutSetUp">PetscLayoutSetUp</A>(v-&gt;map);
-<a name="line724">724: </a>  PetscObjectChangeTypeName((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A>);
-<a name="line725">725: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
-<a name="line726">726: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<font color="#666666">"PetscMatlabEnginePut_C"</font>,<font color="#666666">"VecMatlabEnginePut_Default"</font>,VecMatlabEnginePut_Default);
-<a name="line727">727: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<font color="#666666">"PetscMatlabEngineGet_C"</font>,<font color="#666666">"VecMatlabEngineGet_Default"</font>,VecMatlabEngineGet_Default);
-<a name="line728">728: </a><font color="#A020F0">#endif</font>
-<a name="line729">729: </a>  PetscPublishAll(v);
-<a name="line730">730: </a>  <font color="#4169E1">return</font>(0);
-<a name="line731">731: </a>}
-
-<a name="line735">735: </a><font color="#B22222">/*@C</font>
-<a name="line736">736: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A> - Creates a standard,sequential array-style vector,</font>
-<a name="line737">737: </a><font color="#B22222">   where the user provides the array space to store the vector values.</font>
-
-<a name="line739">739: </a><font color="#B22222">   Collective on <A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
-
-<a name="line741">741: </a><font color="#B22222">   Input Parameter:</font>
-<a name="line742">742: </a><font color="#B22222">+  comm - the communicator, should be <A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A></font>
-<a name="line743">743: </a><font color="#B22222">.  n - the vector length </font>
-<a name="line744">744: </a><font color="#B22222">-  array - memory where the vector elements are to be stored.</font>
-
-<a name="line746">746: </a><font color="#B22222">   Output Parameter:</font>
-<a name="line747">747: </a><font color="#B22222">.  V - the vector</font>
-
-<a name="line749">749: </a><font color="#B22222">   Notes:</font>
-<a name="line750">750: </a><font color="#B22222">   Use <A href="../../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>() or <A href="../../../../../docs/manualpages/Vec/VecDuplicateVecs.html#VecDuplicateVecs">VecDuplicateVecs</A>() to form additional vectors of the</font>
-<a name="line751">751: </a><font color="#B22222">   same type as an existing vector.</font>
-
-<a name="line753">753: </a><font color="#B22222">   If the user-provided array is <A href="../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>, then <A href="../../../../../docs/manualpages/Vec/VecPlaceArray.html#VecPlaceArray">VecPlaceArray</A>() can be used</font>
-<a name="line754">754: </a><font color="#B22222">   at a later stage to SET the array for storing the vector values.</font>
-
-<a name="line756">756: </a><font color="#B22222">   PETSc does NOT free the array when the vector is destroyed via <A href="../../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>().</font>
-<a name="line757">757: </a><font color="#B22222">   The user should not free the array until the vector is destroyed.</font>
-
-<a name="line759">759: </a><font color="#B22222">   Level: intermediate</font>
-
-<a name="line761">761: </a><font color="#B22222">   Concepts: vectors^creating with array</font>
-
-<a name="line763">763: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Vec/VecCreateMPIWithArray.html#VecCreateMPIWithArray">VecCreateMPIWithArray</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(), <A href="../../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(), <A href="../../../../../docs/manualpages/Vec/VecDuplicateVecs.html#VecDuplicateVecs">VecDuplicateVecs</A>(), </font>
-<a name="line764">764: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Vec/VecCreateGhost.html#VecCreateGhost">VecCreateGhost</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>(), <A href="../../../../../docs/manualpages/Vec/VecPlaceArray.html#VecPlaceArray">VecPlaceArray</A>()</font>
-<a name="line765">765: </a><font color="#B22222">@*/</font>
-<a name="line766">766: </a><strong><font color="#4169E1"><a name="VecCreateSeqWithArray"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>(<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> array[],<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> *V)</font></strong>
-<a name="line767">767: </a>{
-<a name="line769">769: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
-
-<a name="line772">772: </a>  <A href="../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(comm,V);
-<a name="line773">773: </a>  <A href="../../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(*V,n,n);
-<a name="line774">774: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
-<a name="line775">775: </a>  <font color="#4169E1">if</font> (size &gt; 1) {
-<a name="line776">776: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Cannot create <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> on more than one process"</font>);
-<a name="line777">777: </a>  }
-<a name="line778">778: </a>  VecCreate_Seq_Private(*V,array);
-<a name="line779">779: </a>  <font color="#4169E1">return</font>(0);
-<a name="line780">780: </a>}
-
-<a name="line782">782: </a><font color="#B22222">/*MC</font>
-<a name="line783">783: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> - <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> = "seq" - The basic sequential vector</font>
-
-<a name="line785">785: </a><font color="#B22222">   Options Database Keys:</font>
-<a name="line786">786: </a><font color="#B22222">. -vec_type seq - sets the vector type to <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> during a call to <A href="../../../../../docs/manualpages/Vec/VecSetFromOptions.html#VecSetFromOptions">VecSetFromOptions</A>()</font>
-
-<a name="line788">788: </a><font color="#B22222">  Level: beginner</font>
-
-<a name="line790">790: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(), <A href="../../../../../docs/manualpages/Vec/VecSetType.html#VecSetType">VecSetType</A>(), <A href="../../../../../docs/manualpages/Vec/VecSetFromOptions.html#VecSetFromOptions">VecSetFromOptions</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>(), <A href="../../../../../docs/manualpages/Vec/VECMPI.html#VECMPI">VECMPI</A>, <A href="../../../../../docs/manualpages/Vec/VecType.html#VecType">VecType</A>, <A href="../../../../../docs/manualpages/Vec/VecCreateMPI.html#VecCreateMPI">VecCreateMPI</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>()</font>
-<a name="line791">791: </a><font color="#B22222">M*/</font>
-
-<a name="line796">796: </a><strong><font color="#4169E1"><a name="VecCreate_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  VecCreate_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> V)</font></strong>
-<a name="line797">797: </a>{
-<a name="line798">798: </a>  Vec_Seq        *s;
-<a name="line799">799: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *array;
-<a name="line801">801: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = PetscMax(V-&gt;map-&gt;n,V-&gt;map-&gt;N);
-<a name="line802">802: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
-
-<a name="line805">805: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)V)-&gt;comm,&amp;size);
-<a name="line806">806: </a>  <font color="#4169E1">if</font> (size &gt; 1) {
-<a name="line807">807: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Cannot create <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> on more than one process"</font>);
-<a name="line808">808: </a>  }
-<a name="line809">809: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;array);
-<a name="line810">810: </a>  PetscLogObjectMemory(V, n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-<a name="line811">811: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(array,n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
-<a name="line812">812: </a>  VecCreate_Seq_Private(V,array);
-<a name="line813">813: </a>  s    = (Vec_Seq*)V-&gt;data;
-<a name="line814">814: </a>  s-&gt;array_allocated = array;
-<a name="line815">815: </a>  <font color="#4169E1">return</font>(0);
-<a name="line816">816: </a>}
-
-
-<a name="line822">822: </a><strong><font color="#4169E1"><a name="VecDuplicate_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecDuplicate_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> win,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> *V)</font></strong>
-<a name="line823">823: </a>{
-
-<a name="line827">827: </a>  <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win)-&gt;comm,win-&gt;map-&gt;n,V);
-<a name="line828">828: </a>  <font color="#4169E1">if</font> (win-&gt;mapping) {
-<a name="line829">829: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win-&gt;mapping);
-<a name="line830">830: </a>    (*V)-&gt;mapping = win-&gt;mapping;
-<a name="line831">831: </a>  }
-<a name="line832">832: </a>  <font color="#4169E1">if</font> (win-&gt;bmapping) {
-<a name="line833">833: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win-&gt;bmapping);
-<a name="line834">834: </a>    (*V)-&gt;bmapping = win-&gt;bmapping;
-<a name="line835">835: </a>  }
-<a name="line836">836: </a>  (*V)-&gt;map-&gt;bs = win-&gt;map-&gt;bs;
-<a name="line837">837: </a>  <A href="../../../../../docs/manualpages/Sys/PetscOListDuplicate.html#PetscOListDuplicate">PetscOListDuplicate</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win)-&gt;olist,&amp;((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*V))-&gt;olist);
-<a name="line838">838: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFListDuplicate.html#PetscFListDuplicate">PetscFListDuplicate</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win)-&gt;qlist,&amp;((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*V))-&gt;qlist);
-
-<a name="line840">840: </a>  (*V)-&gt;stash.ignorenegidx = win-&gt;stash.ignorenegidx;
-
-<a name="line842">842: </a>  <font color="#4169E1">return</font>(0);
-<a name="line843">843: </a>}
-
-<a name="line847">847: </a><strong><font color="#4169E1"><a name="VecSetOption_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecSetOption_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v,VecOption op,<A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> flag)</font></strong>
-<a name="line848">848: </a>{
-<a name="line850">850: </a>  <font color="#4169E1">if</font> (op == VEC_IGNORE_NEGATIVE_INDICES) {
-<a name="line851">851: </a>    v-&gt;stash.ignorenegidx = flag;
-<a name="line852">852: </a>  }
-<a name="line853">853: </a>  <font color="#4169E1">return</font>(0);
-<a name="line854">854: </a>}
+<a name="line352">352: </a>  VecView_Seq_Draw_LG(xin,v);
+<a name="line353">353: </a>  <font color="#4169E1">if</font> (format != PETSC_VIEWER_DRAW_LG) {
+<a name="line354">354: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerPopFormat.html#PetscViewerPopFormat">PetscViewerPopFormat</A>(v);
+<a name="line355">355: </a>  }
+
+<a name="line357">357: </a>  <font color="#4169E1">return</font>(0);
+<a name="line358">358: </a>}
+
+<a name="line362">362: </a><strong><font color="#4169E1"><a name="VecView_Seq_Binary"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Binary(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line363">363: </a>{
+<a name="line364">364: </a>  Vec_Seq        *x = (Vec_Seq *)xin-&gt;data;
+<a name="line366">366: </a>  int            fdes;
+<a name="line367">367: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = xin-&gt;map-&gt;n,cookie=VEC_FILE_COOKIE;
+<a name="line368">368: </a>  FILE           *file;
+<a name="line369">369: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPIIO)</font>
+<a name="line370">370: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isMPIIO;
+<a name="line371">371: </a><font color="#A020F0">#endif</font>
+
+
+<a name="line375">375: </a>  <font color="#B22222">/* Write vector header */</font>
+<a name="line376">376: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryWrite.html#PetscViewerBinaryWrite">PetscViewerBinaryWrite</A>(viewer,&amp;cookie,1,PETSC_INT,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
+<a name="line377">377: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryWrite.html#PetscViewerBinaryWrite">PetscViewerBinaryWrite</A>(viewer,&amp;n,1,PETSC_INT,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
+
+<a name="line379">379: </a>  <font color="#B22222">/* Write vector contents */</font>
+<a name="line380">380: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPIIO)</font>
+<a name="line381">381: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetMPIIO.html#PetscViewerBinaryGetMPIIO">PetscViewerBinaryGetMPIIO</A>(viewer,&amp;isMPIIO);
+<a name="line382">382: </a>  <font color="#4169E1">if</font> (!isMPIIO) {
+<a name="line383">383: </a><font color="#A020F0">#endif</font>
+<a name="line384">384: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetDescriptor.html#PetscViewerBinaryGetDescriptor">PetscViewerBinaryGetDescriptor</A>(viewer,&amp;fdes);
+<a name="line385">385: </a>    <A href="../../../../../docs/manualpages/Sys/PetscBinaryWrite.html#PetscBinaryWrite">PetscBinaryWrite</A>(fdes,x-&gt;array,n,PETSC_SCALAR,<A href="../../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>);
+<a name="line386">386: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPIIO)</font>
+<a name="line387">387: </a>  } <font color="#4169E1">else</font> {
+<a name="line388">388: </a>    MPI_Offset   off;
+<a name="line389">389: </a>    MPI_File     mfdes;
+<a name="line390">390: </a>    <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>  gsizes[1],lsizes[1],lstarts[1];
+<a name="line391">391: </a>    MPI_Datatype view;
+
+<a name="line393">393: </a>    gsizes[0]  = PetscMPIIntCast(n);
+<a name="line394">394: </a>    lsizes[0]  = PetscMPIIntCast(n);
+<a name="line395">395: </a>    lstarts[0] = 0;
+<a name="line396">396: </a>    MPI_Type_create_subarray(1,gsizes,lsizes,lstarts,MPI_ORDER_FORTRAN,<A href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,&amp;view);
+<a name="line397">397: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_commit.html#MPI_Type_commit">MPI_Type_commit</A>(&amp;view);
+
+<a name="line399">399: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetMPIIODescriptor.html#PetscViewerBinaryGetMPIIODescriptor">PetscViewerBinaryGetMPIIODescriptor</A>(viewer,&amp;mfdes);
+<a name="line400">400: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetMPIIOOffset.html#PetscViewerBinaryGetMPIIOOffset">PetscViewerBinaryGetMPIIOOffset</A>(viewer,&amp;off);
+<a name="line401">401: </a>    MPIU_File_write_all(mfdes,x-&gt;array,lsizes[0],<A href="../../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,MPI_STATUS_IGNORE);
+<a name="line402">402: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryAddMPIIOOffset.html#PetscViewerBinaryAddMPIIOOffset">PetscViewerBinaryAddMPIIOOffset</A>(viewer,n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+<a name="line403">403: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_free.html#MPI_Type_free">MPI_Type_free</A>(&amp;view);
+<a name="line404">404: </a>  }
+<a name="line405">405: </a><font color="#A020F0">#endif</font>
+
+<a name="line407">407: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerBinaryGetInfoPointer.html#PetscViewerBinaryGetInfoPointer">PetscViewerBinaryGetInfoPointer</A>(viewer,&amp;file);
+<a name="line408">408: </a>  <font color="#4169E1">if</font> (file &amp;&amp; xin-&gt;map-&gt;bs &gt; 1) {
+<a name="line409">409: </a>    <font color="#4169E1">if</font> (((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin)-&gt;prefix) {
+<a name="line410">410: </a>      <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,file,<font color="#666666">"-%s_vecload_block_size %D\n"</font>,((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin)-&gt;prefix,xin-&gt;map-&gt;bs);
+<a name="line411">411: </a>    } <font color="#4169E1">else</font> {
+<a name="line412">412: </a>      <A href="../../../../../docs/manualpages/Sys/PetscFPrintf.html#PetscFPrintf">PetscFPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A>,file,<font color="#666666">"-vecload_block_size %D\n"</font>,xin-&gt;map-&gt;bs);
+<a name="line413">413: </a>    }
+<a name="line414">414: </a>  }
+<a name="line415">415: </a>  <font color="#4169E1">return</font>(0);
+<a name="line416">416: </a>}
+
+<a name="line418">418: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
+<a name="line421">421: </a><strong><font color="#4169E1"><a name="VecView_Seq_Netcdf"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Netcdf(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> v)</font></strong>
+<a name="line422">422: </a>{
+<a name="line424">424: </a>  int            n = xin-&gt;map-&gt;n,ncid,xdim,xdim_num=1,xin_id,xstart=0;
+<a name="line425">425: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *xarray;
+
+<a name="line428">428: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line429">429: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(xin,&amp;xarray);
+<a name="line430">430: </a>  PetscViewerNetcdfGetID(v,&amp;ncid);
+<a name="line431">431: </a>  <font color="#4169E1">if</font> (ncid &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ORDER,<font color="#666666">"First call PetscViewerNetcdfOpen to create NetCDF dataset"</font>);
+<a name="line432">432: </a>  <font color="#B22222">/* define dimensions */</font>
+<a name="line433">433: </a>  ncmpi_def_dim(ncid,<font color="#666666">"PETSc_Vector_Global_Size"</font>,n,&amp;xdim);
+<a name="line434">434: </a>  <font color="#B22222">/* define variables */</font>
+<a name="line435">435: </a>  ncmpi_def_var(ncid,<font color="#666666">"PETSc_Vector_Seq"</font>,NC_DOUBLE,xdim_num,&amp;xdim,&amp;xin_id);
+<a name="line436">436: </a>  <font color="#B22222">/* leave define mode */</font>
+<a name="line437">437: </a>  ncmpi_enddef(ncid);
+<a name="line438">438: </a>  <font color="#B22222">/* store the vector */</font>
+<a name="line439">439: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetOwnershipRange.html#VecGetOwnershipRange">VecGetOwnershipRange</A>(xin,&amp;xstart,<A href="../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line440">440: </a>  ncmpi_put_vara_double_all(ncid,xin_id,(const MPI_Offset*)&amp;xstart,(const MPI_Offset*)&amp;n,xarray);
+<a name="line441">441: </a><font color="#A020F0">#else </font>
+<a name="line442">442: </a>    <A href="../../../../../docs/manualpages/Sys/PetscPrintf.html#PetscPrintf">PetscPrintf</A>(<A href="../../../../../docs/manualpages/Sys/PETSC_COMM_WORLD.html#PETSC_COMM_WORLD">PETSC_COMM_WORLD</A>,<font color="#666666">"NetCDF viewer not supported for complex numbers\n"</font>);
+<a name="line443">443: </a><font color="#A020F0">#endif</font>
+<a name="line444">444: </a>  <font color="#4169E1">return</font>(0);
+<a name="line445">445: </a>}
+<a name="line446">446: </a><font color="#A020F0">#endif</font>
+
+<a name="line448">448: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
+<a name="line449">449: </a><font color="#A020F0">#include </font><font color="#666666">"mat.h"</font><font color="#A020F0">   </font><font color="#B22222">/* Matlab include file */</font><font color="#A020F0"></font>
+<a name="line453">453: </a><strong><font color="#4169E1"><a name="VecView_Seq_Matlab"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq_Matlab(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> vec,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line454">454: </a>{
+<a name="line456">456: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n;
+<a name="line457">457: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *array;
+<a name="line458">458: </a>
+<a name="line460">460: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetLocalSize.html#VecGetLocalSize">VecGetLocalSize</A>(vec,&amp;n);
+<a name="line461">461: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectName.html#PetscObjectName">PetscObjectName</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vec);
+<a name="line462">462: </a>  <A href="../../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(vec,&amp;array);
+<a name="line463">463: </a>  <A href="../../../../../docs/manualpages/Viewer/PetscViewerMatlabPutArray.html#PetscViewerMatlabPutArray">PetscViewerMatlabPutArray</A>(viewer,n,1,array,((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vec)-&gt;name);
+<a name="line464">464: </a>  <A href="../../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(vec,&amp;array);
+<a name="line465">465: </a>  <font color="#4169E1">return</font>(0);
+<a name="line466">466: </a>}
+<a name="line468">468: </a><font color="#A020F0">#endif</font>
+
+<a name="line472">472: </a><strong><font color="#4169E1"><a name="VecView_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecView_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A> viewer)</font></strong>
+<a name="line473">473: </a>{
+<a name="line475">475: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isdraw,iascii,issocket,isbinary;
+<a name="line476">476: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATHEMATICA)</font>
+<a name="line477">477: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     ismathematica;
+<a name="line478">478: </a><font color="#A020F0">#endif</font>
+<a name="line479">479: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
+<a name="line480">480: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     isnetcdf;
+<a name="line481">481: </a><font color="#A020F0">#endif</font>
+<a name="line482">482: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
+<a name="line483">483: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     ismatlab;
+<a name="line484">484: </a><font color="#A020F0">#endif</font>
+<a name="line485">485: </a><font color="#A020F0">#if defined(PETSC_HAVE_HDF5)</font>
+<a name="line486">486: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     ishdf5;
+<a name="line487">487: </a><font color="#A020F0">#endif</font>
+
+<a name="line490">490: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_DRAW,&amp;isdraw);
+<a name="line491">491: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_ASCII,&amp;iascii);
+<a name="line492">492: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_SOCKET,&amp;issocket);
+<a name="line493">493: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_BINARY,&amp;isbinary);
+<a name="line494">494: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATHEMATICA)</font>
+<a name="line495">495: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_MATHEMATICA,&amp;ismathematica);
+<a name="line496">496: </a><font color="#A020F0">#endif</font>
+<a name="line497">497: </a><font color="#A020F0">#if defined(PETSC_HAVE_HDF5)</font>
+<a name="line498">498: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_HDF5,&amp;ishdf5);
+<a name="line499">499: </a><font color="#A020F0">#endif</font>
+<a name="line500">500: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
+<a name="line501">501: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,PETSC_VIEWER_NETCDF,&amp;isnetcdf);
+<a name="line502">502: </a><font color="#A020F0">#endif</font>
+<a name="line503">503: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
+<a name="line504">504: </a>  <A href="../../../../../docs/manualpages/Sys/PetscTypeCompare.html#PetscTypeCompare">PetscTypeCompare</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer,<A href="../../../../../docs/manualpages/Viewer/PETSC_VIEWER_MATLAB.html#PETSC_VIEWER_MATLAB">PETSC_VIEWER_MATLAB</A>,&amp;ismatlab);
+<a name="line505">505: </a><font color="#A020F0">#endif</font>
+
+<a name="line507">507: </a>  <font color="#4169E1">if</font> (isdraw){
+<a name="line508">508: </a>    VecView_Seq_Draw(xin,viewer);
+<a name="line509">509: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (iascii){
+<a name="line510">510: </a>    VecView_Seq_File(xin,viewer);
+<a name="line511">511: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isbinary) {
+<a name="line512">512: </a>    VecView_Seq_Binary(xin,viewer);
+<a name="line513">513: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATHEMATICA)</font>
+<a name="line514">514: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ismathematica) {
+<a name="line515">515: </a>    <A href="../../../../../docs/manualpages/Viewer/PetscViewerMathematicaPutVector.html#PetscViewerMathematicaPutVector">PetscViewerMathematicaPutVector</A>(viewer,xin);
+<a name="line516">516: </a><font color="#A020F0">#endif</font>
+<a name="line517">517: </a><font color="#A020F0">#if defined(PETSC_HAVE_HDF5)</font>
+<a name="line518">518: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ishdf5) {
+<a name="line519">519: </a>    VecView_MPI_HDF5(xin,viewer); <font color="#B22222">/* Reusing VecView_MPI_HDF5 ... don't want code duplication*/</font>
+<a name="line520">520: </a><font color="#A020F0">#endif</font>
+<a name="line521">521: </a><font color="#A020F0">#if defined(PETSC_HAVE_PNETCDF)</font>
+<a name="line522">522: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (isnetcdf) {
+<a name="line523">523: </a>    VecView_Seq_Netcdf(xin,viewer);
+<a name="line524">524: </a><font color="#A020F0">#endif</font>
+<a name="line525">525: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
+<a name="line526">526: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (ismatlab) {
+<a name="line527">527: </a>    VecView_Seq_Matlab(xin,viewer);
+<a name="line528">528: </a><font color="#A020F0">#endif</font>
+<a name="line529">529: </a>  } <font color="#4169E1">else</font> {
+<a name="line530">530: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_SUP,<font color="#666666">"Viewer type %s not supported by this vector object"</font>,((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)viewer)-&gt;type_name);
+<a name="line531">531: </a>  }
+<a name="line532">532: </a>  <font color="#4169E1">return</font>(0);
+<a name="line533">533: </a>}
+
+<a name="line537">537: </a><strong><font color="#4169E1"><a name="VecGetValues_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecGetValues_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ni,const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ix[],<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> y[])</font></strong>
+<a name="line538">538: </a>{
+<a name="line539">539: </a>  Vec_Seq     *x = (Vec_Seq *)xin-&gt;data;
+<a name="line540">540: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *xx = x-&gt;array;
+<a name="line541">541: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i;
+
+<a name="line544">544: </a>  <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
+<a name="line545">545: </a>    <font color="#4169E1">if</font> (xin-&gt;stash.ignorenegidx &amp;&amp; ix[i] &lt; 0) <font color="#4169E1">continue</font>;
+<a name="line546">546: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line547">547: </a>    <font color="#4169E1">if</font> (ix[i] &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D cannot be negative"</font>,ix[i]);
+<a name="line548">548: </a>    <font color="#4169E1">if</font> (ix[i] &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D to large maximum allowed %D"</font>,ix[i],xin-&gt;map-&gt;n);
+<a name="line549">549: </a><font color="#A020F0">#endif</font>
+<a name="line550">550: </a>    y[i] = xx[ix[i]];
+<a name="line551">551: </a>  }
+<a name="line552">552: </a>  <font color="#4169E1">return</font>(0);
+<a name="line553">553: </a>}
+
+<a name="line557">557: </a><strong><font color="#4169E1"><a name="VecSetValues_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecSetValues_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ni,const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ix[],const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> y[],<A href="../../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> m)</font></strong>
+<a name="line558">558: </a>{
+<a name="line559">559: </a>  Vec_Seq     *x = (Vec_Seq *)xin-&gt;data;
+<a name="line560">560: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *xx = x-&gt;array;
+<a name="line561">561: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i;
+
+<a name="line564">564: </a>  <font color="#4169E1">if</font> (m == <A href="../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>) {
+<a name="line565">565: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
+<a name="line566">566: </a>      <font color="#4169E1">if</font> (xin-&gt;stash.ignorenegidx &amp;&amp; ix[i] &lt; 0) <font color="#4169E1">continue</font>;
+<a name="line567">567: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line568">568: </a>      <font color="#4169E1">if</font> (ix[i] &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D cannot be negative"</font>,ix[i]);
+<a name="line569">569: </a>      <font color="#4169E1">if</font> (ix[i] &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,ix[i],xin-&gt;map-&gt;n);
+<a name="line570">570: </a><font color="#A020F0">#endif</font>
+<a name="line571">571: </a>      xx[ix[i]] = y[i];
+<a name="line572">572: </a>    }
+<a name="line573">573: </a>  } <font color="#4169E1">else</font> {
+<a name="line574">574: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
+<a name="line575">575: </a>      <font color="#4169E1">if</font> (xin-&gt;stash.ignorenegidx &amp;&amp; ix[i] &lt; 0) <font color="#4169E1">continue</font>;
+<a name="line576">576: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line577">577: </a>      <font color="#4169E1">if</font> (ix[i] &lt; 0) <A href="../../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D cannot be negative"</font>,ix[i]);
+<a name="line578">578: </a>      <font color="#4169E1">if</font> (ix[i] &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,ix[i],xin-&gt;map-&gt;n);
+<a name="line579">579: </a><font color="#A020F0">#endif</font>
+<a name="line580">580: </a>      xx[ix[i]] += y[i];
+<a name="line581">581: </a>    }
+<a name="line582">582: </a>  }
+<a name="line583">583: </a>  <font color="#4169E1">return</font>(0);
+<a name="line584">584: </a>}
+
+<a name="line588">588: </a><strong><font color="#4169E1"><a name="VecSetValuesBlocked_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecSetValuesBlocked_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ni,const <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ix[],const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> yin[],<A href="../../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> m)</font></strong>
+<a name="line589">589: </a>{
+<a name="line590">590: </a>  Vec_Seq     *x = (Vec_Seq *)xin-&gt;data;
+<a name="line591">591: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *xx = x-&gt;array,*y = (<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>*)yin;
+<a name="line592">592: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i,bs = xin-&gt;map-&gt;bs,start,j;
+
+<a name="line594">594: </a>  <font color="#B22222">/*</font>
+<a name="line595">595: </a><font color="#B22222">       For optimization could treat bs = 2, 3, 4, 5 as special cases with loop unrolling</font>
+<a name="line596">596: </a><font color="#B22222">  */</font>
+<a name="line598">598: </a>  <font color="#4169E1">if</font> (m == <A href="../../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>) {
+<a name="line599">599: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
+<a name="line600">600: </a>      start = bs*ix[i];
+<a name="line601">601: </a>      <font color="#4169E1">if</font> (start &lt; 0) <font color="#4169E1">continue</font>;
+<a name="line602">602: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line603">603: </a>      <font color="#4169E1">if</font> (start &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,start,xin-&gt;map-&gt;n);
+<a name="line604">604: </a><font color="#A020F0">#endif</font>
+<a name="line605">605: </a>      <font color="#4169E1">for</font> (j=0; j&lt;bs; j++) {
+<a name="line606">606: </a>        xx[start+j] = y[j];
+<a name="line607">607: </a>      }
+<a name="line608">608: </a>      y += bs;
+<a name="line609">609: </a>    }
+<a name="line610">610: </a>  } <font color="#4169E1">else</font> {
+<a name="line611">611: </a>    <font color="#4169E1">for</font> (i=0; i&lt;ni; i++) {
+<a name="line612">612: </a>      start = bs*ix[i];
+<a name="line613">613: </a>      <font color="#4169E1">if</font> (start &lt; 0) <font color="#4169E1">continue</font>;
+<a name="line614">614: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line615">615: </a>      <font color="#4169E1">if</font> (start &gt;= xin-&gt;map-&gt;n) <A href="../../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Out of range index value %D maximum %D"</font>,start,xin-&gt;map-&gt;n);
+<a name="line616">616: </a><font color="#A020F0">#endif</font>
+<a name="line617">617: </a>      <font color="#4169E1">for</font> (j=0; j&lt;bs; j++) {
+<a name="line618">618: </a>        xx[start+j] += y[j];
+<a name="line619">619: </a>      }
+<a name="line620">620: </a>      y += bs;
+<a name="line621">621: </a>    }
+<a name="line622">622: </a>  }
+<a name="line623">623: </a>  <font color="#4169E1">return</font>(0);
+<a name="line624">624: </a>}
+
+
+<a name="line629">629: </a><strong><font color="#4169E1"><a name="VecDestroy_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecDestroy_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v)</font></strong>
+<a name="line630">630: </a>{
+<a name="line631">631: </a>  Vec_Seq        *vs = (Vec_Seq*)v-&gt;data;
+
+
+<a name="line636">636: </a>  <font color="#B22222">/* if memory was published with AMS then destroy it */</font>
+<a name="line637">637: </a>  PetscObjectDepublish(v);
+
+<a name="line639">639: </a><font color="#A020F0">#if defined(PETSC_USE_LOG)</font>
+<a name="line640">640: </a>  PetscLogObjectState((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<font color="#666666">"Length=%D"</font>,v-&gt;map-&gt;n);
+<a name="line641">641: </a><font color="#A020F0">#endif</font>
+<a name="line642">642: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(vs-&gt;array_allocated);
+<a name="line643">643: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(vs);
+
+<a name="line645">645: </a>  <font color="#4169E1">return</font>(0);
+<a name="line646">646: </a>}
+
+<a name="line648">648: </a><font color="#A020F0">#if 0</font>
+<a name="line651">651: </a><strong><font color="#4169E1"><a name="VecPublish_Seq"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecPublish_Seq(<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A> obj)</font></strong>
+<a name="line652">652: </a>{
+<a name="line654">654: </a>  <font color="#4169E1">return</font>(0);
+<a name="line655">655: </a>}
+<a name="line656">656: </a><font color="#A020F0">#endif</font>
+
+<a name="line658">658: </a><strong><font color="#4169E1">EXTERN <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecLoad_Binary(<A href="../../../../../docs/manualpages/Viewer/PetscViewer.html#PetscViewer">PetscViewer</A>, const <A href="../../../../../docs/manualpages/Vec/VecType.html#VecType">VecType</A>, <A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A>*)</font></strong>;
+
+<a name="line660">660: </a>static <font color="#4169E1">struct _VecOps</font> DvOps = {VecDuplicate_Seq, <font color="#B22222">/* 1 */</font>
+<a name="line661">661: </a>            VecDuplicateVecs_Default,
+<a name="line662">662: </a>            VecDestroyVecs_Default,
+<a name="line663">663: </a>            VecDot_Seq,
+<a name="line664">664: </a>            VecMDot_Seq,
+<a name="line665">665: </a>            VecNorm_Seq,
+<a name="line666">666: </a>            VecTDot_Seq,
+<a name="line667">667: </a>            VecMTDot_Seq,
+<a name="line668">668: </a>            VecScale_Seq,
+<a name="line669">669: </a>            VecCopy_Seq, <font color="#B22222">/* 10 */</font>
+<a name="line670">670: </a>            VecSet_Seq,
+<a name="line671">671: </a>            VecSwap_Seq,
+<a name="line672">672: </a>            VecAXPY_Seq,
+<a name="line673">673: </a>            VecAXPBY_Seq,
+<a name="line674">674: </a>            VecMAXPY_Seq,
+<a name="line675">675: </a>            VecAYPX_Seq,
+<a name="line676">676: </a>            VecWAXPY_Seq,
+<a name="line677">677: </a>            VecAXPBYPCZ_Seq,
+<a name="line678">678: </a>            VecPointwiseMult_Seq,
+<a name="line679">679: </a>            VecPointwiseDivide_Seq,
+<a name="line680">680: </a>            VecSetValues_Seq, <font color="#B22222">/* 20 */</font>
+<a name="line681">681: </a>            0,0,
+<a name="line682">682: </a>            VecGetArray_Seq,
+<a name="line683">683: </a>            VecGetSize_Seq,
+<a name="line684">684: </a>            VecGetSize_Seq,
+<a name="line685">685: </a>            VecRestoreArray_Seq,
+<a name="line686">686: </a>            VecMax_Seq,
+<a name="line687">687: </a>            VecMin_Seq,
+<a name="line688">688: </a>            VecSetRandom_Seq,
+<a name="line689">689: </a>            VecSetOption_Seq, <font color="#B22222">/* 30 */</font>
+<a name="line690">690: </a>            VecSetValuesBlocked_Seq,
+<a name="line691">691: </a>            VecDestroy_Seq,
+<a name="line692">692: </a>            VecView_Seq,
+<a name="line693">693: </a>            VecPlaceArray_Seq,
+<a name="line694">694: </a>            VecReplaceArray_Seq,
+<a name="line695">695: </a>            VecDot_Seq,
+<a name="line696">696: </a>            VecTDot_Seq,
+<a name="line697">697: </a>            VecNorm_Seq,
+<a name="line698">698: </a>            VecMDot_Seq,
+<a name="line699">699: </a>            VecMTDot_Seq, <font color="#B22222">/* 40 */</font>
+<a name="line700">700: </a>            VecLoadIntoVector_Default,
+<a name="line701">701: </a>            0, <font color="#B22222">/* VecLoadIntoVectorNative */</font>
+<a name="line702">702: </a>            VecReciprocal_Default,
+<a name="line703">703: </a>            0, <font color="#B22222">/* VecViewNative */</font>
+<a name="line704">704: </a>            VecConjugate_Seq,
+<a name="line705">705: </a>            0,
+<a name="line706">706: </a>            0,
+<a name="line707">707: </a>            VecResetArray_Seq,
+<a name="line708">708: </a>            0,
+<a name="line709">709: </a>            VecMaxPointwiseDivide_Seq,
+<a name="line710">710: </a>            VecLoad_Binary, <font color="#B22222">/* 50 */</font>
+<a name="line711">711: </a>            VecPointwiseMax_Seq,
+<a name="line712">712: </a>            VecPointwiseMaxAbs_Seq,
+<a name="line713">713: </a>            VecPointwiseMin_Seq,
+<a name="line714">714: </a>            VecGetValues_Seq
+<a name="line715">715: </a>          };
+
+
+<a name="line718">718: </a><font color="#B22222">/*</font>
+<a name="line719">719: </a><font color="#B22222">      This is called by VecCreate_Seq() (i.e. <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>()) and <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>()</font>
+<a name="line720">720: </a><font color="#B22222">*/</font>
+<a name="line723">723: </a><strong><font color="#4169E1"><a name="VecCreate_Seq_Private"></a>static <A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecCreate_Seq_Private(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v,const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> array[])</font></strong>
+<a name="line724">724: </a>{
+<a name="line725">725: </a>  Vec_Seq        *s;
+
+<a name="line729">729: </a>  PetscNewLog(v,Vec_Seq,&amp;s);
+<a name="line730">730: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(v-&gt;ops,&amp;DvOps,<font color="#4169E1">sizeof</font>(DvOps));
+<a name="line731">731: </a>  v-&gt;data            = (void*)s;
+<a name="line732">732: </a>  v-&gt;petscnative     = <A href="../../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line733">733: </a>  s-&gt;array           = (<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *)array;
+<a name="line734">734: </a>  s-&gt;array_allocated = 0;
+
+<a name="line736">736: </a>  <font color="#4169E1">if</font> (v-&gt;map-&gt;bs == -1) v-&gt;map-&gt;bs = 1;
+<a name="line737">737: </a>  <A href="../../../../../docs/manualpages/Vec/PetscLayoutSetUp.html#PetscLayoutSetUp">PetscLayoutSetUp</A>(v-&gt;map);
+<a name="line738">738: </a>  PetscObjectChangeTypeName((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A>);
+<a name="line739">739: </a><font color="#A020F0">#if defined(PETSC_HAVE_MATLAB_ENGINE)</font>
+<a name="line740">740: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<font color="#666666">"PetscMatlabEnginePut_C"</font>,<font color="#666666">"VecMatlabEnginePut_Default"</font>,VecMatlabEnginePut_Default);
+<a name="line741">741: </a>  <A href="../../../../../docs/manualpages/Sys/PetscObjectComposeFunctionDynamic.html#PetscObjectComposeFunctionDynamic">PetscObjectComposeFunctionDynamic</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)v,<font color="#666666">"PetscMatlabEngineGet_C"</font>,<font color="#666666">"VecMatlabEngineGet_Default"</font>,VecMatlabEngineGet_Default);
+<a name="line742">742: </a><font color="#A020F0">#endif</font>
+<a name="line743">743: </a>  PetscPublishAll(v);
+<a name="line744">744: </a>  <font color="#4169E1">return</font>(0);
+<a name="line745">745: </a>}
+
+<a name="line749">749: </a><font color="#B22222">/*@C</font>
+<a name="line750">750: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A> - Creates a standard,sequential array-style vector,</font>
+<a name="line751">751: </a><font color="#B22222">   where the user provides the array space to store the vector values.</font>
+
+<a name="line753">753: </a><font color="#B22222">   Collective on <A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A></font>
+
+<a name="line755">755: </a><font color="#B22222">   Input Parameter:</font>
+<a name="line756">756: </a><font color="#B22222">+  comm - the communicator, should be <A href="../../../../../docs/manualpages/Sys/PETSC_COMM_SELF.html#PETSC_COMM_SELF">PETSC_COMM_SELF</A></font>
+<a name="line757">757: </a><font color="#B22222">.  n - the vector length </font>
+<a name="line758">758: </a><font color="#B22222">-  array - memory where the vector elements are to be stored.</font>
+
+<a name="line760">760: </a><font color="#B22222">   Output Parameter:</font>
+<a name="line761">761: </a><font color="#B22222">.  V - the vector</font>
+
+<a name="line763">763: </a><font color="#B22222">   Notes:</font>
+<a name="line764">764: </a><font color="#B22222">   Use <A href="../../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>() or <A href="../../../../../docs/manualpages/Vec/VecDuplicateVecs.html#VecDuplicateVecs">VecDuplicateVecs</A>() to form additional vectors of the</font>
+<a name="line765">765: </a><font color="#B22222">   same type as an existing vector.</font>
+
+<a name="line767">767: </a><font color="#B22222">   If the user-provided array is <A href="../../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>, then <A href="../../../../../docs/manualpages/Vec/VecPlaceArray.html#VecPlaceArray">VecPlaceArray</A>() can be used</font>
+<a name="line768">768: </a><font color="#B22222">   at a later stage to SET the array for storing the vector values.</font>
+
+<a name="line770">770: </a><font color="#B22222">   PETSc does NOT free the array when the vector is destroyed via <A href="../../../../../docs/manualpages/Vec/VecDestroy.html#VecDestroy">VecDestroy</A>().</font>
+<a name="line771">771: </a><font color="#B22222">   The user should not free the array until the vector is destroyed.</font>
+
+<a name="line773">773: </a><font color="#B22222">   Level: intermediate</font>
+
+<a name="line775">775: </a><font color="#B22222">   Concepts: vectors^creating with array</font>
+
+<a name="line777">777: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Vec/VecCreateMPIWithArray.html#VecCreateMPIWithArray">VecCreateMPIWithArray</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(), <A href="../../../../../docs/manualpages/Vec/VecDuplicate.html#VecDuplicate">VecDuplicate</A>(), <A href="../../../../../docs/manualpages/Vec/VecDuplicateVecs.html#VecDuplicateVecs">VecDuplicateVecs</A>(), </font>
+<a name="line778">778: </a><font color="#B22222">          <A href="../../../../../docs/manualpages/Vec/VecCreateGhost.html#VecCreateGhost">VecCreateGhost</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>(), <A href="../../../../../docs/manualpages/Vec/VecPlaceArray.html#VecPlaceArray">VecPlaceArray</A>()</font>
+<a name="line779">779: </a><font color="#B22222">@*/</font>
+<a name="line780">780: </a><strong><font color="#4169E1"><a name="VecCreateSeqWithArray"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>(<A href="../../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A> comm,<A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> array[],<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> *V)</font></strong>
+<a name="line781">781: </a>{
+<a name="line783">783: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
+
+<a name="line786">786: </a>  <A href="../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(comm,V);
+<a name="line787">787: </a>  <A href="../../../../../docs/manualpages/Vec/VecSetSizes.html#VecSetSizes">VecSetSizes</A>(*V,n,n);
+<a name="line788">788: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
+<a name="line789">789: </a>  <font color="#4169E1">if</font> (size &gt; 1) {
+<a name="line790">790: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Cannot create <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> on more than one process"</font>);
+<a name="line791">791: </a>  }
+<a name="line792">792: </a>  VecCreate_Seq_Private(*V,array);
+<a name="line793">793: </a>  <font color="#4169E1">return</font>(0);
+<a name="line794">794: </a>}
+
+<a name="line796">796: </a><font color="#B22222">/*MC</font>
+<a name="line797">797: </a><font color="#B22222">   <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> - <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> = "seq" - The basic sequential vector</font>
+
+<a name="line799">799: </a><font color="#B22222">   Options Database Keys:</font>
+<a name="line800">800: </a><font color="#B22222">. -vec_type seq - sets the vector type to <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> during a call to <A href="../../../../../docs/manualpages/Vec/VecSetFromOptions.html#VecSetFromOptions">VecSetFromOptions</A>()</font>
+
+<a name="line802">802: </a><font color="#B22222">  Level: beginner</font>
+
+<a name="line804">804: </a><font color="#B22222">.seealso: <A href="../../../../../docs/manualpages/Vec/VecCreate.html#VecCreate">VecCreate</A>(), <A href="../../../../../docs/manualpages/Vec/VecSetType.html#VecSetType">VecSetType</A>(), <A href="../../../../../docs/manualpages/Vec/VecSetFromOptions.html#VecSetFromOptions">VecSetFromOptions</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreateSeqWithArray.html#VecCreateSeqWithArray">VecCreateSeqWithArray</A>(), <A href="../../../../../docs/manualpages/Vec/VECMPI.html#VECMPI">VECMPI</A>, <A href="../../../../../docs/manualpages/Vec/VecType.html#VecType">VecType</A>, <A href="../../../../../docs/manualpages/Vec/VecCreateMPI.html#VecCreateMPI">VecCreateMPI</A>(), <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>()</font>
+<a name="line805">805: </a><font color="#B22222">M*/</font>
+
+<a name="line810">810: </a><strong><font color="#4169E1"><a name="VecCreate_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>  VecCreate_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> V)</font></strong>
+<a name="line811">811: </a>{
+<a name="line812">812: </a>  Vec_Seq        *s;
+<a name="line813">813: </a>  <A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>    *array;
+<a name="line815">815: </a>  <A href="../../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = PetscMax(V-&gt;map-&gt;n,V-&gt;map-&gt;N);
+<a name="line816">816: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
+
+<a name="line819">819: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)V)-&gt;comm,&amp;size);
+<a name="line820">820: </a>  <font color="#4169E1">if</font> (size &gt; 1) {
+<a name="line821">821: </a>    <A href="../../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_WRONG,<font color="#666666">"Cannot create <A href="../../../../../docs/manualpages/Vec/VECSEQ.html#VECSEQ">VECSEQ</A> on more than one process"</font>);
+<a name="line822">822: </a>  }
+<a name="line823">823: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;array);
+<a name="line824">824: </a>  PetscLogObjectMemory(V, n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+<a name="line825">825: </a>  <A href="../../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(array,n*<font color="#4169E1">sizeof</font>(<A href="../../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>));
+<a name="line826">826: </a>  VecCreate_Seq_Private(V,array);
+<a name="line827">827: </a>  s    = (Vec_Seq*)V-&gt;data;
+<a name="line828">828: </a>  s-&gt;array_allocated = array;
+<a name="line829">829: </a>  <font color="#4169E1">return</font>(0);
+<a name="line830">830: </a>}
+
+
+<a name="line836">836: </a><strong><font color="#4169E1"><a name="VecDuplicate_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecDuplicate_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> win,<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> *V)</font></strong>
+<a name="line837">837: </a>{
+
+<a name="line841">841: </a>  <A href="../../../../../docs/manualpages/Vec/VecCreateSeq.html#VecCreateSeq">VecCreateSeq</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win)-&gt;comm,win-&gt;map-&gt;n,V);
+<a name="line842">842: </a>  <font color="#4169E1">if</font> (win-&gt;mapping) {
+<a name="line843">843: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win-&gt;mapping);
+<a name="line844">844: </a>    (*V)-&gt;mapping = win-&gt;mapping;
+<a name="line845">845: </a>  }
+<a name="line846">846: </a>  <font color="#4169E1">if</font> (win-&gt;bmapping) {
+<a name="line847">847: </a>    <A href="../../../../../docs/manualpages/Sys/PetscObjectReference.html#PetscObjectReference">PetscObjectReference</A>((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win-&gt;bmapping);
+<a name="line848">848: </a>    (*V)-&gt;bmapping = win-&gt;bmapping;
+<a name="line849">849: </a>  }
+<a name="line850">850: </a>  (*V)-&gt;map-&gt;bs = win-&gt;map-&gt;bs;
+<a name="line851">851: </a>  <A href="../../../../../docs/manualpages/Sys/PetscOListDuplicate.html#PetscOListDuplicate">PetscOListDuplicate</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win)-&gt;olist,&amp;((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*V))-&gt;olist);
+<a name="line852">852: </a>  <A href="../../../../../docs/manualpages/Sys/PetscFListDuplicate.html#PetscFListDuplicate">PetscFListDuplicate</A>(((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)win)-&gt;qlist,&amp;((<A href="../../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)(*V))-&gt;qlist);
+
+<a name="line854">854: </a>  (*V)-&gt;stash.ignorenegidx = win-&gt;stash.ignorenegidx;
+
+<a name="line856">856: </a>  <font color="#4169E1">return</font>(0);
+<a name="line857">857: </a>}
+
+<a name="line861">861: </a><strong><font color="#4169E1"><a name="VecSetOption_Seq"></a><A href="../../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecSetOption_Seq(<A href="../../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> v,VecOption op,<A href="../../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A> flag)</font></strong>
+<a name="line862">862: </a>{
+<a name="line864">864: </a>  <font color="#4169E1">if</font> (op == VEC_IGNORE_NEGATIVE_INDICES) {
+<a name="line865">865: </a>    v-&gt;stash.ignorenegidx = flag;
+<a name="line866">866: </a>  }
+<a name="line867">867: </a>  <font color="#4169E1">return</font>(0);
+<a name="line868">868: </a>}
 </pre>
 </body>
 
Index: petsc/src/vec/vec/utils/vinv.c
===================================================================
--- petsc.orig/src/vec/vec/utils/vinv.c
+++ petsc/src/vec/vec/utils/vinv.c
@@ -1450,11 +1450,14 @@
         ierr = VecGetArray(vec1,&v1);CHKERRQ(ierr); 
         ierr = VecGetArray(vec2,&v2);CHKERRQ(ierr);
 #if defined(PETSC_USE_COMPLEX)
-        PetscInt k;
-        for (k=0; k<n1; k++){
-          if (PetscRealPart(v1[k]) != PetscRealPart(v2[k]) || PetscImaginaryPart(v1[k]) != PetscImaginaryPart(v2[k])){
-            flg1 = PETSC_FALSE;
-            break;
+        {
+          PetscInt k;
+          flg1 = PETSC_TRUE;
+          for (k=0; k<n1; k++){
+            if (PetscRealPart(v1[k]) != PetscRealPart(v2[k]) || PetscImaginaryPart(v1[k]) != PetscImaginaryPart(v2[k])){
+              flg1 = PETSC_FALSE;
+              break;
+            }
           }
         }
 #else 
Index: petsc/src/vec/vec/utils/vinv.c.html
===================================================================
--- petsc.orig/src/vec/vec/utils/vinv.c.html
+++ petsc/src/vec/vec/utils/vinv.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-05-01T01:31:31+00:00">
+<meta name="date" content="2011-03-17T18:45:07+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -1328,27 +1328,30 @@
 <a name="line1450">1450: </a>        <A href="../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(vec1,&amp;v1);
 <a name="line1451">1451: </a>        <A href="../../../../docs/manualpages/Vec/VecGetArray.html#VecGetArray">VecGetArray</A>(vec2,&amp;v2);
 <a name="line1452">1452: </a><font color="#A020F0">#if defined(PETSC_USE_COMPLEX)</font>
-<a name="line1453">1453: </a>        <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> k;
-<a name="line1454">1454: </a>        <font color="#4169E1">for</font> (k=0; k&lt;n1; k++){
-<a name="line1455">1455: </a>          <font color="#4169E1">if</font> (PetscRealPart(v1[k]) != PetscRealPart(v2[k]) || PetscImaginaryPart(v1[k]) != PetscImaginaryPart(v2[k])){
-<a name="line1456">1456: </a>            flg1 = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1457">1457: </a>            <font color="#4169E1">break</font>;
-<a name="line1458">1458: </a>          }
-<a name="line1459">1459: </a>        }
-<a name="line1460">1460: </a><font color="#A020F0">#else </font>
-<a name="line1461">1461: </a>        <A href="../../../../docs/manualpages/Sys/PetscMemcmp.html#PetscMemcmp">PetscMemcmp</A>(v1,v2,n1*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;flg1);
-<a name="line1462">1462: </a><font color="#A020F0">#endif</font>
-<a name="line1463">1463: </a>        <A href="../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(vec1,&amp;v1);
-<a name="line1464">1464: </a>        <A href="../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(vec2,&amp;v2);
-<a name="line1465">1465: </a>        <A href="../../../../docs/manualpages/Sys/PetscObjectSetState.html#PetscObjectSetState">PetscObjectSetState</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) vec1,state1);
-<a name="line1466">1466: </a>        <A href="../../../../docs/manualpages/Sys/PetscObjectSetState.html#PetscObjectSetState">PetscObjectSetState</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) vec2,state2);
-<a name="line1467">1467: </a>      }
-<a name="line1468">1468: </a>    }
-<a name="line1469">1469: </a>    <font color="#B22222">/* combine results from all processors */</font>
-<a name="line1470">1470: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(&amp;flg1,flg,1,MPI_INT,MPI_MIN,((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vec1)-&gt;comm);
-<a name="line1471">1471: </a>  }
-<a name="line1472">1472: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1473">1473: </a>}
+<a name="line1453">1453: </a>        {
+<a name="line1454">1454: </a>          <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> k;
+<a name="line1455">1455: </a>          flg1 = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1456">1456: </a>          <font color="#4169E1">for</font> (k=0; k&lt;n1; k++){
+<a name="line1457">1457: </a>            <font color="#4169E1">if</font> (PetscRealPart(v1[k]) != PetscRealPart(v2[k]) || PetscImaginaryPart(v1[k]) != PetscImaginaryPart(v2[k])){
+<a name="line1458">1458: </a>              flg1 = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1459">1459: </a>              <font color="#4169E1">break</font>;
+<a name="line1460">1460: </a>            }
+<a name="line1461">1461: </a>          }
+<a name="line1462">1462: </a>        }
+<a name="line1463">1463: </a><font color="#A020F0">#else </font>
+<a name="line1464">1464: </a>        <A href="../../../../docs/manualpages/Sys/PetscMemcmp.html#PetscMemcmp">PetscMemcmp</A>(v1,v2,n1*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),&amp;flg1);
+<a name="line1465">1465: </a><font color="#A020F0">#endif</font>
+<a name="line1466">1466: </a>        <A href="../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(vec1,&amp;v1);
+<a name="line1467">1467: </a>        <A href="../../../../docs/manualpages/Vec/VecRestoreArray.html#VecRestoreArray">VecRestoreArray</A>(vec2,&amp;v2);
+<a name="line1468">1468: </a>        <A href="../../../../docs/manualpages/Sys/PetscObjectSetState.html#PetscObjectSetState">PetscObjectSetState</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) vec1,state1);
+<a name="line1469">1469: </a>        <A href="../../../../docs/manualpages/Sys/PetscObjectSetState.html#PetscObjectSetState">PetscObjectSetState</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>) vec2,state2);
+<a name="line1470">1470: </a>      }
+<a name="line1471">1471: </a>    }
+<a name="line1472">1472: </a>    <font color="#B22222">/* combine results from all processors */</font>
+<a name="line1473">1473: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Allreduce.html#MPI_Allreduce">MPI_Allreduce</A>(&amp;flg1,flg,1,MPI_INT,MPI_MIN,((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)vec1)-&gt;comm);
+<a name="line1474">1474: </a>  }
+<a name="line1475">1475: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1476">1476: </a>}
 
 
 
Index: petsc/src/vec/vec/utils/vpscat.c.html
===================================================================
--- petsc.orig/src/vec/vec/utils/vpscat.c.html
+++ petsc/src/vec/vec/utils/vpscat.c.html
@@ -4,7 +4,7 @@
 <head>
 <title></title>
 <meta name="generator" content="c2html 0.9.5">
-<meta name="date" content="2010-04-08T19:24:12+00:00">
+<meta name="date" content="2011-03-17T18:45:16+00:00">
 </head>
 
 <body bgcolor="#FFFFFF">
@@ -155,2065 +155,2067 @@
 <a name="line155">155: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
 <a name="line156">156: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Cancel.html#MPI_Cancel">MPI_Cancel</A>(to-&gt;rev_requests+i);
 <a name="line157">157: </a>    }
-<a name="line158">158: </a>  }
+<a name="line158">158: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(from-&gt;n,from-&gt;requests,to-&gt;rstatus);
+<a name="line159">159: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(to-&gt;n,to-&gt;rev_requests,to-&gt;rstatus);
+<a name="line160">160: </a>  }
+
+<a name="line162">162: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_ALLTOALLW) &amp;&amp; !defined(PETSC_USE_64BIT_INDICES)</font>
+<a name="line163">163: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallw) {
+<a name="line164">164: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(to-&gt;wcounts,to-&gt;wdispls,to-&gt;types);
+<a name="line165">165: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(from-&gt;wcounts,from-&gt;wdispls,from-&gt;types);
+<a name="line166">166: </a>  }
+<a name="line167">167: </a><font color="#A020F0">#endif</font>
+
+<a name="line169">169: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_WIN_CREATE)</font>
+<a name="line170">170: </a>  <font color="#4169E1">if</font> (to-&gt;use_window) {
+<a name="line171">171: </a>    MPI_Win_free(&amp;from-&gt;window);
+<a name="line172">172: </a>    MPI_Win_free(&amp;to-&gt;window);
+<a name="line173">173: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;winstarts);
+<a name="line174">174: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;winstarts);
+<a name="line175">175: </a>  }
+<a name="line176">176: </a><font color="#A020F0">#endif</font>
+
+<a name="line178">178: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallv) {
+<a name="line179">179: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(to-&gt;counts,to-&gt;displs);
+<a name="line180">180: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(from-&gt;counts,from-&gt;displs);
+<a name="line181">181: </a>  }
+
+<a name="line183">183: </a>  <font color="#B22222">/* release MPI resources obtained with <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>() and <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>() */</font>
+<a name="line184">184: </a>  <font color="#B22222">/* </font>
+<a name="line185">185: </a><font color="#B22222">     IBM's PE version of MPI has a bug where freeing these guys will screw up later</font>
+<a name="line186">186: </a><font color="#B22222">     message passing.</font>
+<a name="line187">187: </a><font color="#B22222">  */</font>
+<a name="line188">188: </a><font color="#A020F0">#if !defined(PETSC_HAVE_BROKEN_REQUEST_FREE)</font>
+<a name="line189">189: </a>  <font color="#4169E1">if</font> (!to-&gt;use_alltoallv &amp;&amp; !to-&gt;use_window) {   <font color="#B22222">/* currently the to-&gt;requests etc are ALWAYS allocated even if not used */</font>
+<a name="line190">190: </a>    <font color="#4169E1">if</font> (to-&gt;requests) {
+<a name="line191">191: </a>      <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line192">192: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(to-&gt;requests + i);
+<a name="line193">193: </a>      }
+<a name="line194">194: </a>    }
+<a name="line195">195: </a>    <font color="#4169E1">if</font> (to-&gt;rev_requests) {
+<a name="line196">196: </a>      <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line197">197: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(to-&gt;rev_requests + i);
+<a name="line198">198: </a>      }
+<a name="line199">199: </a>    }
+<a name="line200">200: </a>  }
+<a name="line201">201: </a>  <font color="#B22222">/*</font>
+<a name="line202">202: </a><font color="#B22222">      MPICH could not properly cancel requests thus with ready receiver mode we</font>
+<a name="line203">203: </a><font color="#B22222">    cannot free the requests. It may be fixed now, if not then put the following </font>
+<a name="line204">204: </a><font color="#B22222">    code inside a if !to-&gt;use_readyreceiver) {</font>
+<a name="line205">205: </a><font color="#B22222">  */</font>
+<a name="line206">206: </a>  <font color="#4169E1">if</font> (!to-&gt;use_alltoallv &amp;&amp; !to-&gt;use_window) {    <font color="#B22222">/* currently the from-&gt;requests etc are ALWAYS allocated even if not used */</font>
+<a name="line207">207: </a>    <font color="#4169E1">if</font> (from-&gt;requests) {
+<a name="line208">208: </a>      <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line209">209: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(from-&gt;requests + i);
+<a name="line210">210: </a>      }
+<a name="line211">211: </a>    }
+
+<a name="line213">213: </a>    <font color="#4169E1">if</font> (from-&gt;rev_requests) {
+<a name="line214">214: </a>      <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line215">215: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(from-&gt;rev_requests + i);
+<a name="line216">216: </a>      }
+<a name="line217">217: </a>    }
+<a name="line218">218: </a>  }
+<a name="line219">219: </a><font color="#A020F0">#endif</font>
+
+<a name="line221">221: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;local.vslots);
+<a name="line222">222: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;local.vslots);
+<a name="line223">223: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(to-&gt;counts,to-&gt;displs);
+<a name="line224">224: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(from-&gt;counts,from-&gt;displs);
+<a name="line225">225: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;local.slots_nonmatching);
+<a name="line226">226: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;local.slots_nonmatching);
+<a name="line227">227: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;rev_requests);
+<a name="line228">228: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;rev_requests);
+<a name="line229">229: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;requests);
+<a name="line230">230: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;requests);
+<a name="line231">231: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree4.html#PetscFree4">PetscFree4</A>(to-&gt;values,to-&gt;indices,to-&gt;starts,to-&gt;procs);
+<a name="line232">232: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(to-&gt;sstatus,to-&gt;rstatus);
+<a name="line233">233: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree4.html#PetscFree4">PetscFree4</A>(from-&gt;values,from-&gt;indices,from-&gt;starts,from-&gt;procs);
+<a name="line234">234: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from);
+<a name="line235">235: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to);
+<a name="line236">236: </a>  <A href="../../../../docs/manualpages/Sys/PetscHeaderDestroy.html#PetscHeaderDestroy">PetscHeaderDestroy</A>(ctx);
+<a name="line237">237: </a>  <font color="#4169E1">return</font>(0);
+<a name="line238">238: </a>}
+
+
+
+<a name="line242">242: </a><font color="#B22222">/* --------------------------------------------------------------------------------------*/</font>
+<a name="line243">243: </a><font color="#B22222">/*</font>
+<a name="line244">244: </a><font color="#B22222">    Special optimization to see if the local part of the scatter is actually </font>
+<a name="line245">245: </a><font color="#B22222">    a copy. The scatter routines call <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>() instead.</font>
+<a name="line246">246: </a><font color="#B22222"> </font>
+<a name="line247">247: </a><font color="#B22222">*/</font>
+<a name="line250">250: </a><strong><font color="#4169E1"><a name="VecScatterLocalOptimizeCopy_Private"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterLocalOptimizeCopy_Private(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> scatter,VecScatter_Seq_General *to,VecScatter_Seq_General *from,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs)</font></strong>
+<a name="line251">251: </a>{
+<a name="line252">252: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = to-&gt;n,i,*to_slots = to-&gt;vslots,*from_slots = from-&gt;vslots;
+<a name="line253">253: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       to_start,from_start;
+
+<a name="line257">257: </a>  to_start   = to_slots[0];
+<a name="line258">258: </a>  from_start = from_slots[0];
+
+<a name="line260">260: </a>  <font color="#4169E1">for</font> (i=1; i&lt;n; i++) {
+<a name="line261">261: </a>    to_start   += bs;
+<a name="line262">262: </a>    from_start += bs;
+<a name="line263">263: </a>    <font color="#4169E1">if</font> (to_slots[i]   != to_start)   <font color="#4169E1">return</font>(0);
+<a name="line264">264: </a>    <font color="#4169E1">if</font> (from_slots[i] != from_start) <font color="#4169E1">return</font>(0);
+<a name="line265">265: </a>  }
+<a name="line266">266: </a>  to-&gt;is_copy       = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line267">267: </a>  to-&gt;copy_start    = to_slots[0];
+<a name="line268">268: </a>  to-&gt;copy_length   = bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*n;
+<a name="line269">269: </a>  from-&gt;is_copy     = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line270">270: </a>  from-&gt;copy_start  = from_slots[0];
+<a name="line271">271: </a>  from-&gt;copy_length = bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*n;
+<a name="line272">272: </a>  <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(scatter,<font color="#666666">"Local scatter is a copy, optimizing for it\n"</font>);
+<a name="line273">273: </a>  <font color="#4169E1">return</font>(0);
+<a name="line274">274: </a>}
+
+<a name="line276">276: </a><font color="#B22222">/* --------------------------------------------------------------------------------------*/</font>
+
+<a name="line280">280: </a><strong><font color="#4169E1"><a name="VecScatterCopy_PtoP_X"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCopy_PtoP_X(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> in,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> out)</font></strong>
+<a name="line281">281: </a>{
+<a name="line282">282: </a>  VecScatter_MPI_General *in_to   = (VecScatter_MPI_General*)in-&gt;todata;
+<a name="line283">283: </a>  VecScatter_MPI_General *in_from = (VecScatter_MPI_General*)in-&gt;fromdata,*out_to,*out_from;
+<a name="line284">284: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
+<a name="line285">285: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               ny,bs = in_from-&gt;bs;
+
+<a name="line288">288: </a>  out-&gt;begin     = in-&gt;begin;
+<a name="line289">289: </a>  out-&gt;end       = in-&gt;end;
+<a name="line290">290: </a>  out-&gt;copy      = in-&gt;copy;
+<a name="line291">291: </a>  out-&gt;destroy   = in-&gt;destroy;
+<a name="line292">292: </a>  out-&gt;view      = in-&gt;view;
+
+<a name="line294">294: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
+<a name="line295">295: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_to);
+<a name="line296">296: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_from);
+
+<a name="line298">298: </a>  ny                = in_to-&gt;starts[in_to-&gt;n];
+<a name="line299">299: </a>  out_to-&gt;n         = in_to-&gt;n;
+<a name="line300">300: </a>  out_to-&gt;type      = in_to-&gt;type;
+<a name="line301">301: </a>  out_to-&gt;sendfirst = in_to-&gt;sendfirst;
+
+<a name="line303">303: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_to-&gt;requests);
+<a name="line304">304: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*ny,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_to-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;indices,out_to-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;starts,out_to-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;procs);
+<a name="line305">305: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;sstatus,PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;rstatus);
+<a name="line306">306: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;indices,in_to-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line307">307: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;starts,in_to-&gt;starts,(out_to-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line308">308: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;procs,in_to-&gt;procs,(out_to-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line309">309: </a>
+<a name="line310">310: </a>  out-&gt;todata       = (void*)out_to;
+<a name="line311">311: </a>  out_to-&gt;local.n   = in_to-&gt;local.n;
+<a name="line312">312: </a>  out_to-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line313">313: </a>  out_to-&gt;local.n_nonmatching        = 0;
+<a name="line314">314: </a>  out_to-&gt;local.slots_nonmatching    = 0;
+<a name="line315">315: </a>  <font color="#4169E1">if</font> (in_to-&gt;local.n) {
+<a name="line316">316: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_to-&gt;local.vslots);
+<a name="line317">317: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_from-&gt;local.vslots);
+<a name="line318">318: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;local.vslots,in_to-&gt;local.vslots,in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line319">319: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;local.vslots,in_from-&gt;local.vslots,in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line320">320: </a>  } <font color="#4169E1">else</font> {
+<a name="line321">321: </a>    out_to-&gt;local.vslots   = 0;
+<a name="line322">322: </a>    out_from-&gt;local.vslots = 0;
+<a name="line323">323: </a>  }
+
+<a name="line325">325: </a>  <font color="#B22222">/* allocate entire receive context */</font>
+<a name="line326">326: </a>  out_from-&gt;type      = in_from-&gt;type;
+<a name="line327">327: </a>  ny                  = in_from-&gt;starts[in_from-&gt;n];
+<a name="line328">328: </a>  out_from-&gt;n         = in_from-&gt;n;
+<a name="line329">329: </a>  out_from-&gt;sendfirst = in_from-&gt;sendfirst;
+
+<a name="line331">331: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_from-&gt;requests);
+<a name="line332">332: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(ny*bs,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_from-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;indices,out_from-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;starts,out_from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;procs);
+<a name="line333">333: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;indices,in_from-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line334">334: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;starts,in_from-&gt;starts,(out_from-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line335">335: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;procs,in_from-&gt;procs,(out_from-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line336">336: </a>  out-&gt;fromdata       = (void*)out_from;
+<a name="line337">337: </a>  out_from-&gt;local.n   = in_from-&gt;local.n;
+<a name="line338">338: </a>  out_from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line339">339: </a>  out_from-&gt;local.n_nonmatching        = 0;
+<a name="line340">340: </a>  out_from-&gt;local.slots_nonmatching    = 0;
+
+<a name="line342">342: </a>  <font color="#B22222">/* </font>
+<a name="line343">343: </a><font color="#B22222">      set up the request arrays for use with isend_init() and irecv_init()</font>
+<a name="line344">344: </a><font color="#B22222">  */</font>
+<a name="line345">345: </a>  {
+<a name="line346">346: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> tag;
+<a name="line347">347: </a>    <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>    comm;
+<a name="line348">348: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    *sstarts = out_to-&gt;starts,  *rstarts = out_from-&gt;starts;
+<a name="line349">349: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> *sprocs  = out_to-&gt;procs,   *rprocs  = out_from-&gt;procs;
+<a name="line350">350: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i;
+<a name="line351">351: </a>    <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>  flg;
+<a name="line352">352: </a>    MPI_Request *swaits  = out_to-&gt;requests,*rwaits  = out_from-&gt;requests;
+<a name="line353">353: </a>    MPI_Request *rev_swaits,*rev_rwaits;
+<a name="line354">354: </a>    <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *Ssvalues = out_to-&gt;values, *Srvalues = out_from-&gt;values;
+
+<a name="line356">356: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_to-&gt;rev_requests);
+<a name="line357">357: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_from-&gt;rev_requests);
+
+<a name="line359">359: </a>    rev_rwaits = out_to-&gt;rev_requests;
+<a name="line360">360: </a>    rev_swaits = out_from-&gt;rev_requests;
+
+<a name="line362">362: </a>    out_from-&gt;bs = out_to-&gt;bs = bs;
+<a name="line363">363: </a>    tag     = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)out)-&gt;tag;
+<a name="line364">364: </a>    comm    = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)out)-&gt;comm;
+
+<a name="line366">366: </a>    <font color="#B22222">/* Register the receives that you will use later (sends for scatter reverse) */</font>
+<a name="line367">367: </a>    <font color="#4169E1">for</font> (i=0; i&lt;out_from-&gt;n; i++) {
+<a name="line368">368: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tag,comm,rwaits+i);
+<a name="line369">369: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tag,comm,rev_swaits+i);
+<a name="line370">370: </a>    }
+
+<a name="line372">372: </a>    flg  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line373">373: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_rsend"</font>,&amp;flg,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line374">374: </a>    <font color="#4169E1">if</font> (flg) {
+<a name="line375">375: </a>      out_to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line376">376: </a>      out_from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line377">377: </a>      <font color="#4169E1">for</font> (i=0; i&lt;out_to-&gt;n; i++) {
+<a name="line378">378: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Rsend_init.html#MPI_Rsend_init">MPI_Rsend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
+<a name="line379">379: </a>      }
+<a name="line380">380: </a>      <font color="#4169E1">if</font> (out_from-&gt;n) {MPI_Startall_irecv(out_from-&gt;starts[out_from-&gt;n]*out_from-&gt;bs,out_from-&gt;n,out_from-&gt;requests);}
+<a name="line381">381: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Barrier.html#MPI_Barrier">MPI_Barrier</A>(comm);
+<a name="line382">382: </a>      <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(in,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ready receiver mode\n"</font>);
+<a name="line383">383: </a>    } <font color="#4169E1">else</font> {
+<a name="line384">384: </a>      out_to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line385">385: </a>      out_from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line386">386: </a>      flg                          = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line387">387: </a>      <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_ssend"</font>,&amp;flg,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line388">388: </a>      <font color="#4169E1">if</font> (flg) {
+<a name="line389">389: </a>        <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(in,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> Ssend mode\n"</font>);
+<a name="line390">390: </a>      }
+<a name="line391">391: </a>      <font color="#4169E1">for</font> (i=0; i&lt;out_to-&gt;n; i++) {
+<a name="line392">392: </a>        <font color="#4169E1">if</font> (!flg) {
+<a name="line393">393: </a>          <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
+<a name="line394">394: </a>        } <font color="#4169E1">else</font> {
+<a name="line395">395: </a>          <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Ssend_init.html#MPI_Ssend_init">MPI_Ssend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
+<a name="line396">396: </a>        }
+<a name="line397">397: </a>      }
+<a name="line398">398: </a>    }
+<a name="line399">399: </a>    <font color="#B22222">/* Register receives for scatter reverse */</font>
+<a name="line400">400: </a>    <font color="#4169E1">for</font> (i=0; i&lt;out_to-&gt;n; i++) {
+<a name="line401">401: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,rev_rwaits+i);
+<a name="line402">402: </a>    }
+<a name="line403">403: </a>  }
+
+<a name="line405">405: </a>  <font color="#4169E1">return</font>(0);
+<a name="line406">406: </a>}
+
+<a name="line410">410: </a><strong><font color="#4169E1"><a name="VecScatterCopy_PtoP_AllToAll"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCopy_PtoP_AllToAll(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> in,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> out)</font></strong>
+<a name="line411">411: </a>{
+<a name="line412">412: </a>  VecScatter_MPI_General *in_to   = (VecScatter_MPI_General*)in-&gt;todata;
+<a name="line413">413: </a>  VecScatter_MPI_General *in_from = (VecScatter_MPI_General*)in-&gt;fromdata,*out_to,*out_from;
+<a name="line414">414: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
+<a name="line415">415: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               ny,bs = in_from-&gt;bs;
+<a name="line416">416: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            size;
+
+<a name="line419">419: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)in)-&gt;comm,&amp;size);
+<a name="line420">420: </a>  out-&gt;begin     = in-&gt;begin;
+<a name="line421">421: </a>  out-&gt;end       = in-&gt;end;
+<a name="line422">422: </a>  out-&gt;copy      = in-&gt;copy;
+<a name="line423">423: </a>  out-&gt;destroy   = in-&gt;destroy;
+<a name="line424">424: </a>  out-&gt;view      = in-&gt;view;
+
+<a name="line426">426: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
+<a name="line427">427: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_to);
+<a name="line428">428: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_from);
+
+<a name="line430">430: </a>  ny                = in_to-&gt;starts[in_to-&gt;n];
+<a name="line431">431: </a>  out_to-&gt;n         = in_to-&gt;n;
+<a name="line432">432: </a>  out_to-&gt;type      = in_to-&gt;type;
+<a name="line433">433: </a>  out_to-&gt;sendfirst = in_to-&gt;sendfirst;
+
+<a name="line435">435: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_to-&gt;requests);
+<a name="line436">436: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*ny,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_to-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;indices,out_to-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;starts,out_to-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;procs);
+<a name="line437">437: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;sstatus,PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;rstatus);
+<a name="line438">438: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;indices,in_to-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line439">439: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;starts,in_to-&gt;starts,(out_to-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line440">440: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;procs,in_to-&gt;procs,(out_to-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line441">441: </a>
+<a name="line442">442: </a>  out-&gt;todata       = (void*)out_to;
+<a name="line443">443: </a>  out_to-&gt;local.n   = in_to-&gt;local.n;
+<a name="line444">444: </a>  out_to-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line445">445: </a>  out_to-&gt;local.n_nonmatching        = 0;
+<a name="line446">446: </a>  out_to-&gt;local.slots_nonmatching    = 0;
+<a name="line447">447: </a>  <font color="#4169E1">if</font> (in_to-&gt;local.n) {
+<a name="line448">448: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_to-&gt;local.vslots);
+<a name="line449">449: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_from-&gt;local.vslots);
+<a name="line450">450: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;local.vslots,in_to-&gt;local.vslots,in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line451">451: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;local.vslots,in_from-&gt;local.vslots,in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line452">452: </a>  } <font color="#4169E1">else</font> {
+<a name="line453">453: </a>    out_to-&gt;local.vslots   = 0;
+<a name="line454">454: </a>    out_from-&gt;local.vslots = 0;
+<a name="line455">455: </a>  }
+
+<a name="line457">457: </a>  <font color="#B22222">/* allocate entire receive context */</font>
+<a name="line458">458: </a>  out_from-&gt;type      = in_from-&gt;type;
+<a name="line459">459: </a>  ny                  = in_from-&gt;starts[in_from-&gt;n];
+<a name="line460">460: </a>  out_from-&gt;n         = in_from-&gt;n;
+<a name="line461">461: </a>  out_from-&gt;sendfirst = in_from-&gt;sendfirst;
+
+<a name="line463">463: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_from-&gt;requests);
+<a name="line464">464: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(ny*bs,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_from-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;indices,out_from-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;starts,out_from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;procs);
+<a name="line465">465: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;indices,in_from-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line466">466: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;starts,in_from-&gt;starts,(out_from-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
+<a name="line467">467: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;procs,in_from-&gt;procs,(out_from-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line468">468: </a>  out-&gt;fromdata       = (void*)out_from;
+<a name="line469">469: </a>  out_from-&gt;local.n   = in_from-&gt;local.n;
+<a name="line470">470: </a>  out_from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line471">471: </a>  out_from-&gt;local.n_nonmatching        = 0;
+<a name="line472">472: </a>  out_from-&gt;local.slots_nonmatching    = 0;
+
+<a name="line474">474: </a>  out_to-&gt;use_alltoallv = out_from-&gt;use_alltoallv = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+
+<a name="line476">476: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;displs);
+<a name="line477">477: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;counts,in_to-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line478">478: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;displs,in_to-&gt;displs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+
+<a name="line480">480: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;displs);
+<a name="line481">481: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;counts,in_from-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line482">482: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;displs,in_from-&gt;displs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line483">483: </a>  <font color="#4169E1">return</font>(0);
+<a name="line484">484: </a>}
+<a name="line485">485: </a><font color="#B22222">/* --------------------------------------------------------------------------------------------------</font>
+<a name="line486">486: </a><font color="#B22222">    Packs and unpacks the message data into send or from receive buffers. </font>
+
+<a name="line488">488: </a><font color="#B22222">    These could be generated automatically. </font>
+
+<a name="line490">490: </a><font color="#B22222">    Fortran kernels etc. could be used.</font>
+<a name="line491">491: </a><font color="#B22222">*/</font>
+<a name="line492">492: </a><strong><font color="#4169E1"><a name="Pack_1"></a>PETSC_STATIC_INLINE void Pack_1(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line493">493: </a>{
+<a name="line494">494: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
+<a name="line495">495: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line496">496: </a>    y[i]  = x[indicesx[i]];
+<a name="line497">497: </a>  }
+<a name="line498">498: </a>}
+<a name="line499">499: </a><strong><font color="#4169E1"><a name="UnPack_1"></a>PETSC_STATIC_INLINE void UnPack_1(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line500">500: </a>{
+<a name="line501">501: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
+<a name="line502">502: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line503">503: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line504">504: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line505">505: </a>      y[indicesy[i]] = x[i];
+<a name="line506">506: </a>    }
+<a name="line507">507: </a>    <font color="#4169E1">break</font>;
+<a name="line508">508: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line509">509: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line510">510: </a>      y[indicesy[i]] += x[i];
+<a name="line511">511: </a>    }
+<a name="line512">512: </a>    <font color="#4169E1">break</font>;
+<a name="line513">513: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line514">514: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line515">515: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line516">516: </a>      y[indicesy[i]] = PetscMax(y[indicesy[i]],x[i]);
+<a name="line517">517: </a>    }
+<a name="line518">518: </a><font color="#A020F0">#else</font>
+<a name="line519">519: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line520">520: </a><font color="#A020F0">#endif</font>
+<a name="line521">521: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line522">522: </a>    <font color="#4169E1">break</font>;
+<a name="line523">523: </a>  }
+<a name="line524">524: </a>}
+
+<a name="line526">526: </a><strong><font color="#4169E1"><a name="Scatter_1"></a>PETSC_STATIC_INLINE void Scatter_1(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line527">527: </a>{
+<a name="line528">528: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
+<a name="line529">529: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line530">530: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line531">531: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line532">532: </a>      y[indicesy[i]] = x[indicesx[i]];
+<a name="line533">533: </a>    }
+<a name="line534">534: </a>    <font color="#4169E1">break</font>;
+<a name="line535">535: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line536">536: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line537">537: </a>      y[indicesy[i]] += x[indicesx[i]];
+<a name="line538">538: </a>    }
+<a name="line539">539: </a>    <font color="#4169E1">break</font>;
+<a name="line540">540: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line541">541: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line542">542: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line543">543: </a>      y[indicesy[i]] = PetscMax(y[indicesy[i]],x[indicesx[i]]);
+<a name="line544">544: </a>    }
+<a name="line545">545: </a><font color="#A020F0">#else</font>
+<a name="line546">546: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line547">547: </a><font color="#A020F0">#endif</font>
+<a name="line548">548: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line549">549: </a>    <font color="#4169E1">break</font>;
+<a name="line550">550: </a>  }
+<a name="line551">551: </a>}
+
+<a name="line553">553: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line554">554: </a><strong><font color="#4169E1"><a name="Pack_2"></a>PETSC_STATIC_INLINE void Pack_2(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line555">555: </a>{
+<a name="line556">556: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line558">558: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line559">559: </a>    idx   = *indicesx++;
+<a name="line560">560: </a>    y[0]  = x[idx];
+<a name="line561">561: </a>    y[1]  = x[idx+1];
+<a name="line562">562: </a>    y    += 2;
+<a name="line563">563: </a>  }
+<a name="line564">564: </a>}
+<a name="line565">565: </a><strong><font color="#4169E1"><a name="UnPack_2"></a>PETSC_STATIC_INLINE void UnPack_2(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line566">566: </a>{
+<a name="line567">567: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line569">569: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line570">570: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line571">571: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line572">572: </a>      idy       = *indicesy++;
+<a name="line573">573: </a>      y[idy]    = x[0];
+<a name="line574">574: </a>      y[idy+1]  = x[1];
+<a name="line575">575: </a>      x    += 2;
+<a name="line576">576: </a>    }
+<a name="line577">577: </a>    <font color="#4169E1">break</font>;
+<a name="line578">578: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line579">579: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line580">580: </a>      idy       = *indicesy++;
+<a name="line581">581: </a>      y[idy]    += x[0];
+<a name="line582">582: </a>      y[idy+1]  += x[1];
+<a name="line583">583: </a>      x    += 2;
+<a name="line584">584: </a>    }
+<a name="line585">585: </a>    <font color="#4169E1">break</font>;
+<a name="line586">586: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line587">587: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line588">588: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line589">589: </a>      idy       = *indicesy++;
+<a name="line590">590: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line591">591: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line592">592: </a>      x    += 2;
+<a name="line593">593: </a>    }
+<a name="line594">594: </a><font color="#A020F0">#else</font>
+<a name="line595">595: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line596">596: </a><font color="#A020F0">#endif</font>
+<a name="line597">597: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line598">598: </a>    <font color="#4169E1">break</font>;
+<a name="line599">599: </a>  }
+<a name="line600">600: </a>}
+
+<a name="line602">602: </a><strong><font color="#4169E1"><a name="Scatter_2"></a>PETSC_STATIC_INLINE void Scatter_2(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line603">603: </a>{
+<a name="line604">604: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line606">606: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line607">607: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line608">608: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line609">609: </a>      idx       = *indicesx++;
+<a name="line610">610: </a>      idy       = *indicesy++;
+<a name="line611">611: </a>      y[idy]    = x[idx];
+<a name="line612">612: </a>      y[idy+1]  = x[idx+1];
+<a name="line613">613: </a>    }
+<a name="line614">614: </a>    <font color="#4169E1">break</font>;
+<a name="line615">615: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line616">616: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line617">617: </a>      idx       = *indicesx++;
+<a name="line618">618: </a>      idy       = *indicesy++;
+<a name="line619">619: </a>      y[idy]    += x[idx];
+<a name="line620">620: </a>      y[idy+1]  += x[idx+1];
+<a name="line621">621: </a>    }
+<a name="line622">622: </a>    <font color="#4169E1">break</font>;
+<a name="line623">623: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line624">624: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line625">625: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line626">626: </a>      idx       = *indicesx++;
+<a name="line627">627: </a>      idy       = *indicesy++;
+<a name="line628">628: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line629">629: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line630">630: </a>    }
+<a name="line631">631: </a><font color="#A020F0">#else</font>
+<a name="line632">632: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line633">633: </a><font color="#A020F0">#endif</font>
+<a name="line634">634: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line635">635: </a>    <font color="#4169E1">break</font>;
+<a name="line636">636: </a>  }
+<a name="line637">637: </a>}
+<a name="line638">638: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line639">639: </a><strong><font color="#4169E1"><a name="Pack_3"></a>PETSC_STATIC_INLINE void Pack_3(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line640">640: </a>{
+<a name="line641">641: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line643">643: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line644">644: </a>    idx   = *indicesx++;
+<a name="line645">645: </a>    y[0]  = x[idx];
+<a name="line646">646: </a>    y[1]  = x[idx+1];
+<a name="line647">647: </a>    y[2]  = x[idx+2];
+<a name="line648">648: </a>    y    += 3;
+<a name="line649">649: </a>  }
+<a name="line650">650: </a>}
+<a name="line651">651: </a><strong><font color="#4169E1"><a name="UnPack_3"></a>PETSC_STATIC_INLINE void UnPack_3(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line652">652: </a>{
+<a name="line653">653: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line655">655: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line656">656: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line657">657: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line658">658: </a>      idy       = *indicesy++;
+<a name="line659">659: </a>      y[idy]    = x[0];
+<a name="line660">660: </a>      y[idy+1]  = x[1];
+<a name="line661">661: </a>      y[idy+2]  = x[2];
+<a name="line662">662: </a>      x    += 3;
+<a name="line663">663: </a>    }
+<a name="line664">664: </a>    <font color="#4169E1">break</font>;
+<a name="line665">665: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line666">666: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line667">667: </a>      idy       = *indicesy++;
+<a name="line668">668: </a>      y[idy]    += x[0];
+<a name="line669">669: </a>      y[idy+1]  += x[1];
+<a name="line670">670: </a>      y[idy+2]  += x[2];
+<a name="line671">671: </a>      x    += 3;
+<a name="line672">672: </a>    }
+<a name="line673">673: </a>    <font color="#4169E1">break</font>;
+<a name="line674">674: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line675">675: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line676">676: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line677">677: </a>      idy       = *indicesy++;
+<a name="line678">678: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line679">679: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line680">680: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line681">681: </a>      x    += 3;
+<a name="line682">682: </a>    }
+<a name="line683">683: </a><font color="#A020F0">#else</font>
+<a name="line684">684: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line685">685: </a><font color="#A020F0">#endif</font>
+<a name="line686">686: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line687">687: </a>    <font color="#4169E1">break</font>;
+<a name="line688">688: </a>  }
+<a name="line689">689: </a>}
+
+<a name="line691">691: </a><strong><font color="#4169E1"><a name="Scatter_3"></a>PETSC_STATIC_INLINE void Scatter_3(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line692">692: </a>{
+<a name="line693">693: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line695">695: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line696">696: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line697">697: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line698">698: </a>      idx       = *indicesx++;
+<a name="line699">699: </a>      idy       = *indicesy++;
+<a name="line700">700: </a>      y[idy]    = x[idx];
+<a name="line701">701: </a>      y[idy+1]  = x[idx+1];
+<a name="line702">702: </a>      y[idy+2]  = x[idx+2];
+<a name="line703">703: </a>    }
+<a name="line704">704: </a>    <font color="#4169E1">break</font>;
+<a name="line705">705: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line706">706: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line707">707: </a>      idx       = *indicesx++;
+<a name="line708">708: </a>      idy       = *indicesy++;
+<a name="line709">709: </a>      y[idy]    += x[idx];
+<a name="line710">710: </a>      y[idy+1]  += x[idx+1];
+<a name="line711">711: </a>      y[idy+2]  += x[idx+2];
+<a name="line712">712: </a>    }
+<a name="line713">713: </a>    <font color="#4169E1">break</font>;
+<a name="line714">714: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line715">715: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line716">716: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line717">717: </a>      idx       = *indicesx++;
+<a name="line718">718: </a>      idy       = *indicesy++;
+<a name="line719">719: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line720">720: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line721">721: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line722">722: </a>    }
+<a name="line723">723: </a><font color="#A020F0">#else</font>
+<a name="line724">724: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line725">725: </a><font color="#A020F0">#endif</font>
+<a name="line726">726: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line727">727: </a>    <font color="#4169E1">break</font>;
+<a name="line728">728: </a>  }
+<a name="line729">729: </a>}
+<a name="line730">730: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line731">731: </a><strong><font color="#4169E1"><a name="Pack_4"></a>PETSC_STATIC_INLINE void Pack_4(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line732">732: </a>{
+<a name="line733">733: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line735">735: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line736">736: </a>    idx   = *indicesx++;
+<a name="line737">737: </a>    y[0]  = x[idx];
+<a name="line738">738: </a>    y[1]  = x[idx+1];
+<a name="line739">739: </a>    y[2]  = x[idx+2];
+<a name="line740">740: </a>    y[3]  = x[idx+3];
+<a name="line741">741: </a>    y    += 4;
+<a name="line742">742: </a>  }
+<a name="line743">743: </a>}
+<a name="line744">744: </a><strong><font color="#4169E1"><a name="UnPack_4"></a>PETSC_STATIC_INLINE void UnPack_4(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line745">745: </a>{
+<a name="line746">746: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line748">748: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line749">749: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line750">750: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line751">751: </a>      idy       = *indicesy++;
+<a name="line752">752: </a>      y[idy]    = x[0];
+<a name="line753">753: </a>      y[idy+1]  = x[1];
+<a name="line754">754: </a>      y[idy+2]  = x[2];
+<a name="line755">755: </a>      y[idy+3]  = x[3];
+<a name="line756">756: </a>      x    += 4;
+<a name="line757">757: </a>    }
+<a name="line758">758: </a>    <font color="#4169E1">break</font>;
+<a name="line759">759: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line760">760: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line761">761: </a>      idy       = *indicesy++;
+<a name="line762">762: </a>      y[idy]    += x[0];
+<a name="line763">763: </a>      y[idy+1]  += x[1];
+<a name="line764">764: </a>      y[idy+2]  += x[2];
+<a name="line765">765: </a>      y[idy+3]  += x[3];
+<a name="line766">766: </a>      x    += 4;
+<a name="line767">767: </a>    }
+<a name="line768">768: </a>    <font color="#4169E1">break</font>;
+<a name="line769">769: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line770">770: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line771">771: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line772">772: </a>      idy       = *indicesy++;
+<a name="line773">773: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line774">774: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line775">775: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line776">776: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
+<a name="line777">777: </a>      x    += 4;
+<a name="line778">778: </a>    }
+<a name="line779">779: </a><font color="#A020F0">#else</font>
+<a name="line780">780: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line781">781: </a><font color="#A020F0">#endif</font>
+<a name="line782">782: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line783">783: </a>    <font color="#4169E1">break</font>;
+<a name="line784">784: </a>  }
+<a name="line785">785: </a>}
+
+<a name="line787">787: </a><strong><font color="#4169E1"><a name="Scatter_4"></a>PETSC_STATIC_INLINE void Scatter_4(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line788">788: </a>{
+<a name="line789">789: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line791">791: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line792">792: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line793">793: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line794">794: </a>      idx       = *indicesx++;
+<a name="line795">795: </a>      idy       = *indicesy++;
+<a name="line796">796: </a>      y[idy]    = x[idx];
+<a name="line797">797: </a>      y[idy+1]  = x[idx+1];
+<a name="line798">798: </a>      y[idy+2]  = x[idx+2];
+<a name="line799">799: </a>      y[idy+3]  = x[idx+3];
+<a name="line800">800: </a>    }
+<a name="line801">801: </a>    <font color="#4169E1">break</font>;
+<a name="line802">802: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line803">803: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line804">804: </a>      idx       = *indicesx++;
+<a name="line805">805: </a>      idy       = *indicesy++;
+<a name="line806">806: </a>      y[idy]    += x[idx];
+<a name="line807">807: </a>      y[idy+1]  += x[idx+1];
+<a name="line808">808: </a>      y[idy+2]  += x[idx+2];
+<a name="line809">809: </a>      y[idy+3]  += x[idx+3];
+<a name="line810">810: </a>    }
+<a name="line811">811: </a>    <font color="#4169E1">break</font>;
+<a name="line812">812: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line813">813: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line814">814: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line815">815: </a>      idx       = *indicesx++;
+<a name="line816">816: </a>      idy       = *indicesy++;
+<a name="line817">817: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line818">818: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line819">819: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line820">820: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
+<a name="line821">821: </a>    }
+<a name="line822">822: </a><font color="#A020F0">#else</font>
+<a name="line823">823: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line824">824: </a><font color="#A020F0">#endif</font>
+<a name="line825">825: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line826">826: </a>    <font color="#4169E1">break</font>;
+<a name="line827">827: </a>  }
+<a name="line828">828: </a>}
+<a name="line829">829: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line830">830: </a><strong><font color="#4169E1"><a name="Pack_5"></a>PETSC_STATIC_INLINE void Pack_5(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line831">831: </a>{
+<a name="line832">832: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line834">834: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line835">835: </a>    idx   = *indicesx++;
+<a name="line836">836: </a>    y[0]  = x[idx];
+<a name="line837">837: </a>    y[1]  = x[idx+1];
+<a name="line838">838: </a>    y[2]  = x[idx+2];
+<a name="line839">839: </a>    y[3]  = x[idx+3];
+<a name="line840">840: </a>    y[4]  = x[idx+4];
+<a name="line841">841: </a>    y    += 5;
+<a name="line842">842: </a>  }
+<a name="line843">843: </a>}
+<a name="line844">844: </a><strong><font color="#4169E1"><a name="UnPack_5"></a>PETSC_STATIC_INLINE void UnPack_5(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line845">845: </a>{
+<a name="line846">846: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line848">848: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line849">849: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line850">850: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line851">851: </a>      idy       = *indicesy++;
+<a name="line852">852: </a>      y[idy]    = x[0];
+<a name="line853">853: </a>      y[idy+1]  = x[1];
+<a name="line854">854: </a>      y[idy+2]  = x[2];
+<a name="line855">855: </a>      y[idy+3]  = x[3];
+<a name="line856">856: </a>      y[idy+4]  = x[4];
+<a name="line857">857: </a>      x    += 5;
+<a name="line858">858: </a>    }
+<a name="line859">859: </a>    <font color="#4169E1">break</font>;
+<a name="line860">860: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line861">861: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line862">862: </a>      idy       = *indicesy++;
+<a name="line863">863: </a>      y[idy]    += x[0];
+<a name="line864">864: </a>      y[idy+1]  += x[1];
+<a name="line865">865: </a>      y[idy+2]  += x[2];
+<a name="line866">866: </a>      y[idy+3]  += x[3];
+<a name="line867">867: </a>      y[idy+4]  += x[4];
+<a name="line868">868: </a>      x    += 5;
+<a name="line869">869: </a>    }
+<a name="line870">870: </a>    <font color="#4169E1">break</font>;
+<a name="line871">871: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line872">872: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line873">873: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line874">874: </a>      idy       = *indicesy++;
+<a name="line875">875: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line876">876: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line877">877: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line878">878: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
+<a name="line879">879: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
+<a name="line880">880: </a>      x    += 5;
+<a name="line881">881: </a>    }
+<a name="line882">882: </a><font color="#A020F0">#else</font>
+<a name="line883">883: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line884">884: </a><font color="#A020F0">#endif</font>
+<a name="line885">885: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line886">886: </a>    <font color="#4169E1">break</font>;
+<a name="line887">887: </a>  }
+<a name="line888">888: </a>}
+
+<a name="line890">890: </a><strong><font color="#4169E1"><a name="Scatter_5"></a>PETSC_STATIC_INLINE void Scatter_5(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line891">891: </a>{
+<a name="line892">892: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line894">894: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line895">895: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line896">896: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line897">897: </a>      idx       = *indicesx++;
+<a name="line898">898: </a>      idy       = *indicesy++;
+<a name="line899">899: </a>      y[idy]    = x[idx];
+<a name="line900">900: </a>      y[idy+1]  = x[idx+1];
+<a name="line901">901: </a>      y[idy+2]  = x[idx+2];
+<a name="line902">902: </a>      y[idy+3]  = x[idx+3];
+<a name="line903">903: </a>      y[idy+4]  = x[idx+4];
+<a name="line904">904: </a>    }
+<a name="line905">905: </a>    <font color="#4169E1">break</font>;
+<a name="line906">906: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line907">907: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line908">908: </a>      idx       = *indicesx++;
+<a name="line909">909: </a>      idy       = *indicesy++;
+<a name="line910">910: </a>      y[idy]    += x[idx];
+<a name="line911">911: </a>      y[idy+1]  += x[idx+1];
+<a name="line912">912: </a>      y[idy+2]  += x[idx+2];
+<a name="line913">913: </a>      y[idy+3]  += x[idx+3];
+<a name="line914">914: </a>      y[idy+4]  += x[idx+4];
+<a name="line915">915: </a>    }
+<a name="line916">916: </a>    <font color="#4169E1">break</font>;
+<a name="line917">917: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line918">918: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line919">919: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line920">920: </a>      idx       = *indicesx++;
+<a name="line921">921: </a>      idy       = *indicesy++;
+<a name="line922">922: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line923">923: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line924">924: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line925">925: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
+<a name="line926">926: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
+<a name="line927">927: </a>    }
+<a name="line928">928: </a><font color="#A020F0">#else</font>
+<a name="line929">929: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line930">930: </a><font color="#A020F0">#endif</font>
+<a name="line931">931: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line932">932: </a>    <font color="#4169E1">break</font>;
+<a name="line933">933: </a>  }
+<a name="line934">934: </a>}
+<a name="line935">935: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line936">936: </a><strong><font color="#4169E1"><a name="Pack_6"></a>PETSC_STATIC_INLINE void Pack_6(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line937">937: </a>{
+<a name="line938">938: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line940">940: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line941">941: </a>    idx   = *indicesx++;
+<a name="line942">942: </a>    y[0]  = x[idx];
+<a name="line943">943: </a>    y[1]  = x[idx+1];
+<a name="line944">944: </a>    y[2]  = x[idx+2];
+<a name="line945">945: </a>    y[3]  = x[idx+3];
+<a name="line946">946: </a>    y[4]  = x[idx+4];
+<a name="line947">947: </a>    y[5]  = x[idx+5];
+<a name="line948">948: </a>    y    += 6;
+<a name="line949">949: </a>  }
+<a name="line950">950: </a>}
+<a name="line951">951: </a><strong><font color="#4169E1"><a name="UnPack_6"></a>PETSC_STATIC_INLINE void UnPack_6(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line952">952: </a>{
+<a name="line953">953: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line955">955: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line956">956: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line957">957: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line958">958: </a>      idy       = *indicesy++;
+<a name="line959">959: </a>      y[idy]    = x[0];
+<a name="line960">960: </a>      y[idy+1]  = x[1];
+<a name="line961">961: </a>      y[idy+2]  = x[2];
+<a name="line962">962: </a>      y[idy+3]  = x[3];
+<a name="line963">963: </a>      y[idy+4]  = x[4];
+<a name="line964">964: </a>      y[idy+5]  = x[5];
+<a name="line965">965: </a>      x    += 6;
+<a name="line966">966: </a>    }
+<a name="line967">967: </a>    <font color="#4169E1">break</font>;
+<a name="line968">968: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line969">969: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line970">970: </a>      idy       = *indicesy++;
+<a name="line971">971: </a>      y[idy]    += x[0];
+<a name="line972">972: </a>      y[idy+1]  += x[1];
+<a name="line973">973: </a>      y[idy+2]  += x[2];
+<a name="line974">974: </a>      y[idy+3]  += x[3];
+<a name="line975">975: </a>      y[idy+4]  += x[4];
+<a name="line976">976: </a>      y[idy+5]  += x[5];
+<a name="line977">977: </a>      x    += 6;
+<a name="line978">978: </a>    }
+<a name="line979">979: </a>    <font color="#4169E1">break</font>;
+<a name="line980">980: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line981">981: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line982">982: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line983">983: </a>      idy       = *indicesy++;
+<a name="line984">984: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line985">985: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line986">986: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line987">987: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
+<a name="line988">988: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
+<a name="line989">989: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
+<a name="line990">990: </a>      x    += 6;
+<a name="line991">991: </a>    }
+<a name="line992">992: </a><font color="#A020F0">#else</font>
+<a name="line993">993: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line994">994: </a><font color="#A020F0">#endif</font>
+<a name="line995">995: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line996">996: </a>    <font color="#4169E1">break</font>;
+<a name="line997">997: </a>  }
+<a name="line998">998: </a>}
+
+<a name="line1000">1000: </a><strong><font color="#4169E1"><a name="Scatter_6"></a>PETSC_STATIC_INLINE void Scatter_6(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1001">1001: </a>{
+<a name="line1002">1002: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line1004">1004: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1005">1005: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1006">1006: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1007">1007: </a>      idx       = *indicesx++;
+<a name="line1008">1008: </a>      idy       = *indicesy++;
+<a name="line1009">1009: </a>      y[idy]    = x[idx];
+<a name="line1010">1010: </a>      y[idy+1]  = x[idx+1];
+<a name="line1011">1011: </a>      y[idy+2]  = x[idx+2];
+<a name="line1012">1012: </a>      y[idy+3]  = x[idx+3];
+<a name="line1013">1013: </a>      y[idy+4]  = x[idx+4];
+<a name="line1014">1014: </a>      y[idy+5]  = x[idx+5];
+<a name="line1015">1015: </a>    }
+<a name="line1016">1016: </a>    <font color="#4169E1">break</font>;
+<a name="line1017">1017: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1018">1018: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1019">1019: </a>      idx       = *indicesx++;
+<a name="line1020">1020: </a>      idy       = *indicesy++;
+<a name="line1021">1021: </a>      y[idy]    += x[idx];
+<a name="line1022">1022: </a>      y[idy+1]  += x[idx+1];
+<a name="line1023">1023: </a>      y[idy+2]  += x[idx+2];
+<a name="line1024">1024: </a>      y[idy+3]  += x[idx+3];
+<a name="line1025">1025: </a>      y[idy+4]  += x[idx+4];
+<a name="line1026">1026: </a>      y[idy+5]  += x[idx+5];
+<a name="line1027">1027: </a>    }
+<a name="line1028">1028: </a>    <font color="#4169E1">break</font>;
+<a name="line1029">1029: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1030">1030: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1031">1031: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1032">1032: </a>      idx       = *indicesx++;
+<a name="line1033">1033: </a>      idy       = *indicesy++;
+<a name="line1034">1034: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line1035">1035: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line1036">1036: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line1037">1037: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
+<a name="line1038">1038: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
+<a name="line1039">1039: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
+<a name="line1040">1040: </a>    }
+<a name="line1041">1041: </a><font color="#A020F0">#else</font>
+<a name="line1042">1042: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1043">1043: </a><font color="#A020F0">#endif</font>
+<a name="line1044">1044: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1045">1045: </a>    <font color="#4169E1">break</font>;
+<a name="line1046">1046: </a>  }
+<a name="line1047">1047: </a>}
+<a name="line1048">1048: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line1049">1049: </a><strong><font color="#4169E1"><a name="Pack_7"></a>PETSC_STATIC_INLINE void Pack_7(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line1050">1050: </a>{
+<a name="line1051">1051: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line1053">1053: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1054">1054: </a>    idx   = *indicesx++;
+<a name="line1055">1055: </a>    y[0]  = x[idx];
+<a name="line1056">1056: </a>    y[1]  = x[idx+1];
+<a name="line1057">1057: </a>    y[2]  = x[idx+2];
+<a name="line1058">1058: </a>    y[3]  = x[idx+3];
+<a name="line1059">1059: </a>    y[4]  = x[idx+4];
+<a name="line1060">1060: </a>    y[5]  = x[idx+5];
+<a name="line1061">1061: </a>    y[6]  = x[idx+6];
+<a name="line1062">1062: </a>    y    += 7;
+<a name="line1063">1063: </a>  }
+<a name="line1064">1064: </a>}
+<a name="line1065">1065: </a><strong><font color="#4169E1"><a name="UnPack_7"></a>PETSC_STATIC_INLINE void UnPack_7(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1066">1066: </a>{
+<a name="line1067">1067: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line1069">1069: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1070">1070: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1071">1071: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1072">1072: </a>      idy       = *indicesy++;
+<a name="line1073">1073: </a>      y[idy]    = x[0];
+<a name="line1074">1074: </a>      y[idy+1]  = x[1];
+<a name="line1075">1075: </a>      y[idy+2]  = x[2];
+<a name="line1076">1076: </a>      y[idy+3]  = x[3];
+<a name="line1077">1077: </a>      y[idy+4]  = x[4];
+<a name="line1078">1078: </a>      y[idy+5]  = x[5];
+<a name="line1079">1079: </a>      y[idy+6]  = x[6];
+<a name="line1080">1080: </a>      x    += 7;
+<a name="line1081">1081: </a>    }
+<a name="line1082">1082: </a>    <font color="#4169E1">break</font>;
+<a name="line1083">1083: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1084">1084: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1085">1085: </a>      idy       = *indicesy++;
+<a name="line1086">1086: </a>      y[idy]    += x[0];
+<a name="line1087">1087: </a>      y[idy+1]  += x[1];
+<a name="line1088">1088: </a>      y[idy+2]  += x[2];
+<a name="line1089">1089: </a>      y[idy+3]  += x[3];
+<a name="line1090">1090: </a>      y[idy+4]  += x[4];
+<a name="line1091">1091: </a>      y[idy+5]  += x[5];
+<a name="line1092">1092: </a>      y[idy+6]  += x[6];
+<a name="line1093">1093: </a>      x    += 7;
+<a name="line1094">1094: </a>    }
+<a name="line1095">1095: </a>    <font color="#4169E1">break</font>;
+<a name="line1096">1096: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1097">1097: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1098">1098: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1099">1099: </a>      idy       = *indicesy++;
+<a name="line1100">1100: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line1101">1101: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line1102">1102: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line1103">1103: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
+<a name="line1104">1104: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
+<a name="line1105">1105: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
+<a name="line1106">1106: </a>      y[idy+6]  = PetscMax(y[idy+6],x[6]);
+<a name="line1107">1107: </a>      x    += 7;
+<a name="line1108">1108: </a>    }
+<a name="line1109">1109: </a><font color="#A020F0">#else</font>
+<a name="line1110">1110: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1111">1111: </a><font color="#A020F0">#endif</font>
+<a name="line1112">1112: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1113">1113: </a>    <font color="#4169E1">break</font>;
+<a name="line1114">1114: </a>  }
+<a name="line1115">1115: </a>}
+
+<a name="line1117">1117: </a><strong><font color="#4169E1"><a name="Scatter_7"></a>PETSC_STATIC_INLINE void Scatter_7(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1118">1118: </a>{
+<a name="line1119">1119: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line1121">1121: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1122">1122: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1123">1123: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1124">1124: </a>      idx       = *indicesx++;
+<a name="line1125">1125: </a>      idy       = *indicesy++;
+<a name="line1126">1126: </a>      y[idy]    = x[idx];
+<a name="line1127">1127: </a>      y[idy+1]  = x[idx+1];
+<a name="line1128">1128: </a>      y[idy+2]  = x[idx+2];
+<a name="line1129">1129: </a>      y[idy+3]  = x[idx+3];
+<a name="line1130">1130: </a>      y[idy+4]  = x[idx+4];
+<a name="line1131">1131: </a>      y[idy+5]  = x[idx+5];
+<a name="line1132">1132: </a>      y[idy+6]  = x[idx+6];
+<a name="line1133">1133: </a>    }
+<a name="line1134">1134: </a>    <font color="#4169E1">break</font>;
+<a name="line1135">1135: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1136">1136: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1137">1137: </a>      idx       = *indicesx++;
+<a name="line1138">1138: </a>      idy       = *indicesy++;
+<a name="line1139">1139: </a>      y[idy]    += x[idx];
+<a name="line1140">1140: </a>      y[idy+1]  += x[idx+1];
+<a name="line1141">1141: </a>      y[idy+2]  += x[idx+2];
+<a name="line1142">1142: </a>      y[idy+3]  += x[idx+3];
+<a name="line1143">1143: </a>      y[idy+4]  += x[idx+4];
+<a name="line1144">1144: </a>      y[idy+5]  += x[idx+5];
+<a name="line1145">1145: </a>      y[idy+6]  += x[idx+6];
+<a name="line1146">1146: </a>    }
+<a name="line1147">1147: </a>    <font color="#4169E1">break</font>;
+<a name="line1148">1148: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1149">1149: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1150">1150: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1151">1151: </a>      idx       = *indicesx++;
+<a name="line1152">1152: </a>      idy       = *indicesy++;
+<a name="line1153">1153: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line1154">1154: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line1155">1155: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line1156">1156: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
+<a name="line1157">1157: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
+<a name="line1158">1158: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
+<a name="line1159">1159: </a>      y[idy+6]  = PetscMax(y[idy+6],x[idx+6]);
+<a name="line1160">1160: </a>    }
+<a name="line1161">1161: </a><font color="#A020F0">#else</font>
+<a name="line1162">1162: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1163">1163: </a><font color="#A020F0">#endif</font>
+<a name="line1164">1164: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1165">1165: </a>    <font color="#4169E1">break</font>;
+<a name="line1166">1166: </a>  }
+<a name="line1167">1167: </a>}
+<a name="line1168">1168: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line1169">1169: </a><strong><font color="#4169E1"><a name="Pack_8"></a>PETSC_STATIC_INLINE void Pack_8(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line1170">1170: </a>{
+<a name="line1171">1171: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line1173">1173: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1174">1174: </a>    idx   = *indicesx++;
+<a name="line1175">1175: </a>    y[0]  = x[idx];
+<a name="line1176">1176: </a>    y[1]  = x[idx+1];
+<a name="line1177">1177: </a>    y[2]  = x[idx+2];
+<a name="line1178">1178: </a>    y[3]  = x[idx+3];
+<a name="line1179">1179: </a>    y[4]  = x[idx+4];
+<a name="line1180">1180: </a>    y[5]  = x[idx+5];
+<a name="line1181">1181: </a>    y[6]  = x[idx+6];
+<a name="line1182">1182: </a>    y[7]  = x[idx+7];
+<a name="line1183">1183: </a>    y    += 8;
+<a name="line1184">1184: </a>  }
+<a name="line1185">1185: </a>}
+<a name="line1186">1186: </a><strong><font color="#4169E1"><a name="UnPack_8"></a>PETSC_STATIC_INLINE void UnPack_8(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1187">1187: </a>{
+<a name="line1188">1188: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line1190">1190: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1191">1191: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1192">1192: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1193">1193: </a>      idy       = *indicesy++;
+<a name="line1194">1194: </a>      y[idy]    = x[0];
+<a name="line1195">1195: </a>      y[idy+1]  = x[1];
+<a name="line1196">1196: </a>      y[idy+2]  = x[2];
+<a name="line1197">1197: </a>      y[idy+3]  = x[3];
+<a name="line1198">1198: </a>      y[idy+4]  = x[4];
+<a name="line1199">1199: </a>      y[idy+5]  = x[5];
+<a name="line1200">1200: </a>      y[idy+6]  = x[6];
+<a name="line1201">1201: </a>      y[idy+7]  = x[7];
+<a name="line1202">1202: </a>      x    += 8;
+<a name="line1203">1203: </a>    }
+<a name="line1204">1204: </a>    <font color="#4169E1">break</font>;
+<a name="line1205">1205: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1206">1206: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1207">1207: </a>      idy       = *indicesy++;
+<a name="line1208">1208: </a>      y[idy]    += x[0];
+<a name="line1209">1209: </a>      y[idy+1]  += x[1];
+<a name="line1210">1210: </a>      y[idy+2]  += x[2];
+<a name="line1211">1211: </a>      y[idy+3]  += x[3];
+<a name="line1212">1212: </a>      y[idy+4]  += x[4];
+<a name="line1213">1213: </a>      y[idy+5]  += x[5];
+<a name="line1214">1214: </a>      y[idy+6]  += x[6];
+<a name="line1215">1215: </a>      y[idy+7]  += x[7];
+<a name="line1216">1216: </a>      x    += 8;
+<a name="line1217">1217: </a>    }
+<a name="line1218">1218: </a>    <font color="#4169E1">break</font>;
+<a name="line1219">1219: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1220">1220: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1221">1221: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1222">1222: </a>      idy       = *indicesy++;
+<a name="line1223">1223: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line1224">1224: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line1225">1225: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line1226">1226: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
+<a name="line1227">1227: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
+<a name="line1228">1228: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
+<a name="line1229">1229: </a>      y[idy+6]  = PetscMax(y[idy+6],x[6]);
+<a name="line1230">1230: </a>      y[idy+7]  = PetscMax(y[idy+7],x[7]);
+<a name="line1231">1231: </a>      x    += 8;
+<a name="line1232">1232: </a>    }
+<a name="line1233">1233: </a><font color="#A020F0">#else</font>
+<a name="line1234">1234: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1235">1235: </a><font color="#A020F0">#endif</font>
+<a name="line1236">1236: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1237">1237: </a>    <font color="#4169E1">break</font>;
+<a name="line1238">1238: </a>  }
+<a name="line1239">1239: </a>}
+
+<a name="line1241">1241: </a><strong><font color="#4169E1"><a name="Scatter_8"></a>PETSC_STATIC_INLINE void Scatter_8(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1242">1242: </a>{
+<a name="line1243">1243: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line1245">1245: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1246">1246: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1247">1247: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1248">1248: </a>      idx       = *indicesx++;
+<a name="line1249">1249: </a>      idy       = *indicesy++;
+<a name="line1250">1250: </a>      y[idy]    = x[idx];
+<a name="line1251">1251: </a>      y[idy+1]  = x[idx+1];
+<a name="line1252">1252: </a>      y[idy+2]  = x[idx+2];
+<a name="line1253">1253: </a>      y[idy+3]  = x[idx+3];
+<a name="line1254">1254: </a>      y[idy+4]  = x[idx+4];
+<a name="line1255">1255: </a>      y[idy+5]  = x[idx+5];
+<a name="line1256">1256: </a>      y[idy+6]  = x[idx+6];
+<a name="line1257">1257: </a>      y[idy+7]  = x[idx+7];
+<a name="line1258">1258: </a>    }
+<a name="line1259">1259: </a>    <font color="#4169E1">break</font>;
+<a name="line1260">1260: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1261">1261: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1262">1262: </a>      idx       = *indicesx++;
+<a name="line1263">1263: </a>      idy       = *indicesy++;
+<a name="line1264">1264: </a>      y[idy]    += x[idx];
+<a name="line1265">1265: </a>      y[idy+1]  += x[idx+1];
+<a name="line1266">1266: </a>      y[idy+2]  += x[idx+2];
+<a name="line1267">1267: </a>      y[idy+3]  += x[idx+3];
+<a name="line1268">1268: </a>      y[idy+4]  += x[idx+4];
+<a name="line1269">1269: </a>      y[idy+5]  += x[idx+5];
+<a name="line1270">1270: </a>      y[idy+6]  += x[idx+6];
+<a name="line1271">1271: </a>      y[idy+7]  += x[idx+7];
+<a name="line1272">1272: </a>    }
+<a name="line1273">1273: </a>    <font color="#4169E1">break</font>;
+<a name="line1274">1274: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1275">1275: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1276">1276: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1277">1277: </a>      idx       = *indicesx++;
+<a name="line1278">1278: </a>      idy       = *indicesy++;
+<a name="line1279">1279: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line1280">1280: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line1281">1281: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line1282">1282: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
+<a name="line1283">1283: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
+<a name="line1284">1284: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
+<a name="line1285">1285: </a>      y[idy+6]  = PetscMax(y[idy+6],x[idx+6]);
+<a name="line1286">1286: </a>      y[idy+7]  = PetscMax(y[idy+7],x[idx+7]);
+<a name="line1287">1287: </a>    }
+<a name="line1288">1288: </a><font color="#A020F0">#else</font>
+<a name="line1289">1289: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1290">1290: </a><font color="#A020F0">#endif</font>
+<a name="line1291">1291: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1292">1292: </a>    <font color="#4169E1">break</font>;
+<a name="line1293">1293: </a>  }
+<a name="line1294">1294: </a>}
+
+<a name="line1296">1296: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
+<a name="line1297">1297: </a><strong><font color="#4169E1"><a name="Pack_12"></a>PETSC_STATIC_INLINE void Pack_12(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
+<a name="line1298">1298: </a>{
+<a name="line1299">1299: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
+
+<a name="line1301">1301: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1302">1302: </a>    idx   = *indicesx++;
+<a name="line1303">1303: </a>    y[0]  = x[idx];
+<a name="line1304">1304: </a>    y[1]  = x[idx+1];
+<a name="line1305">1305: </a>    y[2]  = x[idx+2];
+<a name="line1306">1306: </a>    y[3]  = x[idx+3];
+<a name="line1307">1307: </a>    y[4]  = x[idx+4];
+<a name="line1308">1308: </a>    y[5]  = x[idx+5];
+<a name="line1309">1309: </a>    y[6]  = x[idx+6];
+<a name="line1310">1310: </a>    y[7]  = x[idx+7];
+<a name="line1311">1311: </a>    y[8]  = x[idx+8];
+<a name="line1312">1312: </a>    y[9]  = x[idx+9];
+<a name="line1313">1313: </a>    y[10] = x[idx+10];
+<a name="line1314">1314: </a>    y[11] = x[idx+11];
+<a name="line1315">1315: </a>    y    += 12;
+<a name="line1316">1316: </a>  }
+<a name="line1317">1317: </a>}
+<a name="line1318">1318: </a><strong><font color="#4169E1"><a name="UnPack_12"></a>PETSC_STATIC_INLINE void UnPack_12(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1319">1319: </a>{
+<a name="line1320">1320: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
+
+<a name="line1322">1322: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1323">1323: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1324">1324: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1325">1325: </a>      idy       = *indicesy++;
+<a name="line1326">1326: </a>      y[idy]    = x[0];
+<a name="line1327">1327: </a>      y[idy+1]  = x[1];
+<a name="line1328">1328: </a>      y[idy+2]  = x[2];
+<a name="line1329">1329: </a>      y[idy+3]  = x[3];
+<a name="line1330">1330: </a>      y[idy+4]  = x[4];
+<a name="line1331">1331: </a>      y[idy+5]  = x[5];
+<a name="line1332">1332: </a>      y[idy+6]  = x[6];
+<a name="line1333">1333: </a>      y[idy+7]  = x[7];
+<a name="line1334">1334: </a>      y[idy+8]  = x[8];
+<a name="line1335">1335: </a>      y[idy+9]  = x[9];
+<a name="line1336">1336: </a>      y[idy+10] = x[10];
+<a name="line1337">1337: </a>      y[idy+11] = x[11];
+<a name="line1338">1338: </a>      x    += 12;
+<a name="line1339">1339: </a>    }
+<a name="line1340">1340: </a>    <font color="#4169E1">break</font>;
+<a name="line1341">1341: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1342">1342: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1343">1343: </a>      idy       = *indicesy++;
+<a name="line1344">1344: </a>      y[idy]    += x[0];
+<a name="line1345">1345: </a>      y[idy+1]  += x[1];
+<a name="line1346">1346: </a>      y[idy+2]  += x[2];
+<a name="line1347">1347: </a>      y[idy+3]  += x[3];
+<a name="line1348">1348: </a>      y[idy+4]  += x[4];
+<a name="line1349">1349: </a>      y[idy+5]  += x[5];
+<a name="line1350">1350: </a>      y[idy+6]  += x[6];
+<a name="line1351">1351: </a>      y[idy+7]  += x[7];
+<a name="line1352">1352: </a>      y[idy+8]  += x[8];
+<a name="line1353">1353: </a>      y[idy+9]  += x[9];
+<a name="line1354">1354: </a>      y[idy+10] += x[10];
+<a name="line1355">1355: </a>      y[idy+11] += x[11];
+<a name="line1356">1356: </a>      x    += 12;
+<a name="line1357">1357: </a>    }
+<a name="line1358">1358: </a>    <font color="#4169E1">break</font>;
+<a name="line1359">1359: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1360">1360: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1361">1361: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1362">1362: </a>      idy       = *indicesy++;
+<a name="line1363">1363: </a>      y[idy]    = PetscMax(y[idy],x[0]);
+<a name="line1364">1364: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
+<a name="line1365">1365: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
+<a name="line1366">1366: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
+<a name="line1367">1367: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
+<a name="line1368">1368: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
+<a name="line1369">1369: </a>      y[idy+6]  = PetscMax(y[idy+6],x[6]);
+<a name="line1370">1370: </a>      y[idy+7]  = PetscMax(y[idy+7],x[7]);
+<a name="line1371">1371: </a>      y[idy+8]  = PetscMax(y[idy+8],x[8]);
+<a name="line1372">1372: </a>      y[idy+9]  = PetscMax(y[idy+9],x[9]);
+<a name="line1373">1373: </a>      y[idy+10] = PetscMax(y[idy+10],x[10]);
+<a name="line1374">1374: </a>      y[idy+11] = PetscMax(y[idy+11],x[11]);
+<a name="line1375">1375: </a>      x    += 12;
+<a name="line1376">1376: </a>    }
+<a name="line1377">1377: </a><font color="#A020F0">#else</font>
+<a name="line1378">1378: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1379">1379: </a><font color="#A020F0">#endif</font>
+<a name="line1380">1380: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1381">1381: </a>    <font color="#4169E1">break</font>;
+<a name="line1382">1382: </a>  }
+<a name="line1383">1383: </a>}
+
+<a name="line1385">1385: </a><strong><font color="#4169E1"><a name="Scatter_12"></a>PETSC_STATIC_INLINE void Scatter_12(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
+<a name="line1386">1386: </a>{
+<a name="line1387">1387: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
+
+<a name="line1389">1389: </a>  <font color="#4169E1">switch</font> (addv) {
+<a name="line1390">1390: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
+<a name="line1391">1391: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1392">1392: </a>      idx       = *indicesx++;
+<a name="line1393">1393: </a>      idy       = *indicesy++;
+<a name="line1394">1394: </a>      y[idy]    = x[idx];
+<a name="line1395">1395: </a>      y[idy+1]  = x[idx+1];
+<a name="line1396">1396: </a>      y[idy+2]  = x[idx+2];
+<a name="line1397">1397: </a>      y[idy+3]  = x[idx+3];
+<a name="line1398">1398: </a>      y[idy+4]  = x[idx+4];
+<a name="line1399">1399: </a>      y[idy+5]  = x[idx+5];
+<a name="line1400">1400: </a>      y[idy+6]  = x[idx+6];
+<a name="line1401">1401: </a>      y[idy+7]  = x[idx+7];
+<a name="line1402">1402: </a>      y[idy+8]  = x[idx+8];
+<a name="line1403">1403: </a>      y[idy+9]  = x[idx+9];
+<a name="line1404">1404: </a>      y[idy+10] = x[idx+10];
+<a name="line1405">1405: </a>      y[idy+11] = x[idx+11];
+<a name="line1406">1406: </a>    }
+<a name="line1407">1407: </a>    <font color="#4169E1">break</font>;
+<a name="line1408">1408: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
+<a name="line1409">1409: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1410">1410: </a>      idx       = *indicesx++;
+<a name="line1411">1411: </a>      idy       = *indicesy++;
+<a name="line1412">1412: </a>      y[idy]    += x[idx];
+<a name="line1413">1413: </a>      y[idy+1]  += x[idx+1];
+<a name="line1414">1414: </a>      y[idy+2]  += x[idx+2];
+<a name="line1415">1415: </a>      y[idy+3]  += x[idx+3];
+<a name="line1416">1416: </a>      y[idy+4]  += x[idx+4];
+<a name="line1417">1417: </a>      y[idy+5]  += x[idx+5];
+<a name="line1418">1418: </a>      y[idy+6]  += x[idx+6];
+<a name="line1419">1419: </a>      y[idy+7]  += x[idx+7];
+<a name="line1420">1420: </a>      y[idy+8]  += x[idx+8];
+<a name="line1421">1421: </a>      y[idy+9]  += x[idx+9];
+<a name="line1422">1422: </a>      y[idy+10] += x[idx+10];
+<a name="line1423">1423: </a>      y[idy+11] += x[idx+11];
+<a name="line1424">1424: </a>    }
+<a name="line1425">1425: </a>    <font color="#4169E1">break</font>;
+<a name="line1426">1426: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
+<a name="line1427">1427: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1428">1428: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
+<a name="line1429">1429: </a>      idx       = *indicesx++;
+<a name="line1430">1430: </a>      idy       = *indicesy++;
+<a name="line1431">1431: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
+<a name="line1432">1432: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
+<a name="line1433">1433: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
+<a name="line1434">1434: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
+<a name="line1435">1435: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
+<a name="line1436">1436: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
+<a name="line1437">1437: </a>      y[idy+6]  = PetscMax(y[idy+6],x[idx+6]);
+<a name="line1438">1438: </a>      y[idy+7]  = PetscMax(y[idy+7],x[idx+7]);
+<a name="line1439">1439: </a>      y[idy+8]  = PetscMax(y[idy+8],x[idx+8]);
+<a name="line1440">1440: </a>      y[idy+9]  = PetscMax(y[idy+9],x[idx+9]);
+<a name="line1441">1441: </a>      y[idy+10] = PetscMax(y[idy+10],x[idx+10]);
+<a name="line1442">1442: </a>      y[idy+11] = PetscMax(y[idy+11],x[idx+11]);
+<a name="line1443">1443: </a>    }
+<a name="line1444">1444: </a><font color="#A020F0">#else</font>
+<a name="line1445">1445: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
+<a name="line1446">1446: </a><font color="#A020F0">#endif</font>
+<a name="line1447">1447: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
+<a name="line1448">1448: </a>    <font color="#4169E1">break</font>;
+<a name="line1449">1449: </a>  }
+<a name="line1450">1450: </a>}
 
-<a name="line160">160: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_ALLTOALLW) &amp;&amp; !defined(PETSC_USE_64BIT_INDICES)</font>
-<a name="line161">161: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallw) {
-<a name="line162">162: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(to-&gt;wcounts,to-&gt;wdispls,to-&gt;types);
-<a name="line163">163: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(from-&gt;wcounts,from-&gt;wdispls,from-&gt;types);
-<a name="line164">164: </a>  }
-<a name="line165">165: </a><font color="#A020F0">#endif</font>
-
-<a name="line167">167: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_WIN_CREATE)</font>
-<a name="line168">168: </a>  <font color="#4169E1">if</font> (to-&gt;use_window) {
-<a name="line169">169: </a>    MPI_Win_free(&amp;from-&gt;window);
-<a name="line170">170: </a>    MPI_Win_free(&amp;to-&gt;window);
-<a name="line171">171: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;winstarts);
-<a name="line172">172: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;winstarts);
-<a name="line173">173: </a>  }
-<a name="line174">174: </a><font color="#A020F0">#endif</font>
-
-<a name="line176">176: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallv) {
-<a name="line177">177: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(to-&gt;counts,to-&gt;displs);
-<a name="line178">178: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(from-&gt;counts,from-&gt;displs);
-<a name="line179">179: </a>  }
-
-<a name="line181">181: </a>  <font color="#B22222">/* release MPI resources obtained with <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>() and <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>() */</font>
-<a name="line182">182: </a>  <font color="#B22222">/* </font>
-<a name="line183">183: </a><font color="#B22222">     IBM's PE version of MPI has a bug where freeing these guys will screw up later</font>
-<a name="line184">184: </a><font color="#B22222">     message passing.</font>
-<a name="line185">185: </a><font color="#B22222">  */</font>
-<a name="line186">186: </a><font color="#A020F0">#if !defined(PETSC_HAVE_BROKEN_REQUEST_FREE)</font>
-<a name="line187">187: </a>  <font color="#4169E1">if</font> (!to-&gt;use_alltoallv &amp;&amp; !to-&gt;use_window) {   <font color="#B22222">/* currently the to-&gt;requests etc are ALWAYS allocated even if not used */</font>
-<a name="line188">188: </a>    <font color="#4169E1">if</font> (to-&gt;requests) {
-<a name="line189">189: </a>      <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line190">190: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(to-&gt;requests + i);
-<a name="line191">191: </a>      }
-<a name="line192">192: </a>    }
-<a name="line193">193: </a>    <font color="#4169E1">if</font> (to-&gt;rev_requests) {
-<a name="line194">194: </a>      <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line195">195: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(to-&gt;rev_requests + i);
-<a name="line196">196: </a>      }
-<a name="line197">197: </a>    }
-<a name="line198">198: </a>  }
-<a name="line199">199: </a>  <font color="#B22222">/*</font>
-<a name="line200">200: </a><font color="#B22222">      MPICH could not properly cancel requests thus with ready receiver mode we</font>
-<a name="line201">201: </a><font color="#B22222">    cannot free the requests. It may be fixed now, if not then put the following </font>
-<a name="line202">202: </a><font color="#B22222">    code inside a if !to-&gt;use_readyreceiver) {</font>
-<a name="line203">203: </a><font color="#B22222">  */</font>
-<a name="line204">204: </a>  <font color="#4169E1">if</font> (!to-&gt;use_alltoallv &amp;&amp; !to-&gt;use_window) {    <font color="#B22222">/* currently the from-&gt;requests etc are ALWAYS allocated even if not used */</font>
-<a name="line205">205: </a>    <font color="#4169E1">if</font> (from-&gt;requests) {
-<a name="line206">206: </a>      <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line207">207: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(from-&gt;requests + i);
-<a name="line208">208: </a>      }
-<a name="line209">209: </a>    }
-
-<a name="line211">211: </a>    <font color="#4169E1">if</font> (from-&gt;rev_requests) {
-<a name="line212">212: </a>      <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line213">213: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Request_free.html#MPI_Request_free">MPI_Request_free</A>(from-&gt;rev_requests + i);
-<a name="line214">214: </a>      }
-<a name="line215">215: </a>    }
-<a name="line216">216: </a>  }
-<a name="line217">217: </a><font color="#A020F0">#endif</font>
-
-<a name="line219">219: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;local.vslots);
-<a name="line220">220: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;local.vslots);
-<a name="line221">221: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(to-&gt;counts,to-&gt;displs);
-<a name="line222">222: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(from-&gt;counts,from-&gt;displs);
-<a name="line223">223: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;local.slots_nonmatching);
-<a name="line224">224: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;local.slots_nonmatching);
-<a name="line225">225: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;rev_requests);
-<a name="line226">226: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;rev_requests);
-<a name="line227">227: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to-&gt;requests);
-<a name="line228">228: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from-&gt;requests);
-<a name="line229">229: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree4.html#PetscFree4">PetscFree4</A>(to-&gt;values,to-&gt;indices,to-&gt;starts,to-&gt;procs);
-<a name="line230">230: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(to-&gt;sstatus,to-&gt;rstatus);
-<a name="line231">231: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree4.html#PetscFree4">PetscFree4</A>(from-&gt;values,from-&gt;indices,from-&gt;starts,from-&gt;procs);
-<a name="line232">232: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(from);
-<a name="line233">233: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(to);
-<a name="line234">234: </a>  <A href="../../../../docs/manualpages/Sys/PetscHeaderDestroy.html#PetscHeaderDestroy">PetscHeaderDestroy</A>(ctx);
-<a name="line235">235: </a>  <font color="#4169E1">return</font>(0);
-<a name="line236">236: </a>}
-
-
-
-<a name="line240">240: </a><font color="#B22222">/* --------------------------------------------------------------------------------------*/</font>
-<a name="line241">241: </a><font color="#B22222">/*</font>
-<a name="line242">242: </a><font color="#B22222">    Special optimization to see if the local part of the scatter is actually </font>
-<a name="line243">243: </a><font color="#B22222">    a copy. The scatter routines call <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>() instead.</font>
-<a name="line244">244: </a><font color="#B22222"> </font>
-<a name="line245">245: </a><font color="#B22222">*/</font>
-<a name="line248">248: </a><strong><font color="#4169E1"><a name="VecScatterLocalOptimizeCopy_Private"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterLocalOptimizeCopy_Private(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> scatter,VecScatter_Seq_General *to,VecScatter_Seq_General *from,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs)</font></strong>
-<a name="line249">249: </a>{
-<a name="line250">250: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       n = to-&gt;n,i,*to_slots = to-&gt;vslots,*from_slots = from-&gt;vslots;
-<a name="line251">251: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       to_start,from_start;
-
-<a name="line255">255: </a>  to_start   = to_slots[0];
-<a name="line256">256: </a>  from_start = from_slots[0];
-
-<a name="line258">258: </a>  <font color="#4169E1">for</font> (i=1; i&lt;n; i++) {
-<a name="line259">259: </a>    to_start   += bs;
-<a name="line260">260: </a>    from_start += bs;
-<a name="line261">261: </a>    <font color="#4169E1">if</font> (to_slots[i]   != to_start)   <font color="#4169E1">return</font>(0);
-<a name="line262">262: </a>    <font color="#4169E1">if</font> (from_slots[i] != from_start) <font color="#4169E1">return</font>(0);
-<a name="line263">263: </a>  }
-<a name="line264">264: </a>  to-&gt;is_copy       = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line265">265: </a>  to-&gt;copy_start    = to_slots[0];
-<a name="line266">266: </a>  to-&gt;copy_length   = bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*n;
-<a name="line267">267: </a>  from-&gt;is_copy     = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line268">268: </a>  from-&gt;copy_start  = from_slots[0];
-<a name="line269">269: </a>  from-&gt;copy_length = bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*n;
-<a name="line270">270: </a>  <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(scatter,<font color="#666666">"Local scatter is a copy, optimizing for it\n"</font>);
-<a name="line271">271: </a>  <font color="#4169E1">return</font>(0);
-<a name="line272">272: </a>}
-
-<a name="line274">274: </a><font color="#B22222">/* --------------------------------------------------------------------------------------*/</font>
-
-<a name="line278">278: </a><strong><font color="#4169E1"><a name="VecScatterCopy_PtoP_X"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCopy_PtoP_X(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> in,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> out)</font></strong>
-<a name="line279">279: </a>{
-<a name="line280">280: </a>  VecScatter_MPI_General *in_to   = (VecScatter_MPI_General*)in-&gt;todata;
-<a name="line281">281: </a>  VecScatter_MPI_General *in_from = (VecScatter_MPI_General*)in-&gt;fromdata,*out_to,*out_from;
-<a name="line282">282: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
-<a name="line283">283: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               ny,bs = in_from-&gt;bs;
-
-<a name="line286">286: </a>  out-&gt;begin     = in-&gt;begin;
-<a name="line287">287: </a>  out-&gt;end       = in-&gt;end;
-<a name="line288">288: </a>  out-&gt;copy      = in-&gt;copy;
-<a name="line289">289: </a>  out-&gt;destroy   = in-&gt;destroy;
-<a name="line290">290: </a>  out-&gt;view      = in-&gt;view;
-
-<a name="line292">292: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
-<a name="line293">293: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_to);
-<a name="line294">294: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_from);
-
-<a name="line296">296: </a>  ny                = in_to-&gt;starts[in_to-&gt;n];
-<a name="line297">297: </a>  out_to-&gt;n         = in_to-&gt;n;
-<a name="line298">298: </a>  out_to-&gt;type      = in_to-&gt;type;
-<a name="line299">299: </a>  out_to-&gt;sendfirst = in_to-&gt;sendfirst;
-
-<a name="line301">301: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_to-&gt;requests);
-<a name="line302">302: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*ny,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_to-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;indices,out_to-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;starts,out_to-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;procs);
-<a name="line303">303: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;sstatus,PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;rstatus);
-<a name="line304">304: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;indices,in_to-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line305">305: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;starts,in_to-&gt;starts,(out_to-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line306">306: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;procs,in_to-&gt;procs,(out_to-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line307">307: </a>
-<a name="line308">308: </a>  out-&gt;todata       = (void*)out_to;
-<a name="line309">309: </a>  out_to-&gt;local.n   = in_to-&gt;local.n;
-<a name="line310">310: </a>  out_to-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line311">311: </a>  out_to-&gt;local.n_nonmatching        = 0;
-<a name="line312">312: </a>  out_to-&gt;local.slots_nonmatching    = 0;
-<a name="line313">313: </a>  <font color="#4169E1">if</font> (in_to-&gt;local.n) {
-<a name="line314">314: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_to-&gt;local.vslots);
-<a name="line315">315: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_from-&gt;local.vslots);
-<a name="line316">316: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;local.vslots,in_to-&gt;local.vslots,in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line317">317: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;local.vslots,in_from-&gt;local.vslots,in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line318">318: </a>  } <font color="#4169E1">else</font> {
-<a name="line319">319: </a>    out_to-&gt;local.vslots   = 0;
-<a name="line320">320: </a>    out_from-&gt;local.vslots = 0;
-<a name="line321">321: </a>  }
-
-<a name="line323">323: </a>  <font color="#B22222">/* allocate entire receive context */</font>
-<a name="line324">324: </a>  out_from-&gt;type      = in_from-&gt;type;
-<a name="line325">325: </a>  ny                  = in_from-&gt;starts[in_from-&gt;n];
-<a name="line326">326: </a>  out_from-&gt;n         = in_from-&gt;n;
-<a name="line327">327: </a>  out_from-&gt;sendfirst = in_from-&gt;sendfirst;
-
-<a name="line329">329: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_from-&gt;requests);
-<a name="line330">330: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(ny*bs,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_from-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;indices,out_from-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;starts,out_from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;procs);
-<a name="line331">331: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;indices,in_from-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line332">332: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;starts,in_from-&gt;starts,(out_from-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line333">333: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;procs,in_from-&gt;procs,(out_from-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line334">334: </a>  out-&gt;fromdata       = (void*)out_from;
-<a name="line335">335: </a>  out_from-&gt;local.n   = in_from-&gt;local.n;
-<a name="line336">336: </a>  out_from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line337">337: </a>  out_from-&gt;local.n_nonmatching        = 0;
-<a name="line338">338: </a>  out_from-&gt;local.slots_nonmatching    = 0;
-
-<a name="line340">340: </a>  <font color="#B22222">/* </font>
-<a name="line341">341: </a><font color="#B22222">      set up the request arrays for use with isend_init() and irecv_init()</font>
-<a name="line342">342: </a><font color="#B22222">  */</font>
-<a name="line343">343: </a>  {
-<a name="line344">344: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> tag;
-<a name="line345">345: </a>    <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>    comm;
-<a name="line346">346: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    *sstarts = out_to-&gt;starts,  *rstarts = out_from-&gt;starts;
-<a name="line347">347: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> *sprocs  = out_to-&gt;procs,   *rprocs  = out_from-&gt;procs;
-<a name="line348">348: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    i;
-<a name="line349">349: </a>    <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>  flg;
-<a name="line350">350: </a>    MPI_Request *swaits  = out_to-&gt;requests,*rwaits  = out_from-&gt;requests;
-<a name="line351">351: </a>    MPI_Request *rev_swaits,*rev_rwaits;
-<a name="line352">352: </a>    <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *Ssvalues = out_to-&gt;values, *Srvalues = out_from-&gt;values;
-
-<a name="line354">354: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_to-&gt;rev_requests);
-<a name="line355">355: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_from-&gt;rev_requests);
-
-<a name="line357">357: </a>    rev_rwaits = out_to-&gt;rev_requests;
-<a name="line358">358: </a>    rev_swaits = out_from-&gt;rev_requests;
-
-<a name="line360">360: </a>    out_from-&gt;bs = out_to-&gt;bs = bs;
-<a name="line361">361: </a>    tag     = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)out)-&gt;tag;
-<a name="line362">362: </a>    comm    = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)out)-&gt;comm;
-
-<a name="line364">364: </a>    <font color="#B22222">/* Register the receives that you will use later (sends for scatter reverse) */</font>
-<a name="line365">365: </a>    <font color="#4169E1">for</font> (i=0; i&lt;out_from-&gt;n; i++) {
-<a name="line366">366: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tag,comm,rwaits+i);
-<a name="line367">367: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tag,comm,rev_swaits+i);
-<a name="line368">368: </a>    }
-
-<a name="line370">370: </a>    flg  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line371">371: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_rsend"</font>,&amp;flg,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line372">372: </a>    <font color="#4169E1">if</font> (flg) {
-<a name="line373">373: </a>      out_to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line374">374: </a>      out_from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line375">375: </a>      <font color="#4169E1">for</font> (i=0; i&lt;out_to-&gt;n; i++) {
-<a name="line376">376: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Rsend_init.html#MPI_Rsend_init">MPI_Rsend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
-<a name="line377">377: </a>      }
-<a name="line378">378: </a>      <font color="#4169E1">if</font> (out_from-&gt;n) {MPI_Startall_irecv(out_from-&gt;starts[out_from-&gt;n]*out_from-&gt;bs,out_from-&gt;n,out_from-&gt;requests);}
-<a name="line379">379: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Barrier.html#MPI_Barrier">MPI_Barrier</A>(comm);
-<a name="line380">380: </a>      <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(in,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ready receiver mode\n"</font>);
-<a name="line381">381: </a>    } <font color="#4169E1">else</font> {
-<a name="line382">382: </a>      out_to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line383">383: </a>      out_from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line384">384: </a>      flg                          = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line385">385: </a>      <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_ssend"</font>,&amp;flg,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line386">386: </a>      <font color="#4169E1">if</font> (flg) {
-<a name="line387">387: </a>        <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(in,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> Ssend mode\n"</font>);
-<a name="line388">388: </a>      }
-<a name="line389">389: </a>      <font color="#4169E1">for</font> (i=0; i&lt;out_to-&gt;n; i++) {
-<a name="line390">390: </a>        <font color="#4169E1">if</font> (!flg) {
-<a name="line391">391: </a>          <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
-<a name="line392">392: </a>        } <font color="#4169E1">else</font> {
-<a name="line393">393: </a>          <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Ssend_init.html#MPI_Ssend_init">MPI_Ssend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
-<a name="line394">394: </a>        }
-<a name="line395">395: </a>      }
-<a name="line396">396: </a>    }
-<a name="line397">397: </a>    <font color="#B22222">/* Register receives for scatter reverse */</font>
-<a name="line398">398: </a>    <font color="#4169E1">for</font> (i=0; i&lt;out_to-&gt;n; i++) {
-<a name="line399">399: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,rev_rwaits+i);
-<a name="line400">400: </a>    }
-<a name="line401">401: </a>  }
-
-<a name="line403">403: </a>  <font color="#4169E1">return</font>(0);
-<a name="line404">404: </a>}
-
-<a name="line408">408: </a><strong><font color="#4169E1"><a name="VecScatterCopy_PtoP_AllToAll"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCopy_PtoP_AllToAll(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> in,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> out)</font></strong>
-<a name="line409">409: </a>{
-<a name="line410">410: </a>  VecScatter_MPI_General *in_to   = (VecScatter_MPI_General*)in-&gt;todata;
-<a name="line411">411: </a>  VecScatter_MPI_General *in_from = (VecScatter_MPI_General*)in-&gt;fromdata,*out_to,*out_from;
-<a name="line412">412: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
-<a name="line413">413: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               ny,bs = in_from-&gt;bs;
-<a name="line414">414: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            size;
-
-<a name="line417">417: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)in)-&gt;comm,&amp;size);
-<a name="line418">418: </a>  out-&gt;begin     = in-&gt;begin;
-<a name="line419">419: </a>  out-&gt;end       = in-&gt;end;
-<a name="line420">420: </a>  out-&gt;copy      = in-&gt;copy;
-<a name="line421">421: </a>  out-&gt;destroy   = in-&gt;destroy;
-<a name="line422">422: </a>  out-&gt;view      = in-&gt;view;
-
-<a name="line424">424: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
-<a name="line425">425: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_to);
-<a name="line426">426: </a>  PetscNewLog(out,VecScatter_MPI_General,&amp;out_from);
-
-<a name="line428">428: </a>  ny                = in_to-&gt;starts[in_to-&gt;n];
-<a name="line429">429: </a>  out_to-&gt;n         = in_to-&gt;n;
-<a name="line430">430: </a>  out_to-&gt;type      = in_to-&gt;type;
-<a name="line431">431: </a>  out_to-&gt;sendfirst = in_to-&gt;sendfirst;
-
-<a name="line433">433: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_to-&gt;requests);
-<a name="line434">434: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*ny,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_to-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;indices,out_to-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_to-&gt;starts,out_to-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;procs);
-<a name="line435">435: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;sstatus,PetscMax(in_to-&gt;n,in_from-&gt;n),MPI_Status,&amp;out_to-&gt;rstatus);
-<a name="line436">436: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;indices,in_to-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line437">437: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;starts,in_to-&gt;starts,(out_to-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line438">438: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;procs,in_to-&gt;procs,(out_to-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line439">439: </a>
-<a name="line440">440: </a>  out-&gt;todata       = (void*)out_to;
-<a name="line441">441: </a>  out_to-&gt;local.n   = in_to-&gt;local.n;
-<a name="line442">442: </a>  out_to-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line443">443: </a>  out_to-&gt;local.n_nonmatching        = 0;
-<a name="line444">444: </a>  out_to-&gt;local.slots_nonmatching    = 0;
-<a name="line445">445: </a>  <font color="#4169E1">if</font> (in_to-&gt;local.n) {
-<a name="line446">446: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_to-&gt;local.vslots);
-<a name="line447">447: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;out_from-&gt;local.vslots);
-<a name="line448">448: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;local.vslots,in_to-&gt;local.vslots,in_to-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line449">449: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;local.vslots,in_from-&gt;local.vslots,in_from-&gt;local.n*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line450">450: </a>  } <font color="#4169E1">else</font> {
-<a name="line451">451: </a>    out_to-&gt;local.vslots   = 0;
-<a name="line452">452: </a>    out_from-&gt;local.vslots = 0;
-<a name="line453">453: </a>  }
-
-<a name="line455">455: </a>  <font color="#B22222">/* allocate entire receive context */</font>
-<a name="line456">456: </a>  out_from-&gt;type      = in_from-&gt;type;
-<a name="line457">457: </a>  ny                  = in_from-&gt;starts[in_from-&gt;n];
-<a name="line458">458: </a>  out_from-&gt;n         = in_from-&gt;n;
-<a name="line459">459: </a>  out_from-&gt;sendfirst = in_from-&gt;sendfirst;
-
-<a name="line461">461: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(out_from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;out_from-&gt;requests);
-<a name="line462">462: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(ny*bs,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;out_from-&gt;values,ny,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;indices,out_from-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;out_from-&gt;starts,out_from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;procs);
-<a name="line463">463: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;indices,in_from-&gt;indices,ny*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line464">464: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;starts,in_from-&gt;starts,(out_from-&gt;n+1)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>));
-<a name="line465">465: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;procs,in_from-&gt;procs,(out_from-&gt;n)*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line466">466: </a>  out-&gt;fromdata       = (void*)out_from;
-<a name="line467">467: </a>  out_from-&gt;local.n   = in_from-&gt;local.n;
-<a name="line468">468: </a>  out_from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line469">469: </a>  out_from-&gt;local.n_nonmatching        = 0;
-<a name="line470">470: </a>  out_from-&gt;local.slots_nonmatching    = 0;
-
-<a name="line472">472: </a>  out_to-&gt;use_alltoallv = out_from-&gt;use_alltoallv = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-
-<a name="line474">474: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_to-&gt;displs);
-<a name="line475">475: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;counts,in_to-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line476">476: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_to-&gt;displs,in_to-&gt;displs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-
-<a name="line478">478: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;out_from-&gt;displs);
-<a name="line479">479: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;counts,in_from-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line480">480: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemcpy.html#PetscMemcpy">PetscMemcpy</A>(out_from-&gt;displs,in_from-&gt;displs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line481">481: </a>  <font color="#4169E1">return</font>(0);
-<a name="line482">482: </a>}
-<a name="line483">483: </a><font color="#B22222">/* --------------------------------------------------------------------------------------------------</font>
-<a name="line484">484: </a><font color="#B22222">    Packs and unpacks the message data into send or from receive buffers. </font>
-
-<a name="line486">486: </a><font color="#B22222">    These could be generated automatically. </font>
-
-<a name="line488">488: </a><font color="#B22222">    Fortran kernels etc. could be used.</font>
-<a name="line489">489: </a><font color="#B22222">*/</font>
-<a name="line490">490: </a><strong><font color="#4169E1"><a name="Pack_1"></a>PETSC_STATIC_INLINE void Pack_1(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line491">491: </a>{
-<a name="line492">492: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
-<a name="line493">493: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line494">494: </a>    y[i]  = x[indicesx[i]];
-<a name="line495">495: </a>  }
-<a name="line496">496: </a>}
-<a name="line497">497: </a><strong><font color="#4169E1"><a name="UnPack_1"></a>PETSC_STATIC_INLINE void UnPack_1(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line498">498: </a>{
-<a name="line499">499: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
-<a name="line500">500: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line501">501: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line502">502: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line503">503: </a>      y[indicesy[i]] = x[i];
-<a name="line504">504: </a>    }
-<a name="line505">505: </a>    <font color="#4169E1">break</font>;
-<a name="line506">506: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line507">507: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line508">508: </a>      y[indicesy[i]] += x[i];
-<a name="line509">509: </a>    }
-<a name="line510">510: </a>    <font color="#4169E1">break</font>;
-<a name="line511">511: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line512">512: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line513">513: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line514">514: </a>      y[indicesy[i]] = PetscMax(y[indicesy[i]],x[i]);
-<a name="line515">515: </a>    }
-<a name="line516">516: </a><font color="#A020F0">#else</font>
-<a name="line517">517: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line518">518: </a><font color="#A020F0">#endif</font>
-<a name="line519">519: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line520">520: </a>    <font color="#4169E1">break</font>;
-<a name="line521">521: </a>  }
-<a name="line522">522: </a>}
-
-<a name="line524">524: </a><strong><font color="#4169E1"><a name="Scatter_1"></a>PETSC_STATIC_INLINE void Scatter_1(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line525">525: </a>{
-<a name="line526">526: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i;
-<a name="line527">527: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line528">528: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line529">529: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line530">530: </a>      y[indicesy[i]] = x[indicesx[i]];
-<a name="line531">531: </a>    }
-<a name="line532">532: </a>    <font color="#4169E1">break</font>;
-<a name="line533">533: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line534">534: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line535">535: </a>      y[indicesy[i]] += x[indicesx[i]];
-<a name="line536">536: </a>    }
-<a name="line537">537: </a>    <font color="#4169E1">break</font>;
-<a name="line538">538: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line539">539: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line540">540: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line541">541: </a>      y[indicesy[i]] = PetscMax(y[indicesy[i]],x[indicesx[i]]);
-<a name="line542">542: </a>    }
-<a name="line543">543: </a><font color="#A020F0">#else</font>
-<a name="line544">544: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line545">545: </a><font color="#A020F0">#endif</font>
-<a name="line546">546: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line547">547: </a>    <font color="#4169E1">break</font>;
-<a name="line548">548: </a>  }
-<a name="line549">549: </a>}
-
-<a name="line551">551: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line552">552: </a><strong><font color="#4169E1"><a name="Pack_2"></a>PETSC_STATIC_INLINE void Pack_2(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line553">553: </a>{
-<a name="line554">554: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line556">556: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line557">557: </a>    idx   = *indicesx++;
-<a name="line558">558: </a>    y[0]  = x[idx];
-<a name="line559">559: </a>    y[1]  = x[idx+1];
-<a name="line560">560: </a>    y    += 2;
-<a name="line561">561: </a>  }
-<a name="line562">562: </a>}
-<a name="line563">563: </a><strong><font color="#4169E1"><a name="UnPack_2"></a>PETSC_STATIC_INLINE void UnPack_2(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line564">564: </a>{
-<a name="line565">565: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line567">567: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line568">568: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line569">569: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line570">570: </a>      idy       = *indicesy++;
-<a name="line571">571: </a>      y[idy]    = x[0];
-<a name="line572">572: </a>      y[idy+1]  = x[1];
-<a name="line573">573: </a>      x    += 2;
-<a name="line574">574: </a>    }
-<a name="line575">575: </a>    <font color="#4169E1">break</font>;
-<a name="line576">576: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line577">577: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line578">578: </a>      idy       = *indicesy++;
-<a name="line579">579: </a>      y[idy]    += x[0];
-<a name="line580">580: </a>      y[idy+1]  += x[1];
-<a name="line581">581: </a>      x    += 2;
-<a name="line582">582: </a>    }
-<a name="line583">583: </a>    <font color="#4169E1">break</font>;
-<a name="line584">584: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line585">585: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line586">586: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line587">587: </a>      idy       = *indicesy++;
-<a name="line588">588: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line589">589: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line590">590: </a>      x    += 2;
-<a name="line591">591: </a>    }
-<a name="line592">592: </a><font color="#A020F0">#else</font>
-<a name="line593">593: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line594">594: </a><font color="#A020F0">#endif</font>
-<a name="line595">595: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line596">596: </a>    <font color="#4169E1">break</font>;
-<a name="line597">597: </a>  }
-<a name="line598">598: </a>}
-
-<a name="line600">600: </a><strong><font color="#4169E1"><a name="Scatter_2"></a>PETSC_STATIC_INLINE void Scatter_2(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line601">601: </a>{
-<a name="line602">602: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line604">604: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line605">605: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line606">606: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line607">607: </a>      idx       = *indicesx++;
-<a name="line608">608: </a>      idy       = *indicesy++;
-<a name="line609">609: </a>      y[idy]    = x[idx];
-<a name="line610">610: </a>      y[idy+1]  = x[idx+1];
-<a name="line611">611: </a>    }
-<a name="line612">612: </a>    <font color="#4169E1">break</font>;
-<a name="line613">613: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line614">614: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line615">615: </a>      idx       = *indicesx++;
-<a name="line616">616: </a>      idy       = *indicesy++;
-<a name="line617">617: </a>      y[idy]    += x[idx];
-<a name="line618">618: </a>      y[idy+1]  += x[idx+1];
-<a name="line619">619: </a>    }
-<a name="line620">620: </a>    <font color="#4169E1">break</font>;
-<a name="line621">621: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line622">622: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line623">623: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line624">624: </a>      idx       = *indicesx++;
-<a name="line625">625: </a>      idy       = *indicesy++;
-<a name="line626">626: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line627">627: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line628">628: </a>    }
-<a name="line629">629: </a><font color="#A020F0">#else</font>
-<a name="line630">630: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line631">631: </a><font color="#A020F0">#endif</font>
-<a name="line632">632: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line633">633: </a>    <font color="#4169E1">break</font>;
-<a name="line634">634: </a>  }
-<a name="line635">635: </a>}
-<a name="line636">636: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line637">637: </a><strong><font color="#4169E1"><a name="Pack_3"></a>PETSC_STATIC_INLINE void Pack_3(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line638">638: </a>{
-<a name="line639">639: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line641">641: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line642">642: </a>    idx   = *indicesx++;
-<a name="line643">643: </a>    y[0]  = x[idx];
-<a name="line644">644: </a>    y[1]  = x[idx+1];
-<a name="line645">645: </a>    y[2]  = x[idx+2];
-<a name="line646">646: </a>    y    += 3;
-<a name="line647">647: </a>  }
-<a name="line648">648: </a>}
-<a name="line649">649: </a><strong><font color="#4169E1"><a name="UnPack_3"></a>PETSC_STATIC_INLINE void UnPack_3(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line650">650: </a>{
-<a name="line651">651: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line653">653: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line654">654: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line655">655: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line656">656: </a>      idy       = *indicesy++;
-<a name="line657">657: </a>      y[idy]    = x[0];
-<a name="line658">658: </a>      y[idy+1]  = x[1];
-<a name="line659">659: </a>      y[idy+2]  = x[2];
-<a name="line660">660: </a>      x    += 3;
-<a name="line661">661: </a>    }
-<a name="line662">662: </a>    <font color="#4169E1">break</font>;
-<a name="line663">663: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line664">664: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line665">665: </a>      idy       = *indicesy++;
-<a name="line666">666: </a>      y[idy]    += x[0];
-<a name="line667">667: </a>      y[idy+1]  += x[1];
-<a name="line668">668: </a>      y[idy+2]  += x[2];
-<a name="line669">669: </a>      x    += 3;
-<a name="line670">670: </a>    }
-<a name="line671">671: </a>    <font color="#4169E1">break</font>;
-<a name="line672">672: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line673">673: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line674">674: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line675">675: </a>      idy       = *indicesy++;
-<a name="line676">676: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line677">677: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line678">678: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line679">679: </a>      x    += 3;
-<a name="line680">680: </a>    }
-<a name="line681">681: </a><font color="#A020F0">#else</font>
-<a name="line682">682: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line683">683: </a><font color="#A020F0">#endif</font>
-<a name="line684">684: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line685">685: </a>    <font color="#4169E1">break</font>;
-<a name="line686">686: </a>  }
-<a name="line687">687: </a>}
-
-<a name="line689">689: </a><strong><font color="#4169E1"><a name="Scatter_3"></a>PETSC_STATIC_INLINE void Scatter_3(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line690">690: </a>{
-<a name="line691">691: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line693">693: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line694">694: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line695">695: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line696">696: </a>      idx       = *indicesx++;
-<a name="line697">697: </a>      idy       = *indicesy++;
-<a name="line698">698: </a>      y[idy]    = x[idx];
-<a name="line699">699: </a>      y[idy+1]  = x[idx+1];
-<a name="line700">700: </a>      y[idy+2]  = x[idx+2];
-<a name="line701">701: </a>    }
-<a name="line702">702: </a>    <font color="#4169E1">break</font>;
-<a name="line703">703: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line704">704: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line705">705: </a>      idx       = *indicesx++;
-<a name="line706">706: </a>      idy       = *indicesy++;
-<a name="line707">707: </a>      y[idy]    += x[idx];
-<a name="line708">708: </a>      y[idy+1]  += x[idx+1];
-<a name="line709">709: </a>      y[idy+2]  += x[idx+2];
-<a name="line710">710: </a>    }
-<a name="line711">711: </a>    <font color="#4169E1">break</font>;
-<a name="line712">712: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line713">713: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line714">714: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line715">715: </a>      idx       = *indicesx++;
-<a name="line716">716: </a>      idy       = *indicesy++;
-<a name="line717">717: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line718">718: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line719">719: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line720">720: </a>    }
-<a name="line721">721: </a><font color="#A020F0">#else</font>
-<a name="line722">722: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line723">723: </a><font color="#A020F0">#endif</font>
-<a name="line724">724: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line725">725: </a>    <font color="#4169E1">break</font>;
-<a name="line726">726: </a>  }
-<a name="line727">727: </a>}
-<a name="line728">728: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line729">729: </a><strong><font color="#4169E1"><a name="Pack_4"></a>PETSC_STATIC_INLINE void Pack_4(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line730">730: </a>{
-<a name="line731">731: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line733">733: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line734">734: </a>    idx   = *indicesx++;
-<a name="line735">735: </a>    y[0]  = x[idx];
-<a name="line736">736: </a>    y[1]  = x[idx+1];
-<a name="line737">737: </a>    y[2]  = x[idx+2];
-<a name="line738">738: </a>    y[3]  = x[idx+3];
-<a name="line739">739: </a>    y    += 4;
-<a name="line740">740: </a>  }
-<a name="line741">741: </a>}
-<a name="line742">742: </a><strong><font color="#4169E1"><a name="UnPack_4"></a>PETSC_STATIC_INLINE void UnPack_4(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line743">743: </a>{
-<a name="line744">744: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line746">746: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line747">747: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line748">748: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line749">749: </a>      idy       = *indicesy++;
-<a name="line750">750: </a>      y[idy]    = x[0];
-<a name="line751">751: </a>      y[idy+1]  = x[1];
-<a name="line752">752: </a>      y[idy+2]  = x[2];
-<a name="line753">753: </a>      y[idy+3]  = x[3];
-<a name="line754">754: </a>      x    += 4;
-<a name="line755">755: </a>    }
-<a name="line756">756: </a>    <font color="#4169E1">break</font>;
-<a name="line757">757: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line758">758: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line759">759: </a>      idy       = *indicesy++;
-<a name="line760">760: </a>      y[idy]    += x[0];
-<a name="line761">761: </a>      y[idy+1]  += x[1];
-<a name="line762">762: </a>      y[idy+2]  += x[2];
-<a name="line763">763: </a>      y[idy+3]  += x[3];
-<a name="line764">764: </a>      x    += 4;
-<a name="line765">765: </a>    }
-<a name="line766">766: </a>    <font color="#4169E1">break</font>;
-<a name="line767">767: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line768">768: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line769">769: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line770">770: </a>      idy       = *indicesy++;
-<a name="line771">771: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line772">772: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line773">773: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line774">774: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
-<a name="line775">775: </a>      x    += 4;
-<a name="line776">776: </a>    }
-<a name="line777">777: </a><font color="#A020F0">#else</font>
-<a name="line778">778: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line779">779: </a><font color="#A020F0">#endif</font>
-<a name="line780">780: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line781">781: </a>    <font color="#4169E1">break</font>;
-<a name="line782">782: </a>  }
-<a name="line783">783: </a>}
-
-<a name="line785">785: </a><strong><font color="#4169E1"><a name="Scatter_4"></a>PETSC_STATIC_INLINE void Scatter_4(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line786">786: </a>{
-<a name="line787">787: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line789">789: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line790">790: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line791">791: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line792">792: </a>      idx       = *indicesx++;
-<a name="line793">793: </a>      idy       = *indicesy++;
-<a name="line794">794: </a>      y[idy]    = x[idx];
-<a name="line795">795: </a>      y[idy+1]  = x[idx+1];
-<a name="line796">796: </a>      y[idy+2]  = x[idx+2];
-<a name="line797">797: </a>      y[idy+3]  = x[idx+3];
-<a name="line798">798: </a>    }
-<a name="line799">799: </a>    <font color="#4169E1">break</font>;
-<a name="line800">800: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line801">801: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line802">802: </a>      idx       = *indicesx++;
-<a name="line803">803: </a>      idy       = *indicesy++;
-<a name="line804">804: </a>      y[idy]    += x[idx];
-<a name="line805">805: </a>      y[idy+1]  += x[idx+1];
-<a name="line806">806: </a>      y[idy+2]  += x[idx+2];
-<a name="line807">807: </a>      y[idy+3]  += x[idx+3];
-<a name="line808">808: </a>    }
-<a name="line809">809: </a>    <font color="#4169E1">break</font>;
-<a name="line810">810: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line811">811: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line812">812: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line813">813: </a>      idx       = *indicesx++;
-<a name="line814">814: </a>      idy       = *indicesy++;
-<a name="line815">815: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line816">816: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line817">817: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line818">818: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
-<a name="line819">819: </a>    }
-<a name="line820">820: </a><font color="#A020F0">#else</font>
-<a name="line821">821: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line822">822: </a><font color="#A020F0">#endif</font>
-<a name="line823">823: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line824">824: </a>    <font color="#4169E1">break</font>;
-<a name="line825">825: </a>  }
-<a name="line826">826: </a>}
-<a name="line827">827: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line828">828: </a><strong><font color="#4169E1"><a name="Pack_5"></a>PETSC_STATIC_INLINE void Pack_5(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line829">829: </a>{
-<a name="line830">830: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line832">832: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line833">833: </a>    idx   = *indicesx++;
-<a name="line834">834: </a>    y[0]  = x[idx];
-<a name="line835">835: </a>    y[1]  = x[idx+1];
-<a name="line836">836: </a>    y[2]  = x[idx+2];
-<a name="line837">837: </a>    y[3]  = x[idx+3];
-<a name="line838">838: </a>    y[4]  = x[idx+4];
-<a name="line839">839: </a>    y    += 5;
-<a name="line840">840: </a>  }
-<a name="line841">841: </a>}
-<a name="line842">842: </a><strong><font color="#4169E1"><a name="UnPack_5"></a>PETSC_STATIC_INLINE void UnPack_5(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line843">843: </a>{
-<a name="line844">844: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line846">846: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line847">847: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line848">848: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line849">849: </a>      idy       = *indicesy++;
-<a name="line850">850: </a>      y[idy]    = x[0];
-<a name="line851">851: </a>      y[idy+1]  = x[1];
-<a name="line852">852: </a>      y[idy+2]  = x[2];
-<a name="line853">853: </a>      y[idy+3]  = x[3];
-<a name="line854">854: </a>      y[idy+4]  = x[4];
-<a name="line855">855: </a>      x    += 5;
-<a name="line856">856: </a>    }
-<a name="line857">857: </a>    <font color="#4169E1">break</font>;
-<a name="line858">858: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line859">859: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line860">860: </a>      idy       = *indicesy++;
-<a name="line861">861: </a>      y[idy]    += x[0];
-<a name="line862">862: </a>      y[idy+1]  += x[1];
-<a name="line863">863: </a>      y[idy+2]  += x[2];
-<a name="line864">864: </a>      y[idy+3]  += x[3];
-<a name="line865">865: </a>      y[idy+4]  += x[4];
-<a name="line866">866: </a>      x    += 5;
-<a name="line867">867: </a>    }
-<a name="line868">868: </a>    <font color="#4169E1">break</font>;
-<a name="line869">869: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line870">870: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line871">871: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line872">872: </a>      idy       = *indicesy++;
-<a name="line873">873: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line874">874: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line875">875: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line876">876: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
-<a name="line877">877: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
-<a name="line878">878: </a>      x    += 5;
-<a name="line879">879: </a>    }
-<a name="line880">880: </a><font color="#A020F0">#else</font>
-<a name="line881">881: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line882">882: </a><font color="#A020F0">#endif</font>
-<a name="line883">883: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line884">884: </a>    <font color="#4169E1">break</font>;
-<a name="line885">885: </a>  }
-<a name="line886">886: </a>}
-
-<a name="line888">888: </a><strong><font color="#4169E1"><a name="Scatter_5"></a>PETSC_STATIC_INLINE void Scatter_5(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line889">889: </a>{
-<a name="line890">890: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line892">892: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line893">893: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line894">894: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line895">895: </a>      idx       = *indicesx++;
-<a name="line896">896: </a>      idy       = *indicesy++;
-<a name="line897">897: </a>      y[idy]    = x[idx];
-<a name="line898">898: </a>      y[idy+1]  = x[idx+1];
-<a name="line899">899: </a>      y[idy+2]  = x[idx+2];
-<a name="line900">900: </a>      y[idy+3]  = x[idx+3];
-<a name="line901">901: </a>      y[idy+4]  = x[idx+4];
-<a name="line902">902: </a>    }
-<a name="line903">903: </a>    <font color="#4169E1">break</font>;
-<a name="line904">904: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line905">905: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line906">906: </a>      idx       = *indicesx++;
-<a name="line907">907: </a>      idy       = *indicesy++;
-<a name="line908">908: </a>      y[idy]    += x[idx];
-<a name="line909">909: </a>      y[idy+1]  += x[idx+1];
-<a name="line910">910: </a>      y[idy+2]  += x[idx+2];
-<a name="line911">911: </a>      y[idy+3]  += x[idx+3];
-<a name="line912">912: </a>      y[idy+4]  += x[idx+4];
-<a name="line913">913: </a>    }
-<a name="line914">914: </a>    <font color="#4169E1">break</font>;
-<a name="line915">915: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line916">916: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line917">917: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line918">918: </a>      idx       = *indicesx++;
-<a name="line919">919: </a>      idy       = *indicesy++;
-<a name="line920">920: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line921">921: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line922">922: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line923">923: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
-<a name="line924">924: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
-<a name="line925">925: </a>    }
-<a name="line926">926: </a><font color="#A020F0">#else</font>
-<a name="line927">927: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line928">928: </a><font color="#A020F0">#endif</font>
-<a name="line929">929: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line930">930: </a>    <font color="#4169E1">break</font>;
-<a name="line931">931: </a>  }
-<a name="line932">932: </a>}
-<a name="line933">933: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line934">934: </a><strong><font color="#4169E1"><a name="Pack_6"></a>PETSC_STATIC_INLINE void Pack_6(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line935">935: </a>{
-<a name="line936">936: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line938">938: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line939">939: </a>    idx   = *indicesx++;
-<a name="line940">940: </a>    y[0]  = x[idx];
-<a name="line941">941: </a>    y[1]  = x[idx+1];
-<a name="line942">942: </a>    y[2]  = x[idx+2];
-<a name="line943">943: </a>    y[3]  = x[idx+3];
-<a name="line944">944: </a>    y[4]  = x[idx+4];
-<a name="line945">945: </a>    y[5]  = x[idx+5];
-<a name="line946">946: </a>    y    += 6;
-<a name="line947">947: </a>  }
-<a name="line948">948: </a>}
-<a name="line949">949: </a><strong><font color="#4169E1"><a name="UnPack_6"></a>PETSC_STATIC_INLINE void UnPack_6(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line950">950: </a>{
-<a name="line951">951: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line953">953: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line954">954: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line955">955: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line956">956: </a>      idy       = *indicesy++;
-<a name="line957">957: </a>      y[idy]    = x[0];
-<a name="line958">958: </a>      y[idy+1]  = x[1];
-<a name="line959">959: </a>      y[idy+2]  = x[2];
-<a name="line960">960: </a>      y[idy+3]  = x[3];
-<a name="line961">961: </a>      y[idy+4]  = x[4];
-<a name="line962">962: </a>      y[idy+5]  = x[5];
-<a name="line963">963: </a>      x    += 6;
-<a name="line964">964: </a>    }
-<a name="line965">965: </a>    <font color="#4169E1">break</font>;
-<a name="line966">966: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line967">967: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line968">968: </a>      idy       = *indicesy++;
-<a name="line969">969: </a>      y[idy]    += x[0];
-<a name="line970">970: </a>      y[idy+1]  += x[1];
-<a name="line971">971: </a>      y[idy+2]  += x[2];
-<a name="line972">972: </a>      y[idy+3]  += x[3];
-<a name="line973">973: </a>      y[idy+4]  += x[4];
-<a name="line974">974: </a>      y[idy+5]  += x[5];
-<a name="line975">975: </a>      x    += 6;
-<a name="line976">976: </a>    }
-<a name="line977">977: </a>    <font color="#4169E1">break</font>;
-<a name="line978">978: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line979">979: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line980">980: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line981">981: </a>      idy       = *indicesy++;
-<a name="line982">982: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line983">983: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line984">984: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line985">985: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
-<a name="line986">986: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
-<a name="line987">987: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
-<a name="line988">988: </a>      x    += 6;
-<a name="line989">989: </a>    }
-<a name="line990">990: </a><font color="#A020F0">#else</font>
-<a name="line991">991: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line992">992: </a><font color="#A020F0">#endif</font>
-<a name="line993">993: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line994">994: </a>    <font color="#4169E1">break</font>;
-<a name="line995">995: </a>  }
-<a name="line996">996: </a>}
-
-<a name="line998">998: </a><strong><font color="#4169E1"><a name="Scatter_6"></a>PETSC_STATIC_INLINE void Scatter_6(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line999">999: </a>{
-<a name="line1000">1000: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line1002">1002: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1003">1003: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1004">1004: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1005">1005: </a>      idx       = *indicesx++;
-<a name="line1006">1006: </a>      idy       = *indicesy++;
-<a name="line1007">1007: </a>      y[idy]    = x[idx];
-<a name="line1008">1008: </a>      y[idy+1]  = x[idx+1];
-<a name="line1009">1009: </a>      y[idy+2]  = x[idx+2];
-<a name="line1010">1010: </a>      y[idy+3]  = x[idx+3];
-<a name="line1011">1011: </a>      y[idy+4]  = x[idx+4];
-<a name="line1012">1012: </a>      y[idy+5]  = x[idx+5];
-<a name="line1013">1013: </a>    }
-<a name="line1014">1014: </a>    <font color="#4169E1">break</font>;
-<a name="line1015">1015: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1016">1016: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1017">1017: </a>      idx       = *indicesx++;
-<a name="line1018">1018: </a>      idy       = *indicesy++;
-<a name="line1019">1019: </a>      y[idy]    += x[idx];
-<a name="line1020">1020: </a>      y[idy+1]  += x[idx+1];
-<a name="line1021">1021: </a>      y[idy+2]  += x[idx+2];
-<a name="line1022">1022: </a>      y[idy+3]  += x[idx+3];
-<a name="line1023">1023: </a>      y[idy+4]  += x[idx+4];
-<a name="line1024">1024: </a>      y[idy+5]  += x[idx+5];
-<a name="line1025">1025: </a>    }
-<a name="line1026">1026: </a>    <font color="#4169E1">break</font>;
-<a name="line1027">1027: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1028">1028: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1029">1029: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1030">1030: </a>      idx       = *indicesx++;
-<a name="line1031">1031: </a>      idy       = *indicesy++;
-<a name="line1032">1032: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line1033">1033: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line1034">1034: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line1035">1035: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
-<a name="line1036">1036: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
-<a name="line1037">1037: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
-<a name="line1038">1038: </a>    }
-<a name="line1039">1039: </a><font color="#A020F0">#else</font>
-<a name="line1040">1040: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1041">1041: </a><font color="#A020F0">#endif</font>
-<a name="line1042">1042: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1043">1043: </a>    <font color="#4169E1">break</font>;
-<a name="line1044">1044: </a>  }
-<a name="line1045">1045: </a>}
-<a name="line1046">1046: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line1047">1047: </a><strong><font color="#4169E1"><a name="Pack_7"></a>PETSC_STATIC_INLINE void Pack_7(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line1048">1048: </a>{
-<a name="line1049">1049: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line1051">1051: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1052">1052: </a>    idx   = *indicesx++;
-<a name="line1053">1053: </a>    y[0]  = x[idx];
-<a name="line1054">1054: </a>    y[1]  = x[idx+1];
-<a name="line1055">1055: </a>    y[2]  = x[idx+2];
-<a name="line1056">1056: </a>    y[3]  = x[idx+3];
-<a name="line1057">1057: </a>    y[4]  = x[idx+4];
-<a name="line1058">1058: </a>    y[5]  = x[idx+5];
-<a name="line1059">1059: </a>    y[6]  = x[idx+6];
-<a name="line1060">1060: </a>    y    += 7;
-<a name="line1061">1061: </a>  }
-<a name="line1062">1062: </a>}
-<a name="line1063">1063: </a><strong><font color="#4169E1"><a name="UnPack_7"></a>PETSC_STATIC_INLINE void UnPack_7(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line1064">1064: </a>{
-<a name="line1065">1065: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line1067">1067: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1068">1068: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1069">1069: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1070">1070: </a>      idy       = *indicesy++;
-<a name="line1071">1071: </a>      y[idy]    = x[0];
-<a name="line1072">1072: </a>      y[idy+1]  = x[1];
-<a name="line1073">1073: </a>      y[idy+2]  = x[2];
-<a name="line1074">1074: </a>      y[idy+3]  = x[3];
-<a name="line1075">1075: </a>      y[idy+4]  = x[4];
-<a name="line1076">1076: </a>      y[idy+5]  = x[5];
-<a name="line1077">1077: </a>      y[idy+6]  = x[6];
-<a name="line1078">1078: </a>      x    += 7;
-<a name="line1079">1079: </a>    }
-<a name="line1080">1080: </a>    <font color="#4169E1">break</font>;
-<a name="line1081">1081: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1082">1082: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1083">1083: </a>      idy       = *indicesy++;
-<a name="line1084">1084: </a>      y[idy]    += x[0];
-<a name="line1085">1085: </a>      y[idy+1]  += x[1];
-<a name="line1086">1086: </a>      y[idy+2]  += x[2];
-<a name="line1087">1087: </a>      y[idy+3]  += x[3];
-<a name="line1088">1088: </a>      y[idy+4]  += x[4];
-<a name="line1089">1089: </a>      y[idy+5]  += x[5];
-<a name="line1090">1090: </a>      y[idy+6]  += x[6];
-<a name="line1091">1091: </a>      x    += 7;
-<a name="line1092">1092: </a>    }
-<a name="line1093">1093: </a>    <font color="#4169E1">break</font>;
-<a name="line1094">1094: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1095">1095: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1096">1096: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1097">1097: </a>      idy       = *indicesy++;
-<a name="line1098">1098: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line1099">1099: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line1100">1100: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line1101">1101: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
-<a name="line1102">1102: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
-<a name="line1103">1103: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
-<a name="line1104">1104: </a>      y[idy+6]  = PetscMax(y[idy+6],x[6]);
-<a name="line1105">1105: </a>      x    += 7;
-<a name="line1106">1106: </a>    }
-<a name="line1107">1107: </a><font color="#A020F0">#else</font>
-<a name="line1108">1108: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1109">1109: </a><font color="#A020F0">#endif</font>
-<a name="line1110">1110: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1111">1111: </a>    <font color="#4169E1">break</font>;
-<a name="line1112">1112: </a>  }
-<a name="line1113">1113: </a>}
-
-<a name="line1115">1115: </a><strong><font color="#4169E1"><a name="Scatter_7"></a>PETSC_STATIC_INLINE void Scatter_7(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line1116">1116: </a>{
-<a name="line1117">1117: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line1119">1119: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1120">1120: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1121">1121: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1122">1122: </a>      idx       = *indicesx++;
-<a name="line1123">1123: </a>      idy       = *indicesy++;
-<a name="line1124">1124: </a>      y[idy]    = x[idx];
-<a name="line1125">1125: </a>      y[idy+1]  = x[idx+1];
-<a name="line1126">1126: </a>      y[idy+2]  = x[idx+2];
-<a name="line1127">1127: </a>      y[idy+3]  = x[idx+3];
-<a name="line1128">1128: </a>      y[idy+4]  = x[idx+4];
-<a name="line1129">1129: </a>      y[idy+5]  = x[idx+5];
-<a name="line1130">1130: </a>      y[idy+6]  = x[idx+6];
-<a name="line1131">1131: </a>    }
-<a name="line1132">1132: </a>    <font color="#4169E1">break</font>;
-<a name="line1133">1133: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1134">1134: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1135">1135: </a>      idx       = *indicesx++;
-<a name="line1136">1136: </a>      idy       = *indicesy++;
-<a name="line1137">1137: </a>      y[idy]    += x[idx];
-<a name="line1138">1138: </a>      y[idy+1]  += x[idx+1];
-<a name="line1139">1139: </a>      y[idy+2]  += x[idx+2];
-<a name="line1140">1140: </a>      y[idy+3]  += x[idx+3];
-<a name="line1141">1141: </a>      y[idy+4]  += x[idx+4];
-<a name="line1142">1142: </a>      y[idy+5]  += x[idx+5];
-<a name="line1143">1143: </a>      y[idy+6]  += x[idx+6];
-<a name="line1144">1144: </a>    }
-<a name="line1145">1145: </a>    <font color="#4169E1">break</font>;
-<a name="line1146">1146: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1147">1147: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1148">1148: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1149">1149: </a>      idx       = *indicesx++;
-<a name="line1150">1150: </a>      idy       = *indicesy++;
-<a name="line1151">1151: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line1152">1152: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line1153">1153: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line1154">1154: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
-<a name="line1155">1155: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
-<a name="line1156">1156: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
-<a name="line1157">1157: </a>      y[idy+6]  = PetscMax(y[idy+6],x[idx+6]);
-<a name="line1158">1158: </a>    }
-<a name="line1159">1159: </a><font color="#A020F0">#else</font>
-<a name="line1160">1160: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1161">1161: </a><font color="#A020F0">#endif</font>
-<a name="line1162">1162: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1163">1163: </a>    <font color="#4169E1">break</font>;
-<a name="line1164">1164: </a>  }
-<a name="line1165">1165: </a>}
-<a name="line1166">1166: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line1167">1167: </a><strong><font color="#4169E1"><a name="Pack_8"></a>PETSC_STATIC_INLINE void Pack_8(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line1168">1168: </a>{
-<a name="line1169">1169: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line1171">1171: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1172">1172: </a>    idx   = *indicesx++;
-<a name="line1173">1173: </a>    y[0]  = x[idx];
-<a name="line1174">1174: </a>    y[1]  = x[idx+1];
-<a name="line1175">1175: </a>    y[2]  = x[idx+2];
-<a name="line1176">1176: </a>    y[3]  = x[idx+3];
-<a name="line1177">1177: </a>    y[4]  = x[idx+4];
-<a name="line1178">1178: </a>    y[5]  = x[idx+5];
-<a name="line1179">1179: </a>    y[6]  = x[idx+6];
-<a name="line1180">1180: </a>    y[7]  = x[idx+7];
-<a name="line1181">1181: </a>    y    += 8;
-<a name="line1182">1182: </a>  }
-<a name="line1183">1183: </a>}
-<a name="line1184">1184: </a><strong><font color="#4169E1"><a name="UnPack_8"></a>PETSC_STATIC_INLINE void UnPack_8(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line1185">1185: </a>{
-<a name="line1186">1186: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line1188">1188: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1189">1189: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1190">1190: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1191">1191: </a>      idy       = *indicesy++;
-<a name="line1192">1192: </a>      y[idy]    = x[0];
-<a name="line1193">1193: </a>      y[idy+1]  = x[1];
-<a name="line1194">1194: </a>      y[idy+2]  = x[2];
-<a name="line1195">1195: </a>      y[idy+3]  = x[3];
-<a name="line1196">1196: </a>      y[idy+4]  = x[4];
-<a name="line1197">1197: </a>      y[idy+5]  = x[5];
-<a name="line1198">1198: </a>      y[idy+6]  = x[6];
-<a name="line1199">1199: </a>      y[idy+7]  = x[7];
-<a name="line1200">1200: </a>      x    += 8;
-<a name="line1201">1201: </a>    }
-<a name="line1202">1202: </a>    <font color="#4169E1">break</font>;
-<a name="line1203">1203: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1204">1204: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1205">1205: </a>      idy       = *indicesy++;
-<a name="line1206">1206: </a>      y[idy]    += x[0];
-<a name="line1207">1207: </a>      y[idy+1]  += x[1];
-<a name="line1208">1208: </a>      y[idy+2]  += x[2];
-<a name="line1209">1209: </a>      y[idy+3]  += x[3];
-<a name="line1210">1210: </a>      y[idy+4]  += x[4];
-<a name="line1211">1211: </a>      y[idy+5]  += x[5];
-<a name="line1212">1212: </a>      y[idy+6]  += x[6];
-<a name="line1213">1213: </a>      y[idy+7]  += x[7];
-<a name="line1214">1214: </a>      x    += 8;
-<a name="line1215">1215: </a>    }
-<a name="line1216">1216: </a>    <font color="#4169E1">break</font>;
-<a name="line1217">1217: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1218">1218: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1219">1219: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1220">1220: </a>      idy       = *indicesy++;
-<a name="line1221">1221: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line1222">1222: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line1223">1223: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line1224">1224: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
-<a name="line1225">1225: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
-<a name="line1226">1226: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
-<a name="line1227">1227: </a>      y[idy+6]  = PetscMax(y[idy+6],x[6]);
-<a name="line1228">1228: </a>      y[idy+7]  = PetscMax(y[idy+7],x[7]);
-<a name="line1229">1229: </a>      x    += 8;
-<a name="line1230">1230: </a>    }
-<a name="line1231">1231: </a><font color="#A020F0">#else</font>
-<a name="line1232">1232: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1233">1233: </a><font color="#A020F0">#endif</font>
-<a name="line1234">1234: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1235">1235: </a>    <font color="#4169E1">break</font>;
-<a name="line1236">1236: </a>  }
-<a name="line1237">1237: </a>}
-
-<a name="line1239">1239: </a><strong><font color="#4169E1"><a name="Scatter_8"></a>PETSC_STATIC_INLINE void Scatter_8(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line1240">1240: </a>{
-<a name="line1241">1241: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line1243">1243: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1244">1244: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1245">1245: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1246">1246: </a>      idx       = *indicesx++;
-<a name="line1247">1247: </a>      idy       = *indicesy++;
-<a name="line1248">1248: </a>      y[idy]    = x[idx];
-<a name="line1249">1249: </a>      y[idy+1]  = x[idx+1];
-<a name="line1250">1250: </a>      y[idy+2]  = x[idx+2];
-<a name="line1251">1251: </a>      y[idy+3]  = x[idx+3];
-<a name="line1252">1252: </a>      y[idy+4]  = x[idx+4];
-<a name="line1253">1253: </a>      y[idy+5]  = x[idx+5];
-<a name="line1254">1254: </a>      y[idy+6]  = x[idx+6];
-<a name="line1255">1255: </a>      y[idy+7]  = x[idx+7];
-<a name="line1256">1256: </a>    }
-<a name="line1257">1257: </a>    <font color="#4169E1">break</font>;
-<a name="line1258">1258: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1259">1259: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1260">1260: </a>      idx       = *indicesx++;
-<a name="line1261">1261: </a>      idy       = *indicesy++;
-<a name="line1262">1262: </a>      y[idy]    += x[idx];
-<a name="line1263">1263: </a>      y[idy+1]  += x[idx+1];
-<a name="line1264">1264: </a>      y[idy+2]  += x[idx+2];
-<a name="line1265">1265: </a>      y[idy+3]  += x[idx+3];
-<a name="line1266">1266: </a>      y[idy+4]  += x[idx+4];
-<a name="line1267">1267: </a>      y[idy+5]  += x[idx+5];
-<a name="line1268">1268: </a>      y[idy+6]  += x[idx+6];
-<a name="line1269">1269: </a>      y[idy+7]  += x[idx+7];
-<a name="line1270">1270: </a>    }
-<a name="line1271">1271: </a>    <font color="#4169E1">break</font>;
-<a name="line1272">1272: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1273">1273: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1274">1274: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1275">1275: </a>      idx       = *indicesx++;
-<a name="line1276">1276: </a>      idy       = *indicesy++;
-<a name="line1277">1277: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line1278">1278: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line1279">1279: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line1280">1280: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
-<a name="line1281">1281: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
-<a name="line1282">1282: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
-<a name="line1283">1283: </a>      y[idy+6]  = PetscMax(y[idy+6],x[idx+6]);
-<a name="line1284">1284: </a>      y[idy+7]  = PetscMax(y[idy+7],x[idx+7]);
-<a name="line1285">1285: </a>    }
-<a name="line1286">1286: </a><font color="#A020F0">#else</font>
-<a name="line1287">1287: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1288">1288: </a><font color="#A020F0">#endif</font>
-<a name="line1289">1289: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1290">1290: </a>    <font color="#4169E1">break</font>;
-<a name="line1291">1291: </a>  }
-<a name="line1292">1292: </a>}
-
-<a name="line1294">1294: </a>  <font color="#B22222">/* ----------------------------------------------------------------------------------------------- */</font>
-<a name="line1295">1295: </a><strong><font color="#4169E1"><a name="Pack_12"></a>PETSC_STATIC_INLINE void Pack_12(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y)</font></strong>
-<a name="line1296">1296: </a>{
-<a name="line1297">1297: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx;
-
-<a name="line1299">1299: </a>  <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1300">1300: </a>    idx   = *indicesx++;
-<a name="line1301">1301: </a>    y[0]  = x[idx];
-<a name="line1302">1302: </a>    y[1]  = x[idx+1];
-<a name="line1303">1303: </a>    y[2]  = x[idx+2];
-<a name="line1304">1304: </a>    y[3]  = x[idx+3];
-<a name="line1305">1305: </a>    y[4]  = x[idx+4];
-<a name="line1306">1306: </a>    y[5]  = x[idx+5];
-<a name="line1307">1307: </a>    y[6]  = x[idx+6];
-<a name="line1308">1308: </a>    y[7]  = x[idx+7];
-<a name="line1309">1309: </a>    y[8]  = x[idx+8];
-<a name="line1310">1310: </a>    y[9]  = x[idx+9];
-<a name="line1311">1311: </a>    y[10] = x[idx+10];
-<a name="line1312">1312: </a>    y[11] = x[idx+11];
-<a name="line1313">1313: </a>    y    += 12;
-<a name="line1314">1314: </a>  }
-<a name="line1315">1315: </a>}
-<a name="line1316">1316: </a><strong><font color="#4169E1"><a name="UnPack_12"></a>PETSC_STATIC_INLINE void UnPack_12(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line1317">1317: </a>{
-<a name="line1318">1318: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idy;
-
-<a name="line1320">1320: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1321">1321: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1322">1322: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1323">1323: </a>      idy       = *indicesy++;
-<a name="line1324">1324: </a>      y[idy]    = x[0];
-<a name="line1325">1325: </a>      y[idy+1]  = x[1];
-<a name="line1326">1326: </a>      y[idy+2]  = x[2];
-<a name="line1327">1327: </a>      y[idy+3]  = x[3];
-<a name="line1328">1328: </a>      y[idy+4]  = x[4];
-<a name="line1329">1329: </a>      y[idy+5]  = x[5];
-<a name="line1330">1330: </a>      y[idy+6]  = x[6];
-<a name="line1331">1331: </a>      y[idy+7]  = x[7];
-<a name="line1332">1332: </a>      y[idy+8]  = x[8];
-<a name="line1333">1333: </a>      y[idy+9]  = x[9];
-<a name="line1334">1334: </a>      y[idy+10] = x[10];
-<a name="line1335">1335: </a>      y[idy+11] = x[11];
-<a name="line1336">1336: </a>      x    += 12;
-<a name="line1337">1337: </a>    }
-<a name="line1338">1338: </a>    <font color="#4169E1">break</font>;
-<a name="line1339">1339: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1340">1340: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1341">1341: </a>      idy       = *indicesy++;
-<a name="line1342">1342: </a>      y[idy]    += x[0];
-<a name="line1343">1343: </a>      y[idy+1]  += x[1];
-<a name="line1344">1344: </a>      y[idy+2]  += x[2];
-<a name="line1345">1345: </a>      y[idy+3]  += x[3];
-<a name="line1346">1346: </a>      y[idy+4]  += x[4];
-<a name="line1347">1347: </a>      y[idy+5]  += x[5];
-<a name="line1348">1348: </a>      y[idy+6]  += x[6];
-<a name="line1349">1349: </a>      y[idy+7]  += x[7];
-<a name="line1350">1350: </a>      y[idy+8]  += x[8];
-<a name="line1351">1351: </a>      y[idy+9]  += x[9];
-<a name="line1352">1352: </a>      y[idy+10] += x[10];
-<a name="line1353">1353: </a>      y[idy+11] += x[11];
-<a name="line1354">1354: </a>      x    += 12;
-<a name="line1355">1355: </a>    }
-<a name="line1356">1356: </a>    <font color="#4169E1">break</font>;
-<a name="line1357">1357: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1358">1358: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1359">1359: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1360">1360: </a>      idy       = *indicesy++;
-<a name="line1361">1361: </a>      y[idy]    = PetscMax(y[idy],x[0]);
-<a name="line1362">1362: </a>      y[idy+1]  = PetscMax(y[idy+1],x[1]);
-<a name="line1363">1363: </a>      y[idy+2]  = PetscMax(y[idy+2],x[2]);
-<a name="line1364">1364: </a>      y[idy+3]  = PetscMax(y[idy+3],x[3]);
-<a name="line1365">1365: </a>      y[idy+4]  = PetscMax(y[idy+4],x[4]);
-<a name="line1366">1366: </a>      y[idy+5]  = PetscMax(y[idy+5],x[5]);
-<a name="line1367">1367: </a>      y[idy+6]  = PetscMax(y[idy+6],x[6]);
-<a name="line1368">1368: </a>      y[idy+7]  = PetscMax(y[idy+7],x[7]);
-<a name="line1369">1369: </a>      y[idy+8]  = PetscMax(y[idy+8],x[8]);
-<a name="line1370">1370: </a>      y[idy+9]  = PetscMax(y[idy+9],x[9]);
-<a name="line1371">1371: </a>      y[idy+10] = PetscMax(y[idy+10],x[10]);
-<a name="line1372">1372: </a>      y[idy+11] = PetscMax(y[idy+11],x[11]);
-<a name="line1373">1373: </a>      x    += 12;
-<a name="line1374">1374: </a>    }
-<a name="line1375">1375: </a><font color="#A020F0">#else</font>
-<a name="line1376">1376: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1377">1377: </a><font color="#A020F0">#endif</font>
-<a name="line1378">1378: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1379">1379: </a>    <font color="#4169E1">break</font>;
-<a name="line1380">1380: </a>  }
-<a name="line1381">1381: </a>}
-
-<a name="line1383">1383: </a><strong><font color="#4169E1"><a name="Scatter_12"></a>PETSC_STATIC_INLINE void Scatter_12(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> n,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesx,const <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *x,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *indicesy,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *y,<A href="../../../../docs/manualpages/Sys/InsertMode.html#InsertMode">InsertMode</A> addv)</font></strong>
-<a name="line1384">1384: </a>{
-<a name="line1385">1385: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> i,idx,idy;
-
-<a name="line1387">1387: </a>  <font color="#4169E1">switch</font> (addv) {
-<a name="line1388">1388: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/INSERT_VALUES.html#INSERT_VALUES">INSERT_VALUES</A>:
-<a name="line1389">1389: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1390">1390: </a>      idx       = *indicesx++;
-<a name="line1391">1391: </a>      idy       = *indicesy++;
-<a name="line1392">1392: </a>      y[idy]    = x[idx];
-<a name="line1393">1393: </a>      y[idy+1]  = x[idx+1];
-<a name="line1394">1394: </a>      y[idy+2]  = x[idx+2];
-<a name="line1395">1395: </a>      y[idy+3]  = x[idx+3];
-<a name="line1396">1396: </a>      y[idy+4]  = x[idx+4];
-<a name="line1397">1397: </a>      y[idy+5]  = x[idx+5];
-<a name="line1398">1398: </a>      y[idy+6]  = x[idx+6];
-<a name="line1399">1399: </a>      y[idy+7]  = x[idx+7];
-<a name="line1400">1400: </a>      y[idy+8]  = x[idx+8];
-<a name="line1401">1401: </a>      y[idy+9]  = x[idx+9];
-<a name="line1402">1402: </a>      y[idy+10] = x[idx+10];
-<a name="line1403">1403: </a>      y[idy+11] = x[idx+11];
-<a name="line1404">1404: </a>    }
-<a name="line1405">1405: </a>    <font color="#4169E1">break</font>;
-<a name="line1406">1406: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/ADD_VALUES.html#ADD_VALUES">ADD_VALUES</A>:
-<a name="line1407">1407: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1408">1408: </a>      idx       = *indicesx++;
-<a name="line1409">1409: </a>      idy       = *indicesy++;
-<a name="line1410">1410: </a>      y[idy]    += x[idx];
-<a name="line1411">1411: </a>      y[idy+1]  += x[idx+1];
-<a name="line1412">1412: </a>      y[idy+2]  += x[idx+2];
-<a name="line1413">1413: </a>      y[idy+3]  += x[idx+3];
-<a name="line1414">1414: </a>      y[idy+4]  += x[idx+4];
-<a name="line1415">1415: </a>      y[idy+5]  += x[idx+5];
-<a name="line1416">1416: </a>      y[idy+6]  += x[idx+6];
-<a name="line1417">1417: </a>      y[idy+7]  += x[idx+7];
-<a name="line1418">1418: </a>      y[idy+8]  += x[idx+8];
-<a name="line1419">1419: </a>      y[idy+9]  += x[idx+9];
-<a name="line1420">1420: </a>      y[idy+10] += x[idx+10];
-<a name="line1421">1421: </a>      y[idy+11] += x[idx+11];
-<a name="line1422">1422: </a>    }
-<a name="line1423">1423: </a>    <font color="#4169E1">break</font>;
-<a name="line1424">1424: </a><font color="#A020F0">#if !defined(PETSC_USE_COMPLEX)</font>
-<a name="line1425">1425: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1426">1426: </a>    <font color="#4169E1">for</font> (i=0; i&lt;n; i++) {
-<a name="line1427">1427: </a>      idx       = *indicesx++;
-<a name="line1428">1428: </a>      idy       = *indicesy++;
-<a name="line1429">1429: </a>      y[idy]    = PetscMax(y[idy],x[idx]);
-<a name="line1430">1430: </a>      y[idy+1]  = PetscMax(y[idy+1],x[idx+1]);
-<a name="line1431">1431: </a>      y[idy+2]  = PetscMax(y[idy+2],x[idx+2]);
-<a name="line1432">1432: </a>      y[idy+3]  = PetscMax(y[idy+3],x[idx+3]);
-<a name="line1433">1433: </a>      y[idy+4]  = PetscMax(y[idy+4],x[idx+4]);
-<a name="line1434">1434: </a>      y[idy+5]  = PetscMax(y[idy+5],x[idx+5]);
-<a name="line1435">1435: </a>      y[idy+6]  = PetscMax(y[idy+6],x[idx+6]);
-<a name="line1436">1436: </a>      y[idy+7]  = PetscMax(y[idy+7],x[idx+7]);
-<a name="line1437">1437: </a>      y[idy+8]  = PetscMax(y[idy+8],x[idx+8]);
-<a name="line1438">1438: </a>      y[idy+9]  = PetscMax(y[idy+9],x[idx+9]);
-<a name="line1439">1439: </a>      y[idy+10] = PetscMax(y[idy+10],x[idx+10]);
-<a name="line1440">1440: </a>      y[idy+11] = PetscMax(y[idy+11],x[idx+11]);
-<a name="line1441">1441: </a>    }
-<a name="line1442">1442: </a><font color="#A020F0">#else</font>
-<a name="line1443">1443: </a>  <font color="#4169E1">case</font> <A href="../../../../docs/manualpages/Sys/MAX_VALUES.html#MAX_VALUES">MAX_VALUES</A>:
-<a name="line1444">1444: </a><font color="#A020F0">#endif</font>
-<a name="line1445">1445: </a>  <font color="#4169E1">case</font> NOT_SET_VALUES:
-<a name="line1446">1446: </a>    <font color="#4169E1">break</font>;
-<a name="line1447">1447: </a>  }
-<a name="line1448">1448: </a>}
-
-<a name="line1450">1450: </a><font color="#B22222">/* Create the <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>/End_P for our chosen block sizes */</font>
-<a name="line1451">1451: </a><strong><font color="#228B22">#define BS 1</font></strong>
-<a name="line1452">1452: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1453">1453: </a><strong><font color="#228B22">#define BS 2</font></strong>
+<a name="line1452">1452: </a><font color="#B22222">/* Create the <A href="../../../../docs/manualpages/Vec/VecScatterBegin.html#VecScatterBegin">VecScatterBegin</A>/End_P for our chosen block sizes */</font>
+<a name="line1453">1453: </a><strong><font color="#228B22">#define BS 1</font></strong>
 <a name="line1454">1454: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1455">1455: </a><strong><font color="#228B22">#define BS 3</font></strong>
+<a name="line1455">1455: </a><strong><font color="#228B22">#define BS 2</font></strong>
 <a name="line1456">1456: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1457">1457: </a><strong><font color="#228B22">#define BS 4</font></strong>
+<a name="line1457">1457: </a><strong><font color="#228B22">#define BS 3</font></strong>
 <a name="line1458">1458: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1459">1459: </a><strong><font color="#228B22">#define BS 5</font></strong>
+<a name="line1459">1459: </a><strong><font color="#228B22">#define BS 4</font></strong>
 <a name="line1460">1460: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1461">1461: </a><strong><font color="#228B22">#define BS 6</font></strong>
+<a name="line1461">1461: </a><strong><font color="#228B22">#define BS 5</font></strong>
 <a name="line1462">1462: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1463">1463: </a><strong><font color="#228B22">#define BS 7</font></strong>
+<a name="line1463">1463: </a><strong><font color="#228B22">#define BS 6</font></strong>
 <a name="line1464">1464: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1465">1465: </a><strong><font color="#228B22">#define BS 8</font></strong>
+<a name="line1465">1465: </a><strong><font color="#228B22">#define BS 7</font></strong>
 <a name="line1466">1466: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
-<a name="line1467">1467: </a><strong><font color="#228B22">#define BS 12</font></strong>
+<a name="line1467">1467: </a><strong><font color="#228B22">#define BS 8</font></strong>
 <a name="line1468">1468: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
+<a name="line1469">1469: </a><strong><font color="#228B22">#define BS 12</font></strong>
+<a name="line1470">1470: </a> #include <A href="../../../../include/../src/vec/vec/utils/vpscat.h.html">../src/vec/vec/utils/vpscat.h</A>
 
-<a name="line1470">1470: </a><font color="#B22222">/* ==========================================================================================*/</font>
+<a name="line1472">1472: </a><font color="#B22222">/* ==========================================================================================*/</font>
 
-<a name="line1472">1472: </a><font color="#B22222">/*              create parallel to sequential scatter context                           */</font>
+<a name="line1474">1474: </a><font color="#B22222">/*              create parallel to sequential scatter context                           */</font>
 
-<a name="line1474">1474: </a><strong><font color="#4169E1"><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreateCommon_PtoS(VecScatter_MPI_General *,VecScatter_MPI_General *,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A>)</font></strong>;
+<a name="line1476">1476: </a><strong><font color="#4169E1"><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreateCommon_PtoS(VecScatter_MPI_General *,VecScatter_MPI_General *,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A>)</font></strong>;
 
-<a name="line1478">1478: </a><font color="#B22222">/*@</font>
-<a name="line1479">1479: </a><font color="#B22222">     <A href="../../../../docs/manualpages/Vec/VecScatterCreateLocal.html#VecScatterCreateLocal">VecScatterCreateLocal</A> - Creates a <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> from a list of messages it must send and receive.</font>
-
-<a name="line1481">1481: </a><font color="#B22222">     Collective on <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A></font>
-
-<a name="line1483">1483: </a><font color="#B22222">   Input Parameters:</font>
-<a name="line1484">1484: </a><font color="#B22222">+     <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> - obtained with VecScatterCreateEmpty()</font>
-<a name="line1485">1485: </a><font color="#B22222">.     nsends -</font>
-<a name="line1486">1486: </a><font color="#B22222">.     sendSizes -</font>
-<a name="line1487">1487: </a><font color="#B22222">.     sendProcs -</font>
-<a name="line1488">1488: </a><font color="#B22222">.     sendIdx - indices where the sent entries are obtained from (in local, on process numbering), this is one long array of size \sum_{i=0,i&lt;nsends} sendSizes[i]</font>
-<a name="line1489">1489: </a><font color="#B22222">.     nrecvs - number of receives to expect</font>
-<a name="line1490">1490: </a><font color="#B22222">.     recvSizes - </font>
-<a name="line1491">1491: </a><font color="#B22222">.     recvProcs - processes who are sending to me</font>
-<a name="line1492">1492: </a><font color="#B22222">.     recvIdx - indices of where received entries are to be put, (in local, on process numbering), this is one long array of size \sum_{i=0,i&lt;nrecvs} recvSizes[i]</font>
-<a name="line1493">1493: </a><font color="#B22222">-     bs - size of block</font>
-
-<a name="line1495">1495: </a><font color="#B22222">     Notes:  sendSizes[] and recvSizes[] cannot have any 0 entries. If you want to support having 0 entries you need</font>
-<a name="line1496">1496: </a><font color="#B22222">      to change the code below to "compress out" the sendProcs[] and recvProcs[] entries that have 0 entries.</font>
-
-<a name="line1498">1498: </a><font color="#B22222">       Probably does not handle sends to self properly. It should remove those from the counts that are used</font>
-<a name="line1499">1499: </a><font color="#B22222">      in allocating space inside of the from struct</font>
-
-<a name="line1501">1501: </a><font color="#B22222">  Level: intermediate</font>
-
-<a name="line1503">1503: </a><font color="#B22222">@*/</font>
-<a name="line1504">1504: </a><strong><font color="#4169E1"><a name="VecScatterCreateLocal"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> <A href="../../../../docs/manualpages/Vec/VecScatterCreateLocal.html#VecScatterCreateLocal">VecScatterCreateLocal</A>(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nsends,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> sendSizes[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> sendProcs[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> sendIdx[],<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nrecvs,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> recvSizes[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> recvProcs[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> recvIdx[],<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs)</font></strong>
-<a name="line1505">1505: </a>{
-<a name="line1506">1506: </a>  VecScatter_MPI_General *from, *to;
-<a name="line1507">1507: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               sendSize, recvSize;
-<a name="line1508">1508: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               n, i;
-<a name="line1509">1509: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
-
-<a name="line1511">1511: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
-<a name="line1512">1512: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;to);
-<a name="line1513">1513: </a>  to-&gt;n = nsends;
-<a name="line1514">1514: </a>  <font color="#4169E1">for</font>(n = 0, sendSize = 0; n &lt; to-&gt;n; n++) {sendSize += sendSizes[n];}
-<a name="line1515">1515: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;to-&gt;requests);
-<a name="line1516">1516: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*sendSize,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;to-&gt;values,sendSize,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;indices,to-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;starts,to-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;procs);
-<a name="line1517">1517: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(to-&gt;n,nrecvs),MPI_Status,&amp;to-&gt;sstatus,PetscMax(to-&gt;n,nrecvs),MPI_Status,&amp;to-&gt;rstatus);
-<a name="line1518">1518: </a>  to-&gt;starts[0] = 0;
-<a name="line1519">1519: </a>  <font color="#4169E1">for</font>(n = 0; n &lt; to-&gt;n; n++) {
-<a name="line1520">1520: </a>    <font color="#4169E1">if</font> (sendSizes[n] &lt;=0 ) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"sendSizes[n=%D] = %D cannot be less than 1"</font>,n,sendSizes[n]);
-<a name="line1521">1521: </a>    to-&gt;starts[n+1] = to-&gt;starts[n] + sendSizes[n];
-<a name="line1522">1522: </a>    to-&gt;procs[n] = sendProcs[n];
-<a name="line1523">1523: </a>    <font color="#4169E1">for</font>(i = to-&gt;starts[n]; i &lt; to-&gt;starts[n]+sendSizes[n]; i++) {
-<a name="line1524">1524: </a>      to-&gt;indices[i] = sendIdx[i];
-<a name="line1525">1525: </a>    }
-<a name="line1526">1526: </a>  }
-<a name="line1527">1527: </a>  ctx-&gt;todata = (void *) to;
-
-<a name="line1529">1529: </a>  <font color="#B22222">/* allocate entire receive scatter context */</font>
-<a name="line1530">1530: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;from);
-<a name="line1531">1531: </a>  from-&gt;n = nrecvs;
-<a name="line1532">1532: </a>  <font color="#4169E1">for</font>(n = 0, recvSize = 0; n &lt; from-&gt;n; n++) {recvSize += recvSizes[n];}
-<a name="line1533">1533: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;from-&gt;requests);
-<a name="line1534">1534: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*recvSize,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;from-&gt;values,recvSize,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;indices,from-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;starts,from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;procs);
-<a name="line1535">1535: </a>  from-&gt;starts[0] = 0;
-<a name="line1536">1536: </a>  <font color="#4169E1">for</font>(n = 0; n &lt; from-&gt;n; n++) {
-<a name="line1537">1537: </a>    <font color="#4169E1">if</font> (recvSizes[n] &lt;=0 ) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"recvSizes[n=%D] = %D cannot be less than 1"</font>,n,recvSizes[n]);
-<a name="line1538">1538: </a>    from-&gt;starts[n+1] = from-&gt;starts[n] + recvSizes[n];
-<a name="line1539">1539: </a>    from-&gt;procs[n] = recvProcs[n];
-<a name="line1540">1540: </a>    <font color="#4169E1">for</font>(i = from-&gt;starts[n]; i &lt; from-&gt;starts[n]+recvSizes[n]; i++) {
-<a name="line1541">1541: </a>      from-&gt;indices[i] = recvIdx[i];
-<a name="line1542">1542: </a>    }
-<a name="line1543">1543: </a>  }
-<a name="line1544">1544: </a>  ctx-&gt;fromdata = (void *)from;
-
-<a name="line1546">1546: </a>  <font color="#B22222">/* No local scatter optimization */</font>
-<a name="line1547">1547: </a>  from-&gt;local.n      = 0;
-<a name="line1548">1548: </a>  from-&gt;local.vslots = 0;
-<a name="line1549">1549: </a>  to-&gt;local.n        = 0;
-<a name="line1550">1550: </a>  to-&gt;local.vslots   = 0;
-<a name="line1551">1551: </a>  from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1552">1552: </a>  from-&gt;local.n_nonmatching        = 0;
-<a name="line1553">1553: </a>  from-&gt;local.slots_nonmatching    = 0;
-<a name="line1554">1554: </a>  to-&gt;local.nonmatching_computed   = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1555">1555: </a>  to-&gt;local.n_nonmatching          = 0;
-<a name="line1556">1556: </a>  to-&gt;local.slots_nonmatching      = 0;
-
-<a name="line1558">1558: </a>  from-&gt;type = VEC_SCATTER_MPI_GENERAL;
-<a name="line1559">1559: </a>  to-&gt;type   = VEC_SCATTER_MPI_GENERAL;
-<a name="line1560">1560: </a>  from-&gt;bs = bs;
-<a name="line1561">1561: </a>  to-&gt;bs   = bs;
-<a name="line1562">1562: </a>  VecScatterCreateCommon_PtoS(from, to, ctx);
-<a name="line1563">1563: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1564">1564: </a>}
-
-<a name="line1566">1566: </a><font color="#B22222">/*</font>
-<a name="line1567">1567: </a><font color="#B22222">   bs indicates how many elements there are in each block. Normally this would be 1.</font>
-
-<a name="line1569">1569: </a><font color="#B22222">   contains check that <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> can handle the sizes needed </font>
-<a name="line1570">1570: </a><font color="#B22222">*/</font>
-<a name="line1573">1573: </a><strong><font color="#4169E1"><a name="VecScatterCreate_PtoS"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreate_PtoS(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nx,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ny,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidy,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> yin,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
-<a name="line1574">1574: </a>{
-<a name="line1575">1575: </a>  VecScatter_MPI_General *from,*to;
-<a name="line1576">1576: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            size,rank,imdex,tag,n;
-<a name="line1577">1577: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *source = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*owners = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line1578">1578: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *lowner = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*start = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,lengthy,lengthx;
-<a name="line1579">1579: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            *nprocs = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,nrecvs;
-<a name="line1580">1580: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               i,j,idx,nsends;
-<a name="line1581">1581: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *owner = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*starts = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,count,slen;
-<a name="line1582">1582: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *rvalues,*svalues,base,*values,nprocslocal,recvtotal,*rsvalues;
-<a name="line1583">1583: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            *onodes1,*olengths1;
-<a name="line1584">1584: </a>  <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>               comm;
-<a name="line1585">1585: </a>  MPI_Request            *send_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*recv_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line1586">1586: </a>  MPI_Status             recv_status,*send_status;
-<a name="line1587">1587: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
-
-<a name="line1590">1590: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;tag);
-<a name="line1591">1591: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetComm.html#PetscObjectGetComm">PetscObjectGetComm</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin,&amp;comm);
-<a name="line1592">1592: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line1593">1593: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
-<a name="line1594">1594: </a>  owners = xin-&gt;map-&gt;range;
-<a name="line1595">1595: </a>  <A href="../../../../docs/manualpages/Vec/VecGetSize.html#VecGetSize">VecGetSize</A>(yin,&amp;lengthy);
-<a name="line1596">1596: </a>  <A href="../../../../docs/manualpages/Vec/VecGetSize.html#VecGetSize">VecGetSize</A>(xin,&amp;lengthx);
-
-<a name="line1598">1598: </a>  <font color="#B22222">/*  first count number of contributors to each processor */</font>
-<a name="line1599">1599: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;nprocs,nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;owner);
-<a name="line1600">1600: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(nprocs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1601">1601: </a>  j      = 0;
-<a name="line1602">1602: </a>  nsends = 0;
-<a name="line1603">1603: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
-<a name="line1604">1604: </a>    idx = inidx[i];
-<a name="line1605">1605: </a>    <font color="#4169E1">if</font> (idx &lt; owners[j]) j = 0;
-<a name="line1606">1606: </a>    <font color="#4169E1">for</font> (; j&lt;size; j++) {
-<a name="line1607">1607: </a>      <font color="#4169E1">if</font> (idx &lt; owners[j+1]) {
-<a name="line1608">1608: </a>        <font color="#4169E1">if</font> (!nprocs[j]++) nsends++;
-<a name="line1609">1609: </a>        owner[i] = j;
-<a name="line1610">1610: </a>        <font color="#4169E1">break</font>;
-<a name="line1611">1611: </a>      }
-<a name="line1612">1612: </a>    }
-<a name="line1613">1613: </a>  }
-<a name="line1614">1614: </a>  nprocslocal  = nprocs[rank];
-<a name="line1615">1615: </a>  nprocs[rank] = 0;
-<a name="line1616">1616: </a>  <font color="#4169E1">if</font> (nprocslocal) nsends--;
-<a name="line1617">1617: </a>  <font color="#B22222">/* inform other processors of number of messages and max length*/</font>
-<a name="line1618">1618: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherNumberOfMessages.html#PetscGatherNumberOfMessages">PetscGatherNumberOfMessages</A>(comm,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,nprocs,&amp;nrecvs);
-<a name="line1619">1619: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherMessageLengths.html#PetscGatherMessageLengths">PetscGatherMessageLengths</A>(comm,nsends,nrecvs,nprocs,&amp;onodes1,&amp;olengths1);
-<a name="line1620">1620: </a>  <A href="../../../../docs/manualpages/Sys/PetscSortMPIIntWithArray.html#PetscSortMPIIntWithArray">PetscSortMPIIntWithArray</A>(nrecvs,onodes1,olengths1);
-<a name="line1621">1621: </a>  recvtotal = 0; <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) recvtotal += olengths1[i];
-
-<a name="line1623">1623: </a>  <font color="#B22222">/* post receives:   */</font>
-<a name="line1624">1624: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(recvtotal,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;rvalues,nrecvs,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;source,nrecvs,MPI_Request,&amp;recv_waits);
-<a name="line1625">1625: </a>  count  = 0;
-<a name="line1626">1626: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
-<a name="line1627">1627: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>((rvalues+count),olengths1[i],MPIU_INT,onodes1[i],tag,comm,recv_waits+i);
-<a name="line1628">1628: </a>    count += olengths1[i];
-<a name="line1629">1629: </a>  }
-
-<a name="line1631">1631: </a>  <font color="#B22222">/* do sends:</font>
-<a name="line1632">1632: </a><font color="#B22222">     1) starts[i] gives the starting index in svalues for stuff going to </font>
-<a name="line1633">1633: </a><font color="#B22222">     the ith processor</font>
-<a name="line1634">1634: </a><font color="#B22222">  */</font>
-<a name="line1635">1635: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;svalues,nsends,MPI_Request,&amp;send_waits,size+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;starts);
-<a name="line1636">1636: </a>  starts[0]  = 0;
-<a name="line1637">1637: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
-<a name="line1638">1638: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
-<a name="line1639">1639: </a>    <font color="#4169E1">if</font> (owner[i] != rank) {
-<a name="line1640">1640: </a>      svalues[starts[owner[i]]++] = inidx[i];
-<a name="line1641">1641: </a>    }
-<a name="line1642">1642: </a>  }
-
-<a name="line1644">1644: </a>  starts[0] = 0;
-<a name="line1645">1645: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size+1; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
-<a name="line1646">1646: </a>  count = 0;
-<a name="line1647">1647: </a>  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
-<a name="line1648">1648: </a>    <font color="#4169E1">if</font> (nprocs[i]) {
-<a name="line1649">1649: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Isend.html#MPI_Isend">MPI_Isend</A>(svalues+starts[i],nprocs[i],MPIU_INT,i,tag,comm,send_waits+count++);
-<a name="line1650">1650: </a>    }
-<a name="line1651">1651: </a>  }
-
-<a name="line1653">1653: </a>  <font color="#B22222">/*  wait on receives */</font>
-<a name="line1654">1654: </a>  count  = nrecvs;
-<a name="line1655">1655: </a>  slen   = 0;
-<a name="line1656">1656: </a>  <font color="#4169E1">while</font> (count) {
-<a name="line1657">1657: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitany.html#MPI_Waitany">MPI_Waitany</A>(nrecvs,recv_waits,&amp;imdex,&amp;recv_status);
-<a name="line1658">1658: </a>    <font color="#B22222">/* unpack receives into our local space */</font>
-<a name="line1659">1659: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Get_count.html#MPI_Get_count">MPI_Get_count</A>(&amp;recv_status,MPIU_INT,&amp;n);
-<a name="line1660">1660: </a>    slen += n;
-<a name="line1661">1661: </a>    count--;
-<a name="line1662">1662: </a>  }
-
-<a name="line1664">1664: </a>  <font color="#4169E1">if</font> (slen != recvtotal) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_PLIB,<font color="#666666">"Total message lengths %D not expected %D"</font>,slen,recvtotal);
-<a name="line1665">1665: </a>
-<a name="line1666">1666: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
-<a name="line1667">1667: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;to);
-<a name="line1668">1668: </a>  to-&gt;n = nrecvs;
-<a name="line1669">1669: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nrecvs*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;to-&gt;requests);
-<a name="line1670">1670: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*slen,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;to-&gt;values,slen,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;indices,nrecvs+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;starts,nrecvs,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;procs);
-<a name="line1671">1671: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(to-&gt;n,nsends),MPI_Status,&amp;to-&gt;sstatus,PetscMax(to-&gt;n,nsends),MPI_Status,&amp;to-&gt;rstatus);
-<a name="line1672">1672: </a>  ctx-&gt;todata   = (void*)to;
-<a name="line1673">1673: </a>  to-&gt;starts[0] = 0;
-
-<a name="line1675">1675: </a>  <font color="#4169E1">if</font> (nrecvs) {
-
-<a name="line1677">1677: </a>    <font color="#B22222">/* move the data into the send scatter */</font>
-<a name="line1678">1678: </a>    base     = owners[rank];
-<a name="line1679">1679: </a>    rsvalues = rvalues;
-<a name="line1680">1680: </a>    <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
-<a name="line1681">1681: </a>      to-&gt;starts[i+1] = to-&gt;starts[i] + olengths1[i];
-<a name="line1682">1682: </a>      to-&gt;procs[i]    = onodes1[i];
-<a name="line1683">1683: </a>      values = rsvalues;
-<a name="line1684">1684: </a>      rsvalues += olengths1[i];
-<a name="line1685">1685: </a>      <font color="#4169E1">for</font> (j=0; j&lt;olengths1[i]; j++) {
-<a name="line1686">1686: </a>        to-&gt;indices[to-&gt;starts[i] + j] = values[j] - base;
-<a name="line1687">1687: </a>      }
-<a name="line1688">1688: </a>    }
-<a name="line1689">1689: </a>  }
-<a name="line1690">1690: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(olengths1);
-<a name="line1691">1691: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(onodes1);
-<a name="line1692">1692: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(rvalues,source,recv_waits);
-
-<a name="line1694">1694: </a>  <font color="#B22222">/* allocate entire receive scatter context */</font>
-<a name="line1695">1695: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;from);
-<a name="line1696">1696: </a>  from-&gt;n = nsends;
-
-<a name="line1698">1698: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nsends*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;from-&gt;requests);
-<a name="line1699">1699: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>((ny-nprocslocal)*bs,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;from-&gt;values,ny-nprocslocal,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;indices,nsends+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;starts,from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;procs);
-<a name="line1700">1700: </a>  ctx-&gt;fromdata  = (void*)from;
-
-<a name="line1702">1702: </a>  <font color="#B22222">/* move data into receive scatter */</font>
-<a name="line1703">1703: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;lowner,nsends+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;start);
-<a name="line1704">1704: </a>  count = 0; from-&gt;starts[0] = start[0] = 0;
-<a name="line1705">1705: </a>  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
-<a name="line1706">1706: </a>    <font color="#4169E1">if</font> (nprocs[i]) {
-<a name="line1707">1707: </a>      lowner[i]            = count;
-<a name="line1708">1708: </a>      from-&gt;procs[count++] = i;
-<a name="line1709">1709: </a>      from-&gt;starts[count]  = start[count] = start[count-1] + nprocs[i];
-<a name="line1710">1710: </a>    }
-<a name="line1711">1711: </a>  }
-
-<a name="line1713">1713: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
-<a name="line1714">1714: </a>    <font color="#4169E1">if</font> (owner[i] != rank) {
-<a name="line1715">1715: </a>      from-&gt;indices[start[lowner[owner[i]]]++] = inidy[i];
-<a name="line1716">1716: </a>      <font color="#4169E1">if</font> (inidy[i] &gt;= lengthy) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Scattering past end of TO vector"</font>);
-<a name="line1717">1717: </a>    }
-<a name="line1718">1718: </a>  }
-<a name="line1719">1719: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(lowner,start);
-<a name="line1720">1720: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(nprocs,owner);
-<a name="line1721">1721: </a>
-<a name="line1722">1722: </a>  <font color="#B22222">/* wait on sends */</font>
-<a name="line1723">1723: </a>  <font color="#4169E1">if</font> (nsends) {
-<a name="line1724">1724: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nsends*<font color="#4169E1">sizeof</font>(MPI_Status),&amp;send_status);
-<a name="line1725">1725: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(nsends,send_waits,send_status);
-<a name="line1726">1726: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(send_status);
-<a name="line1727">1727: </a>  }
-<a name="line1728">1728: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(svalues,send_waits,starts);
-
-<a name="line1730">1730: </a>  <font color="#4169E1">if</font> (nprocslocal) {
-<a name="line1731">1731: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nt = from-&gt;local.n = to-&gt;local.n = nprocslocal;
-<a name="line1732">1732: </a>    <font color="#B22222">/* we have a scatter to ourselves */</font>
-<a name="line1733">1733: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nt*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;to-&gt;local.vslots);
-<a name="line1734">1734: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nt*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;from-&gt;local.vslots);
-<a name="line1735">1735: </a>    nt   = 0;
-<a name="line1736">1736: </a>    <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
-<a name="line1737">1737: </a>      idx = inidx[i];
-<a name="line1738">1738: </a>      <font color="#4169E1">if</font> (idx &gt;= owners[rank] &amp;&amp; idx &lt; owners[rank+1]) {
-<a name="line1739">1739: </a>        to-&gt;local.vslots[nt]     = idx - owners[rank];
-<a name="line1740">1740: </a>        from-&gt;local.vslots[nt++] = inidy[i];
-<a name="line1741">1741: </a>        <font color="#4169E1">if</font> (inidy[i] &gt;= lengthy) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Scattering past end of TO vector"</font>);
-<a name="line1742">1742: </a>      }
-<a name="line1743">1743: </a>    }
-<a name="line1744">1744: </a>  } <font color="#4169E1">else</font> {
-<a name="line1745">1745: </a>    from-&gt;local.n      = 0;
-<a name="line1746">1746: </a>    from-&gt;local.vslots = 0;
-<a name="line1747">1747: </a>    to-&gt;local.n        = 0;
-<a name="line1748">1748: </a>    to-&gt;local.vslots   = 0;
-<a name="line1749">1749: </a>  }
-
-<a name="line1751">1751: </a>  from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1752">1752: </a>  from-&gt;local.n_nonmatching        = 0;
-<a name="line1753">1753: </a>  from-&gt;local.slots_nonmatching    = 0;
-<a name="line1754">1754: </a>  to-&gt;local.nonmatching_computed   = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1755">1755: </a>  to-&gt;local.n_nonmatching          = 0;
-<a name="line1756">1756: </a>  to-&gt;local.slots_nonmatching      = 0;
-
-<a name="line1758">1758: </a>  from-&gt;type = VEC_SCATTER_MPI_GENERAL;
-<a name="line1759">1759: </a>  to-&gt;type   = VEC_SCATTER_MPI_GENERAL;
-<a name="line1760">1760: </a>  from-&gt;bs = bs;
-<a name="line1761">1761: </a>  to-&gt;bs   = bs;
-<a name="line1762">1762: </a>  VecScatterCreateCommon_PtoS(from,to,ctx);
-<a name="line1763">1763: </a>  <font color="#4169E1">return</font>(0);
-<a name="line1764">1764: </a>}
-
-<a name="line1766">1766: </a><font color="#B22222">/*</font>
-<a name="line1767">1767: </a><font color="#B22222">   bs indicates how many elements there are in each block. Normally this would be 1.</font>
-<a name="line1768">1768: </a><font color="#B22222">*/</font>
-<a name="line1771">1771: </a><strong><font color="#4169E1"><a name="VecScatterCreateCommon_PtoS"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreateCommon_PtoS(VecScatter_MPI_General *from,VecScatter_MPI_General *to,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
-<a name="line1772">1772: </a>{
-<a name="line1773">1773: </a>  <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>       comm = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx)-&gt;comm;
-<a name="line1774">1774: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    tag  = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx)-&gt;tag, tagr;
-<a name="line1775">1775: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       bs   = to-&gt;bs;
-<a name="line1776">1776: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
-<a name="line1777">1777: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i, n;
-<a name="line1779">1779: </a>
-<a name="line1781">1781: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;tagr);
-<a name="line1782">1782: </a>  ctx-&gt;destroy = VecScatterDestroy_PtoP;
-
-<a name="line1784">1784: </a>  ctx-&gt;reproduce = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1785">1785: </a>  to-&gt;sendfirst  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1786">1786: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_reproduce"</font>,&amp;ctx-&gt;reproduce,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1787">1787: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_sendfirst"</font>,&amp;to-&gt;sendfirst,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1788">1788: </a>  from-&gt;sendfirst = to-&gt;sendfirst;
-
-<a name="line1790">1790: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
-<a name="line1791">1791: </a>  <font color="#B22222">/* check if the receives are ALL going into contiguous locations; if so can skip indexing */</font>
-<a name="line1792">1792: </a>  to-&gt;contiq = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1793">1793: </a>  n = from-&gt;starts[from-&gt;n];
-<a name="line1794">1794: </a>  from-&gt;contiq = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1795">1795: </a>  <font color="#4169E1">for</font> (i=1; i&lt;n; i++) {
-<a name="line1796">1796: </a>    <font color="#4169E1">if</font> (from-&gt;indices[i] != from-&gt;indices[i-1] + bs) {
-<a name="line1797">1797: </a>      from-&gt;contiq = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1798">1798: </a>      <font color="#4169E1">break</font>;
-<a name="line1799">1799: </a>    }
-<a name="line1800">1800: </a>  }
-
-<a name="line1802">1802: </a>  to-&gt;use_alltoallv = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1803">1803: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_alltoall"</font>,&amp;to-&gt;use_alltoallv,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1804">1804: </a>  from-&gt;use_alltoallv = to-&gt;use_alltoallv;
-<a name="line1805">1805: </a>  <font color="#4169E1">if</font> (from-&gt;use_alltoallv) <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Alltoallv.html#MPI_Alltoallv">MPI_Alltoallv</A>() for scatter\n"</font>);
-<a name="line1806">1806: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_ALLTOALLW)  &amp;&amp; !defined(PETSC_USE_64BIT_INDICES)</font>
-<a name="line1807">1807: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallv) {
-<a name="line1808">1808: </a>    to-&gt;use_alltoallw = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1809">1809: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_nopack"</font>,&amp;to-&gt;use_alltoallw,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1810">1810: </a>  }
-<a name="line1811">1811: </a>  from-&gt;use_alltoallw = to-&gt;use_alltoallw;
-<a name="line1812">1812: </a>  <font color="#4169E1">if</font> (from-&gt;use_alltoallw) <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using MPI_Alltoallw() for scatter\n"</font>);
-<a name="line1813">1813: </a><font color="#A020F0">#endif</font>
-
-<a name="line1815">1815: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_WIN_CREATE)</font>
-<a name="line1816">1816: </a>  to-&gt;use_window = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1817">1817: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_window"</font>,&amp;to-&gt;use_window,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1818">1818: </a>  from-&gt;use_window = to-&gt;use_window;
-<a name="line1819">1819: </a><font color="#A020F0">#endif</font>
-
-<a name="line1821">1821: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallv) {
-
-<a name="line1823">1823: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;displs);
-<a name="line1824">1824: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(to-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1825">1825: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line1826">1826: </a>      to-&gt;counts[to-&gt;procs[i]] = bs*(to-&gt;starts[i+1] - to-&gt;starts[i]);
-<a name="line1827">1827: </a>    }
-<a name="line1828">1828: </a>    to-&gt;displs[0] = 0;
-<a name="line1829">1829: </a>    <font color="#4169E1">for</font> (i=1; i&lt;size; i++) {
-<a name="line1830">1830: </a>      to-&gt;displs[i] = to-&gt;displs[i-1] + to-&gt;counts[i-1];
-<a name="line1831">1831: </a>    }
-
-<a name="line1833">1833: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;displs);
-<a name="line1834">1834: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(from-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1835">1835: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1836">1836: </a>      from-&gt;counts[from-&gt;procs[i]] = bs*(from-&gt;starts[i+1] - from-&gt;starts[i]);
-<a name="line1837">1837: </a>    }
-<a name="line1838">1838: </a>    from-&gt;displs[0] = 0;
-<a name="line1839">1839: </a>    <font color="#4169E1">for</font> (i=1; i&lt;size; i++) {
-<a name="line1840">1840: </a>      from-&gt;displs[i] = from-&gt;displs[i-1] + from-&gt;counts[i-1];
-<a name="line1841">1841: </a>    }
-<a name="line1842">1842: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_ALLTOALLW) &amp;&amp; !defined(PETSC_USE_64BIT_INDICES)</font>
-<a name="line1843">1843: </a>    <font color="#4169E1">if</font> (to-&gt;use_alltoallw) {
-<a name="line1844">1844: </a>      <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> mpibs = PetscMPIIntCast(bs), mpilen;
-<a name="line1845">1845: </a>      ctx-&gt;packtogether = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1846">1846: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;wcounts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;wdispls,size,MPI_Datatype,&amp;to-&gt;types);
-<a name="line1847">1847: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(to-&gt;wcounts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1848">1848: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(to-&gt;wdispls,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1849">1849: </a>      <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
-<a name="line1850">1850: </a>        to-&gt;types[i] = <A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>;
-<a name="line1851">1851: </a>      }
-
-<a name="line1853">1853: </a>      <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line1854">1854: </a>        to-&gt;wcounts[to-&gt;procs[i]] = 1;
-<a name="line1855">1855: </a>        mpilen = PetscMPIIntCast(to-&gt;starts[i+1]-to-&gt;starts[i]);
-<a name="line1856">1856: </a>        MPI_Type_create_indexed_block(mpilen,mpibs,to-&gt;indices+to-&gt;starts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,to-&gt;types+to-&gt;procs[i]);
-<a name="line1857">1857: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_commit.html#MPI_Type_commit">MPI_Type_commit</A>(to-&gt;types+to-&gt;procs[i]);
-<a name="line1858">1858: </a>      }
-<a name="line1859">1859: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;wcounts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;wdispls,size,MPI_Datatype,&amp;from-&gt;types);
-<a name="line1860">1860: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(from-&gt;wcounts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1861">1861: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(from-&gt;wdispls,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line1862">1862: </a>      <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
-<a name="line1863">1863: </a>        from-&gt;types[i] = <A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>;
-<a name="line1864">1864: </a>      }
-<a name="line1865">1865: </a>      <font color="#4169E1">if</font> (from-&gt;contiq) {
-<a name="line1866">1866: </a>        <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Scattered vector entries are stored contiquously, taking advantage of this with -vecscatter_alltoall\n"</font>);
-<a name="line1867">1867: </a>        <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1868">1868: </a>          from-&gt;wcounts[from-&gt;procs[i]] = bs*(from-&gt;starts[i+1] - from-&gt;starts[i]);
-<a name="line1869">1869: </a>        }
-<a name="line1870">1870: </a>        <font color="#4169E1">if</font> (from-&gt;n) from-&gt;wdispls[from-&gt;procs[0]] = <font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*from-&gt;indices[0];
-<a name="line1871">1871: </a>        <font color="#4169E1">for</font> (i=1; i&lt;from-&gt;n; i++) {
-<a name="line1872">1872: </a>          from-&gt;wdispls[from-&gt;procs[i]] = from-&gt;wdispls[from-&gt;procs[i-1]] + <font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*from-&gt;wcounts[from-&gt;procs[i-1]];
-<a name="line1873">1873: </a>        }
-<a name="line1874">1874: </a>      } <font color="#4169E1">else</font> {
-<a name="line1875">1875: </a>        <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1876">1876: </a>          from-&gt;wcounts[from-&gt;procs[i]] = 1;
-<a name="line1877">1877: </a>          mpilen = PetscMPIIntCast(from-&gt;starts[i+1]-from-&gt;starts[i]);
-<a name="line1878">1878: </a>          MPI_Type_create_indexed_block(mpilen,mpibs,from-&gt;indices+from-&gt;starts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,from-&gt;types+from-&gt;procs[i]);
-<a name="line1879">1879: </a>          <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_commit.html#MPI_Type_commit">MPI_Type_commit</A>(from-&gt;types+from-&gt;procs[i]);
-<a name="line1880">1880: </a>        }
-<a name="line1881">1881: </a>      }
-<a name="line1882">1882: </a>    } <font color="#4169E1">else</font> {
-<a name="line1883">1883: </a>      ctx-&gt;copy = VecScatterCopy_PtoP_AllToAll;
-<a name="line1884">1884: </a>    }
-<a name="line1885">1885: </a><font color="#A020F0">#else </font>
-<a name="line1886">1886: </a>    to-&gt;use_alltoallw   = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1887">1887: </a>    from-&gt;use_alltoallw = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1888">1888: </a>    ctx-&gt;copy           = VecScatterCopy_PtoP_AllToAll;
-<a name="line1889">1889: </a><font color="#A020F0">#endif</font>
-<a name="line1890">1890: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_WIN_CREATE)</font>
-<a name="line1891">1891: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (to-&gt;use_window) {
-<a name="line1892">1892: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> temptag,winsize;
-<a name="line1893">1893: </a>    MPI_Request *request;
-<a name="line1894">1894: </a>    MPI_Status  *status;
-<a name="line1895">1895: </a>
-<a name="line1896">1896: </a>    <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;temptag);
-<a name="line1897">1897: </a>    winsize = (to-&gt;n ? to-&gt;starts[to-&gt;n] : 0)*bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>);
-<a name="line1898">1898: </a>    MPI_Win_create(to-&gt;values ? to-&gt;values : MPI_BOTTOM,winsize,<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),MPI_INFO_NULL,comm,&amp;to-&gt;window);
-<a name="line1899">1899: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(to-&gt;n,&amp;to-&gt;winstarts);
-<a name="line1900">1900: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(to-&gt;n,MPI_Request,&amp;request,to-&gt;n,MPI_Status,&amp;status);
-<a name="line1901">1901: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line1902">1902: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>(to-&gt;winstarts+i,1,MPIU_INT,to-&gt;procs[i],temptag,comm,request+i);
-<a name="line1903">1903: </a>    }
-<a name="line1904">1904: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1905">1905: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(from-&gt;starts+i,1,MPIU_INT,from-&gt;procs[i],temptag,comm);
-<a name="line1906">1906: </a>    }
-<a name="line1907">1907: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(to-&gt;n,request,status);
-<a name="line1908">1908: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(request,status);
-
-<a name="line1910">1910: </a>    winsize = (from-&gt;n ? from-&gt;starts[from-&gt;n] : 0)*bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>);
-<a name="line1911">1911: </a>    MPI_Win_create(from-&gt;values ? from-&gt;values : MPI_BOTTOM,winsize,<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),MPI_INFO_NULL,comm,&amp;from-&gt;window);
-<a name="line1912">1912: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(from-&gt;n,&amp;from-&gt;winstarts);
-<a name="line1913">1913: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(from-&gt;n,MPI_Request,&amp;request,from-&gt;n,MPI_Status,&amp;status);
-<a name="line1914">1914: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1915">1915: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>(from-&gt;winstarts+i,1,MPIU_INT,from-&gt;procs[i],temptag,comm,request+i);
-<a name="line1916">1916: </a>    }
-<a name="line1917">1917: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line1918">1918: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(to-&gt;starts+i,1,MPIU_INT,to-&gt;procs[i],temptag,comm);
-<a name="line1919">1919: </a>    }
-<a name="line1920">1920: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(from-&gt;n,request,status);
-<a name="line1921">1921: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(request,status);
-<a name="line1922">1922: </a><font color="#A020F0">#endif</font>
-<a name="line1923">1923: </a>  } <font color="#4169E1">else</font> {
-<a name="line1924">1924: </a>    <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>  use_rsend = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>, use_ssend = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1925">1925: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    *sstarts = to-&gt;starts,  *rstarts = from-&gt;starts;
-<a name="line1926">1926: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> *sprocs  = to-&gt;procs,   *rprocs  = from-&gt;procs;
-<a name="line1927">1927: </a>    MPI_Request *swaits  = to-&gt;requests,*rwaits  = from-&gt;requests;
-<a name="line1928">1928: </a>    MPI_Request *rev_swaits,*rev_rwaits;
-<a name="line1929">1929: </a>    <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *Ssvalues = to-&gt;values, *Srvalues = from-&gt;values;
-
-<a name="line1931">1931: </a>    <font color="#B22222">/* allocate additional wait variables for the "reverse" scatter */</font>
-<a name="line1932">1932: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;rev_rwaits);
-<a name="line1933">1933: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;rev_swaits);
-<a name="line1934">1934: </a>    to-&gt;rev_requests   = rev_rwaits;
-<a name="line1935">1935: </a>    from-&gt;rev_requests = rev_swaits;
-
-<a name="line1937">1937: </a>    <font color="#B22222">/* Register the receives that you will use later (sends for scatter reverse) */</font>
-<a name="line1938">1938: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_rsend"</font>,&amp;use_rsend,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1939">1939: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_ssend"</font>,&amp;use_ssend,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
-<a name="line1940">1940: </a>    <font color="#4169E1">if</font> (use_rsend) {
-<a name="line1941">1941: </a>      <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ready receiver mode\n"</font>);
-<a name="line1942">1942: </a>      to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1943">1943: </a>      from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line1944">1944: </a>    } <font color="#4169E1">else</font> {
-<a name="line1945">1945: </a>      to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1946">1946: </a>      from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line1947">1947: </a>    }
-<a name="line1948">1948: </a>    <font color="#4169E1">if</font> (use_ssend) {
-<a name="line1949">1949: </a>      <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> Ssend mode\n"</font>);
-<a name="line1950">1950: </a>    }
-
-<a name="line1952">1952: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1953">1953: </a>      <font color="#4169E1">if</font> (use_rsend) {
-<a name="line1954">1954: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Rsend_init.html#MPI_Rsend_init">MPI_Rsend_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tagr,comm,rev_swaits+i);
-<a name="line1955">1955: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (use_ssend) {
-<a name="line1956">1956: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Ssend_init.html#MPI_Ssend_init">MPI_Ssend_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tagr,comm,rev_swaits+i);
-<a name="line1957">1957: </a>      } <font color="#4169E1">else</font> {
-<a name="line1958">1958: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tagr,comm,rev_swaits+i);
-<a name="line1959">1959: </a>      }
-<a name="line1960">1960: </a>    }
-
-<a name="line1962">1962: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line1963">1963: </a>      <font color="#4169E1">if</font> (use_rsend) {
-<a name="line1964">1964: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Rsend_init.html#MPI_Rsend_init">MPI_Rsend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
-<a name="line1965">1965: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (use_ssend) {
-<a name="line1966">1966: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Ssend_init.html#MPI_Ssend_init">MPI_Ssend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
-<a name="line1967">1967: </a>      } <font color="#4169E1">else</font> {
-<a name="line1968">1968: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
-<a name="line1969">1969: </a>      }
-<a name="line1970">1970: </a>    }
-<a name="line1971">1971: </a>    <font color="#B22222">/* Register receives for scatter and reverse */</font>
-<a name="line1972">1972: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
-<a name="line1973">1973: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tag,comm,rwaits+i);
-<a name="line1974">1974: </a>    }
-<a name="line1975">1975: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
-<a name="line1976">1976: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tagr,comm,rev_rwaits+i);
-<a name="line1977">1977: </a>    }
-<a name="line1978">1978: </a>    <font color="#4169E1">if</font> (use_rsend) {
-<a name="line1979">1979: </a>      <font color="#4169E1">if</font> (to-&gt;n)   {MPI_Startall_irecv(to-&gt;starts[to-&gt;n]*to-&gt;bs,to-&gt;n,to-&gt;rev_requests);}
-<a name="line1980">1980: </a>      <font color="#4169E1">if</font> (from-&gt;n) {MPI_Startall_irecv(from-&gt;starts[from-&gt;n]*from-&gt;bs,from-&gt;n,from-&gt;requests);}
-<a name="line1981">1981: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Barrier.html#MPI_Barrier">MPI_Barrier</A>(comm);
-<a name="line1982">1982: </a>    }
-
-<a name="line1984">1984: </a>    ctx-&gt;copy      = VecScatterCopy_PtoP_X;
-<a name="line1985">1985: </a>  }
-<a name="line1986">1986: </a>  PetscInfo1(ctx,<font color="#666666">"Using blocksize %D scatter\n"</font>,bs);
-<a name="line1987">1987: </a>  <font color="#4169E1">switch</font> (bs) {
-<a name="line1988">1988: </a>  <font color="#4169E1">case</font> 12:
-<a name="line1989">1989: </a>    ctx-&gt;begin     = VecScatterBegin_12;
-<a name="line1990">1990: </a>    ctx-&gt;end       = VecScatterEnd_12;
-<a name="line1991">1991: </a>    <font color="#4169E1">break</font>;
-<a name="line1992">1992: </a>  <font color="#4169E1">case</font> 8:
-<a name="line1993">1993: </a>    ctx-&gt;begin     = VecScatterBegin_8;
-<a name="line1994">1994: </a>    ctx-&gt;end       = VecScatterEnd_8;
-<a name="line1995">1995: </a>    <font color="#4169E1">break</font>;
-<a name="line1996">1996: </a>  <font color="#4169E1">case</font> 7:
-<a name="line1997">1997: </a>    ctx-&gt;begin     = VecScatterBegin_7;
-<a name="line1998">1998: </a>    ctx-&gt;end       = VecScatterEnd_7;
-<a name="line1999">1999: </a>    <font color="#4169E1">break</font>;
-<a name="line2000">2000: </a>  <font color="#4169E1">case</font> 6:
-<a name="line2001">2001: </a>    ctx-&gt;begin     = VecScatterBegin_6;
-<a name="line2002">2002: </a>    ctx-&gt;end       = VecScatterEnd_6;
-<a name="line2003">2003: </a>    <font color="#4169E1">break</font>;
-<a name="line2004">2004: </a>  <font color="#4169E1">case</font> 5:
-<a name="line2005">2005: </a>    ctx-&gt;begin     = VecScatterBegin_5;
-<a name="line2006">2006: </a>    ctx-&gt;end       = VecScatterEnd_5;
-<a name="line2007">2007: </a>    <font color="#4169E1">break</font>;
-<a name="line2008">2008: </a>  <font color="#4169E1">case</font> 4:
-<a name="line2009">2009: </a>    ctx-&gt;begin     = VecScatterBegin_4;
-<a name="line2010">2010: </a>    ctx-&gt;end       = VecScatterEnd_4;
-<a name="line2011">2011: </a>    <font color="#4169E1">break</font>;
-<a name="line2012">2012: </a>  <font color="#4169E1">case</font> 3:
-<a name="line2013">2013: </a>    ctx-&gt;begin     = VecScatterBegin_3;
-<a name="line2014">2014: </a>    ctx-&gt;end       = VecScatterEnd_3;
-<a name="line2015">2015: </a>    <font color="#4169E1">break</font>;
-<a name="line2016">2016: </a>  <font color="#4169E1">case</font> 2:
-<a name="line2017">2017: </a>    ctx-&gt;begin     = VecScatterBegin_2;
-<a name="line2018">2018: </a>    ctx-&gt;end       = VecScatterEnd_2;
-<a name="line2019">2019: </a>    <font color="#4169E1">break</font>;
-<a name="line2020">2020: </a>  <font color="#4169E1">case</font> 1:
-<a name="line2021">2021: </a>    ctx-&gt;begin     = VecScatterBegin_1;
-<a name="line2022">2022: </a>    ctx-&gt;end       = VecScatterEnd_1;
-<a name="line2023">2023: </a>    <font color="#4169E1">break</font>;
-<a name="line2024">2024: </a><strong><font color="#FF0000">  default:</font></strong>
-<a name="line2025">2025: </a>    <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Blocksize not supported"</font>);
-<a name="line2026">2026: </a>  }
-<a name="line2027">2027: </a>  ctx-&gt;view      = VecScatterView_MPI;
-<a name="line2028">2028: </a>  <font color="#B22222">/* Check if the local scatter is actually a copy; important special case */</font>
-<a name="line2029">2029: </a>  <font color="#4169E1">if</font> (to-&gt;local.n) {
-<a name="line2030">2030: </a>    VecScatterLocalOptimizeCopy_Private(ctx,&amp;to-&gt;local,&amp;from-&gt;local,bs);
-<a name="line2031">2031: </a>  }
-<a name="line2032">2032: </a>  <font color="#4169E1">return</font>(0);
-<a name="line2033">2033: </a>}
-
-
-
-<a name="line2037">2037: </a><font color="#B22222">/* ------------------------------------------------------------------------------------*/</font>
-<a name="line2038">2038: </a><font color="#B22222">/*</font>
-<a name="line2039">2039: </a><font color="#B22222">         Scatter from local Seq vectors to a parallel vector. </font>
-<a name="line2040">2040: </a><font color="#B22222">         Reverses the order of the arguments, calls VecScatterCreate_PtoS() then</font>
-<a name="line2041">2041: </a><font color="#B22222">         reverses the result.</font>
-<a name="line2042">2042: </a><font color="#B22222">*/</font>
-<a name="line2045">2045: </a><strong><font color="#4169E1"><a name="VecScatterCreate_StoP"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreate_StoP(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nx,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ny,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidy,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> yin,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
-<a name="line2046">2046: </a>{
-<a name="line2047">2047: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
-<a name="line2048">2048: </a>  MPI_Request            *waits;
-<a name="line2049">2049: </a>  VecScatter_MPI_General *to,*from;
-
-<a name="line2052">2052: </a>  VecScatterCreate_PtoS(ny,inidy,nx,inidx,yin,xin,bs,ctx);
-<a name="line2053">2053: </a>  to            = (VecScatter_MPI_General*)ctx-&gt;fromdata;
-<a name="line2054">2054: </a>  from          = (VecScatter_MPI_General*)ctx-&gt;todata;
-<a name="line2055">2055: </a>  ctx-&gt;todata   = (void*)to;
-<a name="line2056">2056: </a>  ctx-&gt;fromdata = (void*)from;
-<a name="line2057">2057: </a>  <font color="#B22222">/* these two are special, they are ALWAYS stored in to struct */</font>
-<a name="line2058">2058: </a>  to-&gt;sstatus   = from-&gt;sstatus;
-<a name="line2059">2059: </a>  to-&gt;rstatus   = from-&gt;rstatus;
-
-<a name="line2061">2061: </a>  from-&gt;sstatus = 0;
-<a name="line2062">2062: </a>  from-&gt;rstatus = 0;
-
-<a name="line2064">2064: </a>  waits              = from-&gt;rev_requests;
-<a name="line2065">2065: </a>  from-&gt;rev_requests = from-&gt;requests;
-<a name="line2066">2066: </a>  from-&gt;requests     = waits;
-<a name="line2067">2067: </a>  waits              = to-&gt;rev_requests;
-<a name="line2068">2068: </a>  to-&gt;rev_requests   = to-&gt;requests;
-<a name="line2069">2069: </a>  to-&gt;requests       = waits;
-<a name="line2070">2070: </a>  <font color="#4169E1">return</font>(0);
-<a name="line2071">2071: </a>}
-
-<a name="line2073">2073: </a><font color="#B22222">/* ---------------------------------------------------------------------------------*/</font>
-<a name="line2076">2076: </a><strong><font color="#4169E1"><a name="VecScatterCreate_PtoP"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreate_PtoP(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nx,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ny,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidy,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> yin,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
-<a name="line2077">2077: </a>{
-<a name="line2079">2079: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size,rank,tag,imdex,n;
-<a name="line2080">2080: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *owners = xin-&gt;map-&gt;range;
-<a name="line2081">2081: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    *nprocs = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line2082">2082: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i,j,idx,nsends,*local_inidx = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*local_inidy = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line2083">2083: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *owner = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*starts = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,count,slen;
-<a name="line2084">2084: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *rvalues = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*svalues = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,base,*values = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*rsvalues,recvtotal,lastidx;
-<a name="line2085">2085: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    *onodes1,*olengths1,nrecvs;
-<a name="line2086">2086: </a>  <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>       comm;
-<a name="line2087">2087: </a>  MPI_Request    *send_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*recv_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line2088">2088: </a>  MPI_Status     recv_status,*send_status = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
-<a name="line2089">2089: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     duplicate = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line2090">2090: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line2091">2091: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     found = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line2092">2092: </a><font color="#A020F0">#endif</font>
-
-<a name="line2095">2095: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;tag);
-<a name="line2096">2096: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetComm.html#PetscObjectGetComm">PetscObjectGetComm</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin,&amp;comm);
-<a name="line2097">2097: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
-<a name="line2098">2098: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
-<a name="line2099">2099: </a>  <font color="#4169E1">if</font> (size == 1) {
-<a name="line2100">2100: </a>    VecScatterCreate_StoP(nx,inidx,ny,inidy,xin,yin,1,ctx);
-<a name="line2101">2101: </a>    <font color="#4169E1">return</font>(0);
-<a name="line2102">2102: </a>  }
-
-<a name="line2104">2104: </a>  <font color="#B22222">/*</font>
-<a name="line2105">2105: </a><font color="#B22222">     Each processor ships off its inidx[j] and inidy[j] to the appropriate processor</font>
-<a name="line2106">2106: </a><font color="#B22222">     They then call the StoPScatterCreate()</font>
-<a name="line2107">2107: </a><font color="#B22222">  */</font>
-<a name="line2108">2108: </a>  <font color="#B22222">/*  first count number of contributors to each processor */</font>
-<a name="line2109">2109: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;nprocs,nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;owner,(size+1),<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;starts);
-<a name="line2110">2110: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(nprocs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
-<a name="line2111">2111: </a>  lastidx = -1;
-<a name="line2112">2112: </a>  j       = 0;
-<a name="line2113">2113: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
-<a name="line2114">2114: </a>    <font color="#B22222">/* if indices are NOT locally sorted, need to start search at the beginning */</font>
-<a name="line2115">2115: </a>    <font color="#4169E1">if</font> (lastidx &gt; (idx = inidx[i])) j = 0;
-<a name="line2116">2116: </a>    lastidx = idx;
-<a name="line2117">2117: </a>    <font color="#4169E1">for</font> (; j&lt;size; j++) {
-<a name="line2118">2118: </a>      <font color="#4169E1">if</font> (idx &gt;= owners[j] &amp;&amp; idx &lt; owners[j+1]) {
-<a name="line2119">2119: </a>        nprocs[j]++;
-<a name="line2120">2120: </a>        owner[i] = j;
-<a name="line2121">2121: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line2122">2122: </a>        found = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line2123">2123: </a><font color="#A020F0">#endif</font>
-<a name="line2124">2124: </a>        <font color="#4169E1">break</font>;
-<a name="line2125">2125: </a>      }
-<a name="line2126">2126: </a>    }
-<a name="line2127">2127: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
-<a name="line2128">2128: </a>    <font color="#4169E1">if</font> (!found) <A href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Index %D out of range"</font>,idx);
-<a name="line2129">2129: </a>    found = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
-<a name="line2130">2130: </a><font color="#A020F0">#endif</font>
-<a name="line2131">2131: </a>  }
-<a name="line2132">2132: </a>  nsends = 0;  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) { nsends += (nprocs[i] &gt; 0);}
-
-<a name="line2134">2134: </a>  <font color="#B22222">/* inform other processors of number of messages and max length*/</font>
-<a name="line2135">2135: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherNumberOfMessages.html#PetscGatherNumberOfMessages">PetscGatherNumberOfMessages</A>(comm,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,nprocs,&amp;nrecvs);
-<a name="line2136">2136: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherMessageLengths.html#PetscGatherMessageLengths">PetscGatherMessageLengths</A>(comm,nsends,nrecvs,nprocs,&amp;onodes1,&amp;olengths1);
-<a name="line2137">2137: </a>  <A href="../../../../docs/manualpages/Sys/PetscSortMPIIntWithArray.html#PetscSortMPIIntWithArray">PetscSortMPIIntWithArray</A>(nrecvs,onodes1,olengths1);
-<a name="line2138">2138: </a>  recvtotal = 0; <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) recvtotal += olengths1[i];
-
-<a name="line2140">2140: </a>  <font color="#B22222">/* post receives:   */</font>
-<a name="line2141">2141: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc5.html#PetscMalloc5">PetscMalloc5</A>(2*recvtotal,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;rvalues,2*nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;svalues,nrecvs,MPI_Request,&amp;recv_waits,nsends,MPI_Request,&amp;send_waits,nsends,MPI_Status,&amp;send_status);
-
-<a name="line2143">2143: </a>  count = 0;
-<a name="line2144">2144: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
-<a name="line2145">2145: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>((rvalues+2*count),2*olengths1[i],MPIU_INT,onodes1[i],tag,comm,recv_waits+i);
-<a name="line2146">2146: </a>    count += olengths1[i];
-<a name="line2147">2147: </a>  }
-<a name="line2148">2148: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(onodes1);
-
-<a name="line2150">2150: </a>  <font color="#B22222">/* do sends:</font>
-<a name="line2151">2151: </a><font color="#B22222">      1) starts[i] gives the starting index in svalues for stuff going to </font>
-<a name="line2152">2152: </a><font color="#B22222">         the ith processor</font>
-<a name="line2153">2153: </a><font color="#B22222">  */</font>
-<a name="line2154">2154: </a>  starts[0]= 0;
-<a name="line2155">2155: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
-<a name="line2156">2156: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
-<a name="line2157">2157: </a>    svalues[2*starts[owner[i]]]       = inidx[i];
-<a name="line2158">2158: </a>    svalues[1 + 2*starts[owner[i]]++] = inidy[i];
-<a name="line2159">2159: </a>  }
-
-<a name="line2161">2161: </a>  starts[0] = 0;
-<a name="line2162">2162: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size+1; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
-<a name="line2163">2163: </a>  count = 0;
-<a name="line2164">2164: </a>  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
-<a name="line2165">2165: </a>    <font color="#4169E1">if</font> (nprocs[i]) {
-<a name="line2166">2166: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Isend.html#MPI_Isend">MPI_Isend</A>(svalues+2*starts[i],2*nprocs[i],MPIU_INT,i,tag,comm,send_waits+count);
-<a name="line2167">2167: </a>      count++;
-<a name="line2168">2168: </a>    }
-<a name="line2169">2169: </a>  }
-<a name="line2170">2170: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(nprocs,owner,starts);
-
-<a name="line2172">2172: </a>  <font color="#B22222">/*  wait on receives */</font>
-<a name="line2173">2173: </a>  count = nrecvs;
-<a name="line2174">2174: </a>  slen  = 0;
-<a name="line2175">2175: </a>  <font color="#4169E1">while</font> (count) {
-<a name="line2176">2176: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitany.html#MPI_Waitany">MPI_Waitany</A>(nrecvs,recv_waits,&amp;imdex,&amp;recv_status);
-<a name="line2177">2177: </a>    <font color="#B22222">/* unpack receives into our local space */</font>
-<a name="line2178">2178: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Get_count.html#MPI_Get_count">MPI_Get_count</A>(&amp;recv_status,MPIU_INT,&amp;n);
-<a name="line2179">2179: </a>    slen += n/2;
-<a name="line2180">2180: </a>    count--;
-<a name="line2181">2181: </a>  }
-<a name="line2182">2182: </a>  <font color="#4169E1">if</font> (slen != recvtotal) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_PLIB,<font color="#666666">"Total message lengths %D not as expected %D"</font>,slen,recvtotal);
-<a name="line2183">2183: </a>
-<a name="line2184">2184: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(slen,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;local_inidx,slen,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;local_inidy);
-<a name="line2185">2185: </a>  base  = owners[rank];
-<a name="line2186">2186: </a>  count = 0;
-<a name="line2187">2187: </a>  rsvalues = rvalues;
-<a name="line2188">2188: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
-<a name="line2189">2189: </a>    values = rsvalues;
-<a name="line2190">2190: </a>    rsvalues += 2*olengths1[i];
-<a name="line2191">2191: </a>    <font color="#4169E1">for</font> (j=0; j&lt;olengths1[i]; j++) {
-<a name="line2192">2192: </a>      local_inidx[count]   = values[2*j] - base;
-<a name="line2193">2193: </a>      local_inidy[count++] = values[2*j+1];
-<a name="line2194">2194: </a>    }
-<a name="line2195">2195: </a>  }
-<a name="line2196">2196: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(olengths1);
-
-<a name="line2198">2198: </a>  <font color="#B22222">/* wait on sends */</font>
-<a name="line2199">2199: </a>  <font color="#4169E1">if</font> (nsends) {<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(nsends,send_waits,send_status);}
-<a name="line2200">2200: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree5.html#PetscFree5">PetscFree5</A>(rvalues,svalues,recv_waits,send_waits,send_status);
-
-<a name="line2202">2202: </a>  <font color="#B22222">/*</font>
-<a name="line2203">2203: </a><font color="#B22222">     should sort and remove duplicates from local_inidx,local_inidy </font>
-<a name="line2204">2204: </a><font color="#B22222">  */</font>
-
-<a name="line2206">2206: </a><font color="#A020F0">#if defined(do_it_slow)</font>
-<a name="line2207">2207: </a>  <font color="#B22222">/* sort on the from index */</font>
-<a name="line2208">2208: </a>  <A href="../../../../docs/manualpages/Sys/PetscSortIntWithArray.html#PetscSortIntWithArray">PetscSortIntWithArray</A>(slen,local_inidx,local_inidy);
-<a name="line2209">2209: </a>  start = 0;
-<a name="line2210">2210: </a>  <font color="#4169E1">while</font> (start &lt; slen) {
-<a name="line2211">2211: </a>    count = start+1;
-<a name="line2212">2212: </a>    last  = local_inidx[start];
-<a name="line2213">2213: </a>    <font color="#4169E1">while</font> (count &lt; slen &amp;&amp; last == local_inidx[count]) count++;
-<a name="line2214">2214: </a>    <font color="#4169E1">if</font> (count &gt; start + 1) { <font color="#B22222">/* found 2 or more same local_inidx[] in a row */</font>
-<a name="line2215">2215: </a>      <font color="#B22222">/* sort on to index */</font>
-<a name="line2216">2216: </a>      <A href="../../../../docs/manualpages/Sys/PetscSortInt.html#PetscSortInt">PetscSortInt</A>(count-start,local_inidy+start);
-<a name="line2217">2217: </a>    }
-<a name="line2218">2218: </a>    <font color="#B22222">/* remove duplicates; not most efficient way, but probably good enough */</font>
-<a name="line2219">2219: </a>    i = start;
-<a name="line2220">2220: </a>    <font color="#4169E1">while</font> (i &lt; count-1) {
-<a name="line2221">2221: </a>      <font color="#4169E1">if</font> (local_inidy[i] != local_inidy[i+1]) {
-<a name="line2222">2222: </a>        i++;
-<a name="line2223">2223: </a>      } <font color="#4169E1">else</font> { <font color="#B22222">/* found a duplicate */</font>
-<a name="line2224">2224: </a>        duplicate = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
-<a name="line2225">2225: </a>        <font color="#4169E1">for</font> (j=i; j&lt;slen-1; j++) {
-<a name="line2226">2226: </a>          local_inidx[j] = local_inidx[j+1];
-<a name="line2227">2227: </a>          local_inidy[j] = local_inidy[j+1];
-<a name="line2228">2228: </a>        }
-<a name="line2229">2229: </a>        slen--;
-<a name="line2230">2230: </a>        count--;
-<a name="line2231">2231: </a>      }
-<a name="line2232">2232: </a>    }
-<a name="line2233">2233: </a>    start = count;
-<a name="line2234">2234: </a>  }
-<a name="line2235">2235: </a><font color="#A020F0">#endif</font>
-<a name="line2236">2236: </a>  <font color="#4169E1">if</font> (duplicate) {
-<a name="line2237">2237: </a>    <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Duplicate from to indices passed in <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(), they are ignored\n"</font>);
-<a name="line2238">2238: </a>  }
-<a name="line2239">2239: </a>  VecScatterCreate_StoP(slen,local_inidx,slen,local_inidy,xin,yin,1,ctx);
-<a name="line2240">2240: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(local_inidx,local_inidy);
-<a name="line2241">2241: </a>  <font color="#4169E1">return</font>(0);
-<a name="line2242">2242: </a>}
+<a name="line1480">1480: </a><font color="#B22222">/*@</font>
+<a name="line1481">1481: </a><font color="#B22222">     <A href="../../../../docs/manualpages/Vec/VecScatterCreateLocal.html#VecScatterCreateLocal">VecScatterCreateLocal</A> - Creates a <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> from a list of messages it must send and receive.</font>
+
+<a name="line1483">1483: </a><font color="#B22222">     Collective on <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A></font>
+
+<a name="line1485">1485: </a><font color="#B22222">   Input Parameters:</font>
+<a name="line1486">1486: </a><font color="#B22222">+     <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> - obtained with VecScatterCreateEmpty()</font>
+<a name="line1487">1487: </a><font color="#B22222">.     nsends -</font>
+<a name="line1488">1488: </a><font color="#B22222">.     sendSizes -</font>
+<a name="line1489">1489: </a><font color="#B22222">.     sendProcs -</font>
+<a name="line1490">1490: </a><font color="#B22222">.     sendIdx - indices where the sent entries are obtained from (in local, on process numbering), this is one long array of size \sum_{i=0,i&lt;nsends} sendSizes[i]</font>
+<a name="line1491">1491: </a><font color="#B22222">.     nrecvs - number of receives to expect</font>
+<a name="line1492">1492: </a><font color="#B22222">.     recvSizes - </font>
+<a name="line1493">1493: </a><font color="#B22222">.     recvProcs - processes who are sending to me</font>
+<a name="line1494">1494: </a><font color="#B22222">.     recvIdx - indices of where received entries are to be put, (in local, on process numbering), this is one long array of size \sum_{i=0,i&lt;nrecvs} recvSizes[i]</font>
+<a name="line1495">1495: </a><font color="#B22222">-     bs - size of block</font>
+
+<a name="line1497">1497: </a><font color="#B22222">     Notes:  sendSizes[] and recvSizes[] cannot have any 0 entries. If you want to support having 0 entries you need</font>
+<a name="line1498">1498: </a><font color="#B22222">      to change the code below to "compress out" the sendProcs[] and recvProcs[] entries that have 0 entries.</font>
+
+<a name="line1500">1500: </a><font color="#B22222">       Probably does not handle sends to self properly. It should remove those from the counts that are used</font>
+<a name="line1501">1501: </a><font color="#B22222">      in allocating space inside of the from struct</font>
+
+<a name="line1503">1503: </a><font color="#B22222">  Level: intermediate</font>
+
+<a name="line1505">1505: </a><font color="#B22222">@*/</font>
+<a name="line1506">1506: </a><strong><font color="#4169E1"><a name="VecScatterCreateLocal"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> <A href="../../../../docs/manualpages/Vec/VecScatterCreateLocal.html#VecScatterCreateLocal">VecScatterCreateLocal</A>(<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nsends,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> sendSizes[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> sendProcs[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> sendIdx[],<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nrecvs,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> recvSizes[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> recvProcs[],const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> recvIdx[],<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs)</font></strong>
+<a name="line1507">1507: </a>{
+<a name="line1508">1508: </a>  VecScatter_MPI_General *from, *to;
+<a name="line1509">1509: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               sendSize, recvSize;
+<a name="line1510">1510: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               n, i;
+<a name="line1511">1511: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
+
+<a name="line1513">1513: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
+<a name="line1514">1514: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;to);
+<a name="line1515">1515: </a>  to-&gt;n = nsends;
+<a name="line1516">1516: </a>  <font color="#4169E1">for</font>(n = 0, sendSize = 0; n &lt; to-&gt;n; n++) {sendSize += sendSizes[n];}
+<a name="line1517">1517: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;to-&gt;requests);
+<a name="line1518">1518: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*sendSize,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;to-&gt;values,sendSize,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;indices,to-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;starts,to-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;procs);
+<a name="line1519">1519: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(to-&gt;n,nrecvs),MPI_Status,&amp;to-&gt;sstatus,PetscMax(to-&gt;n,nrecvs),MPI_Status,&amp;to-&gt;rstatus);
+<a name="line1520">1520: </a>  to-&gt;starts[0] = 0;
+<a name="line1521">1521: </a>  <font color="#4169E1">for</font>(n = 0; n &lt; to-&gt;n; n++) {
+<a name="line1522">1522: </a>    <font color="#4169E1">if</font> (sendSizes[n] &lt;=0 ) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"sendSizes[n=%D] = %D cannot be less than 1"</font>,n,sendSizes[n]);
+<a name="line1523">1523: </a>    to-&gt;starts[n+1] = to-&gt;starts[n] + sendSizes[n];
+<a name="line1524">1524: </a>    to-&gt;procs[n] = sendProcs[n];
+<a name="line1525">1525: </a>    <font color="#4169E1">for</font>(i = to-&gt;starts[n]; i &lt; to-&gt;starts[n]+sendSizes[n]; i++) {
+<a name="line1526">1526: </a>      to-&gt;indices[i] = sendIdx[i];
+<a name="line1527">1527: </a>    }
+<a name="line1528">1528: </a>  }
+<a name="line1529">1529: </a>  ctx-&gt;todata = (void *) to;
+
+<a name="line1531">1531: </a>  <font color="#B22222">/* allocate entire receive scatter context */</font>
+<a name="line1532">1532: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;from);
+<a name="line1533">1533: </a>  from-&gt;n = nrecvs;
+<a name="line1534">1534: </a>  <font color="#4169E1">for</font>(n = 0, recvSize = 0; n &lt; from-&gt;n; n++) {recvSize += recvSizes[n];}
+<a name="line1535">1535: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;from-&gt;requests);
+<a name="line1536">1536: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*recvSize,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;from-&gt;values,recvSize,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;indices,from-&gt;n+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;starts,from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;procs);
+<a name="line1537">1537: </a>  from-&gt;starts[0] = 0;
+<a name="line1538">1538: </a>  <font color="#4169E1">for</font>(n = 0; n &lt; from-&gt;n; n++) {
+<a name="line1539">1539: </a>    <font color="#4169E1">if</font> (recvSizes[n] &lt;=0 ) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"recvSizes[n=%D] = %D cannot be less than 1"</font>,n,recvSizes[n]);
+<a name="line1540">1540: </a>    from-&gt;starts[n+1] = from-&gt;starts[n] + recvSizes[n];
+<a name="line1541">1541: </a>    from-&gt;procs[n] = recvProcs[n];
+<a name="line1542">1542: </a>    <font color="#4169E1">for</font>(i = from-&gt;starts[n]; i &lt; from-&gt;starts[n]+recvSizes[n]; i++) {
+<a name="line1543">1543: </a>      from-&gt;indices[i] = recvIdx[i];
+<a name="line1544">1544: </a>    }
+<a name="line1545">1545: </a>  }
+<a name="line1546">1546: </a>  ctx-&gt;fromdata = (void *)from;
+
+<a name="line1548">1548: </a>  <font color="#B22222">/* No local scatter optimization */</font>
+<a name="line1549">1549: </a>  from-&gt;local.n      = 0;
+<a name="line1550">1550: </a>  from-&gt;local.vslots = 0;
+<a name="line1551">1551: </a>  to-&gt;local.n        = 0;
+<a name="line1552">1552: </a>  to-&gt;local.vslots   = 0;
+<a name="line1553">1553: </a>  from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1554">1554: </a>  from-&gt;local.n_nonmatching        = 0;
+<a name="line1555">1555: </a>  from-&gt;local.slots_nonmatching    = 0;
+<a name="line1556">1556: </a>  to-&gt;local.nonmatching_computed   = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1557">1557: </a>  to-&gt;local.n_nonmatching          = 0;
+<a name="line1558">1558: </a>  to-&gt;local.slots_nonmatching      = 0;
+
+<a name="line1560">1560: </a>  from-&gt;type = VEC_SCATTER_MPI_GENERAL;
+<a name="line1561">1561: </a>  to-&gt;type   = VEC_SCATTER_MPI_GENERAL;
+<a name="line1562">1562: </a>  from-&gt;bs = bs;
+<a name="line1563">1563: </a>  to-&gt;bs   = bs;
+<a name="line1564">1564: </a>  VecScatterCreateCommon_PtoS(from, to, ctx);
+<a name="line1565">1565: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1566">1566: </a>}
+
+<a name="line1568">1568: </a><font color="#B22222">/*</font>
+<a name="line1569">1569: </a><font color="#B22222">   bs indicates how many elements there are in each block. Normally this would be 1.</font>
+
+<a name="line1571">1571: </a><font color="#B22222">   contains check that <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> can handle the sizes needed </font>
+<a name="line1572">1572: </a><font color="#B22222">*/</font>
+<a name="line1575">1575: </a><strong><font color="#4169E1"><a name="VecScatterCreate_PtoS"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreate_PtoS(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nx,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ny,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidy,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> yin,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
+<a name="line1576">1576: </a>{
+<a name="line1577">1577: </a>  VecScatter_MPI_General *from,*to;
+<a name="line1578">1578: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            size,rank,imdex,tag,n;
+<a name="line1579">1579: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *source = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*owners = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line1580">1580: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *lowner = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*start = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,lengthy,lengthx;
+<a name="line1581">1581: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            *nprocs = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,nrecvs;
+<a name="line1582">1582: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               i,j,idx,nsends;
+<a name="line1583">1583: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *owner = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*starts = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,count,slen;
+<a name="line1584">1584: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>               *rvalues,*svalues,base,*values,nprocslocal,recvtotal,*rsvalues;
+<a name="line1585">1585: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>            *onodes1,*olengths1;
+<a name="line1586">1586: </a>  <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>               comm;
+<a name="line1587">1587: </a>  MPI_Request            *send_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*recv_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line1588">1588: </a>  MPI_Status             recv_status,*send_status;
+<a name="line1589">1589: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
+
+<a name="line1592">1592: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;tag);
+<a name="line1593">1593: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetComm.html#PetscObjectGetComm">PetscObjectGetComm</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin,&amp;comm);
+<a name="line1594">1594: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line1595">1595: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
+<a name="line1596">1596: </a>  owners = xin-&gt;map-&gt;range;
+<a name="line1597">1597: </a>  <A href="../../../../docs/manualpages/Vec/VecGetSize.html#VecGetSize">VecGetSize</A>(yin,&amp;lengthy);
+<a name="line1598">1598: </a>  <A href="../../../../docs/manualpages/Vec/VecGetSize.html#VecGetSize">VecGetSize</A>(xin,&amp;lengthx);
+
+<a name="line1600">1600: </a>  <font color="#B22222">/*  first count number of contributors to each processor */</font>
+<a name="line1601">1601: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;nprocs,nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;owner);
+<a name="line1602">1602: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(nprocs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1603">1603: </a>  j      = 0;
+<a name="line1604">1604: </a>  nsends = 0;
+<a name="line1605">1605: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
+<a name="line1606">1606: </a>    idx = inidx[i];
+<a name="line1607">1607: </a>    <font color="#4169E1">if</font> (idx &lt; owners[j]) j = 0;
+<a name="line1608">1608: </a>    <font color="#4169E1">for</font> (; j&lt;size; j++) {
+<a name="line1609">1609: </a>      <font color="#4169E1">if</font> (idx &lt; owners[j+1]) {
+<a name="line1610">1610: </a>        <font color="#4169E1">if</font> (!nprocs[j]++) nsends++;
+<a name="line1611">1611: </a>        owner[i] = j;
+<a name="line1612">1612: </a>        <font color="#4169E1">break</font>;
+<a name="line1613">1613: </a>      }
+<a name="line1614">1614: </a>    }
+<a name="line1615">1615: </a>  }
+<a name="line1616">1616: </a>  nprocslocal  = nprocs[rank];
+<a name="line1617">1617: </a>  nprocs[rank] = 0;
+<a name="line1618">1618: </a>  <font color="#4169E1">if</font> (nprocslocal) nsends--;
+<a name="line1619">1619: </a>  <font color="#B22222">/* inform other processors of number of messages and max length*/</font>
+<a name="line1620">1620: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherNumberOfMessages.html#PetscGatherNumberOfMessages">PetscGatherNumberOfMessages</A>(comm,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,nprocs,&amp;nrecvs);
+<a name="line1621">1621: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherMessageLengths.html#PetscGatherMessageLengths">PetscGatherMessageLengths</A>(comm,nsends,nrecvs,nprocs,&amp;onodes1,&amp;olengths1);
+<a name="line1622">1622: </a>  <A href="../../../../docs/manualpages/Sys/PetscSortMPIIntWithArray.html#PetscSortMPIIntWithArray">PetscSortMPIIntWithArray</A>(nrecvs,onodes1,olengths1);
+<a name="line1623">1623: </a>  recvtotal = 0; <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) recvtotal += olengths1[i];
+
+<a name="line1625">1625: </a>  <font color="#B22222">/* post receives:   */</font>
+<a name="line1626">1626: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(recvtotal,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;rvalues,nrecvs,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;source,nrecvs,MPI_Request,&amp;recv_waits);
+<a name="line1627">1627: </a>  count  = 0;
+<a name="line1628">1628: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
+<a name="line1629">1629: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>((rvalues+count),olengths1[i],MPIU_INT,onodes1[i],tag,comm,recv_waits+i);
+<a name="line1630">1630: </a>    count += olengths1[i];
+<a name="line1631">1631: </a>  }
+
+<a name="line1633">1633: </a>  <font color="#B22222">/* do sends:</font>
+<a name="line1634">1634: </a><font color="#B22222">     1) starts[i] gives the starting index in svalues for stuff going to </font>
+<a name="line1635">1635: </a><font color="#B22222">     the ith processor</font>
+<a name="line1636">1636: </a><font color="#B22222">  */</font>
+<a name="line1637">1637: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;svalues,nsends,MPI_Request,&amp;send_waits,size+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;starts);
+<a name="line1638">1638: </a>  starts[0]  = 0;
+<a name="line1639">1639: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
+<a name="line1640">1640: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
+<a name="line1641">1641: </a>    <font color="#4169E1">if</font> (owner[i] != rank) {
+<a name="line1642">1642: </a>      svalues[starts[owner[i]]++] = inidx[i];
+<a name="line1643">1643: </a>    }
+<a name="line1644">1644: </a>  }
+
+<a name="line1646">1646: </a>  starts[0] = 0;
+<a name="line1647">1647: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size+1; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
+<a name="line1648">1648: </a>  count = 0;
+<a name="line1649">1649: </a>  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
+<a name="line1650">1650: </a>    <font color="#4169E1">if</font> (nprocs[i]) {
+<a name="line1651">1651: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Isend.html#MPI_Isend">MPI_Isend</A>(svalues+starts[i],nprocs[i],MPIU_INT,i,tag,comm,send_waits+count++);
+<a name="line1652">1652: </a>    }
+<a name="line1653">1653: </a>  }
+
+<a name="line1655">1655: </a>  <font color="#B22222">/*  wait on receives */</font>
+<a name="line1656">1656: </a>  count  = nrecvs;
+<a name="line1657">1657: </a>  slen   = 0;
+<a name="line1658">1658: </a>  <font color="#4169E1">while</font> (count) {
+<a name="line1659">1659: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitany.html#MPI_Waitany">MPI_Waitany</A>(nrecvs,recv_waits,&amp;imdex,&amp;recv_status);
+<a name="line1660">1660: </a>    <font color="#B22222">/* unpack receives into our local space */</font>
+<a name="line1661">1661: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Get_count.html#MPI_Get_count">MPI_Get_count</A>(&amp;recv_status,MPIU_INT,&amp;n);
+<a name="line1662">1662: </a>    slen += n;
+<a name="line1663">1663: </a>    count--;
+<a name="line1664">1664: </a>  }
+
+<a name="line1666">1666: </a>  <font color="#4169E1">if</font> (slen != recvtotal) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_PLIB,<font color="#666666">"Total message lengths %D not expected %D"</font>,slen,recvtotal);
+<a name="line1667">1667: </a>
+<a name="line1668">1668: </a>  <font color="#B22222">/* allocate entire send scatter context */</font>
+<a name="line1669">1669: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;to);
+<a name="line1670">1670: </a>  to-&gt;n = nrecvs;
+<a name="line1671">1671: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nrecvs*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;to-&gt;requests);
+<a name="line1672">1672: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>(bs*slen,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;to-&gt;values,slen,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;indices,nrecvs+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;to-&gt;starts,nrecvs,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;procs);
+<a name="line1673">1673: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(PetscMax(to-&gt;n,nsends),MPI_Status,&amp;to-&gt;sstatus,PetscMax(to-&gt;n,nsends),MPI_Status,&amp;to-&gt;rstatus);
+<a name="line1674">1674: </a>  ctx-&gt;todata   = (void*)to;
+<a name="line1675">1675: </a>  to-&gt;starts[0] = 0;
+
+<a name="line1677">1677: </a>  <font color="#4169E1">if</font> (nrecvs) {
+
+<a name="line1679">1679: </a>    <font color="#B22222">/* move the data into the send scatter */</font>
+<a name="line1680">1680: </a>    base     = owners[rank];
+<a name="line1681">1681: </a>    rsvalues = rvalues;
+<a name="line1682">1682: </a>    <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
+<a name="line1683">1683: </a>      to-&gt;starts[i+1] = to-&gt;starts[i] + olengths1[i];
+<a name="line1684">1684: </a>      to-&gt;procs[i]    = onodes1[i];
+<a name="line1685">1685: </a>      values = rsvalues;
+<a name="line1686">1686: </a>      rsvalues += olengths1[i];
+<a name="line1687">1687: </a>      <font color="#4169E1">for</font> (j=0; j&lt;olengths1[i]; j++) {
+<a name="line1688">1688: </a>        to-&gt;indices[to-&gt;starts[i] + j] = values[j] - base;
+<a name="line1689">1689: </a>      }
+<a name="line1690">1690: </a>    }
+<a name="line1691">1691: </a>  }
+<a name="line1692">1692: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(olengths1);
+<a name="line1693">1693: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(onodes1);
+<a name="line1694">1694: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(rvalues,source,recv_waits);
+
+<a name="line1696">1696: </a>  <font color="#B22222">/* allocate entire receive scatter context */</font>
+<a name="line1697">1697: </a>  PetscNewLog(ctx,VecScatter_MPI_General,&amp;from);
+<a name="line1698">1698: </a>  from-&gt;n = nsends;
+
+<a name="line1700">1700: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nsends*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;from-&gt;requests);
+<a name="line1701">1701: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc4.html#PetscMalloc4">PetscMalloc4</A>((ny-nprocslocal)*bs,<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>,&amp;from-&gt;values,ny-nprocslocal,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;indices,nsends+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;from-&gt;starts,from-&gt;n,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;procs);
+<a name="line1702">1702: </a>  ctx-&gt;fromdata  = (void*)from;
+
+<a name="line1704">1704: </a>  <font color="#B22222">/* move data into receive scatter */</font>
+<a name="line1705">1705: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;lowner,nsends+1,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;start);
+<a name="line1706">1706: </a>  count = 0; from-&gt;starts[0] = start[0] = 0;
+<a name="line1707">1707: </a>  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
+<a name="line1708">1708: </a>    <font color="#4169E1">if</font> (nprocs[i]) {
+<a name="line1709">1709: </a>      lowner[i]            = count;
+<a name="line1710">1710: </a>      from-&gt;procs[count++] = i;
+<a name="line1711">1711: </a>      from-&gt;starts[count]  = start[count] = start[count-1] + nprocs[i];
+<a name="line1712">1712: </a>    }
+<a name="line1713">1713: </a>  }
+
+<a name="line1715">1715: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
+<a name="line1716">1716: </a>    <font color="#4169E1">if</font> (owner[i] != rank) {
+<a name="line1717">1717: </a>      from-&gt;indices[start[lowner[owner[i]]]++] = inidy[i];
+<a name="line1718">1718: </a>      <font color="#4169E1">if</font> (inidy[i] &gt;= lengthy) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Scattering past end of TO vector"</font>);
+<a name="line1719">1719: </a>    }
+<a name="line1720">1720: </a>  }
+<a name="line1721">1721: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(lowner,start);
+<a name="line1722">1722: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(nprocs,owner);
+<a name="line1723">1723: </a>
+<a name="line1724">1724: </a>  <font color="#B22222">/* wait on sends */</font>
+<a name="line1725">1725: </a>  <font color="#4169E1">if</font> (nsends) {
+<a name="line1726">1726: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nsends*<font color="#4169E1">sizeof</font>(MPI_Status),&amp;send_status);
+<a name="line1727">1727: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(nsends,send_waits,send_status);
+<a name="line1728">1728: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(send_status);
+<a name="line1729">1729: </a>  }
+<a name="line1730">1730: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(svalues,send_waits,starts);
+
+<a name="line1732">1732: </a>  <font color="#4169E1">if</font> (nprocslocal) {
+<a name="line1733">1733: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nt = from-&gt;local.n = to-&gt;local.n = nprocslocal;
+<a name="line1734">1734: </a>    <font color="#B22222">/* we have a scatter to ourselves */</font>
+<a name="line1735">1735: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nt*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;to-&gt;local.vslots);
+<a name="line1736">1736: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(nt*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>),&amp;from-&gt;local.vslots);
+<a name="line1737">1737: </a>    nt   = 0;
+<a name="line1738">1738: </a>    <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
+<a name="line1739">1739: </a>      idx = inidx[i];
+<a name="line1740">1740: </a>      <font color="#4169E1">if</font> (idx &gt;= owners[rank] &amp;&amp; idx &lt; owners[rank+1]) {
+<a name="line1741">1741: </a>        to-&gt;local.vslots[nt]     = idx - owners[rank];
+<a name="line1742">1742: </a>        from-&gt;local.vslots[nt++] = inidy[i];
+<a name="line1743">1743: </a>        <font color="#4169E1">if</font> (inidy[i] &gt;= lengthy) <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Scattering past end of TO vector"</font>);
+<a name="line1744">1744: </a>      }
+<a name="line1745">1745: </a>    }
+<a name="line1746">1746: </a>  } <font color="#4169E1">else</font> {
+<a name="line1747">1747: </a>    from-&gt;local.n      = 0;
+<a name="line1748">1748: </a>    from-&gt;local.vslots = 0;
+<a name="line1749">1749: </a>    to-&gt;local.n        = 0;
+<a name="line1750">1750: </a>    to-&gt;local.vslots   = 0;
+<a name="line1751">1751: </a>  }
+
+<a name="line1753">1753: </a>  from-&gt;local.nonmatching_computed = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1754">1754: </a>  from-&gt;local.n_nonmatching        = 0;
+<a name="line1755">1755: </a>  from-&gt;local.slots_nonmatching    = 0;
+<a name="line1756">1756: </a>  to-&gt;local.nonmatching_computed   = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1757">1757: </a>  to-&gt;local.n_nonmatching          = 0;
+<a name="line1758">1758: </a>  to-&gt;local.slots_nonmatching      = 0;
+
+<a name="line1760">1760: </a>  from-&gt;type = VEC_SCATTER_MPI_GENERAL;
+<a name="line1761">1761: </a>  to-&gt;type   = VEC_SCATTER_MPI_GENERAL;
+<a name="line1762">1762: </a>  from-&gt;bs = bs;
+<a name="line1763">1763: </a>  to-&gt;bs   = bs;
+<a name="line1764">1764: </a>  VecScatterCreateCommon_PtoS(from,to,ctx);
+<a name="line1765">1765: </a>  <font color="#4169E1">return</font>(0);
+<a name="line1766">1766: </a>}
+
+<a name="line1768">1768: </a><font color="#B22222">/*</font>
+<a name="line1769">1769: </a><font color="#B22222">   bs indicates how many elements there are in each block. Normally this would be 1.</font>
+<a name="line1770">1770: </a><font color="#B22222">*/</font>
+<a name="line1773">1773: </a><strong><font color="#4169E1"><a name="VecScatterCreateCommon_PtoS"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreateCommon_PtoS(VecScatter_MPI_General *from,VecScatter_MPI_General *to,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
+<a name="line1774">1774: </a>{
+<a name="line1775">1775: </a>  <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>       comm = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx)-&gt;comm;
+<a name="line1776">1776: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    tag  = ((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx)-&gt;tag, tagr;
+<a name="line1777">1777: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       bs   = to-&gt;bs;
+<a name="line1778">1778: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size;
+<a name="line1779">1779: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i, n;
+<a name="line1781">1781: </a>
+<a name="line1783">1783: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;tagr);
+<a name="line1784">1784: </a>  ctx-&gt;destroy = VecScatterDestroy_PtoP;
+
+<a name="line1786">1786: </a>  ctx-&gt;reproduce = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1787">1787: </a>  to-&gt;sendfirst  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1788">1788: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_reproduce"</font>,&amp;ctx-&gt;reproduce,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1789">1789: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_sendfirst"</font>,&amp;to-&gt;sendfirst,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1790">1790: </a>  from-&gt;sendfirst = to-&gt;sendfirst;
+
+<a name="line1792">1792: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
+<a name="line1793">1793: </a>  <font color="#B22222">/* check if the receives are ALL going into contiguous locations; if so can skip indexing */</font>
+<a name="line1794">1794: </a>  to-&gt;contiq = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1795">1795: </a>  n = from-&gt;starts[from-&gt;n];
+<a name="line1796">1796: </a>  from-&gt;contiq = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1797">1797: </a>  <font color="#4169E1">for</font> (i=1; i&lt;n; i++) {
+<a name="line1798">1798: </a>    <font color="#4169E1">if</font> (from-&gt;indices[i] != from-&gt;indices[i-1] + bs) {
+<a name="line1799">1799: </a>      from-&gt;contiq = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1800">1800: </a>      <font color="#4169E1">break</font>;
+<a name="line1801">1801: </a>    }
+<a name="line1802">1802: </a>  }
+
+<a name="line1804">1804: </a>  to-&gt;use_alltoallv = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1805">1805: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_alltoall"</font>,&amp;to-&gt;use_alltoallv,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1806">1806: </a>  from-&gt;use_alltoallv = to-&gt;use_alltoallv;
+<a name="line1807">1807: </a>  <font color="#4169E1">if</font> (from-&gt;use_alltoallv) <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Alltoallv.html#MPI_Alltoallv">MPI_Alltoallv</A>() for scatter\n"</font>);
+<a name="line1808">1808: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_ALLTOALLW)  &amp;&amp; !defined(PETSC_USE_64BIT_INDICES)</font>
+<a name="line1809">1809: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallv) {
+<a name="line1810">1810: </a>    to-&gt;use_alltoallw = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1811">1811: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_nopack"</font>,&amp;to-&gt;use_alltoallw,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1812">1812: </a>  }
+<a name="line1813">1813: </a>  from-&gt;use_alltoallw = to-&gt;use_alltoallw;
+<a name="line1814">1814: </a>  <font color="#4169E1">if</font> (from-&gt;use_alltoallw) <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using MPI_Alltoallw() for scatter\n"</font>);
+<a name="line1815">1815: </a><font color="#A020F0">#endif</font>
+
+<a name="line1817">1817: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_WIN_CREATE)</font>
+<a name="line1818">1818: </a>  to-&gt;use_window = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1819">1819: </a>  <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_window"</font>,&amp;to-&gt;use_window,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1820">1820: </a>  from-&gt;use_window = to-&gt;use_window;
+<a name="line1821">1821: </a><font color="#A020F0">#endif</font>
+
+<a name="line1823">1823: </a>  <font color="#4169E1">if</font> (to-&gt;use_alltoallv) {
+
+<a name="line1825">1825: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;displs);
+<a name="line1826">1826: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(to-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1827">1827: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line1828">1828: </a>      to-&gt;counts[to-&gt;procs[i]] = bs*(to-&gt;starts[i+1] - to-&gt;starts[i]);
+<a name="line1829">1829: </a>    }
+<a name="line1830">1830: </a>    to-&gt;displs[0] = 0;
+<a name="line1831">1831: </a>    <font color="#4169E1">for</font> (i=1; i&lt;size; i++) {
+<a name="line1832">1832: </a>      to-&gt;displs[i] = to-&gt;displs[i-1] + to-&gt;counts[i-1];
+<a name="line1833">1833: </a>    }
+
+<a name="line1835">1835: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;counts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;displs);
+<a name="line1836">1836: </a>    <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(from-&gt;counts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1837">1837: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1838">1838: </a>      from-&gt;counts[from-&gt;procs[i]] = bs*(from-&gt;starts[i+1] - from-&gt;starts[i]);
+<a name="line1839">1839: </a>    }
+<a name="line1840">1840: </a>    from-&gt;displs[0] = 0;
+<a name="line1841">1841: </a>    <font color="#4169E1">for</font> (i=1; i&lt;size; i++) {
+<a name="line1842">1842: </a>      from-&gt;displs[i] = from-&gt;displs[i-1] + from-&gt;counts[i-1];
+<a name="line1843">1843: </a>    }
+<a name="line1844">1844: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_ALLTOALLW) &amp;&amp; !defined(PETSC_USE_64BIT_INDICES)</font>
+<a name="line1845">1845: </a>    <font color="#4169E1">if</font> (to-&gt;use_alltoallw) {
+<a name="line1846">1846: </a>      <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> mpibs = PetscMPIIntCast(bs), mpilen;
+<a name="line1847">1847: </a>      ctx-&gt;packtogether = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1848">1848: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;wcounts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;to-&gt;wdispls,size,MPI_Datatype,&amp;to-&gt;types);
+<a name="line1849">1849: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(to-&gt;wcounts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1850">1850: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(to-&gt;wdispls,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1851">1851: </a>      <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
+<a name="line1852">1852: </a>        to-&gt;types[i] = <A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>;
+<a name="line1853">1853: </a>      }
+
+<a name="line1855">1855: </a>      <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line1856">1856: </a>        to-&gt;wcounts[to-&gt;procs[i]] = 1;
+<a name="line1857">1857: </a>        mpilen = PetscMPIIntCast(to-&gt;starts[i+1]-to-&gt;starts[i]);
+<a name="line1858">1858: </a>        MPI_Type_create_indexed_block(mpilen,mpibs,to-&gt;indices+to-&gt;starts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,to-&gt;types+to-&gt;procs[i]);
+<a name="line1859">1859: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_commit.html#MPI_Type_commit">MPI_Type_commit</A>(to-&gt;types+to-&gt;procs[i]);
+<a name="line1860">1860: </a>      }
+<a name="line1861">1861: </a>      <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;wcounts,size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;from-&gt;wdispls,size,MPI_Datatype,&amp;from-&gt;types);
+<a name="line1862">1862: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(from-&gt;wcounts,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1863">1863: </a>      <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(from-&gt;wdispls,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line1864">1864: </a>      <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
+<a name="line1865">1865: </a>        from-&gt;types[i] = <A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>;
+<a name="line1866">1866: </a>      }
+<a name="line1867">1867: </a>      <font color="#4169E1">if</font> (from-&gt;contiq) {
+<a name="line1868">1868: </a>        <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Scattered vector entries are stored contiquously, taking advantage of this with -vecscatter_alltoall\n"</font>);
+<a name="line1869">1869: </a>        <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1870">1870: </a>          from-&gt;wcounts[from-&gt;procs[i]] = bs*(from-&gt;starts[i+1] - from-&gt;starts[i]);
+<a name="line1871">1871: </a>        }
+<a name="line1872">1872: </a>        <font color="#4169E1">if</font> (from-&gt;n) from-&gt;wdispls[from-&gt;procs[0]] = <font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*from-&gt;indices[0];
+<a name="line1873">1873: </a>        <font color="#4169E1">for</font> (i=1; i&lt;from-&gt;n; i++) {
+<a name="line1874">1874: </a>          from-&gt;wdispls[from-&gt;procs[i]] = from-&gt;wdispls[from-&gt;procs[i-1]] + <font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>)*from-&gt;wcounts[from-&gt;procs[i-1]];
+<a name="line1875">1875: </a>        }
+<a name="line1876">1876: </a>      } <font color="#4169E1">else</font> {
+<a name="line1877">1877: </a>        <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1878">1878: </a>          from-&gt;wcounts[from-&gt;procs[i]] = 1;
+<a name="line1879">1879: </a>          mpilen = PetscMPIIntCast(from-&gt;starts[i+1]-from-&gt;starts[i]);
+<a name="line1880">1880: </a>          MPI_Type_create_indexed_block(mpilen,mpibs,from-&gt;indices+from-&gt;starts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,from-&gt;types+from-&gt;procs[i]);
+<a name="line1881">1881: </a>          <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Type_commit.html#MPI_Type_commit">MPI_Type_commit</A>(from-&gt;types+from-&gt;procs[i]);
+<a name="line1882">1882: </a>        }
+<a name="line1883">1883: </a>      }
+<a name="line1884">1884: </a>    } <font color="#4169E1">else</font> {
+<a name="line1885">1885: </a>      ctx-&gt;copy = VecScatterCopy_PtoP_AllToAll;
+<a name="line1886">1886: </a>    }
+<a name="line1887">1887: </a><font color="#A020F0">#else </font>
+<a name="line1888">1888: </a>    to-&gt;use_alltoallw   = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1889">1889: </a>    from-&gt;use_alltoallw = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1890">1890: </a>    ctx-&gt;copy           = VecScatterCopy_PtoP_AllToAll;
+<a name="line1891">1891: </a><font color="#A020F0">#endif</font>
+<a name="line1892">1892: </a><font color="#A020F0">#if defined(PETSC_HAVE_MPI_WIN_CREATE)</font>
+<a name="line1893">1893: </a>  } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (to-&gt;use_window) {
+<a name="line1894">1894: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> temptag,winsize;
+<a name="line1895">1895: </a>    MPI_Request *request;
+<a name="line1896">1896: </a>    MPI_Status  *status;
+<a name="line1897">1897: </a>
+<a name="line1898">1898: </a>    <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;temptag);
+<a name="line1899">1899: </a>    winsize = (to-&gt;n ? to-&gt;starts[to-&gt;n] : 0)*bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>);
+<a name="line1900">1900: </a>    MPI_Win_create(to-&gt;values ? to-&gt;values : MPI_BOTTOM,winsize,<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),MPI_INFO_NULL,comm,&amp;to-&gt;window);
+<a name="line1901">1901: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(to-&gt;n,&amp;to-&gt;winstarts);
+<a name="line1902">1902: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(to-&gt;n,MPI_Request,&amp;request,to-&gt;n,MPI_Status,&amp;status);
+<a name="line1903">1903: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line1904">1904: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>(to-&gt;winstarts+i,1,MPIU_INT,to-&gt;procs[i],temptag,comm,request+i);
+<a name="line1905">1905: </a>    }
+<a name="line1906">1906: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1907">1907: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(from-&gt;starts+i,1,MPIU_INT,from-&gt;procs[i],temptag,comm);
+<a name="line1908">1908: </a>    }
+<a name="line1909">1909: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(to-&gt;n,request,status);
+<a name="line1910">1910: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(request,status);
+
+<a name="line1912">1912: </a>    winsize = (from-&gt;n ? from-&gt;starts[from-&gt;n] : 0)*bs*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>);
+<a name="line1913">1913: </a>    MPI_Win_create(from-&gt;values ? from-&gt;values : MPI_BOTTOM,winsize,<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A>),MPI_INFO_NULL,comm,&amp;from-&gt;window);
+<a name="line1914">1914: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(from-&gt;n,&amp;from-&gt;winstarts);
+<a name="line1915">1915: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(from-&gt;n,MPI_Request,&amp;request,from-&gt;n,MPI_Status,&amp;status);
+<a name="line1916">1916: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1917">1917: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>(from-&gt;winstarts+i,1,MPIU_INT,from-&gt;procs[i],temptag,comm,request+i);
+<a name="line1918">1918: </a>    }
+<a name="line1919">1919: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line1920">1920: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send.html#MPI_Send">MPI_Send</A>(to-&gt;starts+i,1,MPIU_INT,to-&gt;procs[i],temptag,comm);
+<a name="line1921">1921: </a>    }
+<a name="line1922">1922: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(from-&gt;n,request,status);
+<a name="line1923">1923: </a>    <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(request,status);
+<a name="line1924">1924: </a><font color="#A020F0">#endif</font>
+<a name="line1925">1925: </a>  } <font color="#4169E1">else</font> {
+<a name="line1926">1926: </a>    <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>  use_rsend = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>, use_ssend = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1927">1927: </a>    <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>    *sstarts = to-&gt;starts,  *rstarts = from-&gt;starts;
+<a name="line1928">1928: </a>    <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A> *sprocs  = to-&gt;procs,   *rprocs  = from-&gt;procs;
+<a name="line1929">1929: </a>    MPI_Request *swaits  = to-&gt;requests,*rwaits  = from-&gt;requests;
+<a name="line1930">1930: </a>    MPI_Request *rev_swaits,*rev_rwaits;
+<a name="line1931">1931: </a>    <A href="../../../../docs/manualpages/Sys/PetscScalar.html#PetscScalar">PetscScalar</A> *Ssvalues = to-&gt;values, *Srvalues = from-&gt;values;
+
+<a name="line1933">1933: </a>    <font color="#B22222">/* allocate additional wait variables for the "reverse" scatter */</font>
+<a name="line1934">1934: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(to-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;rev_rwaits);
+<a name="line1935">1935: </a>    <A href="../../../../docs/manualpages/Sys/PetscMalloc.html#PetscMalloc">PetscMalloc</A>(from-&gt;n*<font color="#4169E1">sizeof</font>(MPI_Request),&amp;rev_swaits);
+<a name="line1936">1936: </a>    to-&gt;rev_requests   = rev_rwaits;
+<a name="line1937">1937: </a>    from-&gt;rev_requests = rev_swaits;
+
+<a name="line1939">1939: </a>    <font color="#B22222">/* Register the receives that you will use later (sends for scatter reverse) */</font>
+<a name="line1940">1940: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_rsend"</font>,&amp;use_rsend,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1941">1941: </a>    <A href="../../../../docs/manualpages/Sys/PetscOptionsGetTruth.html#PetscOptionsGetTruth">PetscOptionsGetTruth</A>(<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,<font color="#666666">"-vecscatter_ssend"</font>,&amp;use_ssend,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>);
+<a name="line1942">1942: </a>    <font color="#4169E1">if</font> (use_rsend) {
+<a name="line1943">1943: </a>      <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ready receiver mode\n"</font>);
+<a name="line1944">1944: </a>      to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1945">1945: </a>      from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line1946">1946: </a>    } <font color="#4169E1">else</font> {
+<a name="line1947">1947: </a>      to-&gt;use_readyreceiver    = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1948">1948: </a>      from-&gt;use_readyreceiver  = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line1949">1949: </a>    }
+<a name="line1950">1950: </a>    <font color="#4169E1">if</font> (use_ssend) {
+<a name="line1951">1951: </a>      <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Using <A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> Ssend mode\n"</font>);
+<a name="line1952">1952: </a>    }
+
+<a name="line1954">1954: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1955">1955: </a>      <font color="#4169E1">if</font> (use_rsend) {
+<a name="line1956">1956: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Rsend_init.html#MPI_Rsend_init">MPI_Rsend_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tagr,comm,rev_swaits+i);
+<a name="line1957">1957: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (use_ssend) {
+<a name="line1958">1958: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Ssend_init.html#MPI_Ssend_init">MPI_Ssend_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tagr,comm,rev_swaits+i);
+<a name="line1959">1959: </a>      } <font color="#4169E1">else</font> {
+<a name="line1960">1960: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tagr,comm,rev_swaits+i);
+<a name="line1961">1961: </a>      }
+<a name="line1962">1962: </a>    }
+
+<a name="line1964">1964: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line1965">1965: </a>      <font color="#4169E1">if</font> (use_rsend) {
+<a name="line1966">1966: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Rsend_init.html#MPI_Rsend_init">MPI_Rsend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
+<a name="line1967">1967: </a>      } <font color="#4169E1">else</font> <font color="#4169E1">if</font> (use_ssend) {
+<a name="line1968">1968: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Ssend_init.html#MPI_Ssend_init">MPI_Ssend_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
+<a name="line1969">1969: </a>      } <font color="#4169E1">else</font> {
+<a name="line1970">1970: </a>        <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Send_init.html#MPI_Send_init">MPI_Send_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tag,comm,swaits+i);
+<a name="line1971">1971: </a>      }
+<a name="line1972">1972: </a>    }
+<a name="line1973">1973: </a>    <font color="#B22222">/* Register receives for scatter and reverse */</font>
+<a name="line1974">1974: </a>    <font color="#4169E1">for</font> (i=0; i&lt;from-&gt;n; i++) {
+<a name="line1975">1975: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Srvalues+bs*rstarts[i],bs*rstarts[i+1]-bs*rstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,rprocs[i],tag,comm,rwaits+i);
+<a name="line1976">1976: </a>    }
+<a name="line1977">1977: </a>    <font color="#4169E1">for</font> (i=0; i&lt;to-&gt;n; i++) {
+<a name="line1978">1978: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Recv_init.html#MPI_Recv_init">MPI_Recv_init</A>(Ssvalues+bs*sstarts[i],bs*sstarts[i+1]-bs*sstarts[i],<A href="../../../../docs/manualpages/Sys/MPIU_SCALAR.html#MPIU_SCALAR">MPIU_SCALAR</A>,sprocs[i],tagr,comm,rev_rwaits+i);
+<a name="line1979">1979: </a>    }
+<a name="line1980">1980: </a>    <font color="#4169E1">if</font> (use_rsend) {
+<a name="line1981">1981: </a>      <font color="#4169E1">if</font> (to-&gt;n)   {MPI_Startall_irecv(to-&gt;starts[to-&gt;n]*to-&gt;bs,to-&gt;n,to-&gt;rev_requests);}
+<a name="line1982">1982: </a>      <font color="#4169E1">if</font> (from-&gt;n) {MPI_Startall_irecv(from-&gt;starts[from-&gt;n]*from-&gt;bs,from-&gt;n,from-&gt;requests);}
+<a name="line1983">1983: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Barrier.html#MPI_Barrier">MPI_Barrier</A>(comm);
+<a name="line1984">1984: </a>    }
+
+<a name="line1986">1986: </a>    ctx-&gt;copy      = VecScatterCopy_PtoP_X;
+<a name="line1987">1987: </a>  }
+<a name="line1988">1988: </a>  PetscInfo1(ctx,<font color="#666666">"Using blocksize %D scatter\n"</font>,bs);
+<a name="line1989">1989: </a>  <font color="#4169E1">switch</font> (bs) {
+<a name="line1990">1990: </a>  <font color="#4169E1">case</font> 12:
+<a name="line1991">1991: </a>    ctx-&gt;begin     = VecScatterBegin_12;
+<a name="line1992">1992: </a>    ctx-&gt;end       = VecScatterEnd_12;
+<a name="line1993">1993: </a>    <font color="#4169E1">break</font>;
+<a name="line1994">1994: </a>  <font color="#4169E1">case</font> 8:
+<a name="line1995">1995: </a>    ctx-&gt;begin     = VecScatterBegin_8;
+<a name="line1996">1996: </a>    ctx-&gt;end       = VecScatterEnd_8;
+<a name="line1997">1997: </a>    <font color="#4169E1">break</font>;
+<a name="line1998">1998: </a>  <font color="#4169E1">case</font> 7:
+<a name="line1999">1999: </a>    ctx-&gt;begin     = VecScatterBegin_7;
+<a name="line2000">2000: </a>    ctx-&gt;end       = VecScatterEnd_7;
+<a name="line2001">2001: </a>    <font color="#4169E1">break</font>;
+<a name="line2002">2002: </a>  <font color="#4169E1">case</font> 6:
+<a name="line2003">2003: </a>    ctx-&gt;begin     = VecScatterBegin_6;
+<a name="line2004">2004: </a>    ctx-&gt;end       = VecScatterEnd_6;
+<a name="line2005">2005: </a>    <font color="#4169E1">break</font>;
+<a name="line2006">2006: </a>  <font color="#4169E1">case</font> 5:
+<a name="line2007">2007: </a>    ctx-&gt;begin     = VecScatterBegin_5;
+<a name="line2008">2008: </a>    ctx-&gt;end       = VecScatterEnd_5;
+<a name="line2009">2009: </a>    <font color="#4169E1">break</font>;
+<a name="line2010">2010: </a>  <font color="#4169E1">case</font> 4:
+<a name="line2011">2011: </a>    ctx-&gt;begin     = VecScatterBegin_4;
+<a name="line2012">2012: </a>    ctx-&gt;end       = VecScatterEnd_4;
+<a name="line2013">2013: </a>    <font color="#4169E1">break</font>;
+<a name="line2014">2014: </a>  <font color="#4169E1">case</font> 3:
+<a name="line2015">2015: </a>    ctx-&gt;begin     = VecScatterBegin_3;
+<a name="line2016">2016: </a>    ctx-&gt;end       = VecScatterEnd_3;
+<a name="line2017">2017: </a>    <font color="#4169E1">break</font>;
+<a name="line2018">2018: </a>  <font color="#4169E1">case</font> 2:
+<a name="line2019">2019: </a>    ctx-&gt;begin     = VecScatterBegin_2;
+<a name="line2020">2020: </a>    ctx-&gt;end       = VecScatterEnd_2;
+<a name="line2021">2021: </a>    <font color="#4169E1">break</font>;
+<a name="line2022">2022: </a>  <font color="#4169E1">case</font> 1:
+<a name="line2023">2023: </a>    ctx-&gt;begin     = VecScatterBegin_1;
+<a name="line2024">2024: </a>    ctx-&gt;end       = VecScatterEnd_1;
+<a name="line2025">2025: </a>    <font color="#4169E1">break</font>;
+<a name="line2026">2026: </a><strong><font color="#FF0000">  default:</font></strong>
+<a name="line2027">2027: </a>    <A href="../../../../docs/manualpages/Sys/SETERRQ.html#SETERRQ">SETERRQ</A>(PETSC_ERR_SUP,<font color="#666666">"Blocksize not supported"</font>);
+<a name="line2028">2028: </a>  }
+<a name="line2029">2029: </a>  ctx-&gt;view      = VecScatterView_MPI;
+<a name="line2030">2030: </a>  <font color="#B22222">/* Check if the local scatter is actually a copy; important special case */</font>
+<a name="line2031">2031: </a>  <font color="#4169E1">if</font> (to-&gt;local.n) {
+<a name="line2032">2032: </a>    VecScatterLocalOptimizeCopy_Private(ctx,&amp;to-&gt;local,&amp;from-&gt;local,bs);
+<a name="line2033">2033: </a>  }
+<a name="line2034">2034: </a>  <font color="#4169E1">return</font>(0);
+<a name="line2035">2035: </a>}
+
+
+
+<a name="line2039">2039: </a><font color="#B22222">/* ------------------------------------------------------------------------------------*/</font>
+<a name="line2040">2040: </a><font color="#B22222">/*</font>
+<a name="line2041">2041: </a><font color="#B22222">         Scatter from local Seq vectors to a parallel vector. </font>
+<a name="line2042">2042: </a><font color="#B22222">         Reverses the order of the arguments, calls VecScatterCreate_PtoS() then</font>
+<a name="line2043">2043: </a><font color="#B22222">         reverses the result.</font>
+<a name="line2044">2044: </a><font color="#B22222">*/</font>
+<a name="line2047">2047: </a><strong><font color="#4169E1"><a name="VecScatterCreate_StoP"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreate_StoP(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nx,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ny,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidy,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> yin,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> bs,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
+<a name="line2048">2048: </a>{
+<a name="line2049">2049: </a>  <A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A>         ierr;
+<a name="line2050">2050: </a>  MPI_Request            *waits;
+<a name="line2051">2051: </a>  VecScatter_MPI_General *to,*from;
+
+<a name="line2054">2054: </a>  VecScatterCreate_PtoS(ny,inidy,nx,inidx,yin,xin,bs,ctx);
+<a name="line2055">2055: </a>  to            = (VecScatter_MPI_General*)ctx-&gt;fromdata;
+<a name="line2056">2056: </a>  from          = (VecScatter_MPI_General*)ctx-&gt;todata;
+<a name="line2057">2057: </a>  ctx-&gt;todata   = (void*)to;
+<a name="line2058">2058: </a>  ctx-&gt;fromdata = (void*)from;
+<a name="line2059">2059: </a>  <font color="#B22222">/* these two are special, they are ALWAYS stored in to struct */</font>
+<a name="line2060">2060: </a>  to-&gt;sstatus   = from-&gt;sstatus;
+<a name="line2061">2061: </a>  to-&gt;rstatus   = from-&gt;rstatus;
+
+<a name="line2063">2063: </a>  from-&gt;sstatus = 0;
+<a name="line2064">2064: </a>  from-&gt;rstatus = 0;
+
+<a name="line2066">2066: </a>  waits              = from-&gt;rev_requests;
+<a name="line2067">2067: </a>  from-&gt;rev_requests = from-&gt;requests;
+<a name="line2068">2068: </a>  from-&gt;requests     = waits;
+<a name="line2069">2069: </a>  waits              = to-&gt;rev_requests;
+<a name="line2070">2070: </a>  to-&gt;rev_requests   = to-&gt;requests;
+<a name="line2071">2071: </a>  to-&gt;requests       = waits;
+<a name="line2072">2072: </a>  <font color="#4169E1">return</font>(0);
+<a name="line2073">2073: </a>}
+
+<a name="line2075">2075: </a><font color="#B22222">/* ---------------------------------------------------------------------------------*/</font>
+<a name="line2078">2078: </a><strong><font color="#4169E1"><a name="VecScatterCreate_PtoP"></a><A href="../../../../docs/manualpages/Sys/PetscErrorCode.html#PetscErrorCode">PetscErrorCode</A> VecScatterCreate_PtoP(<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> nx,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> ny,const <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A> *inidy,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> xin,<A href="../../../../docs/manualpages/Vec/Vec.html#Vec">Vec</A> yin,<A href="../../../../docs/manualpages/Vec/VecScatter.html#VecScatter">VecScatter</A> ctx)</font></strong>
+<a name="line2079">2079: </a>{
+<a name="line2081">2081: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    size,rank,tag,imdex,n;
+<a name="line2082">2082: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *owners = xin-&gt;map-&gt;range;
+<a name="line2083">2083: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    *nprocs = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line2084">2084: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       i,j,idx,nsends,*local_inidx = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*local_inidy = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line2085">2085: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *owner = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*starts = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,count,slen;
+<a name="line2086">2086: </a>  <A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>       *rvalues = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*svalues = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,base,*values = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*rsvalues,recvtotal,lastidx;
+<a name="line2087">2087: </a>  <A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>    *onodes1,*olengths1,nrecvs;
+<a name="line2088">2088: </a>  <A href="../../../../docs/manualpages/Sys/MPI_Comm.html#MPI_Comm">MPI_Comm</A>       comm;
+<a name="line2089">2089: </a>  MPI_Request    *send_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,*recv_waits = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line2090">2090: </a>  MPI_Status     recv_status,*send_status = <A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>;
+<a name="line2091">2091: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     duplicate = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line2092">2092: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line2093">2093: </a>  <A href="../../../../docs/manualpages/Sys/PetscTruth.html#PetscTruth">PetscTruth</A>     found = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line2094">2094: </a><font color="#A020F0">#endif</font>
+
+<a name="line2097">2097: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetNewTag.html#PetscObjectGetNewTag">PetscObjectGetNewTag</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)ctx,&amp;tag);
+<a name="line2098">2098: </a>  <A href="../../../../docs/manualpages/Sys/PetscObjectGetComm.html#PetscObjectGetComm">PetscObjectGetComm</A>((<A href="../../../../docs/manualpages/Sys/PetscObject.html#PetscObject">PetscObject</A>)xin,&amp;comm);
+<a name="line2099">2099: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_size.html#MPI_Comm_size">MPI_Comm_size</A>(comm,&amp;size);
+<a name="line2100">2100: </a>  <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Comm_rank.html#MPI_Comm_rank">MPI_Comm_rank</A>(comm,&amp;rank);
+<a name="line2101">2101: </a>  <font color="#4169E1">if</font> (size == 1) {
+<a name="line2102">2102: </a>    VecScatterCreate_StoP(nx,inidx,ny,inidy,xin,yin,1,ctx);
+<a name="line2103">2103: </a>    <font color="#4169E1">return</font>(0);
+<a name="line2104">2104: </a>  }
+
+<a name="line2106">2106: </a>  <font color="#B22222">/*</font>
+<a name="line2107">2107: </a><font color="#B22222">     Each processor ships off its inidx[j] and inidy[j] to the appropriate processor</font>
+<a name="line2108">2108: </a><font color="#B22222">     They then call the StoPScatterCreate()</font>
+<a name="line2109">2109: </a><font color="#B22222">  */</font>
+<a name="line2110">2110: </a>  <font color="#B22222">/*  first count number of contributors to each processor */</font>
+<a name="line2111">2111: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc3.html#PetscMalloc3">PetscMalloc3</A>(size,<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>,&amp;nprocs,nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;owner,(size+1),<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;starts);
+<a name="line2112">2112: </a>  <A href="../../../../docs/manualpages/Sys/PetscMemzero.html#PetscMemzero">PetscMemzero</A>(nprocs,size*<font color="#4169E1">sizeof</font>(<A href="../../../../docs/manualpages/Sys/PetscMPIInt.html#PetscMPIInt">PetscMPIInt</A>));
+<a name="line2113">2113: </a>  lastidx = -1;
+<a name="line2114">2114: </a>  j       = 0;
+<a name="line2115">2115: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
+<a name="line2116">2116: </a>    <font color="#B22222">/* if indices are NOT locally sorted, need to start search at the beginning */</font>
+<a name="line2117">2117: </a>    <font color="#4169E1">if</font> (lastidx &gt; (idx = inidx[i])) j = 0;
+<a name="line2118">2118: </a>    lastidx = idx;
+<a name="line2119">2119: </a>    <font color="#4169E1">for</font> (; j&lt;size; j++) {
+<a name="line2120">2120: </a>      <font color="#4169E1">if</font> (idx &gt;= owners[j] &amp;&amp; idx &lt; owners[j+1]) {
+<a name="line2121">2121: </a>        nprocs[j]++;
+<a name="line2122">2122: </a>        owner[i] = j;
+<a name="line2123">2123: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line2124">2124: </a>        found = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line2125">2125: </a><font color="#A020F0">#endif</font>
+<a name="line2126">2126: </a>        <font color="#4169E1">break</font>;
+<a name="line2127">2127: </a>      }
+<a name="line2128">2128: </a>    }
+<a name="line2129">2129: </a><font color="#A020F0">#if defined(PETSC_USE_DEBUG)</font>
+<a name="line2130">2130: </a>    <font color="#4169E1">if</font> (!found) <A href="../../../../docs/manualpages/Sys/SETERRQ1.html#SETERRQ1">SETERRQ1</A>(PETSC_ERR_ARG_OUTOFRANGE,<font color="#666666">"Index %D out of range"</font>,idx);
+<a name="line2131">2131: </a>    found = <A href="../../../../docs/manualpages/Sys/PETSC_FALSE.html#PETSC_FALSE">PETSC_FALSE</A>;
+<a name="line2132">2132: </a><font color="#A020F0">#endif</font>
+<a name="line2133">2133: </a>  }
+<a name="line2134">2134: </a>  nsends = 0;  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) { nsends += (nprocs[i] &gt; 0);}
+
+<a name="line2136">2136: </a>  <font color="#B22222">/* inform other processors of number of messages and max length*/</font>
+<a name="line2137">2137: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherNumberOfMessages.html#PetscGatherNumberOfMessages">PetscGatherNumberOfMessages</A>(comm,<A href="../../../../docs/manualpages/Sys/PETSC_NULL.html#PETSC_NULL">PETSC_NULL</A>,nprocs,&amp;nrecvs);
+<a name="line2138">2138: </a>  <A href="../../../../docs/manualpages/Sys/PetscGatherMessageLengths.html#PetscGatherMessageLengths">PetscGatherMessageLengths</A>(comm,nsends,nrecvs,nprocs,&amp;onodes1,&amp;olengths1);
+<a name="line2139">2139: </a>  <A href="../../../../docs/manualpages/Sys/PetscSortMPIIntWithArray.html#PetscSortMPIIntWithArray">PetscSortMPIIntWithArray</A>(nrecvs,onodes1,olengths1);
+<a name="line2140">2140: </a>  recvtotal = 0; <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) recvtotal += olengths1[i];
+
+<a name="line2142">2142: </a>  <font color="#B22222">/* post receives:   */</font>
+<a name="line2143">2143: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc5.html#PetscMalloc5">PetscMalloc5</A>(2*recvtotal,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;rvalues,2*nx,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;svalues,nrecvs,MPI_Request,&amp;recv_waits,nsends,MPI_Request,&amp;send_waits,nsends,MPI_Status,&amp;send_status);
+
+<a name="line2145">2145: </a>  count = 0;
+<a name="line2146">2146: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
+<a name="line2147">2147: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Irecv.html#MPI_Irecv">MPI_Irecv</A>((rvalues+2*count),2*olengths1[i],MPIU_INT,onodes1[i],tag,comm,recv_waits+i);
+<a name="line2148">2148: </a>    count += olengths1[i];
+<a name="line2149">2149: </a>  }
+<a name="line2150">2150: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(onodes1);
+
+<a name="line2152">2152: </a>  <font color="#B22222">/* do sends:</font>
+<a name="line2153">2153: </a><font color="#B22222">      1) starts[i] gives the starting index in svalues for stuff going to </font>
+<a name="line2154">2154: </a><font color="#B22222">         the ith processor</font>
+<a name="line2155">2155: </a><font color="#B22222">  */</font>
+<a name="line2156">2156: </a>  starts[0]= 0;
+<a name="line2157">2157: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
+<a name="line2158">2158: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nx; i++) {
+<a name="line2159">2159: </a>    svalues[2*starts[owner[i]]]       = inidx[i];
+<a name="line2160">2160: </a>    svalues[1 + 2*starts[owner[i]]++] = inidy[i];
+<a name="line2161">2161: </a>  }
+
+<a name="line2163">2163: </a>  starts[0] = 0;
+<a name="line2164">2164: </a>  <font color="#4169E1">for</font> (i=1; i&lt;size+1; i++) { starts[i] = starts[i-1] + nprocs[i-1];}
+<a name="line2165">2165: </a>  count = 0;
+<a name="line2166">2166: </a>  <font color="#4169E1">for</font> (i=0; i&lt;size; i++) {
+<a name="line2167">2167: </a>    <font color="#4169E1">if</font> (nprocs[i]) {
+<a name="line2168">2168: </a>      <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Isend.html#MPI_Isend">MPI_Isend</A>(svalues+2*starts[i],2*nprocs[i],MPIU_INT,i,tag,comm,send_waits+count);
+<a name="line2169">2169: </a>      count++;
+<a name="line2170">2170: </a>    }
+<a name="line2171">2171: </a>  }
+<a name="line2172">2172: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree3.html#PetscFree3">PetscFree3</A>(nprocs,owner,starts);
+
+<a name="line2174">2174: </a>  <font color="#B22222">/*  wait on receives */</font>
+<a name="line2175">2175: </a>  count = nrecvs;
+<a name="line2176">2176: </a>  slen  = 0;
+<a name="line2177">2177: </a>  <font color="#4169E1">while</font> (count) {
+<a name="line2178">2178: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitany.html#MPI_Waitany">MPI_Waitany</A>(nrecvs,recv_waits,&amp;imdex,&amp;recv_status);
+<a name="line2179">2179: </a>    <font color="#B22222">/* unpack receives into our local space */</font>
+<a name="line2180">2180: </a>    <A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Get_count.html#MPI_Get_count">MPI_Get_count</A>(&amp;recv_status,MPIU_INT,&amp;n);
+<a name="line2181">2181: </a>    slen += n/2;
+<a name="line2182">2182: </a>    count--;
+<a name="line2183">2183: </a>  }
+<a name="line2184">2184: </a>  <font color="#4169E1">if</font> (slen != recvtotal) <A href="../../../../docs/manualpages/Sys/SETERRQ2.html#SETERRQ2">SETERRQ2</A>(PETSC_ERR_PLIB,<font color="#666666">"Total message lengths %D not as expected %D"</font>,slen,recvtotal);
+<a name="line2185">2185: </a>
+<a name="line2186">2186: </a>  <A href="../../../../docs/manualpages/Sys/PetscMalloc2.html#PetscMalloc2">PetscMalloc2</A>(slen,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;local_inidx,slen,<A href="../../../../docs/manualpages/Sys/PetscInt.html#PetscInt">PetscInt</A>,&amp;local_inidy);
+<a name="line2187">2187: </a>  base  = owners[rank];
+<a name="line2188">2188: </a>  count = 0;
+<a name="line2189">2189: </a>  rsvalues = rvalues;
+<a name="line2190">2190: </a>  <font color="#4169E1">for</font> (i=0; i&lt;nrecvs; i++) {
+<a name="line2191">2191: </a>    values = rsvalues;
+<a name="line2192">2192: </a>    rsvalues += 2*olengths1[i];
+<a name="line2193">2193: </a>    <font color="#4169E1">for</font> (j=0; j&lt;olengths1[i]; j++) {
+<a name="line2194">2194: </a>      local_inidx[count]   = values[2*j] - base;
+<a name="line2195">2195: </a>      local_inidy[count++] = values[2*j+1];
+<a name="line2196">2196: </a>    }
+<a name="line2197">2197: </a>  }
+<a name="line2198">2198: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree.html#PetscFree">PetscFree</A>(olengths1);
+
+<a name="line2200">2200: </a>  <font color="#B22222">/* wait on sends */</font>
+<a name="line2201">2201: </a>  <font color="#4169E1">if</font> (nsends) {<A href="http://www.mcs.anl.gov/mpi/www/www3/MPI_Waitall.html#MPI_Waitall">MPI_Waitall</A>(nsends,send_waits,send_status);}
+<a name="line2202">2202: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree5.html#PetscFree5">PetscFree5</A>(rvalues,svalues,recv_waits,send_waits,send_status);
+
+<a name="line2204">2204: </a>  <font color="#B22222">/*</font>
+<a name="line2205">2205: </a><font color="#B22222">     should sort and remove duplicates from local_inidx,local_inidy </font>
+<a name="line2206">2206: </a><font color="#B22222">  */</font>
+
+<a name="line2208">2208: </a><font color="#A020F0">#if defined(do_it_slow)</font>
+<a name="line2209">2209: </a>  <font color="#B22222">/* sort on the from index */</font>
+<a name="line2210">2210: </a>  <A href="../../../../docs/manualpages/Sys/PetscSortIntWithArray.html#PetscSortIntWithArray">PetscSortIntWithArray</A>(slen,local_inidx,local_inidy);
+<a name="line2211">2211: </a>  start = 0;
+<a name="line2212">2212: </a>  <font color="#4169E1">while</font> (start &lt; slen) {
+<a name="line2213">2213: </a>    count = start+1;
+<a name="line2214">2214: </a>    last  = local_inidx[start];
+<a name="line2215">2215: </a>    <font color="#4169E1">while</font> (count &lt; slen &amp;&amp; last == local_inidx[count]) count++;
+<a name="line2216">2216: </a>    <font color="#4169E1">if</font> (count &gt; start + 1) { <font color="#B22222">/* found 2 or more same local_inidx[] in a row */</font>
+<a name="line2217">2217: </a>      <font color="#B22222">/* sort on to index */</font>
+<a name="line2218">2218: </a>      <A href="../../../../docs/manualpages/Sys/PetscSortInt.html#PetscSortInt">PetscSortInt</A>(count-start,local_inidy+start);
+<a name="line2219">2219: </a>    }
+<a name="line2220">2220: </a>    <font color="#B22222">/* remove duplicates; not most efficient way, but probably good enough */</font>
+<a name="line2221">2221: </a>    i = start;
+<a name="line2222">2222: </a>    <font color="#4169E1">while</font> (i &lt; count-1) {
+<a name="line2223">2223: </a>      <font color="#4169E1">if</font> (local_inidy[i] != local_inidy[i+1]) {
+<a name="line2224">2224: </a>        i++;
+<a name="line2225">2225: </a>      } <font color="#4169E1">else</font> { <font color="#B22222">/* found a duplicate */</font>
+<a name="line2226">2226: </a>        duplicate = <A href="../../../../docs/manualpages/Sys/PETSC_TRUE.html#PETSC_TRUE">PETSC_TRUE</A>;
+<a name="line2227">2227: </a>        <font color="#4169E1">for</font> (j=i; j&lt;slen-1; j++) {
+<a name="line2228">2228: </a>          local_inidx[j] = local_inidx[j+1];
+<a name="line2229">2229: </a>          local_inidy[j] = local_inidy[j+1];
+<a name="line2230">2230: </a>        }
+<a name="line2231">2231: </a>        slen--;
+<a name="line2232">2232: </a>        count--;
+<a name="line2233">2233: </a>      }
+<a name="line2234">2234: </a>    }
+<a name="line2235">2235: </a>    start = count;
+<a name="line2236">2236: </a>  }
+<a name="line2237">2237: </a><font color="#A020F0">#endif</font>
+<a name="line2238">2238: </a>  <font color="#4169E1">if</font> (duplicate) {
+<a name="line2239">2239: </a>    <A href="../../../../docs/manualpages/Profiling/PetscInfo.html#PetscInfo">PetscInfo</A>(ctx,<font color="#666666">"Duplicate from to indices passed in <A href="../../../../docs/manualpages/Vec/VecScatterCreate.html#VecScatterCreate">VecScatterCreate</A>(), they are ignored\n"</font>);
+<a name="line2240">2240: </a>  }
+<a name="line2241">2241: </a>  VecScatterCreate_StoP(slen,local_inidx,slen,local_inidy,xin,yin,1,ctx);
+<a name="line2242">2242: </a>  <A href="../../../../docs/manualpages/Sys/PetscFree2.html#PetscFree2">PetscFree2</A>(local_inidx,local_inidy);
+<a name="line2243">2243: </a>  <font color="#4169E1">return</font>(0);
+<a name="line2244">2244: </a>}
 </pre>
 </body>
 
Index: petsc/TAGS
===================================================================
--- petsc.orig/TAGS
+++ petsc/TAGS
@@ -7,79 +7,79 @@
 CFLAGS	10,255
 FFLAGS	11,266
 all:all22,579
-all_build:all_build40,1906
-info:info44,2120
-MINFO 94,4325
-info_h:info_h95,4387
-build:build129,6225
-test:test140,6686
-testx11:testx11142,6806
-test_build:test_build144,6935
-testx11_build:testx11_build151,7474
-testexamples:testexamples158,7907
-testfortran:testfortran166,8350
-            ${OMAKE} PETSC_ARCH=${OMAKE} PETSC_ARCH174,8731
-            echo "Error:echo "Error177,8929
-testexamples_uni:testexamples_uni180,9053
-testfortran_uni:testfortran_uni188,9537
-            ${OMAKE} PETSC_ARCH=${OMAKE} PETSC_ARCH194,9839
-            echo "Error:echo "Error197,10058
-ranlib:ranlib203,10213
-deletelibs:deletelibs207,10295
-deletemods:deletemods209,10348
-allclean:allclean213,10436
-chk_petsc_dir:chk_petsc_dir220,10601
-install:install228,10841
-newall:newall231,10874
-alletags:alletags253,11759
-allfortranstubs:allfortranstubs257,11879
-deletefortranstubs:deletefortranstubs259,11942
-BMAKEFILES 265,12075
-SCRIPTS 266,12158
-alldoc:alldoc276,13080
-alldoc1:alldoc1279,13169
-alldoc2:alldoc2297,14166
-alldocclean:alldocclean301,14296
-deletemanualpages:deletemanualpages304,14376
-allcleanhtml:allcleanhtml313,14768
-chk_concepts_dir:chk_concepts_dir317,14874
-dist:dist326,15299
-web-snapshot:web-snapshot331,15462
-              petsc@harley.mcs.anl.gov:petsc@harley.mcs.anl.gov339,15864
-update-web-snapshot:update-web-snapshot345,16160
-update-web:update-web348,16241
-createfastbuild:createfastbuild358,16912
-gcov:gcov365,17199
-mergegcov:mergegcov368,17251
-allrcslabel:allrcslabel372,17374
-alladicignore:alladicignore378,17586
-alladic:alladic382,17704
-alladiclib:alladiclib390,18018
-            ${OMAKE} PETSC_ARCH=${OMAKE} PETSC_ARCH407,18814
-countfortranfunctions:countfortranfunctions413,19014
-countcfunctions:countcfunctions418,19240
-difffortranfunctions:difffortranfunctions423,19439
-checkbadfortranstubs:checkbadfortranstubs430,19908
-exercises:exercises466,21741
-.PHONY:.PHONY484,22831
-getsigs:getsigs489,23273
-petscao 517,24918
-petscda 518,24951
-petscdraw 519,24984
-petscis 520,25018
-petscksp 521,25048
-petsclog 522,25083
-petscmat 523,25115
-petscmg 524,25150
-petscpc 525,25183
-petscsnes 526,25216
-petscsys 527,25253
-petscts 528,25285
-petsc 529,25319
-petscvec 530,25339
-petscviewer 531,25373
-petscmesh 532,25411
-modules 533,25445
+all_build:all_build40,1933
+info:info44,2147
+MINFO 94,4352
+info_h:info_h95,4414
+build:build129,6252
+test:test140,6713
+testx11:testx11142,6833
+test_build:test_build144,6962
+testx11_build:testx11_build151,7501
+testexamples:testexamples158,7934
+testfortran:testfortran166,8377
+            ${OMAKE} PETSC_ARCH=${OMAKE} PETSC_ARCH174,8758
+            echo "Error:echo "Error177,8956
+testexamples_uni:testexamples_uni180,9080
+testfortran_uni:testfortran_uni188,9564
+            ${OMAKE} PETSC_ARCH=${OMAKE} PETSC_ARCH194,9866
+            echo "Error:echo "Error197,10085
+ranlib:ranlib203,10240
+deletelibs:deletelibs207,10322
+deletemods:deletemods209,10375
+allclean:allclean213,10463
+chk_petsc_dir:chk_petsc_dir220,10628
+install:install228,10868
+newall:newall231,10900
+alletags:alletags253,11785
+allfortranstubs:allfortranstubs257,11905
+deletefortranstubs:deletefortranstubs259,11968
+BMAKEFILES 265,12101
+SCRIPTS 266,12184
+alldoc:alldoc276,13106
+alldoc1:alldoc1279,13195
+alldoc2:alldoc2297,14192
+alldocclean:alldocclean301,14322
+deletemanualpages:deletemanualpages304,14402
+allcleanhtml:allcleanhtml313,14794
+chk_concepts_dir:chk_concepts_dir317,14900
+dist:dist326,15325
+web-snapshot:web-snapshot331,15488
+              petsc@harley.mcs.anl.gov:petsc@harley.mcs.anl.gov339,15890
+update-web-snapshot:update-web-snapshot345,16186
+update-web:update-web348,16267
+createfastbuild:createfastbuild358,16938
+gcov:gcov365,17225
+mergegcov:mergegcov368,17277
+allrcslabel:allrcslabel372,17400
+alladicignore:alladicignore378,17612
+alladic:alladic382,17730
+alladiclib:alladiclib390,18044
+            ${OMAKE} PETSC_ARCH=${OMAKE} PETSC_ARCH407,18840
+countfortranfunctions:countfortranfunctions413,19040
+countcfunctions:countcfunctions418,19266
+difffortranfunctions:difffortranfunctions423,19465
+checkbadfortranstubs:checkbadfortranstubs430,19934
+exercises:exercises466,21767
+.PHONY:.PHONY484,22857
+getsigs:getsigs489,23299
+petscao 517,24944
+petscda 518,24977
+petscdraw 519,25010
+petscis 520,25044
+petscksp 521,25074
+petsclog 522,25109
+petscmat 523,25141
+petscmg 524,25176
+petscpc 525,25209
+petscsnes 526,25242
+petscsys 527,25279
+petscts 528,25311
+petsc 529,25345
+petscvec 530,25365
+petscviewer 531,25399
+petscmesh 532,25437
+modules 533,25471
 
 setup.py,520
 setup.py:^?setup.py^A,1
@@ -1119,27 +1119,27 @@
   def checkCompilerFlag(834,37948
   def addCompilerFlag(855,38798
   def checkPIC(864,39363
-  def checkLargeFileIO(893,40589
-  def getArchiverFlags(912,41397
-  def generateArchiverGuesses(932,42069
-  def checkArchiver(992,45543
-    def checkArchive(994,45657
-    def checkRanlib(1003,46096
-  def setStaticLinker(1056,48630
-  def generateSharedLinkerGuesses(1060,48830
-  def checkSharedLinker(1099,50977
-  def checkLinkerFlag(1129,52536
-  def addLinkerFlag(1147,53252
-  def checkLinkerMac(1155,53602
-  def checkSharedLinkerPaths(1175,54402
-  def checkLibC(1208,55669
-  def generateDynamicLinkerGuesses(1234,56833
-  def checkDynamicLinker(1257,58326
-  def output(1303,60289
-  def updateMPICompilers(1335,61609
-  def checkMPICompilerOverride(1352,61995
-  def configure(1372,62826
-  def no_configure(1396,63740
+  def checkLargeFileIO(893,40597
+  def getArchiverFlags(912,41405
+  def generateArchiverGuesses(932,42077
+  def checkArchiver(992,45551
+    def checkArchive(994,45665
+    def checkRanlib(1003,46104
+  def setStaticLinker(1056,48638
+  def generateSharedLinkerGuesses(1060,48838
+  def checkSharedLinker(1100,51027
+  def checkLinkerFlag(1130,52586
+  def addLinkerFlag(1148,53302
+  def checkLinkerMac(1156,53652
+  def checkSharedLinkerPaths(1176,54452
+  def checkLibC(1209,55719
+  def generateDynamicLinkerGuesses(1235,56883
+  def checkDynamicLinker(1258,58376
+  def output(1304,60339
+  def updateMPICompilers(1336,61659
+  def checkMPICompilerOverride(1353,62045
+  def configure(1373,62876
+  def no_configure(1397,63790
 
 config/BuildSystem/config/programs.py,178
 programs.py:^?programs.py^A,1
@@ -1406,17 +1406,17 @@
   def checkLapack(81,3540
   def checkLib(98,4484
   def generateGuesses(131,6041
-  def getSharedFlag(309,22228
-  def getPrecisionFlag(314,22365
-  def getWindowsNonOptFlags(319,22515
-  def checkNoOptFlag(324,22665
-  def downLoadBlasLapack(330,22793
-  def configureLibrary(436,28418
-  def checkESSL(490,31560
-  def checkPESSL(496,31730
-  def checkMissing(502,31971
-  def checkForRoutine(518,32730
-  def configure(526,33123
+  def getSharedFlag(310,21991
+  def getPrecisionFlag(315,22137
+  def getWindowsNonOptFlags(320,22287
+  def checkNoOptFlag(325,22437
+  def downLoadBlasLapack(331,22565
+  def configureLibrary(437,28190
+  def checkESSL(491,31332
+  def checkPESSL(497,31502
+  def checkMissing(503,31743
+  def checkForRoutine(519,32502
+  def configure(527,32895
 
 config/BuildSystem/config/packages/UMFPACK.py,99
 UMFPACK.py:^?UMFPACK.py^A,1
@@ -2506,8 +2506,8 @@
 blopex.py:^?blopex.py^A,1
 class Configure(3,22
   def __init__(4,65
-  def setupDependencies(14,432
-  def Install(26,1103
+  def setupDependencies(14,434
+  def Install(30,1525
 
 config/PETSc/packages/Chaco.py,65
 Chaco.py:^?Chaco.py^A,1
@@ -2976,8 +2976,8 @@
   def setupHelp(29,723
   def setupDependencies(35,985
   def configureSharedLibraries(41,1235
-  def configureDynamicLibraries(64,2288
-  def configure(78,2909
+  def configureDynamicLibraries(66,2412
+  def configure(80,3033
 
 config/PETSc/utilities/petscdir.py,272
 petscdir.py:^?petscdir.py^A,1
@@ -3681,7 +3681,7 @@
 #define __PETSCADIC_H11,245
 typedef struct _n_PetscADICFunction* PetscADICFunction;20,573
 
-include/petscerror.h,3947
+include/petscerror.h,3975
 petscerror.h:^?petscerror.h^A,1
 #define __PETSCERROR_H5,89
 #define __INSDIR__ 18,535
@@ -3760,39 +3760,40 @@
 #define CHKERRABORT(479,19031
 #define CHKERRCONTINUE(480,19061
 #define CHKMEMQ 481,19089
-#define _ 484,19158
-#define ___ 485,19171
-#define PetscExceptionPush(488,19194
-#define PetscExceptionPop(489,19241
-#define PetscErrorSetCatchable(490,19288
-#define PetscErrorIsCatchable(491,19335
-#define PetscExceptionCaught(493,19393
-#define PetscExceptionValue(494,19450
-#define PetscExceptionTry1(495,19507
-#define PetscExceptionTrySyncNorm(496,19554
-EXTERN PetscErrorCode PETSC_DLLEXPORT PetscError(513,21016
-typedef enum {PETSC_FP_TRAP_OFF=PETSC_FP_TRAP_OFF521,21768
-typedef enum {PETSC_FP_TRAP_OFF=0,PETSC_FP_TRAP_ON=521,21768
-typedef enum {PETSC_FP_TRAP_OFF=0,PETSC_FP_TRAP_ON=1} PetscFPTrap;521,21768
-#define PETSCSTACKSIZE 529,21996
-  const char *function[function532,22041
-  const char *file[file533,22081
-  const char *directory[directory534,22117
-        int  line[line535,22158
-        int currentsize;536,22193
-} PetscStack;537,22218
-#define PetscStackActive 543,22439
-#define PetscFunctionBegin 571,22854
-#define PetscStackPush(581,23260
-#define PetscStackPop 590,23647
-#define PetscFunctionReturn(624,24389
-#define PetscFunctionReturnVoid(629,24461
-#define PetscFunctionBegin 637,24541
-#define PetscFunctionReturn(638,24569
-#define PetscFunctionReturnVoid(639,24611
-#define PetscStackPop 640,24652
-#define PetscStackPush(641,24675
-#define PetscStackActive 642,24702
+#define CHKERRXX(484,19142
+#define _ 488,19215
+#define ___ 489,19228
+#define PetscExceptionPush(492,19251
+#define PetscExceptionPop(493,19298
+#define PetscErrorSetCatchable(494,19345
+#define PetscErrorIsCatchable(495,19392
+#define PetscExceptionCaught(497,19450
+#define PetscExceptionValue(498,19507
+#define PetscExceptionTry1(499,19564
+#define PetscExceptionTrySyncNorm(500,19611
+EXTERN PetscErrorCode PETSC_DLLEXPORT PetscError(517,21073
+typedef enum {PETSC_FP_TRAP_OFF=PETSC_FP_TRAP_OFF525,21825
+typedef enum {PETSC_FP_TRAP_OFF=0,PETSC_FP_TRAP_ON=525,21825
+typedef enum {PETSC_FP_TRAP_OFF=0,PETSC_FP_TRAP_ON=1} PetscFPTrap;525,21825
+#define PETSCSTACKSIZE 533,22053
+  const char *function[function536,22098
+  const char *file[file537,22138
+  const char *directory[directory538,22174
+        int  line[line539,22215
+        int currentsize;540,22250
+} PetscStack;541,22275
+#define PetscStackActive 547,22496
+#define PetscFunctionBegin 575,22911
+#define PetscStackPush(585,23317
+#define PetscStackPop 594,23704
+#define PetscFunctionReturn(628,24446
+#define PetscFunctionReturnVoid(633,24518
+#define PetscFunctionBegin 641,24598
+#define PetscFunctionReturn(642,24626
+#define PetscFunctionReturnVoid(643,24668
+#define PetscStackPop 644,24709
+#define PetscStackPush(645,24732
+#define PetscStackActive 646,24759
 
 include/petscts.h,1750
 petscts.h:^?petscts.h^A,1
@@ -10545,7 +10546,7 @@
 #define PETSC_VIEWER_NETCDF 23,610
 #define PETSC_VIEWER_MATLAB 24,647
 
-include/finclude/petscmatdef.h,3062
+include/finclude/petscmatdef.h,3191
 petscmatdef.h:^?petscmatdef.h^A,1
 #define __PETSCMATDEF_H6,97
 #define Mat 11,199
@@ -10635,19 +10636,23 @@
 #define MATPYTHON 103,3153
 #define MATHYPRESTRUCT 104,3189
 #define MATHYPRESSTRUCT 105,3230
-#define MAT_SOLVER_SPOOLES 109,3296
-#define MAT_SOLVER_SUPERLU 110,3338
-#define MAT_SOLVER_SUPERLU_DIST 111,3380
-#define MAT_SOLVER_UMFPACK 112,3427
-#define MAT_SOLVER_ESSL 113,3469
-#define MAT_SOLVER_LUSOL 114,3508
-#define MAT_SOLVER_MUMPS 115,3548
-#define MAT_SOLVER_DSCPACK 116,3588
-#define MAT_SOLVER_MATLAB 117,3630
-#define MAT_SOLVER_PETSC 118,3671
-#define MAT_SOLVER_BAS 119,3711
+#define MATSUBMATRIX 106,3272
+#define MATFWK 108,3335
+#define MAT_SOLVER_SPOOLES 113,3400
+#define MAT_SOLVER_SUPERLU 114,3442
+#define MAT_SOLVER_SUPERLU_DIST 115,3484
+#define MAT_SOLVER_UMFPACK 116,3531
+#define MAT_SOLVER_ESSL 117,3573
+#define MAT_SOLVER_LUSOL 118,3612
+#define MAT_SOLVER_MUMPS 119,3652
+#define MAT_SOLVER_PASTIX 120,3692
+#define MAT_SOLVER_DSCPACK 121,3733
+#define MAT_SOLVER_MATLAB 122,3775
+#define MAT_SOLVER_PETSC 123,3816
+#define MAT_SOLVER_PLAPACK 124,3856
+#define MAT_SOLVER_BAS 125,3898
 
-include/finclude/petsckspdef.h,862
+include/finclude/petsckspdef.h,914
 petsckspdef.h:^?petsckspdef.h^A,1
 #define __PETSCKSPDEF_H6,97
 #define KSP 11,198
@@ -10682,6 +10687,8 @@
 #define KSPSYMMLQ 45,1030
 #define KSPLCD 46,1057
 #define KSPPYTHON 47,1078
+#define KSPBROYDEN 48,1105
+#define KSPGCR 49,1134
 
 include/finclude/petscda.h90.html,173
 petscda.h90.html:^?petscda.h90.html^A,1
@@ -12645,47 +12652,47 @@
 #define MPI_Comm_rank(627,27900
 #define MPI_Comm_compare(631,28021
 #define MPI_Comm_split(636,28216
-#define MPI_Comm_test_inter(637,28275
-#define MPI_Comm_remote_size(638,28338
-#define MPI_Comm_remote_group(639,28402
-#define MPI_Intercomm_create(640,28456
-#define MPI_Intercomm_merge(642,28570
-#define MPI_Topo_test(644,28640
-#define MPI_Cart_create(645,28687
-#define MPI_Dims_create(647,28777
-#define MPI_Graph_create(648,28848
-#define MPI_Graphdims_Get(649,28901
-#define MPI_Graph_get(650,28975
-#define MPI_Cartdim_get(651,29039
-#define MPI_Cart_get(652,29103
-#define MPI_Cart_rank(654,29193
-#define MPI_Cart_coords(655,29261
-#define MPI_Graph_neighbors_count(657,29346
-#define MPI_Graph_neighbors(659,29437
-#define MPI_Cart_shift(661,29534
-#define MPI_Cart_sub(663,29635
-#define MPI_Cart_map(664,29710
-#define MPI_Graph_map(665,29792
-#define MPI_Get_processor_name(666,29856
-#define MPI_Errhandler_create(668,29992
-#define MPI_Errhandler_set(671,30120
-#define MPI_Errhandler_get(675,30291
-#define MPI_Errhandler_free(676,30347
-#define MPI_Error_string(677,30399
-#define MPI_Error_class(678,30465
-#define MPI_Wtick(679,30523
-#define MPI_Wtime(680,30547
-#define MPI_Pcontrol(681,30571
-#define MPI_NULL_COPY_FN 683,30612
-#define MPI_NULL_DELETE_FN 684,30641
-#define MPI_File_open(688,30697
-#define MPI_File_close(696,31040
-#define MPI_File_set_view(700,31158
-#define MPI_Type_get_extent(709,31565
-#define MPI_File_write_all(713,31712
-#define MPI_File_read_all(721,32073
-#define MPI_Register_datarep(730,32490
-#define MPI_Type_create_subarray(738,32880
+#define MPI_Comm_test_inter(637,28290
+#define MPI_Comm_remote_size(638,28353
+#define MPI_Comm_remote_group(639,28417
+#define MPI_Intercomm_create(640,28471
+#define MPI_Intercomm_merge(642,28585
+#define MPI_Topo_test(644,28655
+#define MPI_Cart_create(645,28702
+#define MPI_Dims_create(647,28792
+#define MPI_Graph_create(648,28863
+#define MPI_Graphdims_Get(649,28916
+#define MPI_Graph_get(650,28990
+#define MPI_Cartdim_get(651,29054
+#define MPI_Cart_get(652,29118
+#define MPI_Cart_rank(654,29208
+#define MPI_Cart_coords(655,29276
+#define MPI_Graph_neighbors_count(657,29361
+#define MPI_Graph_neighbors(659,29452
+#define MPI_Cart_shift(661,29549
+#define MPI_Cart_sub(663,29650
+#define MPI_Cart_map(664,29725
+#define MPI_Graph_map(665,29807
+#define MPI_Get_processor_name(666,29871
+#define MPI_Errhandler_create(668,30007
+#define MPI_Errhandler_set(671,30135
+#define MPI_Errhandler_get(675,30306
+#define MPI_Errhandler_free(676,30362
+#define MPI_Error_string(677,30414
+#define MPI_Error_class(678,30480
+#define MPI_Wtick(679,30538
+#define MPI_Wtime(680,30562
+#define MPI_Pcontrol(681,30586
+#define MPI_NULL_COPY_FN 683,30627
+#define MPI_NULL_DELETE_FN 684,30656
+#define MPI_File_open(688,30712
+#define MPI_File_close(696,31055
+#define MPI_File_set_view(700,31173
+#define MPI_Type_get_extent(709,31580
+#define MPI_File_write_all(713,31727
+#define MPI_File_read_all(721,32088
+#define MPI_Register_datarep(730,32505
+#define MPI_Type_create_subarray(738,32895
 
 include/mpiuni/mpif.h,0
 mpif.h:^?mpif.h^A,1
@@ -17176,150 +17183,150 @@
 #undef __FUNCT__ 854,30437
 #define __FUNCT__ 855,30456
 PetscErrorCode MatAssemblyEnd_MPIBAIJ(856,30499
-#undef __FUNCT__ 955,34518
-#define __FUNCT__ 956,34537
-static PetscErrorCode MatView_MPIBAIJ_ASCIIorDraworSocket(957,34593
-#undef __FUNCT__ 1071,39578
-#define __FUNCT__ 1072,39597
-PetscErrorCode MatView_MPIBAIJ(1073,39633
-#undef __FUNCT__ 1091,40433
-#define __FUNCT__ 1092,40452
-PetscErrorCode MatDestroy_MPIBAIJ(1093,40491
-#undef __FUNCT__ 1131,42443
-#define __FUNCT__ 1132,42462
-PetscErrorCode MatMult_MPIBAIJ(1133,42498
-#undef __FUNCT__ 1155,43287
-#define __FUNCT__ 1156,43306
-PetscErrorCode MatMultAdd_MPIBAIJ(1157,43345
-#undef __FUNCT__ 1170,43836
-#define __FUNCT__ 1171,43855
-PetscErrorCode MatMultTranspose_MPIBAIJ(1172,43900
-#undef __FUNCT__ 1201,45100
-#define __FUNCT__ 1202,45119
-PetscErrorCode MatMultTransposeAdd_MPIBAIJ(1203,45167
-#undef __FUNCT__ 1226,46049
-#define __FUNCT__ 1227,46068
-PetscErrorCode MatGetDiagonal_MPIBAIJ(1228,46111
-#undef __FUNCT__ 1239,46442
-#define __FUNCT__ 1240,46461
-PetscErrorCode MatScale_MPIBAIJ(1241,46498
-#undef __FUNCT__ 1252,46758
-#define __FUNCT__ 1253,46777
-PetscErrorCode MatGetRow_MPIBAIJ(1254,46815
-#undef __FUNCT__ 1332,49668
-#define __FUNCT__ 1333,49687
-PetscErrorCode MatRestoreRow_MPIBAIJ(1334,49729
-#undef __FUNCT__ 1346,50064
-#define __FUNCT__ 1347,50083
-PetscErrorCode MatZeroEntries_MPIBAIJ(1348,50126
-#undef __FUNCT__ 1359,50383
-#define __FUNCT__ 1360,50402
-PetscErrorCode MatGetInfo_MPIBAIJ(1361,50441
-#undef __FUNCT__ 1405,52216
-#define __FUNCT__ 1406,52235
-PetscErrorCode MatSetOption_MPIBAIJ(1407,52276
-#undef __FUNCT__ 1448,53435
-#define __FUNCT__ 1449,53454
-PetscErrorCode MatTranspose_MPIBAIJ(1450,53496
-#undef __FUNCT__ 1513,55669
-#define __FUNCT__ 1514,55688
-PetscErrorCode MatDiagonalScale_MPIBAIJ(1515,55733
-#undef __FUNCT__ 1547,56920
-#define __FUNCT__ 1548,56939
-PetscErrorCode MatZeroRows_MPIBAIJ(1549,56979
-#undef __FUNCT__ 1699,62529
-#define __FUNCT__ 1700,62548
-PetscErrorCode MatSetUnfactored_MPIBAIJ(1701,62593
-#undef __FUNCT__ 1713,62886
-#define __FUNCT__ 1714,62905
-PetscErrorCode MatEqual_MPIBAIJ(1715,62942
-#undef __FUNCT__ 1734,63460
-#define __FUNCT__ 1735,63479
-PetscErrorCode MatCopy_MPIBAIJ(1736,63515
-#undef __FUNCT__ 1753,64089
-#define __FUNCT__ 1754,64108
-PetscErrorCode MatSetUpPreallocation_MPIBAIJ(1755,64158
-#undef __FUNCT__ 1764,64399
-#define __FUNCT__ 1765,64418
-PetscErrorCode MatAXPY_MPIBAIJ(1766,64454
-#undef __FUNCT__ 1790,65176
-#define __FUNCT__ 1791,65195
-PetscErrorCode MatSetBlockSize_MPIBAIJ(1792,65239
-#undef __FUNCT__ 1808,65857
-#define __FUNCT__ 1809,65876
-PetscErrorCode MatRealPart_MPIBAIJ(1810,65916
-#undef __FUNCT__ 1821,66166
-#define __FUNCT__ 1822,66185
-PetscErrorCode MatImaginaryPart_MPIBAIJ(1823,66230
-#undef __FUNCT__ 1834,66495
-#define __FUNCT__ 1835,66514
-PetscErrorCode MatGetSubMatrix_MPIBAIJ(1836,66558
-#undef __FUNCT__ 1858,67452
-#define __FUNCT__ 1859,67471
-PetscErrorCode MatGetSubMatrix_MPIBAIJ_Private(1865,67738
-#undef __FUNCT__1990,72021
-#define __FUNCT__ 1991,72038
-PetscErrorCode MatPermute_MPIBAIJ(1992,72077
-#undef __FUNCT__ 2053,74504
-#define __FUNCT__ 2054,74523
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetGhosts_MPIBAIJ(2055,74564
-#undef __FUNCT__ 2068,74962
-#define __FUNCT__ 2069,74981
-PetscErrorCode MatFDColoringCreate_MPIBAIJ(2073,75106
-#undef __FUNCT__ 2359,86752
-#define __FUNCT__ 2360,86771
-PetscErrorCode MatGetSeqNonzerostructure_MPIBAIJ(2361,86826
-#undef __FUNCT__ 2480,91601
-#define __FUNCT__ 2481,91620
-PetscErrorCode MatSOR_MPIBAIJ(2482,91655
-static struct _MatOps MatOps_Values 2559,94699
-#undef __FUNCT__ 2680,96761
-#define __FUNCT__ 2681,96780
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetDiagonalBlock_MPIBAIJ(2682,96828
-#undef __FUNCT__ 2696,97212
-#define __FUNCT__ 2697,97231
-PetscErrorCode MatMPIBAIJSetPreallocationCSR_MPIBAIJ(2698,97289
-#undef __FUNCT__ 2761,99528
-#define __FUNCT__ 2762,99547
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetPreallocationCSR(2781,100217
-#undef __FUNCT__2794,100703
-#define __FUNCT__ 2795,100720
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetPreallocation_MPIBAIJ(2796,100775
-#undef __FUNCT__ 2878,104023
-#define __FUNCT__ 2879,104042
-PetscErrorCode PETSCMAT_DLLEXPORT MatConvert_MPIBAIJ_MPIAdj(2880,104088
-#undef __FUNCT__ 2940,106057
-#define __FUNCT__ 2941,106076
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreate_MPIBAIJ(2942,106114
-#undef __FUNCT__3048,110742
-#define __FUNCT__ 3049,110759
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreate_BAIJ(3050,110794
-#undef __FUNCT__ 3066,111168
-#define __FUNCT__ 3067,111187
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetPreallocation(3148,115030
-#undef __FUNCT__ 3160,115522
-#define __FUNCT__ 3161,115541
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIBAIJ(3257,120138
-#undef __FUNCT__ 3276,120871
-#define __FUNCT__ 3277,120890
-static PetscErrorCode MatDuplicate_MPIBAIJ(3278,120931
-#undef __FUNCT__ 3363,124171
-#define __FUNCT__ 3364,124190
-PetscErrorCode MatLoad_MPIBAIJ(3365,124226
-#undef __FUNCT__ 3610,133742
-#define __FUNCT__ 3611,133761
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetHashTableFactor(3630,134174
-#undef __FUNCT__ 3643,134542
-#define __FUNCT__ 3644,134561
-PetscErrorCode PETSCMAT_DLLEXPORT MatSetHashTableFactor_MPIBAIJ(3645,134611
-#undef __FUNCT__ 3656,134845
-#define __FUNCT__ 3657,134864
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJGetSeqBAIJ(3658,134905
-#define matmpibaijsetvaluesblocked_ 3672,135295
-#define matmpibaijsetvaluesblocked_ 3674,135404
-#undef __FUNCT__ 3677,135475
-#define __FUNCT__ 3678,135494
-PetscErrorCode matmpibaijsetvaluesblocked_(3699,136026
+#undef __FUNCT__ 955,34519
+#define __FUNCT__ 956,34538
+static PetscErrorCode MatView_MPIBAIJ_ASCIIorDraworSocket(957,34594
+#undef __FUNCT__ 1071,39579
+#define __FUNCT__ 1072,39598
+PetscErrorCode MatView_MPIBAIJ(1073,39634
+#undef __FUNCT__ 1091,40434
+#define __FUNCT__ 1092,40453
+PetscErrorCode MatDestroy_MPIBAIJ(1093,40492
+#undef __FUNCT__ 1131,42444
+#define __FUNCT__ 1132,42463
+PetscErrorCode MatMult_MPIBAIJ(1133,42499
+#undef __FUNCT__ 1155,43288
+#define __FUNCT__ 1156,43307
+PetscErrorCode MatMultAdd_MPIBAIJ(1157,43346
+#undef __FUNCT__ 1170,43837
+#define __FUNCT__ 1171,43856
+PetscErrorCode MatMultTranspose_MPIBAIJ(1172,43901
+#undef __FUNCT__ 1201,45101
+#define __FUNCT__ 1202,45120
+PetscErrorCode MatMultTransposeAdd_MPIBAIJ(1203,45168
+#undef __FUNCT__ 1226,46050
+#define __FUNCT__ 1227,46069
+PetscErrorCode MatGetDiagonal_MPIBAIJ(1228,46112
+#undef __FUNCT__ 1239,46443
+#define __FUNCT__ 1240,46462
+PetscErrorCode MatScale_MPIBAIJ(1241,46499
+#undef __FUNCT__ 1252,46759
+#define __FUNCT__ 1253,46778
+PetscErrorCode MatGetRow_MPIBAIJ(1254,46816
+#undef __FUNCT__ 1332,49669
+#define __FUNCT__ 1333,49688
+PetscErrorCode MatRestoreRow_MPIBAIJ(1334,49730
+#undef __FUNCT__ 1346,50065
+#define __FUNCT__ 1347,50084
+PetscErrorCode MatZeroEntries_MPIBAIJ(1348,50127
+#undef __FUNCT__ 1359,50384
+#define __FUNCT__ 1360,50403
+PetscErrorCode MatGetInfo_MPIBAIJ(1361,50442
+#undef __FUNCT__ 1405,52217
+#define __FUNCT__ 1406,52236
+PetscErrorCode MatSetOption_MPIBAIJ(1407,52277
+#undef __FUNCT__ 1448,53436
+#define __FUNCT__ 1449,53455
+PetscErrorCode MatTranspose_MPIBAIJ(1450,53497
+#undef __FUNCT__ 1513,55670
+#define __FUNCT__ 1514,55689
+PetscErrorCode MatDiagonalScale_MPIBAIJ(1515,55734
+#undef __FUNCT__ 1547,56921
+#define __FUNCT__ 1548,56940
+PetscErrorCode MatZeroRows_MPIBAIJ(1549,56980
+#undef __FUNCT__ 1699,62530
+#define __FUNCT__ 1700,62549
+PetscErrorCode MatSetUnfactored_MPIBAIJ(1701,62594
+#undef __FUNCT__ 1713,62887
+#define __FUNCT__ 1714,62906
+PetscErrorCode MatEqual_MPIBAIJ(1715,62943
+#undef __FUNCT__ 1734,63461
+#define __FUNCT__ 1735,63480
+PetscErrorCode MatCopy_MPIBAIJ(1736,63516
+#undef __FUNCT__ 1753,64090
+#define __FUNCT__ 1754,64109
+PetscErrorCode MatSetUpPreallocation_MPIBAIJ(1755,64159
+#undef __FUNCT__ 1764,64400
+#define __FUNCT__ 1765,64419
+PetscErrorCode MatAXPY_MPIBAIJ(1766,64455
+#undef __FUNCT__ 1790,65177
+#define __FUNCT__ 1791,65196
+PetscErrorCode MatSetBlockSize_MPIBAIJ(1792,65240
+#undef __FUNCT__ 1808,65858
+#define __FUNCT__ 1809,65877
+PetscErrorCode MatRealPart_MPIBAIJ(1810,65917
+#undef __FUNCT__ 1821,66167
+#define __FUNCT__ 1822,66186
+PetscErrorCode MatImaginaryPart_MPIBAIJ(1823,66231
+#undef __FUNCT__ 1834,66496
+#define __FUNCT__ 1835,66515
+PetscErrorCode MatGetSubMatrix_MPIBAIJ(1836,66559
+#undef __FUNCT__ 1858,67453
+#define __FUNCT__ 1859,67472
+PetscErrorCode MatGetSubMatrix_MPIBAIJ_Private(1865,67739
+#undef __FUNCT__1990,72022
+#define __FUNCT__ 1991,72039
+PetscErrorCode MatPermute_MPIBAIJ(1992,72078
+#undef __FUNCT__ 2053,74505
+#define __FUNCT__ 2054,74524
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetGhosts_MPIBAIJ(2055,74565
+#undef __FUNCT__ 2068,74963
+#define __FUNCT__ 2069,74982
+PetscErrorCode MatFDColoringCreate_MPIBAIJ(2073,75107
+#undef __FUNCT__ 2359,86753
+#define __FUNCT__ 2360,86772
+PetscErrorCode MatGetSeqNonzerostructure_MPIBAIJ(2361,86827
+#undef __FUNCT__ 2480,91602
+#define __FUNCT__ 2481,91621
+PetscErrorCode MatSOR_MPIBAIJ(2482,91656
+static struct _MatOps MatOps_Values 2559,94700
+#undef __FUNCT__ 2680,96762
+#define __FUNCT__ 2681,96781
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetDiagonalBlock_MPIBAIJ(2682,96829
+#undef __FUNCT__ 2696,97213
+#define __FUNCT__ 2697,97232
+PetscErrorCode MatMPIBAIJSetPreallocationCSR_MPIBAIJ(2698,97290
+#undef __FUNCT__ 2761,99529
+#define __FUNCT__ 2762,99548
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetPreallocationCSR(2781,100218
+#undef __FUNCT__2794,100704
+#define __FUNCT__ 2795,100721
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetPreallocation_MPIBAIJ(2796,100776
+#undef __FUNCT__ 2878,104024
+#define __FUNCT__ 2879,104043
+PetscErrorCode PETSCMAT_DLLEXPORT MatConvert_MPIBAIJ_MPIAdj(2880,104089
+#undef __FUNCT__ 2940,106058
+#define __FUNCT__ 2941,106077
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreate_MPIBAIJ(2942,106115
+#undef __FUNCT__3048,110743
+#define __FUNCT__ 3049,110760
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreate_BAIJ(3050,110795
+#undef __FUNCT__ 3066,111169
+#define __FUNCT__ 3067,111188
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetPreallocation(3148,115031
+#undef __FUNCT__ 3160,115523
+#define __FUNCT__ 3161,115542
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIBAIJ(3257,120139
+#undef __FUNCT__ 3276,120872
+#define __FUNCT__ 3277,120891
+static PetscErrorCode MatDuplicate_MPIBAIJ(3278,120932
+#undef __FUNCT__ 3363,124172
+#define __FUNCT__ 3364,124191
+PetscErrorCode MatLoad_MPIBAIJ(3365,124227
+#undef __FUNCT__ 3610,133743
+#define __FUNCT__ 3611,133762
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJSetHashTableFactor(3630,134175
+#undef __FUNCT__ 3643,134543
+#define __FUNCT__ 3644,134562
+PetscErrorCode PETSCMAT_DLLEXPORT MatSetHashTableFactor_MPIBAIJ(3645,134612
+#undef __FUNCT__ 3656,134846
+#define __FUNCT__ 3657,134865
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIBAIJGetSeqBAIJ(3658,134906
+#define matmpibaijsetvaluesblocked_ 3672,135296
+#define matmpibaijsetvaluesblocked_ 3674,135405
+#undef __FUNCT__ 3677,135476
+#define __FUNCT__ 3678,135495
+PetscErrorCode matmpibaijsetvaluesblocked_(3699,136027
 
 src/mat/impls/baij/mpi/ftn-custom/makefile,140
 makefile:^?makefile^A,1
@@ -19052,12 +19059,12 @@
 #undef __FUNCT__ 5,110
 #define __FUNCT__ 6,129
 PetscErrorCode MatMult_SeqSBAIJ_1_Hermitian_ushort(8,200
-#undef __FUNCT__ 56,1610
-#define __FUNCT__ 57,1629
-PetscErrorCode MatMult_SeqSBAIJ_1_ushort(59,1690
-#undef __FUNCT__ 107,3080
-#define __FUNCT__ 108,3099
-PetscErrorCode MatSOR_SeqSBAIJ_ushort(110,3157
+#undef __FUNCT__ 59,1755
+#define __FUNCT__ 60,1774
+PetscErrorCode MatMult_SeqSBAIJ_1_ushort(62,1835
+#undef __FUNCT__ 113,3368
+#define __FUNCT__ 114,3387
+PetscErrorCode MatSOR_SeqSBAIJ_ushort(116,3445
 
 src/mat/impls/sbaij/seq/sbaijfact9.c,132
 sbaijfact9.c:^?sbaijfact9.c^A,1
@@ -20127,21 +20134,21 @@
 #undef __FUNCT__ 142,3957
 #define __FUNCT__ 143,3977
 static PetscErrorCode MatMultAdd_SubMatrix(144,4018
-#undef __FUNCT__ 163,4879
-#define __FUNCT__ 164,4898
-static PetscErrorCode MatMultTranspose_SubMatrix(165,4945
-#undef __FUNCT__ 184,5804
-#define __FUNCT__ 185,5823
-static PetscErrorCode MatMultTransposeAdd_SubMatrix(186,5873
-#undef __FUNCT__ 205,6752
-#define __FUNCT__ 206,6771
-static PetscErrorCode MatDestroy_SubMatrix(207,6812
-#undef __FUNCT__228,7616
-#define __FUNCT__ 229,7633
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreateSubMatrix(250,8176
-#undef __FUNCT__ 313,10604
-#define __FUNCT__ 314,10623
-PetscErrorCode PETSCMAT_DLLEXPORT MatSubMatrixUpdate(333,11169
+#undef __FUNCT__ 176,5591
+#define __FUNCT__ 177,5610
+static PetscErrorCode MatMultTranspose_SubMatrix(178,5657
+#undef __FUNCT__ 197,6516
+#define __FUNCT__ 198,6535
+static PetscErrorCode MatMultTransposeAdd_SubMatrix(199,6585
+#undef __FUNCT__ 231,8174
+#define __FUNCT__ 232,8193
+static PetscErrorCode MatDestroy_SubMatrix(233,8234
+#undef __FUNCT__254,9038
+#define __FUNCT__ 255,9055
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreateSubMatrix(276,9598
+#undef __FUNCT__ 339,12026
+#define __FUNCT__ 340,12045
+PetscErrorCode PETSCMAT_DLLEXPORT MatSubMatrixUpdate(359,12591
 
 src/mat/impls/lrc/makefile,165
 makefile:^?makefile^A,1
@@ -21962,259 +21969,259 @@
 #undef __FUNCT__ 480,18853
 #define __FUNCT__ 481,18872
 PetscErrorCode MatAssemblyEnd_MPIAIJ(482,18914
-#undef __FUNCT__ 549,21603
-#define __FUNCT__ 550,21622
-PetscErrorCode MatZeroEntries_MPIAIJ(551,21664
-#undef __FUNCT__ 562,21919
-#define __FUNCT__ 563,21938
-PetscErrorCode MatZeroRows_MPIAIJ(564,21977
-#undef __FUNCT__ 712,27476
-#define __FUNCT__ 713,27495
-PetscErrorCode MatMult_MPIAIJ(714,27530
-#undef __FUNCT__ 732,28196
-#define __FUNCT__ 733,28215
-PetscErrorCode MatMultDiagonalBlock_MPIAIJ(734,28263
-#undef __FUNCT__ 744,28507
-#define __FUNCT__ 745,28526
-PetscErrorCode MatMultAdd_MPIAIJ(746,28564
-#undef __FUNCT__ 759,29053
-#define __FUNCT__ 760,29072
-PetscErrorCode MatMultTranspose_MPIAIJ(761,29116
-#undef __FUNCT__791,30327
-#define __FUNCT__ 792,30344
-PetscErrorCode PETSCMAT_DLLEXPORT MatIsTranspose_MPIAIJ(793,30386
-#undef __FUNCT__ 835,32118
-#define __FUNCT__ 836,32137
-PetscErrorCode MatMultTransposeAdd_MPIAIJ(837,32184
-#undef __FUNCT__ 858,32898
-#define __FUNCT__ 859,32917
-PetscErrorCode MatGetDiagonal_MPIAIJ(860,32959
-#undef __FUNCT__ 874,33445
-#define __FUNCT__ 875,33464
-PetscErrorCode MatScale_MPIAIJ(876,33500
-#undef __FUNCT__ 887,33758
-#define __FUNCT__ 888,33777
-PetscErrorCode MatDestroy_MPIAIJ(889,33815
-#undef __FUNCT__ 926,35750
-#define __FUNCT__ 927,35769
-PetscErrorCode MatView_MPIAIJ_Binary(928,35811
-#undef __FUNCT__ 1052,41065
-#define __FUNCT__ 1053,41084
-PetscErrorCode MatView_MPIAIJ_ASCIIorDraworSocket(1054,41139
-#undef __FUNCT__ 1189,47509
-#define __FUNCT__ 1190,47528
-PetscErrorCode MatView_MPIAIJ(1191,47563
-#undef __FUNCT__ 1209,48363
-#define __FUNCT__ 1210,48382
-PetscErrorCode MatSOR_MPIAIJ(1211,48416
-#undef __FUNCT__1311,52526
-#define __FUNCT__ 1312,52543
-PetscErrorCode MatPermute_MPIAIJ(1313,52581
-#undef __FUNCT__ 1374,55006
-#define __FUNCT__ 1375,55025
-PetscErrorCode MatGetInfo_MPIAIJ(1376,55063
-#undef __FUNCT__ 1419,56730
-#define __FUNCT__ 1420,56749
-PetscErrorCode MatSetOption_MPIAIJ(1421,56789
-#undef __FUNCT__ 1467,58135
-#define __FUNCT__ 1468,58154
-PetscErrorCode MatGetRow_MPIAIJ(1469,58191
-#undef __FUNCT__ 1547,60914
-#define __FUNCT__ 1548,60933
-PetscErrorCode MatRestoreRow_MPIAIJ(1549,60974
-#undef __FUNCT__ 1561,61315
-#define __FUNCT__ 1562,61334
-PetscErrorCode MatNorm_MPIAIJ(1563,61369
-#undef __FUNCT__ 1638,63967
-#define __FUNCT__ 1639,63986
-PetscErrorCode MatTranspose_MPIAIJ(1640,64026
-#undef __FUNCT__ 1709,66599
-#define __FUNCT__ 1710,66618
-PetscErrorCode MatDiagonalScale_MPIAIJ(1711,66662
-#undef __FUNCT__ 1743,67821
-#define __FUNCT__ 1744,67840
-PetscErrorCode MatSetBlockSize_MPIAIJ(1745,67883
-#undef __FUNCT__ 1757,68280
-#define __FUNCT__ 1758,68299
-PetscErrorCode MatSetUnfactored_MPIAIJ(1759,68343
-#undef __FUNCT__ 1769,68559
-#define __FUNCT__ 1770,68578
-PetscErrorCode MatEqual_MPIAIJ(1771,68614
-#undef __FUNCT__ 1790,69129
-#define __FUNCT__ 1791,69148
-PetscErrorCode MatCopy_MPIAIJ(1792,69183
-#undef __FUNCT__ 1814,70136
-#define __FUNCT__ 1815,70155
-PetscErrorCode MatSetUpPreallocation_MPIAIJ(1816,70204
-#undef __FUNCT__ 1825,70418
-#define __FUNCT__ 1826,70437
-PetscErrorCode MatAXPY_MPIAIJ(1827,70472
-#undef __FUNCT__ 1869,71914
-#define __FUNCT__ 1870,71933
-PetscErrorCode PETSCMAT_DLLEXPORT MatConjugate_MPIAIJ(1871,71973
-#undef __FUNCT__ 1886,72332
-#define __FUNCT__ 1887,72351
-PetscErrorCode MatRealPart_MPIAIJ(1888,72390
-#undef __FUNCT__ 1899,72637
-#define __FUNCT__ 1900,72656
-PetscErrorCode MatImaginaryPart_MPIAIJ(1901,72700
-#undef __FUNCT__ 1922,73349
-#define __FUNCT__ 1923,73368
-PetscErrorCode MatILUFactorSymbolic_MPIAIJ(1927,73508
-  typedef graph_dist::ilu_default::ilu_level_graph_type  lgraph_type;1949,74343
-#undef __FUNCT__ 1972,75415
-#define __FUNCT__ 1973,75434
-PetscErrorCode MatLUFactorNumeric_MPIAIJ(1974,75480
-#undef __FUNCT__ 1980,75614
-#define __FUNCT__ 1981,75633
-PetscErrorCode MatSolve_MPIAIJ(1985,75761
-  typedef graph_dist::ilu_default::ilu_level_graph_type  lgraph_type;1989,75868
-  typedef boost::multi_array_ref<PetscScalar, 1> array_ref_type;2012,76619
-                                boost::property_map<graph_dist::ilu_default::graph_type, boost::vertex_index_t>::type>  gvector_type;2017,76955
-  PetscInt       nzlocal,::nzlocal2028,77472
-  PetscInt       nzlocal,nsends,::nsends2028,77472
-  PetscInt       nzlocal,nsends,nrecvs;::nrecvs2028,77472
-  PetscMPIInt    *send_rank,::send_rank2029,77512
-  PetscMPIInt    *send_rank,*recv_rank;::recv_rank2029,77512
-  PetscInt       *sbuf_nz,::sbuf_nz2030,77552
-  PetscInt       *sbuf_nz,*rbuf_nz,::rbuf_nz2030,77552
-  PetscInt       *sbuf_nz,*rbuf_nz,*sbuf_j,::sbuf_j2030,77552
-  PetscInt       *sbuf_nz,*rbuf_nz,*sbuf_j,**rbuf_j;::rbuf_j2030,77552
-  PetscScalar    *sbuf_a,::sbuf_a2031,77605
-  PetscScalar    *sbuf_a,**rbuf_a;::rbuf_a2031,77605
-} Mat_Redundant;2033,77677
-#undef __FUNCT__ 2035,77695
-#define __FUNCT__ 2036,77714
-PetscErrorCode PetscContainerDestroy_MatRedundant(2037,77769
-#undef __FUNCT__ 2056,78453
-#define __FUNCT__ 2057,78472
-PetscErrorCode MatDestroy_MatRedundant(2058,78516
-#undef __FUNCT__ 2078,79195
-#define __FUNCT__ 2079,79214
-PetscErrorCode MatGetRedundantMatrix_MPIAIJ(2080,79263
-#undef __FUNCT__ 2401,92250
-#define __FUNCT__ 2402,92269
-PetscErrorCode MatGetRowMaxAbs_MPIAIJ(2403,92312
-#undef __FUNCT__ 2443,93426
-#define __FUNCT__ 2444,93445
-PetscErrorCode MatGetRowMinAbs_MPIAIJ(2445,93488
-#undef __FUNCT__ 2485,94602
-#define __FUNCT__ 2486,94621
-PetscErrorCode MatGetRowMin_MPIAIJ(2487,94661
-#undef __FUNCT__ 2526,96183
-#define __FUNCT__ 2527,96202
-PetscErrorCode MatGetRowMax_MPIAIJ(2528,96242
-#undef __FUNCT__ 2567,97764
-#define __FUNCT__ 2568,97783
-PetscErrorCode MatGetSeqNonzerostructure_MPIAIJ(2569,97837
-static struct _MatOps MatOps_Values 2583,98354
-#undef __FUNCT__ 2724,101069
-#define __FUNCT__ 2725,101088
-PetscErrorCode PETSCMAT_DLLEXPORT MatStoreValues_MPIAIJ(2726,101130
-#undef __FUNCT__ 2739,101443
-#define __FUNCT__ 2740,101462
-PetscErrorCode PETSCMAT_DLLEXPORT MatRetrieveValues_MPIAIJ(2741,101507
-#undef __FUNCT__ 2755,101850
-#define __FUNCT__ 2756,101869
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocation_MPIAIJ(2757,101922
-#undef __FUNCT__ 2804,103892
-#define __FUNCT__ 2805,103911
-PetscErrorCode MatDuplicate_MPIAIJ(2806,103951
-#undef __FUNCT__ 2867,106493
-#define __FUNCT__ 2868,106512
-PetscErrorCode MatLoad_MPIAIJ(2869,106547
-#undef __FUNCT__ 3071,114148
-#define __FUNCT__ 3072,114167
-PetscErrorCode MatGetSubMatrix_MPIAIJ(3073,114210
-#undef __FUNCT__ 3095,115102
-#define __FUNCT__ 3096,115121
-PetscErrorCode MatGetSubMatrix_MPIAIJ_Private(3104,115453
-#undef __FUNCT__ 3225,119564
-#define __FUNCT__ 3226,119583
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocationCSR_MPIAIJ(3227,119639
-#undef __FUNCT__ 3294,121956
-#define __FUNCT__ 3295,121975
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocationCSR(3341,123649
-#undef __FUNCT__ 3353,124094
-#define __FUNCT__ 3354,124113
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocation(3481,129927
-#undef __FUNCT__ 3493,130393
-#define __FUNCT__ 3494,130412
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIAIJWithArrays(3549,132476
-#undef __FUNCT__ 3565,133154
-#define __FUNCT__ 3566,133173
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIAIJ(3740,141188
-#undef __FUNCT__ 3759,141898
-#define __FUNCT__ 3760,141917
-PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJGetSeqAIJ(3761,141956
-#undef __FUNCT__ 3772,142207
-#define __FUNCT__ 3773,142226
-PetscErrorCode MatSetColoring_MPIAIJ(3774,142268
-#undef __FUNCT__ 3837,145057
-#define __FUNCT__ 3838,145076
-PetscErrorCode MatSetValuesAdic_MPIAIJ(3839,145120
-#undef __FUNCT__ 3851,145437
-#define __FUNCT__ 3852,145456
-PetscErrorCode MatSetValuesAdifor_MPIAIJ(3853,145502
-#undef __FUNCT__ 3864,145836
-#define __FUNCT__ 3865,145855
-PetscErrorCode PETSCMAT_DLLEXPORT MatMerge(3886,146456
-#undef __FUNCT__ 3935,148462
-#define __FUNCT__ 3936,148481
-PetscErrorCode MatFileSplit(3937,148514
-#undef __FUNCT__ 3979,150161
-#define __FUNCT__ 3980,150180
-PetscErrorCode PETSCMAT_DLLEXPORT MatDestroy_MPIAIJ_SeqsToMPI(3981,150228
-#undef __FUNCT__ 4017,151612
-#define __FUNCT__ 4018,151631
-PetscErrorCode PETSCMAT_DLLEXPORT MatMerge_SeqsToMPINumeric(4042,152470
-#undef __FUNCT__ 4159,156909
-#define __FUNCT__ 4160,156928
-PetscErrorCode PETSCMAT_DLLEXPORT MatMerge_SeqsToMPISymbolic(4161,156975
-#undef __FUNCT__4408,167163
-#define __FUNCT__ 4409,167180
-PetscErrorCode PETSCMAT_DLLEXPORT MatMerge_SeqsToMPI(4410,167219
-#undef __FUNCT__4424,167754
-#define __FUNCT__ 4425,167771
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetLocalMat(4441,168108
-#undef __FUNCT__4519,170848
-#define __FUNCT__ 4520,170865
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetLocalMatCondensed(4537,171317
-#undef __FUNCT__4589,172977
-#define __FUNCT__ 4590,172994
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetBrowsOfAcols(4609,173634
-#undef __FUNCT__4664,175704
-#define __FUNCT__ 4665,175721
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetBrowsOfAoCols(4685,176390
-#undef __FUNCT__4890,184708
-#define __FUNCT__ 4891,184725
-PetscErrorCode PETSCMAT_DLLEXPORT MatGetCommunicationStructs(4909,185288
-#undef __FUNCT__4934,186235
-#define __FUNCT__ 4935,186252
-PetscErrorCode MatMatMultNumeric_MPIDense_MPIAIJ(4945,186677
-#undef __FUNCT__4961,187230
-#define __FUNCT__ 4962,187247
-PetscErrorCode MatMatMultSymbolic_MPIDense_MPIAIJ(4963,187302
-#undef __FUNCT__4982,188128
-#define __FUNCT__ 4983,188145
-PetscErrorCode MatMatMult_MPIDense_MPIAIJ(4984,188192
-#undef __FUNCT__ 5023,189313
-#define __FUNCT__ 5024,189332
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreate_MPIAIJ(5025,189369
-#undef __FUNCT__ 5125,194446
-#define __FUNCT__ 5126,194465
-PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIAIJWithSplitArrays(5169,196140
-#define matsetvaluesmpiaij_ 5212,197952
-#define matsetvaluesmpiaij_ 5214,198045
-#undef CHKERRQ5218,198158
-#define CHKERRQ(5219,198173
-#undef SETERRQ25220,198239
-#define SETERRQ2(5221,198255
-#undef SETERRQ5222,198328
-#define SETERRQ(5223,198343
-#undef __FUNCT__ 5226,198427
-#define __FUNCT__ 5227,198446
-void PETSC_STDCALL matsetvaluesmpiaij_(5228,198486
+#undef __FUNCT__ 549,21604
+#define __FUNCT__ 550,21623
+PetscErrorCode MatZeroEntries_MPIAIJ(551,21665
+#undef __FUNCT__ 562,21920
+#define __FUNCT__ 563,21939
+PetscErrorCode MatZeroRows_MPIAIJ(564,21978
+#undef __FUNCT__ 712,27477
+#define __FUNCT__ 713,27496
+PetscErrorCode MatMult_MPIAIJ(714,27531
+#undef __FUNCT__ 732,28197
+#define __FUNCT__ 733,28216
+PetscErrorCode MatMultDiagonalBlock_MPIAIJ(734,28264
+#undef __FUNCT__ 744,28508
+#define __FUNCT__ 745,28527
+PetscErrorCode MatMultAdd_MPIAIJ(746,28565
+#undef __FUNCT__ 759,29054
+#define __FUNCT__ 760,29073
+PetscErrorCode MatMultTranspose_MPIAIJ(761,29117
+#undef __FUNCT__791,30328
+#define __FUNCT__ 792,30345
+PetscErrorCode PETSCMAT_DLLEXPORT MatIsTranspose_MPIAIJ(793,30387
+#undef __FUNCT__ 835,32119
+#define __FUNCT__ 836,32138
+PetscErrorCode MatMultTransposeAdd_MPIAIJ(837,32185
+#undef __FUNCT__ 858,32899
+#define __FUNCT__ 859,32918
+PetscErrorCode MatGetDiagonal_MPIAIJ(860,32960
+#undef __FUNCT__ 874,33446
+#define __FUNCT__ 875,33465
+PetscErrorCode MatScale_MPIAIJ(876,33501
+#undef __FUNCT__ 887,33759
+#define __FUNCT__ 888,33778
+PetscErrorCode MatDestroy_MPIAIJ(889,33816
+#undef __FUNCT__ 926,35751
+#define __FUNCT__ 927,35770
+PetscErrorCode MatView_MPIAIJ_Binary(928,35812
+#undef __FUNCT__ 1052,41066
+#define __FUNCT__ 1053,41085
+PetscErrorCode MatView_MPIAIJ_ASCIIorDraworSocket(1054,41140
+#undef __FUNCT__ 1189,47510
+#define __FUNCT__ 1190,47529
+PetscErrorCode MatView_MPIAIJ(1191,47564
+#undef __FUNCT__ 1209,48364
+#define __FUNCT__ 1210,48383
+PetscErrorCode MatSOR_MPIAIJ(1211,48417
+#undef __FUNCT__1311,52527
+#define __FUNCT__ 1312,52544
+PetscErrorCode MatPermute_MPIAIJ(1313,52582
+#undef __FUNCT__ 1374,55007
+#define __FUNCT__ 1375,55026
+PetscErrorCode MatGetInfo_MPIAIJ(1376,55064
+#undef __FUNCT__ 1419,56731
+#define __FUNCT__ 1420,56750
+PetscErrorCode MatSetOption_MPIAIJ(1421,56790
+#undef __FUNCT__ 1467,58136
+#define __FUNCT__ 1468,58155
+PetscErrorCode MatGetRow_MPIAIJ(1469,58192
+#undef __FUNCT__ 1547,60915
+#define __FUNCT__ 1548,60934
+PetscErrorCode MatRestoreRow_MPIAIJ(1549,60975
+#undef __FUNCT__ 1561,61316
+#define __FUNCT__ 1562,61335
+PetscErrorCode MatNorm_MPIAIJ(1563,61370
+#undef __FUNCT__ 1638,63968
+#define __FUNCT__ 1639,63987
+PetscErrorCode MatTranspose_MPIAIJ(1640,64027
+#undef __FUNCT__ 1709,66600
+#define __FUNCT__ 1710,66619
+PetscErrorCode MatDiagonalScale_MPIAIJ(1711,66663
+#undef __FUNCT__ 1743,67822
+#define __FUNCT__ 1744,67841
+PetscErrorCode MatSetBlockSize_MPIAIJ(1745,67884
+#undef __FUNCT__ 1757,68281
+#define __FUNCT__ 1758,68300
+PetscErrorCode MatSetUnfactored_MPIAIJ(1759,68344
+#undef __FUNCT__ 1769,68560
+#define __FUNCT__ 1770,68579
+PetscErrorCode MatEqual_MPIAIJ(1771,68615
+#undef __FUNCT__ 1790,69130
+#define __FUNCT__ 1791,69149
+PetscErrorCode MatCopy_MPIAIJ(1792,69184
+#undef __FUNCT__ 1814,70137
+#define __FUNCT__ 1815,70156
+PetscErrorCode MatSetUpPreallocation_MPIAIJ(1816,70205
+#undef __FUNCT__ 1825,70419
+#define __FUNCT__ 1826,70438
+PetscErrorCode MatAXPY_MPIAIJ(1827,70473
+#undef __FUNCT__ 1869,71915
+#define __FUNCT__ 1870,71934
+PetscErrorCode PETSCMAT_DLLEXPORT MatConjugate_MPIAIJ(1871,71974
+#undef __FUNCT__ 1886,72333
+#define __FUNCT__ 1887,72352
+PetscErrorCode MatRealPart_MPIAIJ(1888,72391
+#undef __FUNCT__ 1899,72638
+#define __FUNCT__ 1900,72657
+PetscErrorCode MatImaginaryPart_MPIAIJ(1901,72701
+#undef __FUNCT__ 1922,73350
+#define __FUNCT__ 1923,73369
+PetscErrorCode MatILUFactorSymbolic_MPIAIJ(1927,73509
+  typedef graph_dist::ilu_default::ilu_level_graph_type  lgraph_type;1949,74344
+#undef __FUNCT__ 1972,75416
+#define __FUNCT__ 1973,75435
+PetscErrorCode MatLUFactorNumeric_MPIAIJ(1974,75481
+#undef __FUNCT__ 1980,75615
+#define __FUNCT__ 1981,75634
+PetscErrorCode MatSolve_MPIAIJ(1985,75762
+  typedef graph_dist::ilu_default::ilu_level_graph_type  lgraph_type;1989,75869
+  typedef boost::multi_array_ref<PetscScalar, 1> array_ref_type;2012,76620
+                                boost::property_map<graph_dist::ilu_default::graph_type, boost::vertex_index_t>::type>  gvector_type;2017,76956
+  PetscInt       nzlocal,::nzlocal2028,77473
+  PetscInt       nzlocal,nsends,::nsends2028,77473
+  PetscInt       nzlocal,nsends,nrecvs;::nrecvs2028,77473
+  PetscMPIInt    *send_rank,::send_rank2029,77513
+  PetscMPIInt    *send_rank,*recv_rank;::recv_rank2029,77513
+  PetscInt       *sbuf_nz,::sbuf_nz2030,77553
+  PetscInt       *sbuf_nz,*rbuf_nz,::rbuf_nz2030,77553
+  PetscInt       *sbuf_nz,*rbuf_nz,*sbuf_j,::sbuf_j2030,77553
+  PetscInt       *sbuf_nz,*rbuf_nz,*sbuf_j,**rbuf_j;::rbuf_j2030,77553
+  PetscScalar    *sbuf_a,::sbuf_a2031,77606
+  PetscScalar    *sbuf_a,**rbuf_a;::rbuf_a2031,77606
+} Mat_Redundant;2033,77678
+#undef __FUNCT__ 2035,77696
+#define __FUNCT__ 2036,77715
+PetscErrorCode PetscContainerDestroy_MatRedundant(2037,77770
+#undef __FUNCT__ 2056,78454
+#define __FUNCT__ 2057,78473
+PetscErrorCode MatDestroy_MatRedundant(2058,78517
+#undef __FUNCT__ 2078,79196
+#define __FUNCT__ 2079,79215
+PetscErrorCode MatGetRedundantMatrix_MPIAIJ(2080,79264
+#undef __FUNCT__ 2401,92251
+#define __FUNCT__ 2402,92270
+PetscErrorCode MatGetRowMaxAbs_MPIAIJ(2403,92313
+#undef __FUNCT__ 2443,93427
+#define __FUNCT__ 2444,93446
+PetscErrorCode MatGetRowMinAbs_MPIAIJ(2445,93489
+#undef __FUNCT__ 2485,94603
+#define __FUNCT__ 2486,94622
+PetscErrorCode MatGetRowMin_MPIAIJ(2487,94662
+#undef __FUNCT__ 2526,96184
+#define __FUNCT__ 2527,96203
+PetscErrorCode MatGetRowMax_MPIAIJ(2528,96243
+#undef __FUNCT__ 2567,97765
+#define __FUNCT__ 2568,97784
+PetscErrorCode MatGetSeqNonzerostructure_MPIAIJ(2569,97838
+static struct _MatOps MatOps_Values 2583,98355
+#undef __FUNCT__ 2724,101070
+#define __FUNCT__ 2725,101089
+PetscErrorCode PETSCMAT_DLLEXPORT MatStoreValues_MPIAIJ(2726,101131
+#undef __FUNCT__ 2739,101444
+#define __FUNCT__ 2740,101463
+PetscErrorCode PETSCMAT_DLLEXPORT MatRetrieveValues_MPIAIJ(2741,101508
+#undef __FUNCT__ 2755,101851
+#define __FUNCT__ 2756,101870
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocation_MPIAIJ(2757,101923
+#undef __FUNCT__ 2804,103893
+#define __FUNCT__ 2805,103912
+PetscErrorCode MatDuplicate_MPIAIJ(2806,103952
+#undef __FUNCT__ 2867,106494
+#define __FUNCT__ 2868,106513
+PetscErrorCode MatLoad_MPIAIJ(2869,106548
+#undef __FUNCT__ 3071,114149
+#define __FUNCT__ 3072,114168
+PetscErrorCode MatGetSubMatrix_MPIAIJ(3073,114211
+#undef __FUNCT__ 3095,115103
+#define __FUNCT__ 3096,115122
+PetscErrorCode MatGetSubMatrix_MPIAIJ_Private(3104,115454
+#undef __FUNCT__ 3225,119565
+#define __FUNCT__ 3226,119584
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocationCSR_MPIAIJ(3227,119640
+#undef __FUNCT__ 3294,121957
+#define __FUNCT__ 3295,121976
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocationCSR(3341,123650
+#undef __FUNCT__ 3353,124095
+#define __FUNCT__ 3354,124114
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJSetPreallocation(3481,129928
+#undef __FUNCT__ 3493,130394
+#define __FUNCT__ 3494,130413
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIAIJWithArrays(3549,132477
+#undef __FUNCT__ 3565,133155
+#define __FUNCT__ 3566,133174
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIAIJ(3740,141189
+#undef __FUNCT__ 3759,141899
+#define __FUNCT__ 3760,141918
+PetscErrorCode PETSCMAT_DLLEXPORT MatMPIAIJGetSeqAIJ(3761,141957
+#undef __FUNCT__ 3772,142208
+#define __FUNCT__ 3773,142227
+PetscErrorCode MatSetColoring_MPIAIJ(3774,142269
+#undef __FUNCT__ 3837,145058
+#define __FUNCT__ 3838,145077
+PetscErrorCode MatSetValuesAdic_MPIAIJ(3839,145121
+#undef __FUNCT__ 3851,145438
+#define __FUNCT__ 3852,145457
+PetscErrorCode MatSetValuesAdifor_MPIAIJ(3853,145503
+#undef __FUNCT__ 3864,145837
+#define __FUNCT__ 3865,145856
+PetscErrorCode PETSCMAT_DLLEXPORT MatMerge(3886,146457
+#undef __FUNCT__ 3935,148463
+#define __FUNCT__ 3936,148482
+PetscErrorCode MatFileSplit(3937,148515
+#undef __FUNCT__ 3979,150162
+#define __FUNCT__ 3980,150181
+PetscErrorCode PETSCMAT_DLLEXPORT MatDestroy_MPIAIJ_SeqsToMPI(3981,150229
+#undef __FUNCT__ 4017,151613
+#define __FUNCT__ 4018,151632
+PetscErrorCode PETSCMAT_DLLEXPORT MatMerge_SeqsToMPINumeric(4042,152471
+#undef __FUNCT__ 4159,156910
+#define __FUNCT__ 4160,156929
+PetscErrorCode PETSCMAT_DLLEXPORT MatMerge_SeqsToMPISymbolic(4161,156976
+#undef __FUNCT__4408,167164
+#define __FUNCT__ 4409,167181
+PetscErrorCode PETSCMAT_DLLEXPORT MatMerge_SeqsToMPI(4410,167220
+#undef __FUNCT__4424,167755
+#define __FUNCT__ 4425,167772
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetLocalMat(4441,168109
+#undef __FUNCT__4519,170849
+#define __FUNCT__ 4520,170866
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetLocalMatCondensed(4537,171318
+#undef __FUNCT__4589,172978
+#define __FUNCT__ 4590,172995
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetBrowsOfAcols(4609,173635
+#undef __FUNCT__4664,175705
+#define __FUNCT__ 4665,175722
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetBrowsOfAoCols(4685,176391
+#undef __FUNCT__4890,184709
+#define __FUNCT__ 4891,184726
+PetscErrorCode PETSCMAT_DLLEXPORT MatGetCommunicationStructs(4909,185289
+#undef __FUNCT__4934,186236
+#define __FUNCT__ 4935,186253
+PetscErrorCode MatMatMultNumeric_MPIDense_MPIAIJ(4945,186678
+#undef __FUNCT__4961,187231
+#define __FUNCT__ 4962,187248
+PetscErrorCode MatMatMultSymbolic_MPIDense_MPIAIJ(4963,187303
+#undef __FUNCT__4982,188129
+#define __FUNCT__ 4983,188146
+PetscErrorCode MatMatMult_MPIDense_MPIAIJ(4984,188193
+#undef __FUNCT__ 5023,189314
+#define __FUNCT__ 5024,189333
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreate_MPIAIJ(5025,189370
+#undef __FUNCT__ 5125,194447
+#define __FUNCT__ 5126,194466
+PetscErrorCode PETSCMAT_DLLEXPORT MatCreateMPIAIJWithSplitArrays(5169,196141
+#define matsetvaluesmpiaij_ 5212,197953
+#define matsetvaluesmpiaij_ 5214,198046
+#undef CHKERRQ5218,198159
+#define CHKERRQ(5219,198174
+#undef SETERRQ25220,198240
+#define SETERRQ2(5221,198256
+#undef SETERRQ5222,198329
+#define SETERRQ(5223,198344
+#undef __FUNCT__ 5226,198428
+#define __FUNCT__ 5227,198447
+void PETSC_STDCALL matsetvaluesmpiaij_(5228,198487
 
 src/mat/impls/aij/mpi/ftn-custom/makefile,140
 makefile:^?makefile^A,1
@@ -22279,42 +22286,42 @@
 #undef __FUNCT__ 48,2301
 #define __FUNCT__ 49,2320
 PetscErrorCode MatConvertToCSC(63,2861
-#undef __FUNCT__ 195,7688
-#define __FUNCT__ 196,7707
-PetscErrorCode MatDestroy_Pastix(201,7833
-#undef __FUNCT__ 243,9184
-#define __FUNCT__ 244,9203
-PetscErrorCode MatSolve_PaStiX(250,9315
-#undef __FUNCT__ 316,11486
-#define __FUNCT__ 317,11506
-PetscErrorCode MatFactorNumeric_PaStiX(318,11550
-#undef __FUNCT__ 476,17623
-#define __FUNCT__ 477,17642
-PetscErrorCode MatLUFactorSymbolic_AIJPASTIX(478,17692
-#undef __FUNCT__ 492,18156
-#define __FUNCT__ 493,18175
-PetscErrorCode MatCholeskyFactorSymbolic_SBAIJPASTIX(494,18233
-#undef __FUNCT__506,18659
-#define __FUNCT__ 507,18676
-PetscErrorCode MatView_PaStiX(508,18711
-#undef __FUNCT__ 549,20283
-#define __FUNCT__ 550,20302
-PetscErrorCode MatGetInfo_PaStiX(551,20340
-#undef __FUNCT__ 570,20915
-#define __FUNCT__ 571,20934
-PetscErrorCode MatFactorGetSolverPackage_pastix(572,20987
-#undef __FUNCT__ 584,21248
-#define __FUNCT__ 585,21267
-PetscErrorCode MatGetFactor_seqaij_pastix(586,21314
-#undef __FUNCT__ 624,22804
-#define __FUNCT__ 625,22823
-PetscErrorCode MatGetFactor_mpiaij_pastix(626,22870
-#undef __FUNCT__ 661,24377
-#define __FUNCT__ 662,24396
-PetscErrorCode MatGetFactor_seqsbaij_pastix(663,24445
-#undef __FUNCT__ 701,26003
-#define __FUNCT__ 702,26022
-PetscErrorCode MatGetFactor_mpisbaij_pastix(703,26071
+#undef __FUNCT__ 200,7948
+#define __FUNCT__ 201,7967
+PetscErrorCode MatDestroy_Pastix(206,8093
+#undef __FUNCT__ 248,9444
+#define __FUNCT__ 249,9463
+PetscErrorCode MatSolve_PaStiX(255,9575
+#undef __FUNCT__ 321,11746
+#define __FUNCT__ 322,11766
+PetscErrorCode MatFactorNumeric_PaStiX(323,11810
+#undef __FUNCT__ 489,18209
+#define __FUNCT__ 490,18228
+PetscErrorCode MatLUFactorSymbolic_AIJPASTIX(491,18278
+#undef __FUNCT__ 505,18742
+#define __FUNCT__ 506,18761
+PetscErrorCode MatCholeskyFactorSymbolic_SBAIJPASTIX(507,18819
+#undef __FUNCT__519,19245
+#define __FUNCT__ 520,19262
+PetscErrorCode MatView_PaStiX(521,19297
+#undef __FUNCT__ 562,20869
+#define __FUNCT__ 563,20888
+PetscErrorCode MatGetInfo_PaStiX(564,20926
+#undef __FUNCT__ 583,21501
+#define __FUNCT__ 584,21520
+PetscErrorCode MatFactorGetSolverPackage_pastix(585,21573
+#undef __FUNCT__ 597,21834
+#define __FUNCT__ 598,21853
+PetscErrorCode MatGetFactor_seqaij_pastix(599,21900
+#undef __FUNCT__ 637,23390
+#define __FUNCT__ 638,23409
+PetscErrorCode MatGetFactor_mpiaij_pastix(639,23456
+#undef __FUNCT__ 674,24963
+#define __FUNCT__ 675,24982
+PetscErrorCode MatGetFactor_seqsbaij_pastix(676,25031
+#undef __FUNCT__ 714,26589
+#define __FUNCT__ 715,26608
+PetscErrorCode MatGetFactor_mpisbaij_pastix(716,26657
 
 src/mat/impls/aij/mpi/mumps/makefile,175
 makefile:^?makefile^A,1
@@ -22481,9 +22488,9 @@
 #undef __FUNCT__675,25184
 #define __FUNCT__ 676,25201
 PetscErrorCode MatFactorInfo_SuperLU_DIST(677,25248
-#undef __FUNCT__718,27576
-#define __FUNCT__ 719,27593
-PetscErrorCode MatView_SuperLU_DIST(720,27634
+#undef __FUNCT__716,27502
+#define __FUNCT__ 717,27519
+PetscErrorCode MatView_SuperLU_DIST(718,27560
 
 src/mat/impls/aij/mpi/spooles/makefile,175
 makefile:^?makefile^A,1
@@ -30943,61 +30950,61 @@
 src/vec/vec/impls/seq/bvec2.c,1930
 bvec2.c:^?bvec2.c^A,1
 #define PETSCVEC_DLL1,0
-#undef __FUNCT__ 16,343
-#define __FUNCT__ 17,362
-PetscErrorCode VecNorm_Seq(18,394
-#undef __FUNCT__ 89,2593
-#define __FUNCT__ 90,2612
-PetscErrorCode VecView_Seq_File(91,2649
-#undef __FUNCT__ 290,10475
-#define __FUNCT__ 291,10494
-static PetscErrorCode VecView_Seq_Draw_LG(292,10534
-#undef __FUNCT__ 329,11675
-#define __FUNCT__ 330,11694
-static PetscErrorCode VecView_Seq_Draw(331,11731
-#undef __FUNCT__ 356,12490
-#define __FUNCT__ 357,12509
-static PetscErrorCode VecView_Seq_Binary(358,12548
-#undef __FUNCT__ 415,14662
-#define __FUNCT__ 416,14681
-PetscErrorCode VecView_Seq_Netcdf(417,14720
-#undef __FUNCT__ 447,15904
-#define __FUNCT__ 448,15923
-PetscErrorCode VecView_Seq_Matlab(449,15962
-#undef __FUNCT__ 466,16467
-#define __FUNCT__ 467,16486
-PetscErrorCode VecView_Seq(468,16518
-#undef __FUNCT__ 521,18439
-#define __FUNCT__ 522,18458
-PetscErrorCode VecGetValues_Seq(523,18495
-#undef __FUNCT__ 541,19121
-#define __FUNCT__ 542,19140
-PetscErrorCode VecSetValues_Seq(543,19177
-#undef __FUNCT__ 572,20255
-#define __FUNCT__ 573,20274
-PetscErrorCode VecSetValuesBlocked_Seq(574,20318
-#undef __FUNCT__ 613,21436
-#define __FUNCT__ 614,21455
-PetscErrorCode VecDestroy_Seq(615,21490
-#undef __FUNCT__ 635,21948
-#define __FUNCT__ 636,21967
-static PetscErrorCode VecPublish_Seq(637,22002
-static struct _VecOps DvOps 646,22189
-#undef __FUNCT__ 707,23926
-#define __FUNCT__ 708,23945
-static PetscErrorCode VecCreate_Seq_Private(709,23987
-#undef __FUNCT__ 733,24977
-#define __FUNCT__ 734,24996
-PetscErrorCode PETSCVEC_DLLEXPORT VecCreateSeqWithArray(766,26059
-#undef __FUNCT__ 794,26916
-#define __FUNCT__ 795,26935
-PetscErrorCode PETSCVEC_DLLEXPORT VecCreate_Seq(796,26969
-#undef __FUNCT__ 820,27724
-#define __FUNCT__ 821,27743
-PetscErrorCode VecDuplicate_Seq(822,27780
-#undef __FUNCT__845,28540
-#define __FUNCT__ 846,28557
-PetscErrorCode VecSetOption_Seq(847,28594
+#undef __FUNCT__ 20,437
+#define __FUNCT__ 21,456
+PetscErrorCode VecNorm_Seq(22,488
+#undef __FUNCT__ 93,2687
+#define __FUNCT__ 94,2706
+PetscErrorCode VecView_Seq_File(95,2743
+#undef __FUNCT__ 294,10569
+#define __FUNCT__ 295,10588
+static PetscErrorCode VecView_Seq_Draw_LG(296,10628
+#undef __FUNCT__ 333,11769
+#define __FUNCT__ 334,11788
+static PetscErrorCode VecView_Seq_Draw(335,11825
+#undef __FUNCT__ 360,12584
+#define __FUNCT__ 361,12603
+static PetscErrorCode VecView_Seq_Binary(362,12642
+#undef __FUNCT__ 419,14756
+#define __FUNCT__ 420,14775
+PetscErrorCode VecView_Seq_Netcdf(421,14814
+#undef __FUNCT__ 451,15998
+#define __FUNCT__ 452,16017
+PetscErrorCode VecView_Seq_Matlab(453,16056
+#undef __FUNCT__ 470,16561
+#define __FUNCT__ 471,16580
+PetscErrorCode VecView_Seq(472,16612
+#undef __FUNCT__ 535,18894
+#define __FUNCT__ 536,18913
+PetscErrorCode VecGetValues_Seq(537,18950
+#undef __FUNCT__ 555,19576
+#define __FUNCT__ 556,19595
+PetscErrorCode VecSetValues_Seq(557,19632
+#undef __FUNCT__ 586,20710
+#define __FUNCT__ 587,20729
+PetscErrorCode VecSetValuesBlocked_Seq(588,20773
+#undef __FUNCT__ 627,21891
+#define __FUNCT__ 628,21910
+PetscErrorCode VecDestroy_Seq(629,21945
+#undef __FUNCT__ 649,22403
+#define __FUNCT__ 650,22422
+static PetscErrorCode VecPublish_Seq(651,22457
+static struct _VecOps DvOps 660,22644
+#undef __FUNCT__ 721,24381
+#define __FUNCT__ 722,24400
+static PetscErrorCode VecCreate_Seq_Private(723,24442
+#undef __FUNCT__ 747,25432
+#define __FUNCT__ 748,25451
+PetscErrorCode PETSCVEC_DLLEXPORT VecCreateSeqWithArray(780,26514
+#undef __FUNCT__ 808,27371
+#define __FUNCT__ 809,27390
+PetscErrorCode PETSCVEC_DLLEXPORT VecCreate_Seq(810,27424
+#undef __FUNCT__ 834,28179
+#define __FUNCT__ 835,28198
+PetscErrorCode VecDuplicate_Seq(836,28235
+#undef __FUNCT__859,28995
+#define __FUNCT__ 860,29012
+PetscErrorCode VecSetOption_Seq(861,29049
 
 src/vec/vec/impls/seq/ftn-custom/makefile,140
 makefile:^?makefile^A,1
@@ -33570,45 +33577,45 @@
 #undef __FUNCT__ 373,11682
 #define __FUNCT__ 374,11701
 PetscErrorCode PETSC_DLLEXPORT PetscViewerASCIIPrintf(399,12625
-#undef __FUNCT__ 461,14916
-#define __FUNCT__ 462,14935
-PetscErrorCode PETSC_DLLEXPORT PetscViewerFileSetName(478,15465
-#undef __FUNCT__ 492,15932
-#define __FUNCT__ 493,15951
-PetscErrorCode PETSC_DLLEXPORT PetscViewerFileGetName(510,16388
-#undef __FUNCT__ 524,16826
-#define __FUNCT__ 525,16845
-PetscErrorCode PETSC_DLLEXPORT PetscViewerFileGetName_ASCII(526,16895
-#undef __FUNCT__ 538,17162
-#define __FUNCT__ 539,17181
-PetscErrorCode PETSC_DLLEXPORT PetscViewerFileSetName_ASCII(540,17231
-#undef __FUNCT__ 616,19543
-#define __FUNCT__ 617,19562
-PetscErrorCode PetscViewerGetSingleton_ASCII(618,19613
-#undef __FUNCT__ 654,20911
-#define __FUNCT__ 655,20930
-PetscErrorCode PetscViewerRestoreSingleton_ASCII(656,20985
-#undef __FUNCT__ 678,21781
-#define __FUNCT__ 679,21800
-PetscErrorCode PetscViewerGetSubcomm_ASCII(680,21849
-#undef __FUNCT__ 718,23278
-#define __FUNCT__ 719,23297
-PetscErrorCode PetscViewerRestoreSubcomm_ASCII(720,23350
-#undef __FUNCT__ 743,24151
-#define __FUNCT__ 744,24170
-PetscErrorCode PETSC_DLLEXPORT PetscViewerCreate_ASCII(745,24215
-#undef __FUNCT__ 786,26107
-#define __FUNCT__ 787,26126
-PetscErrorCode PETSC_DLLEXPORT PetscViewerASCIISynchronizedPrintf(809,26903
-#undef __FUNCT__ 873,29105
-#define __FUNCT__ 874,29124
-PetscErrorCode PetscViewerASCIIMonitorCreate(898,29809
-#undef __FUNCT__ 909,30197
-#define __FUNCT__ 910,30216
-PetscErrorCode PetscViewerASCIIMonitorDestroy(927,30755
-#undef __FUNCT__ 937,31018
-#define __FUNCT__ 938,31037
-PetscErrorCode PETSC_DLLEXPORT PetscViewerASCIIMonitorPrintf(958,31795
+#undef __FUNCT__ 462,14945
+#define __FUNCT__ 463,14964
+PetscErrorCode PETSC_DLLEXPORT PetscViewerFileSetName(479,15494
+#undef __FUNCT__ 493,15961
+#define __FUNCT__ 494,15980
+PetscErrorCode PETSC_DLLEXPORT PetscViewerFileGetName(511,16417
+#undef __FUNCT__ 525,16855
+#define __FUNCT__ 526,16874
+PetscErrorCode PETSC_DLLEXPORT PetscViewerFileGetName_ASCII(527,16924
+#undef __FUNCT__ 539,17191
+#define __FUNCT__ 540,17210
+PetscErrorCode PETSC_DLLEXPORT PetscViewerFileSetName_ASCII(541,17260
+#undef __FUNCT__ 617,19572
+#define __FUNCT__ 618,19591
+PetscErrorCode PetscViewerGetSingleton_ASCII(619,19642
+#undef __FUNCT__ 655,20940
+#define __FUNCT__ 656,20959
+PetscErrorCode PetscViewerRestoreSingleton_ASCII(657,21014
+#undef __FUNCT__ 679,21810
+#define __FUNCT__ 680,21829
+PetscErrorCode PetscViewerGetSubcomm_ASCII(681,21878
+#undef __FUNCT__ 719,23307
+#define __FUNCT__ 720,23326
+PetscErrorCode PetscViewerRestoreSubcomm_ASCII(721,23379
+#undef __FUNCT__ 744,24180
+#define __FUNCT__ 745,24199
+PetscErrorCode PETSC_DLLEXPORT PetscViewerCreate_ASCII(746,24244
+#undef __FUNCT__ 787,26136
+#define __FUNCT__ 788,26155
+PetscErrorCode PETSC_DLLEXPORT PetscViewerASCIISynchronizedPrintf(810,26932
+#undef __FUNCT__ 875,29163
+#define __FUNCT__ 876,29182
+PetscErrorCode PetscViewerASCIIMonitorCreate(900,29867
+#undef __FUNCT__ 911,30255
+#define __FUNCT__ 912,30274
+PetscErrorCode PetscViewerASCIIMonitorDestroy(929,30813
+#undef __FUNCT__ 939,31076
+#define __FUNCT__ 940,31095
+PetscErrorCode PETSC_DLLEXPORT PetscViewerASCIIMonitorPrintf(960,31853
 
 src/sys/viewer/impls/ascii/asciiimpl.h,494
 asciiimpl.h:^?asciiimpl.h^A,1
@@ -35455,142 +35462,144 @@
 #define __FUNCT__ 358,9905
 PetscErrorCode PETSC_DLLEXPORT PetscRegisterFinalizeAll(368,10171
 
-src/sys/objects/options.c,5444
+src/sys/objects/options.c,5508
 options.c:^?options.c^A,1
 #define PETSC_DLL1,0
-#define MAXOPTIONS 24,744
-#define MAXALIASES 25,767
-#define MAXOPTIONSMONITORS 26,789
-  int            N,29,836
-  int            N,argc,29,836
-  int            N,argc,Naliases;29,836
-  char           **args,args30,870
-  char           **args,*names[names30,870
-  char           **args,*names[MAXOPTIONS],*values[values30,870
-  char           *aliases1[aliases131,934
-  char           *aliases1[MAXALIASES],*aliases2[aliases231,934
-  PetscTruth     used[used32,996
-  PetscTruth     namegiven;33,1031
-  char           programname[programname34,1059
-  PetscErrorCode (*monitor[monitor37,1225
-  PetscErrorCode (*monitordestroy[monitordestroy38,1345
-  void           *monitorcontext[monitorcontext39,1422
-  PetscInt       numbermonitors;40,1540
-} PetscOptionsTable;42,1661
-static PetscOptionsTable      *options options45,1684
-#define PetscOptionsMonitor(51,1812
-#undef __FUNCT__ 58,2120
-#define __FUNCT__ 59,2139
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsAtoi(63,2296
-#undef __FUNCT__ 103,3597
-#define __FUNCT__ 104,3616
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsAtod(108,3750
-#undef __FUNCT__ 140,4743
-#define __FUNCT__ 141,4762
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsAtol(145,4916
-#undef __FUNCT__ 174,6301
-#define __FUNCT__ 175,6320
-PetscErrorCode PETSC_DLLEXPORT PetscGetProgramName(194,6827
-#undef __FUNCT__ 205,7221
-#define __FUNCT__ 206,7240
-PetscErrorCode PETSC_DLLEXPORT PetscSetProgramName(207,7280
-#undef __FUNCT__ 217,7547
-#define __FUNCT__ 218,7566
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsValidKey(231,7855
-#undef __FUNCT__ 242,8197
-#define __FUNCT__ 243,8216
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsInsertString(266,9168
-static char *Petscgetline(Petscgetline299,10242
-#undef __FUNCT__ 322,10929
-#define __FUNCT__ 323,10948
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsInsertFile(345,11859
-#undef __FUNCT__ 470,16469
-#define __FUNCT__ 471,16488
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsInsert(496,17408
-#undef __FUNCT__ 596,21406
-#define __FUNCT__ 597,21425
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsPrint(616,21892
-#undef __FUNCT__ 642,22774
-#define __FUNCT__ 643,22793
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetAll(660,23218
-#undef __FUNCT__ 694,24272
-#define __FUNCT__ 695,24291
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsClear(703,24471
-#undef __FUNCT__ 722,24936
-#define __FUNCT__ 723,24955
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsDestroy(735,25247
-#undef __FUNCT__ 747,25497
-#define __FUNCT__ 748,25516
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsSetValue(770,26196
-#undef __FUNCT__ 842,28530
-#define __FUNCT__ 843,28549
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsClearValue(859,29040
-#undef __FUNCT__ 900,30221
-#define __FUNCT__ 901,30240
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsSetAlias(921,31099
-#undef __FUNCT__ 946,32209
-#define __FUNCT__ 947,32228
-static PetscErrorCode PetscOptionsFindPair_Private(948,32277
-#undef __FUNCT__ 1015,34341
-#define __FUNCT__ 1016,34360
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsReject(1038,35284
-#undef __FUNCT__ 1055,35780
-#define __FUNCT__ 1056,35799
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsHasName(1085,36977
-#undef __FUNCT__ 1097,37305
-#define __FUNCT__ 1098,37324
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetInt(1124,38340
-#undef __FUNCT__ 1146,38949
-#define __FUNCT__ 1147,38968
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetEList(1176,40032
-#undef __FUNCT__ 1209,41084
-#define __FUNCT__ 1210,41103
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetEnum(1242,42465
-#undef __FUNCT__ 1261,43233
-#define __FUNCT__ 1262,43252
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetTruth(1295,44533
-#undef __FUNCT__ 1318,45145
-#define __FUNCT__ 1319,45164
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetTruthArray(1352,46424
-#undef __FUNCT__ 1383,47435
-#define __FUNCT__ 1384,47454
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetReal(1410,48401
-#undef __FUNCT__ 1429,49003
-#define __FUNCT__ 1430,49022
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetScalar(1460,50109
-#undef __FUNCT__ 1502,51478
-#define __FUNCT__ 1503,51497
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetRealArray(1532,52600
-#undef __FUNCT__ 1562,53600
-#define __FUNCT__ 1563,53619
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetIntArray(1592,54753
-#undef __FUNCT__ 1647,56849
-#define __FUNCT__ 1648,56868
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetString(1684,58102
-#undef __FUNCT__ 1707,58746
-#define __FUNCT__ 1708,58765
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetStringArray(1745,60121
-#undef __FUNCT__ 1776,61190
-#define __FUNCT__ 1777,61209
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsAllUsed(1791,61501
-#undef __FUNCT__ 1803,61717
-#define __FUNCT__ 1804,61736
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsLeft(1817,62028
-#undef __FUNCT__ 1836,62554
-#define __FUNCT__ 1837,62573
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsCreate(1842,62680
-#undef __FUNCT__1860,63179
-#define __FUNCT__ 1861,63196
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsSetFromOptions(1882,63986
-#undef __FUNCT__ 1903,65013
-#define __FUNCT__ 1904,65032
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsMonitorDefault(1921,65412
-#undef __FUNCT__ 1934,65839
-#define __FUNCT__ 1935,65858
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsMonitorSet(1979,67520
-#undef __FUNCT__ 1991,68092
-#define __FUNCT__ 1992,68111
-PetscErrorCode PETSC_DLLEXPORT PetscOptionsMonitorCancel(2009,68608
+#define _XOPEN_SOURCE 4,142
+#define _BSD_SOURCE5,168
+#define MAXOPTIONS 28,914
+#define MAXALIASES 29,937
+#define MAXOPTIONSMONITORS 30,959
+  int            N,33,1006
+  int            N,argc,33,1006
+  int            N,argc,Naliases;33,1006
+  char           **args,args34,1040
+  char           **args,*names[names34,1040
+  char           **args,*names[MAXOPTIONS],*values[values34,1040
+  char           *aliases1[aliases135,1104
+  char           *aliases1[MAXALIASES],*aliases2[aliases235,1104
+  PetscTruth     used[used36,1166
+  PetscTruth     namegiven;37,1201
+  char           programname[programname38,1229
+  PetscErrorCode (*monitor[monitor41,1395
+  PetscErrorCode (*monitordestroy[monitordestroy42,1515
+  void           *monitorcontext[monitorcontext43,1592
+  PetscInt       numbermonitors;44,1710
+} PetscOptionsTable;46,1831
+static PetscOptionsTable      *options options49,1854
+#define PetscOptionsMonitor(55,1982
+#undef __FUNCT__ 62,2290
+#define __FUNCT__ 63,2309
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsAtoi(67,2466
+#undef __FUNCT__ 111,3838
+#define __FUNCT__ 112,3857
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsAtod(116,3991
+#undef __FUNCT__ 148,4984
+#define __FUNCT__ 149,5003
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsAtol(153,5157
+#undef __FUNCT__ 182,6542
+#define __FUNCT__ 183,6561
+PetscErrorCode PETSC_DLLEXPORT PetscGetProgramName(202,7068
+#undef __FUNCT__ 213,7462
+#define __FUNCT__ 214,7481
+PetscErrorCode PETSC_DLLEXPORT PetscSetProgramName(215,7521
+#undef __FUNCT__ 225,7788
+#define __FUNCT__ 226,7807
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsValidKey(239,8096
+#undef __FUNCT__ 250,8438
+#define __FUNCT__ 251,8457
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsInsertString(274,9409
+static char *Petscgetline(Petscgetline307,10483
+#undef __FUNCT__ 330,11170
+#define __FUNCT__ 331,11189
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsInsertFile(353,12100
+#undef __FUNCT__ 478,16710
+#define __FUNCT__ 479,16729
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsInsert(504,17649
+#undef __FUNCT__ 604,21647
+#define __FUNCT__ 605,21666
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsPrint(624,22133
+#undef __FUNCT__ 650,23015
+#define __FUNCT__ 651,23034
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetAll(668,23459
+#undef __FUNCT__ 702,24513
+#define __FUNCT__ 703,24532
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsClear(711,24712
+#undef __FUNCT__ 730,25177
+#define __FUNCT__ 731,25196
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsDestroy(743,25488
+#undef __FUNCT__ 755,25738
+#define __FUNCT__ 756,25757
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsSetValue(778,26437
+#undef __FUNCT__ 850,28771
+#define __FUNCT__ 851,28790
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsClearValue(867,29281
+#undef __FUNCT__ 908,30462
+#define __FUNCT__ 909,30481
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsSetAlias(929,31340
+#undef __FUNCT__ 954,32450
+#define __FUNCT__ 955,32469
+static PetscErrorCode PetscOptionsFindPair_Private(956,32518
+#undef __FUNCT__ 1023,34582
+#define __FUNCT__ 1024,34601
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsReject(1046,35525
+#undef __FUNCT__ 1063,36021
+#define __FUNCT__ 1064,36040
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsHasName(1093,37218
+#undef __FUNCT__ 1105,37546
+#define __FUNCT__ 1106,37565
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetInt(1132,38581
+#undef __FUNCT__ 1154,39190
+#define __FUNCT__ 1155,39209
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetEList(1184,40273
+#undef __FUNCT__ 1217,41325
+#define __FUNCT__ 1218,41344
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetEnum(1250,42706
+#undef __FUNCT__ 1269,43474
+#define __FUNCT__ 1270,43493
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetTruth(1303,44774
+#undef __FUNCT__ 1326,45386
+#define __FUNCT__ 1327,45405
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetTruthArray(1360,46665
+#undef __FUNCT__ 1391,47676
+#define __FUNCT__ 1392,47695
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetReal(1418,48642
+#undef __FUNCT__ 1437,49244
+#define __FUNCT__ 1438,49263
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetScalar(1468,50350
+#undef __FUNCT__ 1510,51719
+#define __FUNCT__ 1511,51738
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetRealArray(1540,52841
+#undef __FUNCT__ 1570,53841
+#define __FUNCT__ 1571,53860
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetIntArray(1600,54994
+#undef __FUNCT__ 1655,57090
+#define __FUNCT__ 1656,57109
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetString(1692,58343
+#undef __FUNCT__ 1715,58987
+#define __FUNCT__ 1716,59006
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsGetStringArray(1753,60362
+#undef __FUNCT__ 1784,61431
+#define __FUNCT__ 1785,61450
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsAllUsed(1799,61742
+#undef __FUNCT__ 1811,61958
+#define __FUNCT__ 1812,61977
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsLeft(1825,62269
+#undef __FUNCT__ 1844,62795
+#define __FUNCT__ 1845,62814
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsCreate(1850,62921
+#undef __FUNCT__1868,63420
+#define __FUNCT__ 1869,63437
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsSetFromOptions(1890,64227
+#undef __FUNCT__ 1911,65254
+#define __FUNCT__ 1912,65273
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsMonitorDefault(1929,65653
+#undef __FUNCT__ 1942,66080
+#define __FUNCT__ 1943,66099
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsMonitorSet(1987,67761
+#undef __FUNCT__ 1999,68333
+#define __FUNCT__ 2000,68352
+PetscErrorCode PETSC_DLLEXPORT PetscOptionsMonitorCancel(2017,68849
 
 src/sys/objects/gcookie.c,131
 gcookie.c:^?gcookie.c^A,1
@@ -35847,7 +35856,7 @@
 PetscErrorCode PETSC_DLLEXPORT PetscObjectComposedDataIncreaseScalar(197,6184
 PetscErrorCode PETSC_DLLEXPORT PetscObjectComposedDataIncreaseScalarstar(221,7065
 
-src/sys/objects/pinit.c,2787
+src/sys/objects/pinit.c,2785
 pinit.c:^?pinit.c^A,1
 #define PETSC_DLL1,0
 PetscErrorCode __gierr 25,850
@@ -35913,15 +35922,15 @@
 #undef __FUNCT__ 696,23893
 #define __FUNCT__ 697,23912
 PetscErrorCode PETSC_DLLEXPORT PetscFinalize(736,25561
-#undef __FUNCT__ 1001,35386
-#define __FUNCT__ 1002,35405
-PetscErrorCode PETSC_DLLEXPORT PetscGlobalMax(1023,35959
-#undef __FUNCT__ 1028,36123
-#define __FUNCT__ 1029,36142
-PetscErrorCode PETSC_DLLEXPORT PetscGlobalMin(1050,36696
-#undef __FUNCT__ 1055,36860
-#define __FUNCT__ 1056,36879
-PetscErrorCode PETSC_DLLEXPORT PetscGlobalSum(1077,37407
+#undef __FUNCT__ 996,35131
+#define __FUNCT__ 997,35150
+PetscErrorCode PETSC_DLLEXPORT PetscGlobalMax(1018,35704
+#undef __FUNCT__ 1023,35868
+#define __FUNCT__ 1024,35887
+PetscErrorCode PETSC_DLLEXPORT PetscGlobalMin(1045,36441
+#undef __FUNCT__ 1050,36605
+#define __FUNCT__ 1051,36624
+PetscErrorCode PETSC_DLLEXPORT PetscGlobalSum(1072,37152
 
 src/sys/objects/mpinit.c,1149
 mpinit.c:^?mpinit.c^A,1
@@ -37808,24 +37817,24 @@
 #undef __FUNCT__ 238,6705
 #define __FUNCT__ 239,6724
 PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedPrintf(263,7581
-#undef __FUNCT__ 303,8856
-#define __FUNCT__ 304,8875
-PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedFPrintf(327,9588
-#undef __FUNCT__ 366,10871
-#define __FUNCT__ 367,10890
-PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedFlush(386,11502
-#undef __FUNCT__ 440,13338
-#define __FUNCT__ 441,13357
-PetscErrorCode PETSC_DLLEXPORT PetscFPrintf(464,13945
-#undef __FUNCT__ 483,14431
-#define __FUNCT__ 484,14450
-PetscErrorCode PETSC_DLLEXPORT PetscPrintf(509,15145
-#undef __FUNCT__ 556,16803
-#define __FUNCT__ 557,16822
-PetscErrorCode PETSC_DLLEXPORT PetscHelpPrintfDefault(558,16866
-#undef __FUNCT__ 581,17496
-#define __FUNCT__ 582,17515
-PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedFGets(602,18040
+#undef __FUNCT__ 304,8885
+#define __FUNCT__ 305,8904
+PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedFPrintf(328,9617
+#undef __FUNCT__ 368,10953
+#define __FUNCT__ 369,10972
+PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedFlush(388,11584
+#undef __FUNCT__ 442,13420
+#define __FUNCT__ 443,13439
+PetscErrorCode PETSC_DLLEXPORT PetscFPrintf(466,14027
+#undef __FUNCT__ 486,14568
+#define __FUNCT__ 487,14587
+PetscErrorCode PETSC_DLLEXPORT PetscPrintf(512,15282
+#undef __FUNCT__ 560,16969
+#define __FUNCT__ 561,16988
+PetscErrorCode PETSC_DLLEXPORT PetscHelpPrintfDefault(562,17032
+#undef __FUNCT__ 586,17691
+#define __FUNCT__ 587,17710
+PetscErrorCode PETSC_DLLEXPORT PetscSynchronizedFGets(607,18235
 
 src/sys/fileio/fpath.c,355
 fpath.c:^?fpath.c^A,1
@@ -38703,7 +38712,7 @@
 MANSEC 13,194
 LOCDIR 14,209
 
-src/sys/f90-src/f90_cwrap.c,3770
+src/sys/f90-src/f90_cwrap.c,3771
 f90_cwrap.c:^?f90_cwrap.c^A,1
 #define f90array1dcreatescalar_ 6,136
 #define f90array1daccessscalar_ 7,201
@@ -38732,83 +38741,83 @@
 #undef __FUNCT__48,3047
 #define __FUNCT__ 49,3064
 PetscErrorCode F90Array1dCreate(50,3101
-#undef __FUNCT__67,3837
-#define __FUNCT__ 68,3854
-PetscErrorCode PETSC_DLLEXPORT F90Array1dAccess(69,3891
-#undef __FUNCT__86,4568
-#define __FUNCT__ 87,4585
-PetscErrorCode PETSC_DLLEXPORT F90Array1dDestroy(88,4623
-#define f90array2dcreatescalar_ 108,5382
-#define f90array2daccessscalar_ 109,5447
-#define f90array2ddestroyscalar_ 110,5512
-#define f90array2dcreatereal_ 111,5578
-#define f90array2daccessreal_ 112,5641
-#define f90array2ddestroyreal_ 113,5704
-#define f90array2dcreateint_ 114,5768
-#define f90array2daccessint_ 115,5830
-#define f90array2ddestroyint_ 116,5892
-#define f90array2dcreatefortranaddr_ 117,5955
-#define f90array2daccessfortranaddr_ 118,6025
-#define f90array2ddestroyfortranaddr_ 119,6095
-#define f90array2dcreatescalar_ 121,6212
-#define f90array2daccessscalar_ 122,6277
-#define f90array2ddestroyscalar_ 123,6342
-#define f90array2dcreatereal_ 124,6408
-#define f90array2daccessreal_ 125,6471
-#define f90array2ddestroyreal_ 126,6534
-#define f90array2dcreateint_ 127,6598
-#define f90array2daccessint_ 128,6660
-#define f90array2ddestroyint_ 129,6722
-#define f90array2dcreatefortranaddr_ 130,6785
-#define f90array2daccessfortranaddr_ 131,6855
-#define f90array2ddestroyfortranaddr_ 132,6925
-#undef __FUNCT__150,8381
-#define __FUNCT__ 151,8398
-PetscErrorCode F90Array2dCreate(152,8435
-#undef __FUNCT__169,9267
-#define __FUNCT__ 170,9284
-PetscErrorCode PETSC_DLLEXPORT F90Array2dAccess(171,9321
-#undef __FUNCT__188,9998
-#define __FUNCT__ 189,10015
-PetscErrorCode PETSC_DLLEXPORT F90Array2dDestroy(190,10053
-#define f90array1dgetaddrscalar_ 209,10811
-#define f90array1dgetaddrreal_ 210,10879
-#define f90array1dgetaddrint_ 211,10945
-#define f90array1dgetaddrfortranaddr_ 212,11010
-#define f90array1dgetaddrscalar_ 214,11129
-#define f90array1dgetaddrreal_ 215,11197
-#define f90array1dgetaddrint_ 216,11263
-#define f90array1dgetaddrfortranaddr_ 217,11328
-void PETSC_STDCALL f90array1dgetaddrscalar_(221,11424
-void PETSC_STDCALL f90array1dgetaddrreal_(225,11550
-void PETSC_STDCALL f90array1dgetaddrint_(229,11674
-void PETSC_STDCALL f90array1dgetaddrfortranaddr_(233,11797
-#define f90array2dgetaddrscalar_ 241,12055
-#define f90array2dgetaddrreal_ 242,12123
-#define f90array2dgetaddrint_ 243,12189
-#define f90array2dgetaddrfortranaddr_ 244,12254
-#define f90array2dgetaddrscalar_ 246,12373
-#define f90array2dgetaddrreal_ 247,12441
-#define f90array2dgetaddrint_ 248,12507
-#define f90array2dgetaddrfortranaddr_ 249,12572
-void PETSC_STDCALL f90array2dgetaddrscalar_(253,12668
-void PETSC_STDCALL f90array2dgetaddrreal_(257,12794
-void PETSC_STDCALL f90array2dgetaddrint_(261,12918
-void PETSC_STDCALL f90array2dgetaddrfortranaddr_(265,13041
+#undef __FUNCT__70,3983
+#define __FUNCT__ 71,4000
+PetscErrorCode PETSC_DLLEXPORT F90Array1dAccess(72,4037
+#undef __FUNCT__89,4714
+#define __FUNCT__ 90,4731
+PetscErrorCode PETSC_DLLEXPORT F90Array1dDestroy(91,4769
+#define f90array2dcreatescalar_ 111,5528
+#define f90array2daccessscalar_ 112,5593
+#define f90array2ddestroyscalar_ 113,5658
+#define f90array2dcreatereal_ 114,5724
+#define f90array2daccessreal_ 115,5787
+#define f90array2ddestroyreal_ 116,5850
+#define f90array2dcreateint_ 117,5914
+#define f90array2daccessint_ 118,5976
+#define f90array2ddestroyint_ 119,6038
+#define f90array2dcreatefortranaddr_ 120,6101
+#define f90array2daccessfortranaddr_ 121,6171
+#define f90array2ddestroyfortranaddr_ 122,6241
+#define f90array2dcreatescalar_ 124,6358
+#define f90array2daccessscalar_ 125,6423
+#define f90array2ddestroyscalar_ 126,6488
+#define f90array2dcreatereal_ 127,6554
+#define f90array2daccessreal_ 128,6617
+#define f90array2ddestroyreal_ 129,6680
+#define f90array2dcreateint_ 130,6744
+#define f90array2daccessint_ 131,6806
+#define f90array2ddestroyint_ 132,6868
+#define f90array2dcreatefortranaddr_ 133,6931
+#define f90array2daccessfortranaddr_ 134,7001
+#define f90array2ddestroyfortranaddr_ 135,7071
+#undef __FUNCT__153,8527
+#define __FUNCT__ 154,8544
+PetscErrorCode F90Array2dCreate(155,8581
+#undef __FUNCT__172,9413
+#define __FUNCT__ 173,9430
+PetscErrorCode PETSC_DLLEXPORT F90Array2dAccess(174,9467
+#undef __FUNCT__191,10144
+#define __FUNCT__ 192,10161
+PetscErrorCode PETSC_DLLEXPORT F90Array2dDestroy(193,10199
+#define f90array1dgetaddrscalar_ 212,10957
+#define f90array1dgetaddrreal_ 213,11025
+#define f90array1dgetaddrint_ 214,11091
+#define f90array1dgetaddrfortranaddr_ 215,11156
+#define f90array1dgetaddrscalar_ 217,11275
+#define f90array1dgetaddrreal_ 218,11343
+#define f90array1dgetaddrint_ 219,11409
+#define f90array1dgetaddrfortranaddr_ 220,11474
+void PETSC_STDCALL f90array1dgetaddrscalar_(224,11570
+void PETSC_STDCALL f90array1dgetaddrreal_(228,11696
+void PETSC_STDCALL f90array1dgetaddrint_(232,11820
+void PETSC_STDCALL f90array1dgetaddrfortranaddr_(236,11943
+#define f90array2dgetaddrscalar_ 244,12201
+#define f90array2dgetaddrreal_ 245,12269
+#define f90array2dgetaddrint_ 246,12335
+#define f90array2dgetaddrfortranaddr_ 247,12400
+#define f90array2dgetaddrscalar_ 249,12519
+#define f90array2dgetaddrreal_ 250,12587
+#define f90array2dgetaddrint_ 251,12653
+#define f90array2dgetaddrfortranaddr_ 252,12718
+void PETSC_STDCALL f90array2dgetaddrscalar_(256,12814
+void PETSC_STDCALL f90array2dgetaddrreal_(260,12940
+void PETSC_STDCALL f90array2dgetaddrint_(264,13064
+void PETSC_STDCALL f90array2dgetaddrfortranaddr_(268,13187
 
 src/sys/f90-src/f90impl.h,366
 f90impl.h:^?f90impl.h^A,1
 #define __PETSCF90_H3,28
-#define PETSC_F90_2PTR_PROTO_NOVAR 9,188
-#define PETSC_F90_2PTR_PROTO(10,230
-#define PETSC_F90_2PTR_PARAM(11,275
-#define PETSC_F90_2PTR_PROTO_NOVAR13,321
-#define PETSC_F90_2PTR_PROTO(14,356
-#define PETSC_F90_2PTR_PARAM(15,390
-#define F90Array1d 20,463
-#define F90Array2d 21,487
-#define F90Array3d 22,511
-#define F90Array4d 23,535
+#define PETSC_F90_2PTR_PROTO_NOVAR 9,218
+#define PETSC_F90_2PTR_PROTO(10,260
+#define PETSC_F90_2PTR_PARAM(11,305
+#define PETSC_F90_2PTR_PROTO_NOVAR13,351
+#define PETSC_F90_2PTR_PROTO(14,386
+#define PETSC_F90_2PTR_PARAM(15,420
+#define F90Array1d 20,493
+#define F90Array2d 21,517
+#define F90Array3d 22,541
+#define F90Array4d 23,565
 
 src/sys/f90-src/fsrc/makefile,164
 makefile:^?makefile^A,1
@@ -48706,36 +48715,36 @@
 #undef __FUNCT__ 568,19931
 #define __FUNCT__ 569,19950
 PetscErrorCode PETSCDM_DLLEXPORT DAGetMatrix(596,21012
-#undef __FUNCT__ 722,26553
-#define __FUNCT__ 723,26572
-PetscErrorCode DAGetMatrix2d_MPIAIJ(724,26614
-#undef __FUNCT__ 827,30373
-#define __FUNCT__ 828,30392
-PetscErrorCode DAGetMatrix2d_MPIAIJ_Fill(829,30439
-#undef __FUNCT__ 956,35054
-#define __FUNCT__ 957,35073
-PetscErrorCode DAGetMatrix3d_MPIAIJ(958,35115
-#undef __FUNCT__ 1072,39556
-#define __FUNCT__ 1073,39575
-PetscErrorCode DAGetMatrix1d_MPIAIJ(1074,39617
-#undef __FUNCT__ 1136,41942
-#define __FUNCT__ 1137,41961
-PetscErrorCode DAGetMatrix2d_MPIBAIJ(1138,42004
-#undef __FUNCT__ 1230,45626
-#define __FUNCT__ 1231,45645
-PetscErrorCode DAGetMatrix3d_MPIBAIJ(1232,45688
-#undef __FUNCT__ 1340,49925
-#define __FUNCT__ 1341,49944
-static PetscErrorCode L2GFilterUpperTriangular(1346,50157
-#undef __FUNCT__ 1361,50598
-#define __FUNCT__ 1362,50617
-PetscErrorCode DAGetMatrix2d_MPISBAIJ(1363,50661
-#undef __FUNCT__ 1459,54460
-#define __FUNCT__ 1460,54479
-PetscErrorCode DAGetMatrix3d_MPISBAIJ(1461,54523
-#undef __FUNCT__ 1573,59001
-#define __FUNCT__ 1574,59020
-PetscErrorCode DAGetMatrix3d_MPIAIJ_Fill(1575,59067
+#undef __FUNCT__ 722,26561
+#define __FUNCT__ 723,26580
+PetscErrorCode DAGetMatrix2d_MPIAIJ(724,26622
+#undef __FUNCT__ 827,30381
+#define __FUNCT__ 828,30400
+PetscErrorCode DAGetMatrix2d_MPIAIJ_Fill(829,30447
+#undef __FUNCT__ 956,35062
+#define __FUNCT__ 957,35081
+PetscErrorCode DAGetMatrix3d_MPIAIJ(958,35123
+#undef __FUNCT__ 1072,39564
+#define __FUNCT__ 1073,39583
+PetscErrorCode DAGetMatrix1d_MPIAIJ(1074,39625
+#undef __FUNCT__ 1136,41950
+#define __FUNCT__ 1137,41969
+PetscErrorCode DAGetMatrix2d_MPIBAIJ(1138,42012
+#undef __FUNCT__ 1230,45634
+#define __FUNCT__ 1231,45653
+PetscErrorCode DAGetMatrix3d_MPIBAIJ(1232,45696
+#undef __FUNCT__ 1340,49933
+#define __FUNCT__ 1341,49952
+static PetscErrorCode L2GFilterUpperTriangular(1346,50165
+#undef __FUNCT__ 1361,50606
+#define __FUNCT__ 1362,50625
+PetscErrorCode DAGetMatrix2d_MPISBAIJ(1363,50669
+#undef __FUNCT__ 1459,54468
+#define __FUNCT__ 1460,54487
+PetscErrorCode DAGetMatrix3d_MPISBAIJ(1461,54531
+#undef __FUNCT__ 1573,59009
+#define __FUNCT__ 1574,59028
+PetscErrorCode DAGetMatrix3d_MPIAIJ_Fill(1575,59075
 
 src/dm/da/utils/pack.c,7094
 pack.c:^?pack.c^A,1
@@ -58457,11 +58466,11 @@
 LIBBASE 11,155
 LOCDIR 12,178
 
-src/ksp/ksp/impls/gmres/fgmres/ftn-custom/zmodpcff.c,207
+src/ksp/ksp/impls/gmres/fgmres/ftn-custom/zmodpcff.c,367
 zmodpcff.c:^?zmodpcff.c^A,1
-static PetscErrorCode ourmodify(10,259
-static PetscErrorCode ourmoddestroy(17,614
-void PETSC_STDCALL kspfgmressetmodifypc_(29,1149
+static PetscErrorCode ourmodify(14,493
+static PetscErrorCode ourmoddestroy(21,848
+void PETSC_STDCALL kspfgmressetmodifypc_(33,1383
 
 src/ksp/ksp/impls/minres/makefile,136
 makefile:^?makefile^A,1
@@ -59562,7 +59571,7 @@
 	  ${OMAKE} PETSC_ARCH=${PETSC_ARCH} PETSC_DIR=${PETSC_DIR} ACTION=${TESTMODE}_$$i MPIEXEC=120,6574
 	make ACTION=124,6715
 
-conf/rules,15687
+conf/rules,15708
 rules:^?rules^A,1
 	@mypwd=6,111
 	@mypwd=`pwd`; cd ${PETSC_DIR} 2>&1 > /dev/null;null6,111
@@ -59759,86 +59768,87 @@
 	-@cd ${PETSC_DIR}/config/BuildSystem;BuildSystem838,34044
 	-@for i in ${$842,34106
 	    /bin/echo -n ${LOCDIR}$${i} " " >> ${BASE_DIR}/files;files843,34135
-	-@cd ${$882,34939
-	-@cd ${$895,35578
-	-@cd ${$899,35694
-	${CLINKER} -shared -Wl,Wl900,35728
-	${CLINKER} -shared -Wl,-soname,soname900,35728
-	-@cd ${$903,35915
-	sys_lib=904,35949
-	sys_lib=`echo "${SYS_LIB}" | sed s?-Wl,-rpath?-L?g`; external_lib=904,35949
-	-@cd ${$908,36227
-	-@cd ${$912,36418
-	${AR} x ${INSTALL_LIB_DIR}/lt_${LIBNAME}.${$913,36452
-	${LIBTOOL} --mode=mode914,36514
-	${LIBTOOL} --mode=link ${CLINKER} ${CFLAGS} ${CCPPFLAGS} -rpath ${INSTALL_LIB_DIR} -o ${LIBNAME}.la *.lo;lo914,36514
-	${LIBTOOL} --mode=mode915,36623
-	-@cd ${$922,36831
-        if [ "${LIBNAME}" = "libpetsc" ]; then OTHERLIBS=923,36865
-        if [ "${LIBNAME}" = "libpetsc" ]; then OTHERLIBS="${PACKAGES_LIBS} ${EXTERNAL_LIB}  ${SYS_LIB}  ${OTHERSHAREDLIBS}  ${SL_LINKER_LIBS} -lm -lc "; fi;923,36865
-        if [ "${LIBNAME}" = "libpetscsys" ]; then OTHERLIBS=924,37023
-        if [ "${LIBNAME}" = "libpetscsys" ]; then OTHERLIBS="${EXTERNAL_LIB}  ${SYS_LIB}  ${OTHERSHAREDLIBS}  ${SL_LINKER_LIBS} -lm -lc "; fi;924,37023
-        if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS=925,37167
-        if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS="${HYPRE_LIB} ${PETSC_SYS_LIB_BASIC}"  ; fi;925,37167
-        if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS=926,37273
-        if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS="${PLAPACK_LIB} ${SCOTCH_LIB} ${PARTY_LIB} ${CHACO_LIB} ${JOSTLE_LIB} ${SUPERLU_LIB} ${SUPERLU_DIST_LIB} ${SPOOLES_LIB} ${MUMPS_LIB} ${SCALAPACK_LIB} ${BLACS_LIB} ${PARMETIS_LIB} ${UMFPACK_LIB} ${LUSOL_LIB} ${DSCPACK_LIB} ${PETSC_VEC_LIB_BASIC}"  ; fi;926,37273
-        if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS=927,37587
-        if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS="${TRIANGLE_LIB} ${TETGEN_LIB} ${HYPRE_LIB} ${PETSC_MAT_LIB_BASIC} ${MPI_LIB}"  ; fi;927,37587
-        if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS=928,37733
-        if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS="${HYPRE_LIB} ${PETSC_DM_LIB_BASIC}"  ; fi;928,37733
-        if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS=929,37838
-        if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS="${PETSC_KSP_LIB_BASIC}"  ; fi;929,37838
-        if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS=930,37932
-        if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS="${SUNDIALS_LIB} ${PETSC_SNES_LIB_BASIC}"  ; fi;930,37932
-        if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS=931,38041
-        if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS="${PETSC_TS_LIB_BASIC}"  ; fi;931,38041
-        if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS=932,38137
-        if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS="${PETSC_TS_LIB_BASIC}"  ; fi;932,38137
-        if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS=933,38233
-        if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS="${PETSC_KSP_LIB_BASIC} ${SLEPC_EXTERNAL_LIB}"  ; fi;933,38233
-        if [ "${LIBNAME}" = "libtao" ]; then OTHERLIBS=934,38345
-        if [ "${LIBNAME}" = "libtao" ]; then OTHERLIBS="${PETSC_TS_LIB_BASIC}"  ; fi;934,38345
-        if [ "${LIBNAME}" = "libtaopetsc" ]; then OTHERLIBS=935,38432
-        if [ "${LIBNAME}" = "libtaopetsc" ]; then OTHERLIBS="-L${TAO_LIB_DIR} -ltao ${PETSC_TS_LIB_BASIC}"  ; fi;935,38432
-        if [ "${LIBNAME}" = "libtaofortran" ]; then OTHERLIBS=936,38547
-        if [ "${LIBNAME}" = "libtaofortran" ]; then OTHERLIBS="-L${TAO_LIB_DIR} -ltaopetsc -ltao ${PETSC_TS_LIB_BASIC}"  ; fi;936,38547
-        if [ "${MACOSX_DEPLOYMENT_TARGET}" = "" ]; then MACOSX_DEPLOYMENT_TARGET=937,38675
-        if [ "${MACOSX_DEPLOYMENT_TARGET}" = "" ]; then MACOSX_DEPLOYMENT_TARGET=10.5; export MACOSX_DEPLOYMENT_TARGET;937,38675
-        if [ "${MACOSX_DEPLOYMENT_TARGET}" = "" ]; then MACOSX_DEPLOYMENT_TARGET=10.5; export MACOSX_DEPLOYMENT_TARGET; fi;937,38675
-        ${LD_SHARED} -g  -dynamiclib -single_module -multiply_defined suppress -undefined dynamic_lookup ${DARWIN_COMMONS_USE_DYLIBS} -o ${INSTALL_LIB_DIR}/$$LIBNAME.dylib *.o -L${PETSC_LIB_DIR}  $$OTHERLIBS;938,38800
-	if [ -f /usr/bin/dsymutil ]; then /usr/bin/dsymutil ${INSTALL_LIB_DIR}/$$LIBNAME.dylib > /dev/null;null939,39011
-	-@cd ${$942,39131
-       if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS=943,39165
-       if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) $(PETSC_SYS_LIB_BASIC)"  ; fi;943,39165
-       if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS=944,39276
-       if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS="${PLAPACK_LIB} -L$(PETSC_LIB_DIR) ${PETSC_VEC_LIB_BASIC}"  ; fi;944,39276
-       if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS=945,39402
-       if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_MAT_LIB_BASIC}"  ; fi;945,39402
-       if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS=946,39512
-       if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_DM_LIB_BASIC}"  ; fi;946,39512
-       if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS=947,39622
-       if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_KSP_LIB_BASIC}"  ; fi;947,39622
-       if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS=948,39734
-       if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_SNES_LIB_BASIC}"  ; fi;948,39734
-       if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS=949,39845
-       if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_TS_LIB_BASIC}"  ; fi;949,39845
-       if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS=950,39959
-       if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_TS_LIB_BASIC}"  ; fi;950,39959
-       if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS=951,40073
-       if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_KSP_LIB_BASIC}"  ; fi;951,40073
-	-@if @if967,41049
-	-@if @if972,41165
-            cwd=974,41272
-	      mkdir ${INSTALL_LIB_DIR}/$$LIBNAME.tmp-petsc-shlib;shlib977,41340
-	      if test -f ${INSTALL_LIB_DIR}/$$LIBNAME.${AR_LIB_SUFFIX} -o -f ${INSTALL_LIB_DIR}/lt_$$LIBNAME.${$978,41401
-	        if test -f ${INSTALL_LIB_DIR}/$$LIBNAME.${$979,41528
-	          flag=980,41605
-	          flag=`find ${INSTALL_LIB_DIR} -type f -name $$LIBNAME.${AR_LIB_SUFFIX} -newer ${INSTALL_LIB_DIR}/$$LIBNAME.${SL_LINKER_SUFFIX} -print`print980,41605
-	            flag=982,41794
-	            flag=`find ${INSTALL_LIB_DIR} -type f -name lt_$$LIBNAME.${AR_LIB_SUFFIX} -newer ${INSTALL_LIB_DIR}/$$LIBNAME.${SL_LINKER_SUFFIX} -print`print982,41794
-	          fi;983,41948
-	          flag=985,41981
-	        fi;986,42008
+	-@cd ${$882,34937
+	-@cd ${$886,35106
+	-@cd ${$899,35745
+	-@cd ${$903,35861
+	${CLINKER} -shared -Wl,Wl904,35895
+	${CLINKER} -shared -Wl,-soname,soname904,35895
+	-@cd ${$907,36082
+	sys_lib=908,36116
+	sys_lib=`echo "${SYS_LIB}" | sed s?-Wl,-rpath?-L?g`; external_lib=908,36116
+	-@cd ${$912,36394
+	-@cd ${$916,36585
+	${AR} x ${INSTALL_LIB_DIR}/lt_${LIBNAME}.${$917,36619
+	${LIBTOOL} --mode=mode918,36681
+	${LIBTOOL} --mode=link ${CLINKER} ${CFLAGS} ${CCPPFLAGS} -rpath ${INSTALL_LIB_DIR} -o ${LIBNAME}.la *.lo;lo918,36681
+	${LIBTOOL} --mode=mode919,36790
+	-@cd ${$926,36998
+        if [ "${LIBNAME}" = "libpetsc" ]; then OTHERLIBS=927,37032
+        if [ "${LIBNAME}" = "libpetsc" ]; then OTHERLIBS="${PACKAGES_LIBS} ${EXTERNAL_LIB}  ${SYS_LIB}  ${OTHERSHAREDLIBS}  ${SL_LINKER_LIBS} -lm -lc "; fi;927,37032
+        if [ "${LIBNAME}" = "libpetscsys" ]; then OTHERLIBS=928,37190
+        if [ "${LIBNAME}" = "libpetscsys" ]; then OTHERLIBS="${EXTERNAL_LIB}  ${SYS_LIB}  ${OTHERSHAREDLIBS}  ${SL_LINKER_LIBS} -lm -lc "; fi;928,37190
+        if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS=929,37334
+        if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS="${HYPRE_LIB} ${PETSC_SYS_LIB_BASIC}"  ; fi;929,37334
+        if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS=930,37440
+        if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS="${PLAPACK_LIB} ${SCOTCH_LIB} ${PARTY_LIB} ${CHACO_LIB} ${JOSTLE_LIB} ${SUPERLU_LIB} ${SUPERLU_DIST_LIB} ${SPOOLES_LIB} ${MUMPS_LIB} ${SCALAPACK_LIB} ${BLACS_LIB} ${PARMETIS_LIB} ${UMFPACK_LIB} ${LUSOL_LIB} ${DSCPACK_LIB} ${PETSC_VEC_LIB_BASIC}"  ; fi;930,37440
+        if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS=931,37754
+        if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS="${TRIANGLE_LIB} ${TETGEN_LIB} ${HYPRE_LIB} ${PETSC_MAT_LIB_BASIC} ${MPI_LIB}"  ; fi;931,37754
+        if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS=932,37900
+        if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS="${HYPRE_LIB} ${PETSC_DM_LIB_BASIC}"  ; fi;932,37900
+        if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS=933,38005
+        if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS="${PETSC_KSP_LIB_BASIC}"  ; fi;933,38005
+        if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS=934,38099
+        if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS="${SUNDIALS_LIB} ${PETSC_SNES_LIB_BASIC}"  ; fi;934,38099
+        if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS=935,38208
+        if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS="${PETSC_TS_LIB_BASIC}"  ; fi;935,38208
+        if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS=936,38304
+        if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS="${PETSC_TS_LIB_BASIC}"  ; fi;936,38304
+        if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS=937,38400
+        if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS="${PETSC_KSP_LIB_BASIC} ${SLEPC_EXTERNAL_LIB}"  ; fi;937,38400
+        if [ "${LIBNAME}" = "libtao" ]; then OTHERLIBS=938,38512
+        if [ "${LIBNAME}" = "libtao" ]; then OTHERLIBS="${PETSC_TS_LIB_BASIC}"  ; fi;938,38512
+        if [ "${LIBNAME}" = "libtaopetsc" ]; then OTHERLIBS=939,38599
+        if [ "${LIBNAME}" = "libtaopetsc" ]; then OTHERLIBS="-L${TAO_LIB_DIR} -ltao ${PETSC_TS_LIB_BASIC}"  ; fi;939,38599
+        if [ "${LIBNAME}" = "libtaofortran" ]; then OTHERLIBS=940,38714
+        if [ "${LIBNAME}" = "libtaofortran" ]; then OTHERLIBS="-L${TAO_LIB_DIR} -ltaopetsc -ltao ${PETSC_TS_LIB_BASIC}"  ; fi;940,38714
+        if [ "${MACOSX_DEPLOYMENT_TARGET}" = "" ]; then MACOSX_DEPLOYMENT_TARGET=941,38842
+        if [ "${MACOSX_DEPLOYMENT_TARGET}" = "" ]; then MACOSX_DEPLOYMENT_TARGET=10.5; export MACOSX_DEPLOYMENT_TARGET;941,38842
+        if [ "${MACOSX_DEPLOYMENT_TARGET}" = "" ]; then MACOSX_DEPLOYMENT_TARGET=10.5; export MACOSX_DEPLOYMENT_TARGET; fi;941,38842
+        ${LD_SHARED} -g  -dynamiclib -single_module -multiply_defined suppress -undefined dynamic_lookup ${DARWIN_COMMONS_USE_DYLIBS} -o ${INSTALL_LIB_DIR}/$$LIBNAME.dylib *.o -L${PETSC_LIB_DIR}  $$OTHERLIBS;942,38967
+	if [ -f /usr/bin/dsymutil ]; then /usr/bin/dsymutil ${INSTALL_LIB_DIR}/$$LIBNAME.dylib > /dev/null;null943,39178
+	-@cd ${$946,39298
+       if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS=947,39332
+       if [ "${LIBNAME}" = "libpetscvec" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) $(PETSC_SYS_LIB_BASIC)"  ; fi;947,39332
+       if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS=948,39443
+       if [ "${LIBNAME}" = "libpetscmat" ]; then OTHERLIBS="${PLAPACK_LIB} -L$(PETSC_LIB_DIR) ${PETSC_VEC_LIB_BASIC}"  ; fi;948,39443
+       if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS=949,39569
+       if [ "${LIBNAME}" = "libpetscdm" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_MAT_LIB_BASIC}"  ; fi;949,39569
+       if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS=950,39679
+       if [ "${LIBNAME}" = "libpetscksp" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_DM_LIB_BASIC}"  ; fi;950,39679
+       if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS=951,39789
+       if [ "${LIBNAME}" = "libpetscsnes" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_KSP_LIB_BASIC}"  ; fi;951,39789
+       if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS=952,39901
+       if [ "${LIBNAME}" = "libpetscts" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_SNES_LIB_BASIC}"  ; fi;952,39901
+       if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS=953,40012
+       if [ "${LIBNAME}" = "libpetscfortran" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_TS_LIB_BASIC}"  ; fi;953,40012
+       if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS=954,40126
+       if [ "${LIBNAME}" = "libpetsccontrib" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_TS_LIB_BASIC}"  ; fi;954,40126
+       if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS=955,40240
+       if [ "${LIBNAME}" = "libslepc" ]; then OTHERLIBS="-L$(PETSC_LIB_DIR) ${PETSC_KSP_LIB_BASIC}"  ; fi;955,40240
+	-@if @if971,41216
+	-@if @if976,41332
+            cwd=978,41439
+	      mkdir ${INSTALL_LIB_DIR}/$$LIBNAME.tmp-petsc-shlib;shlib981,41507
+	      if test -f ${INSTALL_LIB_DIR}/$$LIBNAME.${AR_LIB_SUFFIX} -o -f ${INSTALL_LIB_DIR}/lt_$$LIBNAME.${$982,41568
+	        if test -f ${INSTALL_LIB_DIR}/$$LIBNAME.${$983,41695
+	          flag=984,41772
+	          flag=`find ${INSTALL_LIB_DIR} -type f -name $$LIBNAME.${AR_LIB_SUFFIX} -newer ${INSTALL_LIB_DIR}/$$LIBNAME.${SL_LINKER_SUFFIX} -print`print984,41772
+	            flag=986,41961
+	            flag=`find ${INSTALL_LIB_DIR} -type f -name lt_$$LIBNAME.${AR_LIB_SUFFIX} -newer ${INSTALL_LIB_DIR}/$$LIBNAME.${SL_LINKER_SUFFIX} -print`print986,41961
+	          fi;987,42115
+	          flag=989,42148
+	        fi;990,42175
 
 conf/adicmfb.init,19
 adicmfb.init:^?adicmfb.init^A,1
