
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>PetscInitialize</title><meta name="generator" content="MATLAB 7.11"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2011-10-29"><meta name="DC.source" content="PetscInitialize.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> err = PetscInitialize(args,argfile,arghelp)
<span class="comment">%</span>
<span class="comment">%  PETSc must be configured with --with-shared-libraries --with-matlab-engine --with-matlab [--download-f2cblaslapack]</span>
<span class="comment">%</span>
<span class="comment">%  The option --download-f2cblaslapack must be used if using 64bit MATLAB on LINUX or 64bit MATLAB and the --download-ml external package on Apple Mac OS X.</span>
<span class="comment">%</span>
<span class="comment">%  You can build with or without MPI, but cannot run on more than one process</span>
<span class="comment">%</span>
<span class="comment">%  There is currently no MPI in the API, the MPI_Comm is not in any of the</span>
<span class="comment">%  argument lists but otherwise the argument lists try to mimic the C binding</span>
<span class="comment">%</span>
<span class="comment">%  Add ${PETSC_DIR}/bin/matlab/classes to your MATLAB path</span>
<span class="comment">%</span>
<span class="comment">%  In MATLAB use help PETSc to get started using PETSc from MATLAB</span>
<span class="comment">%</span>
<span class="comment">%</span>

<span class="keyword">if</span> ~libisloaded(<span class="string">'libpetsc'</span>)
  PETSC_DIR = getenv(<span class="string">'PETSC_DIR'</span>);
  PETSC_ARCH = getenv(<span class="string">'PETSC_ARCH'</span>);
  <span class="keyword">if</span> (length(PETSC_DIR) == 0)
    disp(<span class="string">'Must have environmental variable PETSC_DIR set'</span>)
  <span class="keyword">end</span>
  <span class="keyword">if</span> (length(PETSC_ARCH) == 0)
    disp(<span class="string">'Must have environmental variable PETSC_ARCH set'</span>)
  <span class="keyword">end</span>
  loadlibrary([PETSC_DIR <span class="string">'/'</span> PETSC_ARCH <span class="string">'/lib/'</span> <span class="string">'libpetsc'</span>], [PETSC_DIR <span class="string">'/bin/matlab/classes/matlabheader.h'</span>]);
<span class="keyword">end</span>

<span class="keyword">if</span> (nargin == 0)
  args = <span class="string">''</span>;
<span class="keyword">end</span>
<span class="keyword">if</span> (nargin &lt; 2)
  argfile = <span class="string">''</span>;
<span class="keyword">end</span>
<span class="keyword">if</span> (nargin &lt; 3)
  arghelp = <span class="string">''</span>;
<span class="keyword">end</span>
<span class="keyword">if</span> (ischar(args))
  args = {args};
<span class="keyword">end</span>

<span class="comment">% append any options in the options variable</span>
<span class="keyword">global</span> options
<span class="keyword">if</span> (length(options) &gt; 0)
  args = [args,options];
  disp(<span class="string">'Using additional options'</span>)
  disp(options)
<span class="keyword">end</span>

<span class="comment">% first argument should be program name, use matlab for this</span>
arg = [<span class="string">'matlab'</span>,args];
<span class="comment">%</span>
<span class="comment">% If the user forgot to PetscFinalize() we do it for them, before restarting PETSc</span>
<span class="comment">%</span>
init = calllib(<span class="string">'libpetsc'</span>, <span class="string">'PetscInitializedMatlab'</span>);
<span class="keyword">if</span> (init)
  err = calllib(<span class="string">'libpetsc'</span>, <span class="string">'PetscFinalize'</span>);PetscCHKERRQ(err);
<span class="keyword">end</span>
err = calllib(<span class="string">'libpetsc'</span>, <span class="string">'PetscInitializeMatlab'</span>, length(arg), arg,argfile,arghelp);PetscCHKERRQ(err);
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.11<br></p></div><!--
##### SOURCE BEGIN #####
function err = PetscInitialize(args,argfile,arghelp)
%
%  PETSc must be configured with REPLACE_WITH_DASH_DASHwith-shared-libraries REPLACE_WITH_DASH_DASHwith-matlab-engine REPLACE_WITH_DASH_DASHwith-matlab [REPLACE_WITH_DASH_DASHdownload-f2cblaslapack]
%
%  The option REPLACE_WITH_DASH_DASHdownload-f2cblaslapack must be used if using 64bit MATLAB on LINUX or 64bit MATLAB and the REPLACE_WITH_DASH_DASHdownload-ml external package on Apple Mac OS X.
%
%  You can build with or without MPI, but cannot run on more than one process
%
%  There is currently no MPI in the API, the MPI_Comm is not in any of the 
%  argument lists but otherwise the argument lists try to mimic the C binding
%
%  Add ${PETSC_DIR}/bin/matlab/classes to your MATLAB path
%
%  In MATLAB use help PETSc to get started using PETSc from MATLAB
%
%

if ~libisloaded('libpetsc')
  PETSC_DIR = getenv('PETSC_DIR');
  PETSC_ARCH = getenv('PETSC_ARCH');
  if (length(PETSC_DIR) == 0) 
    disp('Must have environmental variable PETSC_DIR set')
  end
  if (length(PETSC_ARCH) == 0) 
    disp('Must have environmental variable PETSC_ARCH set')
  end
  loadlibrary([PETSC_DIR '/' PETSC_ARCH '/lib/' 'libpetsc'], [PETSC_DIR '/bin/matlab/classes/matlabheader.h']);
end

if (nargin == 0)
  args = '';
end
if (nargin < 2) 
  argfile = '';
end
if (nargin < 3)
  arghelp = '';
end
if (ischar(args)) 
  args = {args};
end

% append any options in the options variable
global options
if (length(options) > 0)
  args = [args,options];
  disp('Using additional options')
  disp(options)
end

% first argument should be program name, use matlab for this
arg = ['matlab',args];
%
% If the user forgot to PetscFinalize() we do it for them, before restarting PETSc
%
init = calllib('libpetsc', 'PetscInitializedMatlab');
if (init) 
  err = calllib('libpetsc', 'PetscFinalize');PetscCHKERRQ(err);
end
err = calllib('libpetsc', 'PetscInitializeMatlab', length(arg), arg,argfile,arghelp);PetscCHKERRQ(err);



##### SOURCE END #####
--></body></html>